2025-09-24 15:04:28 [INFO]  Load config from ./configs/CIFAR10_alpha0.1.yaml
2025-09-24 15:04:28 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.1', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.1}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:30 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:30 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 15:04:30 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:31 [INFO]  OneshotOurs
2025-09-24 15:04:31 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 15:04:31 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 15:04:32 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 15:04:34 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 15:04:36 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 15:04:38 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 15:04:40 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 15:04:42 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 15:04:44 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 15:04:46 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 15:04:48 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 15:04:49 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 15:04:51 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 15:04:53 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 15:04:55 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 15:04:57 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 15:04:59 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 15:05:00 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 15:05:02 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 15:05:04 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 15:05:06 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 15:05:08 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 15:05:10 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 15:05:10 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 15:05:11 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 15:05:11 [INFO]  Two-stage training enabled: Alignment epochs set to 1.
2025-09-24 15:05:11 [INFO]  Round 0 starts--------|
2025-09-24 15:05:11 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:17 [INFO]  generating sample per sample
2025-09-24 15:05:17 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:05:50 [INFO]  Epoch 0 loss: 249.7390694618225; train accuracy: 0.003963694852941176; test accuracy: 0.1
2025-09-24 15:05:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_0.pth
2025-09-24 15:05:50 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:23 [INFO]  Epoch 1 loss: 356.60999298095703; train accuracy: 0.3245634191176471; test accuracy: 0.1254
2025-09-24 15:06:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:55 [INFO]  Epoch 2 loss: 328.4556760787964; train accuracy: 0.39803538602941174; test accuracy: 0.2268
2025-09-24 15:06:55 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:27 [INFO]  Epoch 3 loss: 322.3189506530762; train accuracy: 0.4120519301470588; test accuracy: 0.2234
2025-09-24 15:07:27 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:01 [INFO]  Epoch 4 loss: 318.999680519104; train accuracy: 0.3493221507352941; test accuracy: 0.1366
2025-09-24 15:08:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:08:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:08:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:08:06 [INFO]  generating sample per sample
2025-09-24 15:08:06 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:08:40 [INFO]  Epoch 0 loss: 263.9524230957031; train accuracy: 0.23795572916666666; test accuracy: 0.0979
2025-09-24 15:08:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_0.pth
2025-09-24 15:08:40 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:15 [INFO]  Epoch 1 loss: 366.79730319976807; train accuracy: 0.3275282118055556; test accuracy: 0.2025
2025-09-24 15:09:15 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:50 [INFO]  Epoch 2 loss: 346.78671741485596; train accuracy: 0.3514539930555556; test accuracy: 0.1618
2025-09-24 15:09:50 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:22 [INFO]  Epoch 3 loss: 343.9357089996338; train accuracy: 0.4300130208333333; test accuracy: 0.1938
2025-09-24 15:10:22 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:51 [INFO]  Epoch 4 loss: 332.6708917617798; train accuracy: 0.3709852430555556; test accuracy: 0.1782
2025-09-24 15:10:51 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:10:51 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:10:51 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:10:57 [INFO]  generating sample per sample
2025-09-24 15:10:57 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:11:45 [INFO]  Epoch 0 loss: 417.41118335723877; train accuracy: 0.10816271551724138; test accuracy: 0.0794
2025-09-24 15:11:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_0.pth
2025-09-24 15:11:45 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:31 [INFO]  Epoch 1 loss: 589.1502408981323; train accuracy: 0.18622036637931033; test accuracy: 0.1269
2025-09-24 15:12:31 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:23 [INFO]  Epoch 2 loss: 547.1013317108154; train accuracy: 0.37351831896551724; test accuracy: 0.2844
2025-09-24 15:13:23 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:14 [INFO]  Epoch 3 loss: 523.825795173645; train accuracy: 0.44073275862068967; test accuracy: 0.3295
2025-09-24 15:14:14 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:06 [INFO]  Epoch 4 loss: 503.0039210319519; train accuracy: 0.45969154094827586; test accuracy: 0.33
2025-09-24 15:15:06 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:15:06 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:15:06 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:15:08 [INFO]  generating sample per sample
2025-09-24 15:15:08 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:15:24 [INFO]  Epoch 0 loss: 118.80098628997803; train accuracy: 0.0; test accuracy: 0.1
2025-09-24 15:15:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_0.pth
2025-09-24 15:15:25 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:41 [INFO]  Epoch 1 loss: 183.2868938446045; train accuracy: 0.427734375; test accuracy: 0.0935
2025-09-24 15:15:41 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:57 [INFO]  Epoch 2 loss: 139.71093463897705; train accuracy: 0.2890625; test accuracy: 0.1139
2025-09-24 15:15:57 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:14 [INFO]  Epoch 3 loss: 135.5022144317627; train accuracy: 0.414794921875; test accuracy: 0.1543
2025-09-24 15:16:14 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:29 [INFO]  Epoch 4 loss: 133.57602882385254; train accuracy: 0.356201171875; test accuracy: 0.1591
2025-09-24 15:16:29 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:16:29 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:16:29 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:16:30 [INFO]  generating sample per sample
2025-09-24 15:16:30 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:16:35 [INFO]  Epoch 0 loss: 22.724289417266846; train accuracy: 0.0234375; test accuracy: 0.0958
2025-09-24 15:16:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_0.pth
2025-09-24 15:16:35 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:41 [INFO]  Epoch 1 loss: 32.32416915893555; train accuracy: 0.9153645833333334; test accuracy: 0.0992
2025-09-24 15:16:41 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:45 [INFO]  Epoch 2 loss: 28.81474208831787; train accuracy: 0.9615885416666666; test accuracy: 0.1
2025-09-24 15:16:45 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:51 [INFO]  Epoch 3 loss: 25.165142059326172; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 15:16:51 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:56 [INFO]  Epoch 4 loss: 23.48849058151245; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 15:16:56 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:16:56 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:16:56 [INFO]  Round 0 Finish--------|
2025-09-24 15:16:56 [INFO]  Model variance: mean: 0.0011533640790730715, sum: 12887.634765625
2025-09-24 15:16:56 [INFO]  g_protos_std: 1.006218671798706
2025-09-24 15:17:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4538
2025-09-24 15:17:01 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:17:01 [INFO]  Round 1 starts--------|
2025-09-24 15:17:01 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:17:01 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:17:33 [INFO]  Epoch 5 loss: 234.05870962142944; train accuracy: 0.41934742647058826; test accuracy: 0.1962
2025-09-24 15:17:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_5.pth
2025-09-24 15:17:33 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:05 [INFO]  Epoch 6 loss: 311.05858612060547; train accuracy: 0.44152113970588236; test accuracy: 0.2006
2025-09-24 15:18:05 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:36 [INFO]  Epoch 7 loss: 306.9680299758911; train accuracy: 0.4332490808823529; test accuracy: 0.1768
2025-09-24 15:18:36 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:05 [INFO]  Epoch 8 loss: 302.6181745529175; train accuracy: 0.4931640625; test accuracy: 0.2188
2025-09-24 15:19:05 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:35 [INFO]  Epoch 9 loss: 295.3625297546387; train accuracy: 0.4944852941176471; test accuracy: 0.2249
2025-09-24 15:19:35 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:19:35 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:19:35 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:19:35 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:20:08 [INFO]  Epoch 5 loss: 247.13538694381714; train accuracy: 0.2857530381944444; test accuracy: 0.1792
2025-09-24 15:20:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_5.pth
2025-09-24 15:20:09 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:41 [INFO]  Epoch 6 loss: 327.35936737060547; train accuracy: 0.34716796875; test accuracy: 0.1969
2025-09-24 15:20:41 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:15 [INFO]  Epoch 7 loss: 324.75744342803955; train accuracy: 0.40869140625; test accuracy: 0.2319
2025-09-24 15:21:15 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:47 [INFO]  Epoch 8 loss: 316.2979850769043; train accuracy: 0.5067816840277778; test accuracy: 0.2762
2025-09-24 15:21:47 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:18 [INFO]  Epoch 9 loss: 314.5745334625244; train accuracy: 0.6247287326388888; test accuracy: 0.341
2025-09-24 15:22:18 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:22:18 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:22:18 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:22:18 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:23:10 [INFO]  Epoch 5 loss: 377.71751642227173; train accuracy: 0.5268049568965517; test accuracy: 0.3869
2025-09-24 15:23:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_5.pth
2025-09-24 15:23:11 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:00 [INFO]  Epoch 6 loss: 476.63308477401733; train accuracy: 0.38190328663793105; test accuracy: 0.2785
2025-09-24 15:24:00 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:52 [INFO]  Epoch 7 loss: 451.900297164917; train accuracy: 0.5343480603448276; test accuracy: 0.3849
2025-09-24 15:24:52 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:43 [INFO]  Epoch 8 loss: 450.3306498527527; train accuracy: 0.6430495689655172; test accuracy: 0.4621
2025-09-24 15:25:43 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:34 [INFO]  Epoch 9 loss: 451.2130002975464; train accuracy: 0.5697400323275862; test accuracy: 0.4043
2025-09-24 15:26:34 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:26:34 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:26:34 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:26:34 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:26:50 [INFO]  Epoch 5 loss: 110.4087462425232; train accuracy: 0.5546875; test accuracy: 0.1061
2025-09-24 15:26:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_5.pth
2025-09-24 15:26:51 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:06 [INFO]  Epoch 6 loss: 130.28873348236084; train accuracy: 0.2802734375; test accuracy: 0.1099
2025-09-24 15:27:06 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:22 [INFO]  Epoch 7 loss: 129.11658191680908; train accuracy: 0.4354248046875; test accuracy: 0.1384
2025-09-24 15:27:22 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:38 [INFO]  Epoch 8 loss: 125.73445463180542; train accuracy: 0.56982421875; test accuracy: 0.1122
2025-09-24 15:27:38 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:55 [INFO]  Epoch 9 loss: 127.5736494064331; train accuracy: 0.574951171875; test accuracy: 0.1198
2025-09-24 15:27:55 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:27:55 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:27:55 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:27:55 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:28:01 [INFO]  Epoch 5 loss: 21.837228775024414; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 15:28:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_5.pth
2025-09-24 15:28:01 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:06 [INFO]  Epoch 6 loss: 23.25357723236084; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 15:28:06 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:11 [INFO]  Epoch 7 loss: 23.03349208831787; train accuracy: 0.962890625; test accuracy: 0.1
2025-09-24 15:28:11 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:17 [INFO]  Epoch 8 loss: 22.687702655792236; train accuracy: 0.9622395833333334; test accuracy: 0.1
2025-09-24 15:28:17 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:22 [INFO]  Epoch 9 loss: 22.674650192260742; train accuracy: 0.9700520833333334; test accuracy: 0.1
2025-09-24 15:28:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:28:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:28:22 [INFO]  Round 1 Finish--------|
2025-09-24 15:28:22 [INFO]  Model variance: mean: 0.001528104767203331, sum: 17074.96875
2025-09-24 15:28:22 [INFO]  g_protos_std: 1.0062068700790405
2025-09-24 15:28:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5319
2025-09-24 15:28:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:28:27 [INFO]  Round 2 starts--------|
2025-09-24 15:28:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:28:27 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:28:53 [INFO]  Epoch 10 loss: 228.84330701828003; train accuracy: 0.4742647058823529; test accuracy: 0.2139
2025-09-24 15:28:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_10.pth
2025-09-24 15:28:55 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:19 [INFO]  Epoch 11 loss: 292.7948212623596; train accuracy: 0.4515165441176471; test accuracy: 0.2306
2025-09-24 15:29:19 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:47 [INFO]  Epoch 12 loss: 292.27836322784424; train accuracy: 0.48816636029411764; test accuracy: 0.2188
2025-09-24 15:29:47 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:18 [INFO]  Epoch 13 loss: 289.4166350364685; train accuracy: 0.6459099264705882; test accuracy: 0.3476
2025-09-24 15:30:18 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:48 [INFO]  Epoch 14 loss: 284.4958071708679; train accuracy: 0.6532628676470589; test accuracy: 0.3363
2025-09-24 15:30:48 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:30:48 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:30:48 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:30:48 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:31:20 [INFO]  Epoch 10 loss: 238.292950630188; train accuracy: 0.5228949652777778; test accuracy: 0.3127
2025-09-24 15:31:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_10.pth
2025-09-24 15:31:20 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:54 [INFO]  Epoch 11 loss: 308.6419219970703; train accuracy: 0.6304796006944444; test accuracy: 0.3323
2025-09-24 15:31:54 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:27 [INFO]  Epoch 12 loss: 306.97715854644775; train accuracy: 0.5707465277777778; test accuracy: 0.3298
2025-09-24 15:32:27 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:57 [INFO]  Epoch 13 loss: 301.8800640106201; train accuracy: 0.6201714409722222; test accuracy: 0.3399
2025-09-24 15:32:57 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:32 [INFO]  Epoch 14 loss: 294.26896238327026; train accuracy: 0.6600477430555556; test accuracy: 0.3647
2025-09-24 15:33:32 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:33:32 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:33:32 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:33:32 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:34:26 [INFO]  Epoch 10 loss: 356.9254994392395; train accuracy: 0.6199824892241379; test accuracy: 0.4472
2025-09-24 15:34:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_10.pth
2025-09-24 15:34:26 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:20 [INFO]  Epoch 11 loss: 430.496301651001; train accuracy: 0.5935816271551724; test accuracy: 0.4221
2025-09-24 15:35:20 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:14 [INFO]  Epoch 12 loss: 430.0027780532837; train accuracy: 0.7183795797413793; test accuracy: 0.4985
2025-09-24 15:36:14 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:09 [INFO]  Epoch 13 loss: 421.14458894729614; train accuracy: 0.7515153556034483; test accuracy: 0.5295
2025-09-24 15:37:09 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:00 [INFO]  Epoch 14 loss: 430.1682620048523; train accuracy: 0.7917901400862069; test accuracy: 0.5539
2025-09-24 15:38:00 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:38:00 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:38:00 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:38:00 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:38:17 [INFO]  Epoch 10 loss: 108.05468559265137; train accuracy: 0.634765625; test accuracy: 0.161
2025-09-24 15:38:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_10.pth
2025-09-24 15:38:18 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:36 [INFO]  Epoch 11 loss: 125.16490125656128; train accuracy: 0.6787109375; test accuracy: 0.2025
2025-09-24 15:38:36 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:53 [INFO]  Epoch 12 loss: 123.52337837219238; train accuracy: 0.6353759765625; test accuracy: 0.1421
2025-09-24 15:38:53 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:10 [INFO]  Epoch 13 loss: 124.74092388153076; train accuracy: 0.7528076171875; test accuracy: 0.206
2025-09-24 15:39:10 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:27 [INFO]  Epoch 14 loss: 121.79448413848877; train accuracy: 0.6314697265625; test accuracy: 0.1423
2025-09-24 15:39:27 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:39:27 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:39:27 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:39:28 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:39:33 [INFO]  Epoch 10 loss: 21.35039234161377; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 15:39:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_10.pth
2025-09-24 15:39:33 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:39 [INFO]  Epoch 11 loss: 22.313961505889893; train accuracy: 0.966796875; test accuracy: 0.1005
2025-09-24 15:39:39 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:44 [INFO]  Epoch 12 loss: 22.306599617004395; train accuracy: 0.9700520833333334; test accuracy: 0.1
2025-09-24 15:39:44 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:49 [INFO]  Epoch 13 loss: 22.218222618103027; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 15:39:49 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:55 [INFO]  Epoch 14 loss: 22.2318377494812; train accuracy: 0.966796875; test accuracy: 0.1001
2025-09-24 15:39:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:39:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:39:55 [INFO]  Round 2 Finish--------|
2025-09-24 15:39:55 [INFO]  Model variance: mean: 0.0018462833249941468, sum: 20630.28125
2025-09-24 15:39:55 [INFO]  g_protos_std: 1.0062203407287598
2025-09-24 15:40:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5988
2025-09-24 15:40:00 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:40:00 [INFO]  Round 3 starts--------|
2025-09-24 15:40:00 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:40:00 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:40:35 [INFO]  Epoch 15 loss: 224.43191146850586; train accuracy: 0.5571001838235294; test accuracy: 0.2691
2025-09-24 15:40:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_15.pth
2025-09-24 15:40:35 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:17 [INFO]  Epoch 16 loss: 278.6641516685486; train accuracy: 0.6718175551470589; test accuracy: 0.354
2025-09-24 15:41:17 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:58 [INFO]  Epoch 17 loss: 275.3071346282959; train accuracy: 0.5814568014705882; test accuracy: 0.2828
2025-09-24 15:41:58 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:43 [INFO]  Epoch 18 loss: 272.6315288543701; train accuracy: 0.5411879595588235; test accuracy: 0.2816
2025-09-24 15:42:43 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:26 [INFO]  Epoch 19 loss: 270.78666830062866; train accuracy: 0.6897403492647058; test accuracy: 0.3626
2025-09-24 15:43:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:43:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:43:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:43:26 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:44:10 [INFO]  Epoch 15 loss: 234.1968207359314; train accuracy: 0.7188042534722222; test accuracy: 0.3832
2025-09-24 15:44:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_15.pth
2025-09-24 15:44:10 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:53 [INFO]  Epoch 16 loss: 296.14825963974; train accuracy: 0.6165907118055556; test accuracy: 0.3281
2025-09-24 15:44:53 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:35 [INFO]  Epoch 17 loss: 284.49557638168335; train accuracy: 0.7084418402777778; test accuracy: 0.3866
2025-09-24 15:45:35 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:19 [INFO]  Epoch 18 loss: 285.53703260421753; train accuracy: 0.66357421875; test accuracy: 0.3787
2025-09-24 15:46:19 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:03 [INFO]  Epoch 19 loss: 283.7477765083313; train accuracy: 0.5559353298611112; test accuracy: 0.3028
2025-09-24 15:47:03 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:47:03 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:47:03 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:47:03 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:48:11 [INFO]  Epoch 15 loss: 348.4212746620178; train accuracy: 0.6876010237068966; test accuracy: 0.4779
2025-09-24 15:48:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_15.pth
2025-09-24 15:48:11 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:22 [INFO]  Epoch 16 loss: 414.7922568321228; train accuracy: 0.8189318426724138; test accuracy: 0.5719
2025-09-24 15:49:22 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:32 [INFO]  Epoch 17 loss: 407.7281336784363; train accuracy: 0.8415274784482759; test accuracy: 0.5857
2025-09-24 15:50:32 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:40 [INFO]  Epoch 18 loss: 408.7122287750244; train accuracy: 0.677667025862069; test accuracy: 0.4817
2025-09-24 15:51:40 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:49 [INFO]  Epoch 19 loss: 402.17960834503174; train accuracy: 0.8372171336206896; test accuracy: 0.5859
2025-09-24 15:52:49 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:52:49 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:52:49 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:52:49 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:53:11 [INFO]  Epoch 15 loss: 106.20969104766846; train accuracy: 0.7742919921875; test accuracy: 0.2412
2025-09-24 15:53:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_15.pth
2025-09-24 15:53:11 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:32 [INFO]  Epoch 16 loss: 120.92967700958252; train accuracy: 0.794189453125; test accuracy: 0.2293
2025-09-24 15:53:32 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:53 [INFO]  Epoch 17 loss: 119.91599464416504; train accuracy: 0.777587890625; test accuracy: 0.2356
2025-09-24 15:53:53 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:14 [INFO]  Epoch 18 loss: 121.75048732757568; train accuracy: 0.798828125; test accuracy: 0.2199
2025-09-24 15:54:14 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:35 [INFO]  Epoch 19 loss: 120.0098443031311; train accuracy: 0.6365966796875; test accuracy: 0.2181
2025-09-24 15:54:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:54:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:54:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:54:35 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:54:42 [INFO]  Epoch 15 loss: 21.090219974517822; train accuracy: 0.9635416666666666; test accuracy: 0.1
2025-09-24 15:54:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_15.pth
2025-09-24 15:54:42 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:49 [INFO]  Epoch 16 loss: 22.112759590148926; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 15:54:49 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:55 [INFO]  Epoch 17 loss: 22.039754390716553; train accuracy: 0.962890625; test accuracy: 0.1001
2025-09-24 15:54:55 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:02 [INFO]  Epoch 18 loss: 22.10292959213257; train accuracy: 0.966796875; test accuracy: 0.1
2025-09-24 15:55:02 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:08 [INFO]  Epoch 19 loss: 21.936262130737305; train accuracy: 0.9622395833333334; test accuracy: 0.1
2025-09-24 15:55:08 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:55:08 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:55:08 [INFO]  Round 3 Finish--------|
2025-09-24 15:55:08 [INFO]  Model variance: mean: 0.0021200100891292095, sum: 23688.890625
2025-09-24 15:55:08 [INFO]  g_protos_std: 1.0062510967254639
2025-09-24 15:55:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6423
2025-09-24 15:55:18 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:55:18 [INFO]  Round 4 starts--------|
2025-09-24 15:55:18 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:55:18 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:55:57 [INFO]  Epoch 20 loss: 220.23460817337036; train accuracy: 0.6676815257352942; test accuracy: 0.3265
2025-09-24 15:55:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_20.pth
2025-09-24 15:55:57 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:40 [INFO]  Epoch 21 loss: 270.4254484176636; train accuracy: 0.6988166360294118; test accuracy: 0.3486
2025-09-24 15:56:40 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:22 [INFO]  Epoch 22 loss: 266.2601971626282; train accuracy: 0.712890625; test accuracy: 0.3621
2025-09-24 15:57:22 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:02 [INFO]  Epoch 23 loss: 265.10137367248535; train accuracy: 0.7491957720588235; test accuracy: 0.3946
2025-09-24 15:58:02 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:42 [INFO]  Epoch 24 loss: 262.82434368133545; train accuracy: 0.7178883272058824; test accuracy: 0.3973
2025-09-24 15:58:42 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:58:42 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:58:42 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:58:42 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:59:25 [INFO]  Epoch 20 loss: 231.2903971672058; train accuracy: 0.5885416666666666; test accuracy: 0.342
2025-09-24 15:59:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_20.pth
2025-09-24 15:59:25 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:08 [INFO]  Epoch 21 loss: 274.26326036453247; train accuracy: 0.6104058159722222; test accuracy: 0.3352
2025-09-24 16:00:08 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:51 [INFO]  Epoch 22 loss: 279.850839138031; train accuracy: 0.6795247395833334; test accuracy: 0.3891
2025-09-24 16:00:51 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:35 [INFO]  Epoch 23 loss: 283.09374809265137; train accuracy: 0.6912434895833334; test accuracy: 0.3799
2025-09-24 16:01:35 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:19 [INFO]  Epoch 24 loss: 272.5702247619629; train accuracy: 0.7776150173611112; test accuracy: 0.4511
2025-09-24 16:02:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:02:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:02:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:02:19 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:03:27 [INFO]  Epoch 20 loss: 342.8611798286438; train accuracy: 0.8049232219827587; test accuracy: 0.5611
2025-09-24 16:03:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_20.pth
2025-09-24 16:03:27 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:35 [INFO]  Epoch 21 loss: 401.07765531539917; train accuracy: 0.8245218211206896; test accuracy: 0.5746
2025-09-24 16:04:35 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:42 [INFO]  Epoch 22 loss: 395.0085029602051; train accuracy: 0.8014547413793104; test accuracy: 0.5618
2025-09-24 16:05:42 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:48 [INFO]  Epoch 23 loss: 392.2410469055176; train accuracy: 0.7407058189655172; test accuracy: 0.5247
2025-09-24 16:06:48 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:54 [INFO]  Epoch 24 loss: 392.84196281433105; train accuracy: 0.8444908405172413; test accuracy: 0.5873
2025-09-24 16:07:54 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:07:54 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:07:54 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:07:54 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:08:14 [INFO]  Epoch 20 loss: 105.23397922515869; train accuracy: 0.7879638671875; test accuracy: 0.2225
2025-09-24 16:08:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_20.pth
2025-09-24 16:08:15 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:37 [INFO]  Epoch 21 loss: 117.46828556060791; train accuracy: 0.7646484375; test accuracy: 0.2252
2025-09-24 16:08:37 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:58 [INFO]  Epoch 22 loss: 120.79213285446167; train accuracy: 0.8033447265625; test accuracy: 0.2447
2025-09-24 16:08:58 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:18 [INFO]  Epoch 23 loss: 118.25249338150024; train accuracy: 0.7503662109375; test accuracy: 0.2028
2025-09-24 16:09:18 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:38 [INFO]  Epoch 24 loss: 117.17687273025513; train accuracy: 0.7066650390625; test accuracy: 0.1766
2025-09-24 16:09:38 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:09:38 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:09:38 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:09:38 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:09:45 [INFO]  Epoch 20 loss: 20.991969108581543; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 16:09:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_20.pth
2025-09-24 16:09:45 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:52 [INFO]  Epoch 21 loss: 21.933143138885498; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 16:09:52 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:58 [INFO]  Epoch 22 loss: 21.972224712371826; train accuracy: 0.9635416666666666; test accuracy: 0.1011
2025-09-24 16:09:58 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:04 [INFO]  Epoch 23 loss: 21.888742446899414; train accuracy: 0.96484375; test accuracy: 0.1001
2025-09-24 16:10:04 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:10 [INFO]  Epoch 24 loss: 22.024396419525146; train accuracy: 0.962890625; test accuracy: 0.1003
2025-09-24 16:10:10 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:10:10 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:10:10 [INFO]  Round 4 Finish--------|
2025-09-24 16:10:10 [INFO]  Model variance: mean: 0.002363751409575343, sum: 26412.443359375
2025-09-24 16:10:10 [INFO]  g_protos_std: 1.006292462348938
2025-09-24 16:10:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6868
2025-09-24 16:10:19 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:10:19 [INFO]  Round 5 starts--------|
2025-09-24 16:10:19 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:10:19 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:10:59 [INFO]  Epoch 25 loss: 217.68465375900269; train accuracy: 0.7804457720588235; test accuracy: 0.4305
2025-09-24 16:11:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_25.pth
2025-09-24 16:11:00 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:39 [INFO]  Epoch 26 loss: 256.57817697525024; train accuracy: 0.7647058823529411; test accuracy: 0.4106
2025-09-24 16:11:39 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:19 [INFO]  Epoch 27 loss: 254.77622652053833; train accuracy: 0.8235294117647058; test accuracy: 0.4619
2025-09-24 16:12:19 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:58 [INFO]  Epoch 28 loss: 256.92017936706543; train accuracy: 0.7179457720588235; test accuracy: 0.4065
2025-09-24 16:12:58 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:37 [INFO]  Epoch 29 loss: 263.51005601882935; train accuracy: 0.7678653492647058; test accuracy: 0.4416
2025-09-24 16:13:37 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:13:37 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:13:37 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:13:37 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:14:18 [INFO]  Epoch 25 loss: 226.38971996307373; train accuracy: 0.6887478298611112; test accuracy: 0.3836
2025-09-24 16:14:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_25.pth
2025-09-24 16:14:18 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:00 [INFO]  Epoch 26 loss: 269.6948890686035; train accuracy: 0.7405598958333334; test accuracy: 0.398
2025-09-24 16:15:00 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:41 [INFO]  Epoch 27 loss: 268.8163471221924; train accuracy: 0.7312825520833334; test accuracy: 0.4138
2025-09-24 16:15:41 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:24 [INFO]  Epoch 28 loss: 275.33685064315796; train accuracy: 0.7154405381944444; test accuracy: 0.4025
2025-09-24 16:16:24 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:04 [INFO]  Epoch 29 loss: 268.3374562263489; train accuracy: 0.7565646701388888; test accuracy: 0.4101
2025-09-24 16:17:04 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:17:04 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:17:04 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:17:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:18:09 [INFO]  Epoch 25 loss: 336.35452032089233; train accuracy: 0.8348262392241379; test accuracy: 0.5827
2025-09-24 16:18:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_25.pth
2025-09-24 16:18:09 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:14 [INFO]  Epoch 26 loss: 388.18365573883057; train accuracy: 0.8415611530172413; test accuracy: 0.5897
2025-09-24 16:19:14 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:20 [INFO]  Epoch 27 loss: 383.5043568611145; train accuracy: 0.8098060344827587; test accuracy: 0.5647
2025-09-24 16:20:20 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:29 [INFO]  Epoch 28 loss: 385.5308656692505; train accuracy: 0.8690396012931034; test accuracy: 0.6018
2025-09-24 16:21:29 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:35 [INFO]  Epoch 29 loss: 383.17937183380127; train accuracy: 0.8535492995689655; test accuracy: 0.5913
2025-09-24 16:22:35 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:22:35 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:22:35 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:22:35 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:22:55 [INFO]  Epoch 25 loss: 104.27815961837769; train accuracy: 0.68701171875; test accuracy: 0.2024
2025-09-24 16:22:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_25.pth
2025-09-24 16:22:55 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:15 [INFO]  Epoch 26 loss: 116.63811159133911; train accuracy: 0.8487548828125; test accuracy: 0.2447
2025-09-24 16:23:15 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:36 [INFO]  Epoch 27 loss: 116.79712438583374; train accuracy: 0.827392578125; test accuracy: 0.2252
2025-09-24 16:23:36 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:57 [INFO]  Epoch 28 loss: 115.56468057632446; train accuracy: 0.8095703125; test accuracy: 0.2469
2025-09-24 16:23:57 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:19 [INFO]  Epoch 29 loss: 114.50466728210449; train accuracy: 0.787353515625; test accuracy: 0.2054
2025-09-24 16:24:19 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:24:19 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:24:19 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:24:19 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:24:25 [INFO]  Epoch 25 loss: 20.937666416168213; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 16:24:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_25.pth
2025-09-24 16:24:26 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:33 [INFO]  Epoch 26 loss: 21.88945770263672; train accuracy: 0.9635416666666666; test accuracy: 0.1
2025-09-24 16:24:33 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:39 [INFO]  Epoch 27 loss: 21.973981857299805; train accuracy: 0.962890625; test accuracy: 0.1006
2025-09-24 16:24:39 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:47 [INFO]  Epoch 28 loss: 21.828516960144043; train accuracy: 0.9635416666666666; test accuracy: 0.1096
2025-09-24 16:24:47 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:53 [INFO]  Epoch 29 loss: 21.85486936569214; train accuracy: 0.966796875; test accuracy: 0.1039
2025-09-24 16:24:53 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:24:53 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:24:53 [INFO]  Round 5 Finish--------|
2025-09-24 16:24:53 [INFO]  Model variance: mean: 0.0025830648373812437, sum: 28863.04296875
2025-09-24 16:24:53 [INFO]  g_protos_std: 1.0063369274139404
2025-09-24 16:25:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7001
2025-09-24 16:25:02 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:25:02 [INFO]  Round 6 starts--------|
2025-09-24 16:25:02 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:25:02 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:25:43 [INFO]  Epoch 30 loss: 216.77741765975952; train accuracy: 0.7151309742647058; test accuracy: 0.3826
2025-09-24 16:25:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_30.pth
2025-09-24 16:25:44 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:26 [INFO]  Epoch 31 loss: 252.17827939987183; train accuracy: 0.7076631433823529; test accuracy: 0.4009
2025-09-24 16:26:26 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:27:08 [INFO]  Epoch 32 loss: 253.7849359512329; train accuracy: 0.7872242647058824; test accuracy: 0.4302
2025-09-24 16:27:08 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:30:53 [INFO]  Epoch 33 loss: 252.22729873657227; train accuracy: 0.8017578125; test accuracy: 0.4379
2025-09-24 16:30:53 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:35 [INFO]  Epoch 34 loss: 249.67322254180908; train accuracy: 0.7105353860294118; test accuracy: 0.3708
2025-09-24 16:31:35 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:31:35 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:31:35 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:31:35 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:52:52 [INFO]  Epoch 30 loss: 222.79399633407593; train accuracy: 0.7339409722222222; test accuracy: 0.4232
2025-09-24 16:52:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_30.pth
2025-09-24 16:52:52 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:36 [INFO]  Epoch 31 loss: 264.07949447631836; train accuracy: 0.7321506076388888; test accuracy: 0.419
2025-09-24 16:53:36 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:21 [INFO]  Epoch 32 loss: 264.5120105743408; train accuracy: 0.8211263020833334; test accuracy: 0.4708
2025-09-24 16:54:21 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:55:04 [INFO]  Epoch 33 loss: 266.04674911499023; train accuracy: 0.7117513020833334; test accuracy: 0.4158
2025-09-24 16:55:04 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:55:49 [INFO]  Epoch 34 loss: 261.93968057632446; train accuracy: 0.8190104166666666; test accuracy: 0.4503
2025-09-24 16:55:49 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:55:49 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:55:49 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:55:49 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:57:01 [INFO]  Epoch 30 loss: 329.34092950820923; train accuracy: 0.7834051724137931; test accuracy: 0.5543
2025-09-24 16:57:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_30.pth
2025-09-24 16:57:01 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:11 [INFO]  Epoch 31 loss: 372.7860951423645; train accuracy: 0.8938577586206896; test accuracy: 0.6191
2025-09-24 16:58:11 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:19 [INFO]  Epoch 32 loss: 380.900351524353; train accuracy: 0.8217268318965517; test accuracy: 0.5773
2025-09-24 16:59:19 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:00:27 [INFO]  Epoch 33 loss: 379.1789755821228; train accuracy: 0.7883553340517241; test accuracy: 0.5566
2025-09-24 17:00:27 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:01:35 [INFO]  Epoch 34 loss: 384.6806044578552; train accuracy: 0.8949016702586207; test accuracy: 0.6205
2025-09-24 17:01:35 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:01:35 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:01:35 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:01:35 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:01:56 [INFO]  Epoch 30 loss: 103.73381662368774; train accuracy: 0.804931640625; test accuracy: 0.2114
2025-09-24 17:01:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_30.pth
2025-09-24 17:01:57 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:17 [INFO]  Epoch 31 loss: 115.81362104415894; train accuracy: 0.828125; test accuracy: 0.2565
2025-09-24 17:02:17 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:38 [INFO]  Epoch 32 loss: 115.81390047073364; train accuracy: 0.70068359375; test accuracy: 0.2096
2025-09-24 17:02:38 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:58 [INFO]  Epoch 33 loss: 115.35380601882935; train accuracy: 0.664794921875; test accuracy: 0.1502
2025-09-24 17:02:58 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:17 [INFO]  Epoch 34 loss: 114.76779842376709; train accuracy: 0.867919921875; test accuracy: 0.2475
2025-09-24 17:03:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:03:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:03:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:03:17 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:03:24 [INFO]  Epoch 30 loss: 20.91523265838623; train accuracy: 0.966796875; test accuracy: 0.1011
2025-09-24 17:03:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_30.pth
2025-09-24 17:03:24 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:31 [INFO]  Epoch 31 loss: 21.697670459747314; train accuracy: 0.9661458333333334; test accuracy: 0.1006
2025-09-24 17:03:31 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:37 [INFO]  Epoch 32 loss: 21.845197677612305; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 17:03:37 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:43 [INFO]  Epoch 33 loss: 21.696406364440918; train accuracy: 0.9674479166666666; test accuracy: 0.1
2025-09-24 17:03:43 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:49 [INFO]  Epoch 34 loss: 21.687323570251465; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 17:03:49 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:03:49 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:03:49 [INFO]  Round 6 Finish--------|
2025-09-24 17:03:49 [INFO]  Model variance: mean: 0.00278464169241488, sum: 31115.451171875
2025-09-24 17:03:49 [INFO]  g_protos_std: 1.006393551826477
2025-09-24 17:03:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7193
2025-09-24 17:03:58 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:03:58 [INFO]  Round 7 starts--------|
2025-09-24 17:03:58 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:03:58 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:04:38 [INFO]  Epoch 35 loss: 211.46653413772583; train accuracy: 0.7643037683823529; test accuracy: 0.4596
2025-09-24 17:04:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_35.pth
2025-09-24 17:04:38 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:16 [INFO]  Epoch 36 loss: 248.60931873321533; train accuracy: 0.8120978860294118; test accuracy: 0.4614
2025-09-24 17:05:16 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:55 [INFO]  Epoch 37 loss: 244.9164366722107; train accuracy: 0.7410960477941176; test accuracy: 0.4028
2025-09-24 17:05:55 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:33 [INFO]  Epoch 38 loss: 244.10684537887573; train accuracy: 0.6862936580882353; test accuracy: 0.3626
2025-09-24 17:06:33 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:07:12 [INFO]  Epoch 39 loss: 243.9370789527893; train accuracy: 0.8448988970588235; test accuracy: 0.4846
2025-09-24 17:07:12 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:07:12 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:07:12 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:07:12 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:07:53 [INFO]  Epoch 35 loss: 222.55526971817017; train accuracy: 0.8123914930555556; test accuracy: 0.4647
2025-09-24 17:07:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_35.pth
2025-09-24 17:07:53 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:33 [INFO]  Epoch 36 loss: 260.54258728027344; train accuracy: 0.8453233506944444; test accuracy: 0.4756
2025-09-24 17:08:33 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:09:14 [INFO]  Epoch 37 loss: 254.27155447006226; train accuracy: 0.7298177083333334; test accuracy: 0.4035
2025-09-24 17:09:14 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:09:55 [INFO]  Epoch 38 loss: 261.2540912628174; train accuracy: 0.7511393229166666; test accuracy: 0.4271
2025-09-24 17:09:55 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:10:37 [INFO]  Epoch 39 loss: 258.0642695426941; train accuracy: 0.8563368055555556; test accuracy: 0.4633
2025-09-24 17:10:37 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:10:37 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:10:37 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:10:37 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:11:41 [INFO]  Epoch 35 loss: 328.18558502197266; train accuracy: 0.8639884159482759; test accuracy: 0.5988
2025-09-24 17:11:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_35.pth
2025-09-24 17:11:42 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:45 [INFO]  Epoch 36 loss: 370.81491804122925; train accuracy: 0.7619544719827587; test accuracy: 0.5328
2025-09-24 17:12:45 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:50 [INFO]  Epoch 37 loss: 371.85648107528687; train accuracy: 0.885809536637931; test accuracy: 0.6102
2025-09-24 17:13:50 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:14:53 [INFO]  Epoch 38 loss: 372.21940898895264; train accuracy: 0.8549299568965517; test accuracy: 0.589
2025-09-24 17:14:53 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:15:57 [INFO]  Epoch 39 loss: 359.31299781799316; train accuracy: 0.8721039870689655; test accuracy: 0.6177
2025-09-24 17:15:57 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:15:57 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:15:57 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:15:57 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:16:18 [INFO]  Epoch 35 loss: 102.86769247055054; train accuracy: 0.87109375; test accuracy: 0.2432
2025-09-24 17:16:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_35.pth
2025-09-24 17:16:18 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:39 [INFO]  Epoch 36 loss: 115.58690071105957; train accuracy: 0.7607421875; test accuracy: 0.2162
2025-09-24 17:16:39 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:59 [INFO]  Epoch 37 loss: 115.09699964523315; train accuracy: 0.8660888671875; test accuracy: 0.2461
2025-09-24 17:16:59 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:17:19 [INFO]  Epoch 38 loss: 112.71928071975708; train accuracy: 0.760986328125; test accuracy: 0.2416
2025-09-24 17:17:19 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:17:38 [INFO]  Epoch 39 loss: 114.16699457168579; train accuracy: 0.7840576171875; test accuracy: 0.205
2025-09-24 17:17:38 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:17:38 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:17:38 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:17:38 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:17:44 [INFO]  Epoch 35 loss: 20.899938106536865; train accuracy: 0.9674479166666666; test accuracy: 0.1
2025-09-24 17:17:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_35.pth
2025-09-24 17:17:44 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:17:51 [INFO]  Epoch 36 loss: 21.76078701019287; train accuracy: 0.9635416666666666; test accuracy: 0.1
2025-09-24 17:17:51 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:17:57 [INFO]  Epoch 37 loss: 21.571397304534912; train accuracy: 0.96484375; test accuracy: 0.1038
2025-09-24 17:17:57 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:18:04 [INFO]  Epoch 38 loss: 21.80685806274414; train accuracy: 0.9609375; test accuracy: 0.1008
2025-09-24 17:18:04 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:18:10 [INFO]  Epoch 39 loss: 21.781986713409424; train accuracy: 0.9622395833333334; test accuracy: 0.1
2025-09-24 17:18:10 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:18:10 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:18:10 [INFO]  Round 7 Finish--------|
2025-09-24 17:18:10 [INFO]  Model variance: mean: 0.00297175464220345, sum: 33206.2421875
2025-09-24 17:18:10 [INFO]  g_protos_std: 1.0064550638198853
2025-09-24 17:18:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7541
2025-09-24 17:18:19 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:18:19 [INFO]  Round 8 starts--------|
2025-09-24 17:18:19 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:18:19 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:18:58 [INFO]  Epoch 40 loss: 208.05135822296143; train accuracy: 0.80859375; test accuracy: 0.4249
2025-09-24 17:18:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_40.pth
2025-09-24 17:18:59 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:19:39 [INFO]  Epoch 41 loss: 242.59401655197144; train accuracy: 0.8139935661764706; test accuracy: 0.4304
2025-09-24 17:19:39 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:18 [INFO]  Epoch 42 loss: 244.1946611404419; train accuracy: 0.7918198529411765; test accuracy: 0.433
2025-09-24 17:20:18 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:54 [INFO]  Epoch 43 loss: 240.17346143722534; train accuracy: 0.8076171875; test accuracy: 0.438
2025-09-24 17:20:54 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:21:30 [INFO]  Epoch 44 loss: 243.20111560821533; train accuracy: 0.8475988051470589; test accuracy: 0.4708
2025-09-24 17:21:30 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:21:30 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:21:30 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:21:31 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:22:06 [INFO]  Epoch 40 loss: 219.6306447982788; train accuracy: 0.8336588541666666; test accuracy: 0.4489
2025-09-24 17:22:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_40.pth
2025-09-24 17:22:07 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:22:44 [INFO]  Epoch 41 loss: 257.87380599975586; train accuracy: 0.7629123263888888; test accuracy: 0.4365
2025-09-24 17:22:44 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:23:20 [INFO]  Epoch 42 loss: 251.0694489479065; train accuracy: 0.8441840277777778; test accuracy: 0.4636
2025-09-24 17:23:20 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:23:57 [INFO]  Epoch 43 loss: 256.70966482162476; train accuracy: 0.8495551215277778; test accuracy: 0.4687
2025-09-24 17:23:57 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:24:37 [INFO]  Epoch 44 loss: 253.255868434906; train accuracy: 0.8331705729166666; test accuracy: 0.4916
2025-09-24 17:24:37 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:24:37 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:24:37 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:24:37 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:25:39 [INFO]  Epoch 40 loss: 324.99359035491943; train accuracy: 0.8713631465517241; test accuracy: 0.605
2025-09-24 17:25:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_40.pth
2025-09-24 17:25:40 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:26:44 [INFO]  Epoch 41 loss: 364.500470161438; train accuracy: 0.890692349137931; test accuracy: 0.6127
2025-09-24 17:26:44 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:27:46 [INFO]  Epoch 42 loss: 371.0171871185303; train accuracy: 0.8745622306034483; test accuracy: 0.614
2025-09-24 17:27:46 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:28:49 [INFO]  Epoch 43 loss: 359.9499659538269; train accuracy: 0.8542901400862069; test accuracy: 0.6294
2025-09-24 17:28:49 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:29:52 [INFO]  Epoch 44 loss: 363.6797785758972; train accuracy: 0.8441540948275862; test accuracy: 0.6067
2025-09-24 17:29:52 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:29:52 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:29:52 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:29:52 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:30:11 [INFO]  Epoch 40 loss: 102.72706508636475; train accuracy: 0.8590087890625; test accuracy: 0.2367
2025-09-24 17:30:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_40.pth
2025-09-24 17:30:11 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:30 [INFO]  Epoch 41 loss: 111.08440589904785; train accuracy: 0.8853759765625; test accuracy: 0.2543
2025-09-24 17:30:30 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:50 [INFO]  Epoch 42 loss: 114.45280456542969; train accuracy: 0.823974609375; test accuracy: 0.241
2025-09-24 17:30:50 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:09 [INFO]  Epoch 43 loss: 112.14959239959717; train accuracy: 0.830810546875; test accuracy: 0.2292
2025-09-24 17:31:09 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:28 [INFO]  Epoch 44 loss: 112.2126693725586; train accuracy: 0.8626708984375; test accuracy: 0.2652
2025-09-24 17:31:28 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:31:28 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:31:28 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:31:28 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:31:34 [INFO]  Epoch 40 loss: 20.887454509735107; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 17:31:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_40.pth
2025-09-24 17:31:35 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:41 [INFO]  Epoch 41 loss: 21.70364475250244; train accuracy: 0.96484375; test accuracy: 0.1005
2025-09-24 17:31:41 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:47 [INFO]  Epoch 42 loss: 21.701071739196777; train accuracy: 0.9615885416666666; test accuracy: 0.1002
2025-09-24 17:31:47 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:53 [INFO]  Epoch 43 loss: 21.601981163024902; train accuracy: 0.9622395833333334; test accuracy: 0.1064
2025-09-24 17:31:53 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:00 [INFO]  Epoch 44 loss: 21.73072385787964; train accuracy: 0.9622395833333334; test accuracy: 0.1069
2025-09-24 17:32:00 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:32:00 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:32:00 [INFO]  Round 8 Finish--------|
2025-09-24 17:32:00 [INFO]  Model variance: mean: 0.0031496514566242695, sum: 35194.0546875
2025-09-24 17:32:00 [INFO]  g_protos_std: 1.006516695022583
2025-09-24 17:32:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7814
2025-09-24 17:32:08 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:32:08 [INFO]  Round 9 starts--------|
2025-09-24 17:32:08 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:32:08 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:32:46 [INFO]  Epoch 45 loss: 207.1001696586609; train accuracy: 0.8178423713235294; test accuracy: 0.4873
2025-09-24 17:32:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_45.pth
2025-09-24 17:32:46 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:24 [INFO]  Epoch 46 loss: 241.34440994262695; train accuracy: 0.8112362132352942; test accuracy: 0.4372
2025-09-24 17:33:24 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:01 [INFO]  Epoch 47 loss: 241.23779201507568; train accuracy: 0.8701171875; test accuracy: 0.4965
2025-09-24 17:34:01 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:38 [INFO]  Epoch 48 loss: 234.0346131324768; train accuracy: 0.8719554227941176; test accuracy: 0.5038
2025-09-24 17:34:38 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:35:16 [INFO]  Epoch 49 loss: 237.49950456619263; train accuracy: 0.8489200367647058; test accuracy: 0.4668
2025-09-24 17:35:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:35:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:35:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:35:16 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:35:56 [INFO]  Epoch 45 loss: 220.58576440811157; train accuracy: 0.7912868923611112; test accuracy: 0.4387
2025-09-24 17:35:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_45.pth
2025-09-24 17:35:56 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:36:36 [INFO]  Epoch 46 loss: 252.88339948654175; train accuracy: 0.7918836805555556; test accuracy: 0.4303
2025-09-24 17:36:36 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:16 [INFO]  Epoch 47 loss: 249.5025372505188; train accuracy: 0.8337673611111112; test accuracy: 0.4593
2025-09-24 17:37:16 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:54 [INFO]  Epoch 48 loss: 250.01790714263916; train accuracy: 0.8200412326388888; test accuracy: 0.4589
2025-09-24 17:37:54 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:38:32 [INFO]  Epoch 49 loss: 244.06354808807373; train accuracy: 0.8509114583333334; test accuracy: 0.4972
2025-09-24 17:38:32 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:38:32 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:38:32 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:38:32 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:39:34 [INFO]  Epoch 45 loss: 321.7115993499756; train accuracy: 0.8914331896551724; test accuracy: 0.6096
2025-09-24 17:39:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_45.pth
2025-09-24 17:39:34 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:40:36 [INFO]  Epoch 46 loss: 363.78890800476074; train accuracy: 0.8408539870689655; test accuracy: 0.5815
2025-09-24 17:40:36 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:41:38 [INFO]  Epoch 47 loss: 360.39847898483276; train accuracy: 0.9036570581896551; test accuracy: 0.6269
2025-09-24 17:41:38 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:42:39 [INFO]  Epoch 48 loss: 358.9170126914978; train accuracy: 0.8624730603448276; test accuracy: 0.6103
2025-09-24 17:42:39 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:43:42 [INFO]  Epoch 49 loss: 363.457293510437; train accuracy: 0.8335466056034483; test accuracy: 0.5862
2025-09-24 17:43:42 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:43:42 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:43:42 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:43:42 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:44:02 [INFO]  Epoch 45 loss: 102.87857151031494; train accuracy: 0.83154296875; test accuracy: 0.2245
2025-09-24 17:44:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_45.pth
2025-09-24 17:44:02 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:44:21 [INFO]  Epoch 46 loss: 111.24359655380249; train accuracy: 0.854736328125; test accuracy: 0.249
2025-09-24 17:44:21 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:44:41 [INFO]  Epoch 47 loss: 111.97906923294067; train accuracy: 0.88818359375; test accuracy: 0.2625
2025-09-24 17:44:41 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:44:59 [INFO]  Epoch 48 loss: 112.21092081069946; train accuracy: 0.8729248046875; test accuracy: 0.2656
2025-09-24 17:44:59 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:45:19 [INFO]  Epoch 49 loss: 110.60145235061646; train accuracy: 0.901611328125; test accuracy: 0.2647
2025-09-24 17:45:19 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:45:19 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:45:19 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:45:19 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:45:25 [INFO]  Epoch 45 loss: 20.985037803649902; train accuracy: 0.96484375; test accuracy: 0.1008
2025-09-24 17:45:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_45.pth
2025-09-24 17:45:26 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:45:32 [INFO]  Epoch 46 loss: 21.745660305023193; train accuracy: 0.9635416666666666; test accuracy: 0.1
2025-09-24 17:45:32 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:45:38 [INFO]  Epoch 47 loss: 21.704769134521484; train accuracy: 0.9635416666666666; test accuracy: 0.1002
2025-09-24 17:45:38 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:45:44 [INFO]  Epoch 48 loss: 21.594590663909912; train accuracy: 0.9661458333333334; test accuracy: 0.1
2025-09-24 17:45:44 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:45:50 [INFO]  Epoch 49 loss: 21.597286701202393; train accuracy: 0.9654947916666666; test accuracy: 0.1001
2025-09-24 17:45:50 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:45:50 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:45:50 [INFO]  Round 9 Finish--------|
2025-09-24 17:45:50 [INFO]  Model variance: mean: 0.0033170960377901793, sum: 37065.0703125
2025-09-24 17:45:50 [INFO]  g_protos_std: 1.0065850019454956
2025-09-24 17:45:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.77
2025-09-24 17:45:58 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:45:58 [INFO]  Round 10 starts--------|
2025-09-24 17:45:58 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:45:58 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:46:36 [INFO]  Epoch 50 loss: 204.65572261810303; train accuracy: 0.8475988051470589; test accuracy: 0.4926
2025-09-24 17:46:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_50.pth
2025-09-24 17:46:36 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:47:15 [INFO]  Epoch 51 loss: 237.21981239318848; train accuracy: 0.8253676470588235; test accuracy: 0.4415
2025-09-24 17:47:15 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:47:53 [INFO]  Epoch 52 loss: 238.64959621429443; train accuracy: 0.8217486213235294; test accuracy: 0.4663
2025-09-24 17:47:53 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:48:30 [INFO]  Epoch 53 loss: 230.2583827972412; train accuracy: 0.7593635110294118; test accuracy: 0.4131
2025-09-24 17:48:30 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:49:10 [INFO]  Epoch 54 loss: 232.38010787963867; train accuracy: 0.8709214154411765; test accuracy: 0.4887
2025-09-24 17:49:10 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:49:10 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:49:10 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:49:10 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:49:49 [INFO]  Epoch 50 loss: 217.7995753288269; train accuracy: 0.8800455729166666; test accuracy: 0.5035
2025-09-24 17:49:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_50.pth
2025-09-24 17:49:50 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:50:28 [INFO]  Epoch 51 loss: 246.8209047317505; train accuracy: 0.7937282986111112; test accuracy: 0.478
2025-09-24 17:50:28 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:51:09 [INFO]  Epoch 52 loss: 248.10693264007568; train accuracy: 0.7856987847222222; test accuracy: 0.4644
2025-09-24 17:51:09 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:51:50 [INFO]  Epoch 53 loss: 248.55056476593018; train accuracy: 0.8670247395833334; test accuracy: 0.5206
2025-09-24 17:51:50 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:52:29 [INFO]  Epoch 54 loss: 251.08153104782104; train accuracy: 0.8452690972222222; test accuracy: 0.4997
2025-09-24 17:52:29 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:52:29 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:52:29 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:52:29 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:53:33 [INFO]  Epoch 50 loss: 320.05253744125366; train accuracy: 0.876885775862069; test accuracy: 0.6084
2025-09-24 17:53:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_50.pth
2025-09-24 17:53:33 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:54:33 [INFO]  Epoch 51 loss: 360.2604179382324; train accuracy: 0.9098868534482759; test accuracy: 0.6396
2025-09-24 17:54:33 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:55:34 [INFO]  Epoch 52 loss: 354.16388463974; train accuracy: 0.9248046875; test accuracy: 0.6491
2025-09-24 17:55:34 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:56:37 [INFO]  Epoch 53 loss: 358.879358291626; train accuracy: 0.8779296875; test accuracy: 0.6355
2025-09-24 17:56:37 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:57:39 [INFO]  Epoch 54 loss: 354.50164461135864; train accuracy: 0.9164197198275862; test accuracy: 0.6683
2025-09-24 17:57:39 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:57:39 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:57:39 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:57:39 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:57:58 [INFO]  Epoch 50 loss: 102.63562536239624; train accuracy: 0.871826171875; test accuracy: 0.2412
2025-09-24 17:57:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_50.pth
2025-09-24 17:57:59 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:58:17 [INFO]  Epoch 51 loss: 109.85689210891724; train accuracy: 0.856689453125; test accuracy: 0.2353
2025-09-24 17:58:17 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:58:36 [INFO]  Epoch 52 loss: 111.5362319946289; train accuracy: 0.875; test accuracy: 0.2436
2025-09-24 17:58:36 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:58:55 [INFO]  Epoch 53 loss: 113.56673240661621; train accuracy: 0.8621826171875; test accuracy: 0.2574
2025-09-24 17:58:55 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:14 [INFO]  Epoch 54 loss: 110.6829342842102; train accuracy: 0.8765869140625; test accuracy: 0.245
2025-09-24 17:59:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:59:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:59:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:59:14 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:59:20 [INFO]  Epoch 50 loss: 20.868539333343506; train accuracy: 0.9674479166666666; test accuracy: 0.101
2025-09-24 17:59:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_50.pth
2025-09-24 17:59:21 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:27 [INFO]  Epoch 51 loss: 21.601562976837158; train accuracy: 0.9661458333333334; test accuracy: 0.1026
2025-09-24 17:59:27 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:33 [INFO]  Epoch 52 loss: 21.53796672821045; train accuracy: 0.9635416666666666; test accuracy: 0.1032
2025-09-24 17:59:33 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:39 [INFO]  Epoch 53 loss: 21.736971855163574; train accuracy: 0.96484375; test accuracy: 0.1037
2025-09-24 17:59:39 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:45 [INFO]  Epoch 54 loss: 21.53821325302124; train accuracy: 0.9661458333333334; test accuracy: 0.1
2025-09-24 17:59:45 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:59:45 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:59:45 [INFO]  Round 10 Finish--------|
2025-09-24 17:59:45 [INFO]  Model variance: mean: 0.0034759596455842257, sum: 38840.20703125
2025-09-24 17:59:45 [INFO]  g_protos_std: 1.006651759147644
2025-09-24 17:59:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7903
2025-09-24 17:59:53 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:59:53 [INFO]  Round 11 starts--------|
2025-09-24 17:59:53 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:59:53 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:00:32 [INFO]  Epoch 55 loss: 204.35960912704468; train accuracy: 0.7514935661764706; test accuracy: 0.3988
2025-09-24 18:00:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_55.pth
2025-09-24 18:00:32 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:01:09 [INFO]  Epoch 56 loss: 237.11141395568848; train accuracy: 0.7977366727941176; test accuracy: 0.4275
2025-09-24 18:01:09 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:01:46 [INFO]  Epoch 57 loss: 228.28559017181396; train accuracy: 0.8520220588235294; test accuracy: 0.4844
2025-09-24 18:01:46 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:02:23 [INFO]  Epoch 58 loss: 235.34263467788696; train accuracy: 0.8441521139705882; test accuracy: 0.4686
2025-09-24 18:02:23 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:03:00 [INFO]  Epoch 59 loss: 234.41254901885986; train accuracy: 0.8451286764705882; test accuracy: 0.4675
2025-09-24 18:03:00 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 18:03:00 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 18:03:00 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 18:03:00 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:03:42 [INFO]  Epoch 55 loss: 214.51076745986938; train accuracy: 0.8350694444444444; test accuracy: 0.4758
2025-09-24 18:03:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_55.pth
2025-09-24 18:03:42 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:04:24 [INFO]  Epoch 56 loss: 241.22963285446167; train accuracy: 0.8541666666666666; test accuracy: 0.5057
2025-09-24 18:04:24 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:05:05 [INFO]  Epoch 57 loss: 239.80063724517822; train accuracy: 0.8977322048611112; test accuracy: 0.4935
2025-09-24 18:05:05 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:05:46 [INFO]  Epoch 58 loss: 241.23764753341675; train accuracy: 0.8448350694444444; test accuracy: 0.5006
2025-09-24 18:05:46 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:06:27 [INFO]  Epoch 59 loss: 246.18875217437744; train accuracy: 0.8695203993055556; test accuracy: 0.5133
2025-09-24 18:06:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 18:06:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 18:06:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 18:06:27 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:07:32 [INFO]  Epoch 55 loss: 318.6678075790405; train accuracy: 0.8806910021551724; test accuracy: 0.6134
2025-09-24 18:07:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_55.pth
2025-09-24 18:07:33 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:08:39 [INFO]  Epoch 56 loss: 356.63843727111816; train accuracy: 0.8997171336206896; test accuracy: 0.6321
2025-09-24 18:08:39 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:09:44 [INFO]  Epoch 57 loss: 356.3919596672058; train accuracy: 0.9052397629310345; test accuracy: 0.6473
2025-09-24 18:09:44 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:10:51 [INFO]  Epoch 58 loss: 357.84936571121216; train accuracy: 0.8762459590517241; test accuracy: 0.638
2025-09-24 18:10:51 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:11:58 [INFO]  Epoch 59 loss: 347.19723892211914; train accuracy: 0.8850350215517241; test accuracy: 0.6654
2025-09-24 18:11:58 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 18:11:58 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 18:11:58 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 18:11:58 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:12:19 [INFO]  Epoch 55 loss: 101.17604541778564; train accuracy: 0.8543701171875; test accuracy: 0.2527
2025-09-24 18:12:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_55.pth
2025-09-24 18:12:19 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:12:39 [INFO]  Epoch 56 loss: 112.24030590057373; train accuracy: 0.8385009765625; test accuracy: 0.2545
2025-09-24 18:12:39 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:13:00 [INFO]  Epoch 57 loss: 109.43219041824341; train accuracy: 0.77685546875; test accuracy: 0.2556
2025-09-24 18:13:00 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:13:21 [INFO]  Epoch 58 loss: 108.91242980957031; train accuracy: 0.8419189453125; test accuracy: 0.2453
2025-09-24 18:13:21 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:13:41 [INFO]  Epoch 59 loss: 109.77917623519897; train accuracy: 0.8994140625; test accuracy: 0.2542
2025-09-24 18:13:41 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 18:13:41 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 18:13:41 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 18:13:41 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:13:48 [INFO]  Epoch 55 loss: 20.85006809234619; train accuracy: 0.9661458333333334; test accuracy: 0.1003
2025-09-24 18:13:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_55.pth
2025-09-24 18:13:48 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:13:54 [INFO]  Epoch 56 loss: 21.710594177246094; train accuracy: 0.966796875; test accuracy: 0.1083
2025-09-24 18:13:54 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:14:00 [INFO]  Epoch 57 loss: 21.6284818649292; train accuracy: 0.9609375; test accuracy: 0.1
2025-09-24 18:14:00 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:14:07 [INFO]  Epoch 58 loss: 22.013856887817383; train accuracy: 0.9654947916666666; test accuracy: 0.1012
2025-09-24 18:14:07 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:14:13 [INFO]  Epoch 59 loss: 21.849730968475342; train accuracy: 0.9661458333333334; test accuracy: 0.1
2025-09-24 18:14:13 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 18:14:13 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 18:14:13 [INFO]  Round 11 Finish--------|
2025-09-24 18:14:13 [INFO]  Model variance: mean: 0.00362834008410573, sum: 40542.8984375
2025-09-24 18:14:13 [INFO]  g_protos_std: 1.0067204236984253
2025-09-24 18:14:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7987
2025-09-24 18:14:21 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 18:14:21 [INFO]  Round 12 starts--------|
2025-09-24 18:14:21 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 18:14:21 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:15:02 [INFO]  Epoch 60 loss: 201.01056623458862; train accuracy: 0.8181295955882353; test accuracy: 0.4464
2025-09-24 18:15:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_60.pth
2025-09-24 18:15:02 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:15:40 [INFO]  Epoch 61 loss: 230.69268035888672; train accuracy: 0.8501838235294118; test accuracy: 0.4824
2025-09-24 18:15:40 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:16:21 [INFO]  Epoch 62 loss: 227.85896730422974; train accuracy: 0.8941865808823529; test accuracy: 0.4709
2025-09-24 18:16:21 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:17:01 [INFO]  Epoch 63 loss: 226.68592357635498; train accuracy: 0.8552964154411765; test accuracy: 0.4523
2025-09-24 18:17:01 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:17:40 [INFO]  Epoch 64 loss: 228.3122911453247; train accuracy: 0.7567784926470589; test accuracy: 0.4226
2025-09-24 18:17:40 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 18:17:40 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 18:17:40 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 18:17:40 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:18:20 [INFO]  Epoch 60 loss: 212.65039730072021; train accuracy: 0.8596462673611112; test accuracy: 0.5069
2025-09-24 18:18:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_60.pth
2025-09-24 18:18:21 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:19:01 [INFO]  Epoch 61 loss: 239.2897047996521; train accuracy: 0.8779296875; test accuracy: 0.5259
2025-09-24 18:19:01 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:19:43 [INFO]  Epoch 62 loss: 239.15399742126465; train accuracy: 0.8586154513888888; test accuracy: 0.5113
2025-09-24 18:19:43 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:20:25 [INFO]  Epoch 63 loss: 244.0407156944275; train accuracy: 0.8609483506944444; test accuracy: 0.5025
2025-09-24 18:20:25 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:21:06 [INFO]  Epoch 64 loss: 240.84312629699707; train accuracy: 0.8736979166666666; test accuracy: 0.5257
2025-09-24 18:21:06 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 18:21:06 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 18:21:06 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 18:21:06 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:22:07 [INFO]  Epoch 60 loss: 317.6152009963989; train accuracy: 0.8973599137931034; test accuracy: 0.6212
2025-09-24 18:22:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_60.pth
2025-09-24 18:22:08 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:23:12 [INFO]  Epoch 61 loss: 351.2956647872925; train accuracy: 0.9136247306034483; test accuracy: 0.6442
2025-09-24 18:23:12 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:24:18 [INFO]  Epoch 62 loss: 354.20957374572754; train accuracy: 0.8912311422413793; test accuracy: 0.6336
2025-09-24 18:24:18 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:25:26 [INFO]  Epoch 63 loss: 352.867938041687; train accuracy: 0.8836206896551724; test accuracy: 0.6257
2025-09-24 18:25:26 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:26:32 [INFO]  Epoch 64 loss: 359.83857250213623; train accuracy: 0.9094154094827587; test accuracy: 0.6439
2025-09-24 18:26:32 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 18:26:32 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 18:26:32 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 18:26:32 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:26:52 [INFO]  Epoch 60 loss: 100.9319372177124; train accuracy: 0.8851318359375; test accuracy: 0.257
2025-09-24 18:26:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_60.pth
2025-09-24 18:26:53 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:27:14 [INFO]  Epoch 61 loss: 110.0614423751831; train accuracy: 0.8720703125; test accuracy: 0.2498
2025-09-24 18:27:14 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:27:35 [INFO]  Epoch 62 loss: 109.11941719055176; train accuracy: 0.90185546875; test accuracy: 0.2554
2025-09-24 18:27:35 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:27:56 [INFO]  Epoch 63 loss: 108.76577854156494; train accuracy: 0.877197265625; test accuracy: 0.2505
2025-09-24 18:27:56 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:28:17 [INFO]  Epoch 64 loss: 109.24269533157349; train accuracy: 0.7647705078125; test accuracy: 0.2484
2025-09-24 18:28:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 18:28:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 18:28:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 18:28:17 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:28:23 [INFO]  Epoch 60 loss: 20.847920894622803; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 18:28:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_60.pth
2025-09-24 18:28:23 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:28:31 [INFO]  Epoch 61 loss: 21.686254024505615; train accuracy: 0.966796875; test accuracy: 0.1127
2025-09-24 18:28:31 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:28:37 [INFO]  Epoch 62 loss: 21.55246877670288; train accuracy: 0.9641927083333334; test accuracy: 0.1009
2025-09-24 18:28:37 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:28:44 [INFO]  Epoch 63 loss: 21.69483757019043; train accuracy: 0.9680989583333334; test accuracy: 0.1
2025-09-24 18:28:44 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:28:50 [INFO]  Epoch 64 loss: 21.727089405059814; train accuracy: 0.9641927083333334; test accuracy: 0.1001
2025-09-24 18:28:50 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 18:28:50 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 18:28:50 [INFO]  Round 12 Finish--------|
2025-09-24 18:28:51 [INFO]  Model variance: mean: 0.0037751493509858847, sum: 42183.3359375
2025-09-24 18:28:51 [INFO]  g_protos_std: 1.0067880153656006
2025-09-24 18:28:59 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8025
2025-09-24 18:28:59 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 18:28:59 [INFO]  Round 13 starts--------|
2025-09-24 18:28:59 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 18:28:59 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:29:38 [INFO]  Epoch 65 loss: 202.51425218582153; train accuracy: 0.8647173713235294; test accuracy: 0.483
2025-09-24 18:29:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_65.pth
2025-09-24 18:29:39 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:30:20 [INFO]  Epoch 66 loss: 231.49863815307617; train accuracy: 0.8876378676470589; test accuracy: 0.4871
2025-09-24 18:30:20 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:31:01 [INFO]  Epoch 67 loss: 224.2286081314087; train accuracy: 0.8946461397058824; test accuracy: 0.4761
2025-09-24 18:31:01 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:31:40 [INFO]  Epoch 68 loss: 231.06789112091064; train accuracy: 0.8088235294117647; test accuracy: 0.4682
2025-09-24 18:31:40 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:32:23 [INFO]  Epoch 69 loss: 232.22652292251587; train accuracy: 0.8500114889705882; test accuracy: 0.491
2025-09-24 18:32:23 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 18:32:23 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 18:32:23 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 18:32:23 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:33:08 [INFO]  Epoch 65 loss: 214.78112316131592; train accuracy: 0.8790690104166666; test accuracy: 0.5155
2025-09-24 18:33:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_65.pth
2025-09-24 18:33:09 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:33:54 [INFO]  Epoch 66 loss: 242.2457251548767; train accuracy: 0.8620334201388888; test accuracy: 0.5273
2025-09-24 18:33:54 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:34:40 [INFO]  Epoch 67 loss: 234.86345672607422; train accuracy: 0.87841796875; test accuracy: 0.5456
2025-09-24 18:34:40 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:52:31 [INFO]  Epoch 68 loss: 236.37733507156372; train accuracy: 0.8839518229166666; test accuracy: 0.4956
2025-09-24 18:52:31 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:53:16 [INFO]  Epoch 69 loss: 236.77381229400635; train accuracy: 0.8426649305555556; test accuracy: 0.5498
2025-09-24 18:53:16 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 18:53:16 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 18:53:16 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 18:53:16 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:54:26 [INFO]  Epoch 65 loss: 313.2294054031372; train accuracy: 0.938543911637931; test accuracy: 0.6736
2025-09-24 18:54:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_65.pth
2025-09-24 18:54:27 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:55:37 [INFO]  Epoch 66 loss: 351.10278272628784; train accuracy: 0.9170258620689655; test accuracy: 0.6504
2025-09-24 18:55:37 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:56:45 [INFO]  Epoch 67 loss: 345.7535786628723; train accuracy: 0.9275323275862069; test accuracy: 0.6617
2025-09-24 18:56:45 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:57:54 [INFO]  Epoch 68 loss: 362.35325813293457; train accuracy: 0.9085061961206896; test accuracy: 0.6763
2025-09-24 18:57:54 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:59:02 [INFO]  Epoch 69 loss: 348.4630517959595; train accuracy: 0.9052397629310345; test accuracy: 0.684
2025-09-24 18:59:02 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 18:59:02 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 18:59:02 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 18:59:02 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:59:24 [INFO]  Epoch 65 loss: 100.91492462158203; train accuracy: 0.903076171875; test accuracy: 0.2582
2025-09-24 18:59:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_65.pth
2025-09-24 18:59:24 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:59:44 [INFO]  Epoch 66 loss: 107.65520858764648; train accuracy: 0.9185791015625; test accuracy: 0.273
2025-09-24 18:59:44 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:00:06 [INFO]  Epoch 67 loss: 109.52170944213867; train accuracy: 0.926513671875; test accuracy: 0.2773
2025-09-24 19:00:06 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:00:27 [INFO]  Epoch 68 loss: 107.63431167602539; train accuracy: 0.8642578125; test accuracy: 0.2676
2025-09-24 19:00:27 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:00:48 [INFO]  Epoch 69 loss: 108.11929225921631; train accuracy: 0.889892578125; test accuracy: 0.2713
2025-09-24 19:00:48 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:00:48 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:00:48 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:00:48 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:00:56 [INFO]  Epoch 65 loss: 20.863656520843506; train accuracy: 0.966796875; test accuracy: 0.1003
2025-09-24 19:00:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_65.pth
2025-09-24 19:00:56 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:01:02 [INFO]  Epoch 66 loss: 21.595006942749023; train accuracy: 0.9635416666666666; test accuracy: 0.1
2025-09-24 19:01:02 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:01:10 [INFO]  Epoch 67 loss: 21.78887128829956; train accuracy: 0.9622395833333334; test accuracy: 0.1151
2025-09-24 19:01:10 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:01:17 [INFO]  Epoch 68 loss: 21.58458709716797; train accuracy: 0.9661458333333334; test accuracy: 0.105
2025-09-24 19:01:17 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:01:23 [INFO]  Epoch 69 loss: 21.527623176574707; train accuracy: 0.9635416666666666; test accuracy: 0.1007
2025-09-24 19:01:23 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:01:23 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:01:23 [INFO]  Round 13 Finish--------|
2025-09-24 19:01:23 [INFO]  Model variance: mean: 0.003915666602551937, sum: 43753.46875
2025-09-24 19:01:23 [INFO]  g_protos_std: 1.0068598985671997
2025-09-24 19:01:32 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8078
2025-09-24 19:01:32 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:01:32 [INFO]  Round 14 starts--------|
2025-09-24 19:01:32 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:01:32 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:02:14 [INFO]  Epoch 70 loss: 201.9006805419922; train accuracy: 0.9129136029411765; test accuracy: 0.503
2025-09-24 19:02:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_70.pth
2025-09-24 19:02:15 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:02:56 [INFO]  Epoch 71 loss: 225.8581838607788; train accuracy: 0.8637982536764706; test accuracy: 0.4684
2025-09-24 19:02:56 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:03:37 [INFO]  Epoch 72 loss: 223.42739057540894; train accuracy: 0.8331227022058824; test accuracy: 0.4465
2025-09-24 19:03:37 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:04:20 [INFO]  Epoch 73 loss: 227.60943508148193; train accuracy: 0.8866038602941176; test accuracy: 0.466
2025-09-24 19:04:20 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:05:01 [INFO]  Epoch 74 loss: 223.41531610488892; train accuracy: 0.8100298713235294; test accuracy: 0.4285
2025-09-24 19:05:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:05:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:05:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:05:01 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:05:43 [INFO]  Epoch 70 loss: 212.85843992233276; train accuracy: 0.8862847222222222; test accuracy: 0.5515
2025-09-24 19:05:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_70.pth
2025-09-24 19:05:43 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:06:27 [INFO]  Epoch 71 loss: 235.15135431289673; train accuracy: 0.8333875868055556; test accuracy: 0.5039
2025-09-24 19:06:27 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:07:11 [INFO]  Epoch 72 loss: 228.3105444908142; train accuracy: 0.8880208333333334; test accuracy: 0.5207
2025-09-24 19:07:11 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:07:56 [INFO]  Epoch 73 loss: 231.7832260131836; train accuracy: 0.8760850694444444; test accuracy: 0.5392
2025-09-24 19:07:56 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:08:39 [INFO]  Epoch 74 loss: 233.56641912460327; train accuracy: 0.8860134548611112; test accuracy: 0.5104
2025-09-24 19:08:39 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:08:39 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:08:39 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:08:39 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:09:48 [INFO]  Epoch 70 loss: 315.1699776649475; train accuracy: 0.9062163254310345; test accuracy: 0.6689
2025-09-24 19:09:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_70.pth
2025-09-24 19:09:48 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:10:58 [INFO]  Epoch 71 loss: 347.3346061706543; train accuracy: 0.9369612068965517; test accuracy: 0.6564
2025-09-24 19:10:58 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:12:06 [INFO]  Epoch 72 loss: 341.7990093231201; train accuracy: 0.9304620150862069; test accuracy: 0.6759
2025-09-24 19:12:06 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:13:17 [INFO]  Epoch 73 loss: 346.16993951797485; train accuracy: 0.9220770474137931; test accuracy: 0.6889
2025-09-24 19:13:17 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:14:24 [INFO]  Epoch 74 loss: 341.1330261230469; train accuracy: 0.9434940732758621; test accuracy: 0.685
2025-09-24 19:14:24 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:14:24 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:14:24 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:14:24 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:14:46 [INFO]  Epoch 70 loss: 100.6341724395752; train accuracy: 0.90234375; test accuracy: 0.2658
2025-09-24 19:14:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_70.pth
2025-09-24 19:14:46 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:15:08 [INFO]  Epoch 71 loss: 108.62335729598999; train accuracy: 0.9178466796875; test accuracy: 0.2757
2025-09-24 19:15:08 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:15:28 [INFO]  Epoch 72 loss: 108.01984357833862; train accuracy: 0.786376953125; test accuracy: 0.2276
2025-09-24 19:15:28 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:15:49 [INFO]  Epoch 73 loss: 107.70758962631226; train accuracy: 0.87060546875; test accuracy: 0.2652
2025-09-24 19:15:49 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:16:10 [INFO]  Epoch 74 loss: 108.77531576156616; train accuracy: 0.9256591796875; test accuracy: 0.285
2025-09-24 19:16:10 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:16:10 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:16:10 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:16:10 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:16:17 [INFO]  Epoch 70 loss: 20.82976531982422; train accuracy: 0.9602864583333334; test accuracy: 0.1006
2025-09-24 19:16:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_70.pth
2025-09-24 19:16:18 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:16:24 [INFO]  Epoch 71 loss: 21.504122257232666; train accuracy: 0.96484375; test accuracy: 0.1008
2025-09-24 19:16:24 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:16:31 [INFO]  Epoch 72 loss: 21.484586238861084; train accuracy: 0.9661458333333334; test accuracy: 0.106
2025-09-24 19:16:31 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:16:38 [INFO]  Epoch 73 loss: 21.66434907913208; train accuracy: 0.9622395833333334; test accuracy: 0.1003
2025-09-24 19:16:38 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:16:46 [INFO]  Epoch 74 loss: 21.520305633544922; train accuracy: 0.9622395833333334; test accuracy: 0.1031
2025-09-24 19:16:46 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:16:46 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:16:46 [INFO]  Round 14 Finish--------|
2025-09-24 19:16:46 [INFO]  Model variance: mean: 0.004052549600601196, sum: 45282.9921875
2025-09-24 19:16:46 [INFO]  g_protos_std: 1.0069397687911987
2025-09-24 19:16:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8224
2025-09-24 19:16:55 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:16:55 [INFO]  Round 15 starts--------|
2025-09-24 19:16:55 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:16:55 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:17:37 [INFO]  Epoch 75 loss: 201.5900158882141; train accuracy: 0.8521369485294118; test accuracy: 0.4555
2025-09-24 19:17:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_75.pth
2025-09-24 19:17:38 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:18:19 [INFO]  Epoch 76 loss: 225.56889390945435; train accuracy: 0.8154871323529411; test accuracy: 0.4256
2025-09-24 19:18:19 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:19:01 [INFO]  Epoch 77 loss: 219.2910327911377; train accuracy: 0.9237706801470589; test accuracy: 0.5095
2025-09-24 19:19:01 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:19:41 [INFO]  Epoch 78 loss: 219.55561542510986; train accuracy: 0.8422564338235294; test accuracy: 0.4725
2025-09-24 19:19:41 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:20:22 [INFO]  Epoch 79 loss: 217.67967128753662; train accuracy: 0.8482881433823529; test accuracy: 0.449
2025-09-24 19:20:22 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:20:22 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:20:22 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:20:22 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:21:07 [INFO]  Epoch 75 loss: 211.60736560821533; train accuracy: 0.9110785590277778; test accuracy: 0.5109
2025-09-24 19:21:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_75.pth
2025-09-24 19:21:08 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:21:50 [INFO]  Epoch 76 loss: 234.9486689567566; train accuracy: 0.8827039930555556; test accuracy: 0.5266
2025-09-24 19:21:50 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:22:32 [INFO]  Epoch 77 loss: 227.26394367218018; train accuracy: 0.8840603298611112; test accuracy: 0.5384
2025-09-24 19:22:32 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:23:13 [INFO]  Epoch 78 loss: 231.00857400894165; train accuracy: 0.8931749131944444; test accuracy: 0.5642
2025-09-24 19:23:13 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:23:53 [INFO]  Epoch 79 loss: 231.12675094604492; train accuracy: 0.8805881076388888; test accuracy: 0.5186
2025-09-24 19:23:53 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:23:53 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:23:53 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:23:53 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:24:59 [INFO]  Epoch 75 loss: 315.62272214889526; train accuracy: 0.9233566810344828; test accuracy: 0.6689
2025-09-24 19:24:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_75.pth
2025-09-24 19:24:59 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:26:03 [INFO]  Epoch 76 loss: 340.0744333267212; train accuracy: 0.9259159482758621; test accuracy: 0.69
2025-09-24 19:26:03 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:27:06 [INFO]  Epoch 77 loss: 342.5598964691162; train accuracy: 0.9170258620689655; test accuracy: 0.6914
2025-09-24 19:27:06 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:28:10 [INFO]  Epoch 78 loss: 345.01561880111694; train accuracy: 0.9019733297413793; test accuracy: 0.6773
2025-09-24 19:28:10 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:29:14 [INFO]  Epoch 79 loss: 343.4953866004944; train accuracy: 0.9105266702586207; test accuracy: 0.6585
2025-09-24 19:29:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:29:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:29:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:29:14 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:29:34 [INFO]  Epoch 75 loss: 100.51070356369019; train accuracy: 0.8427734375; test accuracy: 0.23
2025-09-24 19:29:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_75.pth
2025-09-24 19:29:35 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:29:56 [INFO]  Epoch 76 loss: 109.57565879821777; train accuracy: 0.842041015625; test accuracy: 0.2493
2025-09-24 19:29:56 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:30:16 [INFO]  Epoch 77 loss: 107.35952711105347; train accuracy: 0.88720703125; test accuracy: 0.2681
2025-09-24 19:30:16 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:30:37 [INFO]  Epoch 78 loss: 109.2566270828247; train accuracy: 0.8515625; test accuracy: 0.2678
2025-09-24 19:30:37 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:30:57 [INFO]  Epoch 79 loss: 106.52810621261597; train accuracy: 0.912353515625; test accuracy: 0.2849
2025-09-24 19:30:57 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:30:57 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:30:57 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:30:57 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:31:03 [INFO]  Epoch 75 loss: 20.827783584594727; train accuracy: 0.962890625; test accuracy: 0.1039
2025-09-24 19:31:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_75.pth
2025-09-24 19:31:04 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:31:10 [INFO]  Epoch 76 loss: 21.606412410736084; train accuracy: 0.9622395833333334; test accuracy: 0.1089
2025-09-24 19:31:10 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:31:16 [INFO]  Epoch 77 loss: 21.831605911254883; train accuracy: 0.9680989583333334; test accuracy: 0.1047
2025-09-24 19:31:16 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:31:22 [INFO]  Epoch 78 loss: 21.5498046875; train accuracy: 0.9615885416666666; test accuracy: 0.1006
2025-09-24 19:31:22 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:31:29 [INFO]  Epoch 79 loss: 21.52699089050293; train accuracy: 0.9602864583333334; test accuracy: 0.1042
2025-09-24 19:31:29 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:31:29 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:31:29 [INFO]  Round 15 Finish--------|
2025-09-24 19:31:29 [INFO]  Model variance: mean: 0.004186057951301336, sum: 46774.8125
2025-09-24 19:31:29 [INFO]  g_protos_std: 1.0070140361785889
2025-09-24 19:31:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8186
2025-09-24 19:31:38 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:31:38 [INFO]  Round 16 starts--------|
2025-09-24 19:31:38 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:31:38 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:32:17 [INFO]  Epoch 80 loss: 197.82881116867065; train accuracy: 0.8577665441176471; test accuracy: 0.477
2025-09-24 19:32:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_80.pth
2025-09-24 19:32:18 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:32:57 [INFO]  Epoch 81 loss: 217.2273473739624; train accuracy: 0.9014246323529411; test accuracy: 0.4886
2025-09-24 19:32:57 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:33:33 [INFO]  Epoch 82 loss: 217.24585723876953; train accuracy: 0.8812040441176471; test accuracy: 0.4736
2025-09-24 19:33:33 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:34:12 [INFO]  Epoch 83 loss: 220.9537091255188; train accuracy: 0.8816061580882353; test accuracy: 0.4654
2025-09-24 19:34:12 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:34:50 [INFO]  Epoch 84 loss: 215.9815649986267; train accuracy: 0.8498391544117647; test accuracy: 0.4566
2025-09-24 19:34:50 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:34:50 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:34:50 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:34:50 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:35:28 [INFO]  Epoch 80 loss: 209.9760308265686; train accuracy: 0.8004557291666666; test accuracy: 0.4807
2025-09-24 19:35:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_80.pth
2025-09-24 19:35:30 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:36:10 [INFO]  Epoch 81 loss: 231.29370307922363; train accuracy: 0.8896484375; test accuracy: 0.5762
2025-09-24 19:36:10 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:36:53 [INFO]  Epoch 82 loss: 229.8366527557373; train accuracy: 0.8404947916666666; test accuracy: 0.5044
2025-09-24 19:36:53 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:37:37 [INFO]  Epoch 83 loss: 228.221284866333; train accuracy: 0.8900824652777778; test accuracy: 0.5223
2025-09-24 19:37:37 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:38:19 [INFO]  Epoch 84 loss: 222.71610927581787; train accuracy: 0.8774956597222222; test accuracy: 0.5746
2025-09-24 19:38:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:38:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:38:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:38:19 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:39:24 [INFO]  Epoch 80 loss: 310.65874433517456; train accuracy: 0.9288793103448276; test accuracy: 0.6827
2025-09-24 19:39:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_80.pth
2025-09-24 19:39:24 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:40:28 [INFO]  Epoch 81 loss: 330.3087844848633; train accuracy: 0.951104525862069; test accuracy: 0.6846
2025-09-24 19:40:28 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:41:29 [INFO]  Epoch 82 loss: 343.5020213127136; train accuracy: 0.9315059267241379; test accuracy: 0.6933
2025-09-24 19:41:29 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:42:35 [INFO]  Epoch 83 loss: 344.8273763656616; train accuracy: 0.9044989224137931; test accuracy: 0.6608
2025-09-24 19:42:35 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:43:38 [INFO]  Epoch 84 loss: 339.6838402748108; train accuracy: 0.9314049030172413; test accuracy: 0.7095
2025-09-24 19:43:38 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:43:38 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:43:38 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:43:38 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:43:57 [INFO]  Epoch 80 loss: 100.26232290267944; train accuracy: 0.9271240234375; test accuracy: 0.281
2025-09-24 19:43:58 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_80.pth
2025-09-24 19:43:58 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:44:17 [INFO]  Epoch 81 loss: 107.68613815307617; train accuracy: 0.9326171875; test accuracy: 0.2855
2025-09-24 19:44:17 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:44:37 [INFO]  Epoch 82 loss: 106.67441463470459; train accuracy: 0.9305419921875; test accuracy: 0.2827
2025-09-24 19:44:37 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:44:56 [INFO]  Epoch 83 loss: 106.94503688812256; train accuracy: 0.937744140625; test accuracy: 0.2867
2025-09-24 19:44:56 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:16 [INFO]  Epoch 84 loss: 105.34109878540039; train accuracy: 0.922607421875; test accuracy: 0.2865
2025-09-24 19:45:16 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:45:16 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:45:16 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:45:17 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:45:23 [INFO]  Epoch 80 loss: 20.822837829589844; train accuracy: 0.9654947916666666; test accuracy: 0.103
2025-09-24 19:45:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_80.pth
2025-09-24 19:45:23 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:30 [INFO]  Epoch 81 loss: 21.442660331726074; train accuracy: 0.9641927083333334; test accuracy: 0.101
2025-09-24 19:45:30 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:36 [INFO]  Epoch 82 loss: 21.53890085220337; train accuracy: 0.9622395833333334; test accuracy: 0.1143
2025-09-24 19:45:36 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:42 [INFO]  Epoch 83 loss: 21.670405387878418; train accuracy: 0.9635416666666666; test accuracy: 0.1023
2025-09-24 19:45:42 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:48 [INFO]  Epoch 84 loss: 21.92948341369629; train accuracy: 0.9661458333333334; test accuracy: 0.1018
2025-09-24 19:45:48 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:45:48 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:45:48 [INFO]  Round 16 Finish--------|
2025-09-24 19:45:48 [INFO]  Model variance: mean: 0.0043154447339475155, sum: 48220.5703125
2025-09-24 19:45:48 [INFO]  g_protos_std: 1.0070923566818237
2025-09-24 19:45:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8297
2025-09-24 19:45:57 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:45:57 [INFO]  Round 17 starts--------|
2025-09-24 19:45:57 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:45:57 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:46:37 [INFO]  Epoch 85 loss: 200.12892723083496; train accuracy: 0.8880399816176471; test accuracy: 0.4963
2025-09-24 19:46:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_85.pth
2025-09-24 19:46:37 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:47:16 [INFO]  Epoch 86 loss: 219.39934921264648; train accuracy: 0.8923483455882353; test accuracy: 0.4747
2025-09-24 19:47:16 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:47:53 [INFO]  Epoch 87 loss: 216.37053537368774; train accuracy: 0.8998736213235294; test accuracy: 0.4885
2025-09-24 19:47:53 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:48:31 [INFO]  Epoch 88 loss: 217.14801692962646; train accuracy: 0.8743106617647058; test accuracy: 0.4706
2025-09-24 19:48:31 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:49:09 [INFO]  Epoch 89 loss: 223.5710005760193; train accuracy: 0.9128561580882353; test accuracy: 0.4896
2025-09-24 19:49:09 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:49:09 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:49:09 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:49:09 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:49:49 [INFO]  Epoch 85 loss: 208.81158065795898; train accuracy: 0.9187282986111112; test accuracy: 0.5649
2025-09-24 19:49:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_85.pth
2025-09-24 19:49:49 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:50:29 [INFO]  Epoch 86 loss: 229.0128893852234; train accuracy: 0.8898111979166666; test accuracy: 0.5493
2025-09-24 19:50:29 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:51:09 [INFO]  Epoch 87 loss: 221.25935220718384; train accuracy: 0.8127712673611112; test accuracy: 0.503
2025-09-24 19:51:09 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:51:48 [INFO]  Epoch 88 loss: 229.05125665664673; train accuracy: 0.9204644097222222; test accuracy: 0.5622
2025-09-24 19:51:48 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:52:28 [INFO]  Epoch 89 loss: 229.24587154388428; train accuracy: 0.9180772569444444; test accuracy: 0.538
2025-09-24 19:52:28 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:52:28 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:52:28 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:52:28 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:53:30 [INFO]  Epoch 85 loss: 308.3081932067871; train accuracy: 0.8999865301724138; test accuracy: 0.6761
2025-09-24 19:53:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_85.pth
2025-09-24 19:53:31 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:54:32 [INFO]  Epoch 86 loss: 343.5099263191223; train accuracy: 0.9113685344827587; test accuracy: 0.6685
2025-09-24 19:54:32 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:55:34 [INFO]  Epoch 87 loss: 334.524450302124; train accuracy: 0.9029498922413793; test accuracy: 0.6803
2025-09-24 19:55:34 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:56:37 [INFO]  Epoch 88 loss: 336.86000204086304; train accuracy: 0.9359509698275862; test accuracy: 0.7012
2025-09-24 19:56:37 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:57:41 [INFO]  Epoch 89 loss: 336.64191246032715; train accuracy: 0.9016702586206896; test accuracy: 0.7068
2025-09-24 19:57:41 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:57:41 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:57:41 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:57:41 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:58:00 [INFO]  Epoch 85 loss: 100.73102617263794; train accuracy: 0.9195556640625; test accuracy: 0.2647
2025-09-24 19:58:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_85.pth
2025-09-24 19:58:00 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:58:20 [INFO]  Epoch 86 loss: 106.94919061660767; train accuracy: 0.924560546875; test accuracy: 0.2835
2025-09-24 19:58:20 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:58:40 [INFO]  Epoch 87 loss: 106.29799461364746; train accuracy: 0.8709716796875; test accuracy: 0.256
2025-09-24 19:58:40 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:59:00 [INFO]  Epoch 88 loss: 107.18220329284668; train accuracy: 0.918212890625; test accuracy: 0.2787
2025-09-24 19:59:00 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:59:19 [INFO]  Epoch 89 loss: 106.46450901031494; train accuracy: 0.8970947265625; test accuracy: 0.2933
2025-09-24 19:59:19 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:59:19 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:59:19 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:59:19 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:59:25 [INFO]  Epoch 85 loss: 20.827143669128418; train accuracy: 0.9615885416666666; test accuracy: 0.1012
2025-09-24 19:59:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_85.pth
2025-09-24 19:59:26 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:59:32 [INFO]  Epoch 86 loss: 21.61650514602661; train accuracy: 0.966796875; test accuracy: 0.113
2025-09-24 19:59:32 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:59:38 [INFO]  Epoch 87 loss: 21.409274578094482; train accuracy: 0.9661458333333334; test accuracy: 0.102
2025-09-24 19:59:38 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:59:44 [INFO]  Epoch 88 loss: 21.776514053344727; train accuracy: 0.9661458333333334; test accuracy: 0.1004
2025-09-24 19:59:44 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:59:51 [INFO]  Epoch 89 loss: 21.556856632232666; train accuracy: 0.962890625; test accuracy: 0.101
2025-09-24 19:59:51 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:59:51 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:59:51 [INFO]  Round 17 Finish--------|
2025-09-24 19:59:51 [INFO]  Model variance: mean: 0.0044405534863471985, sum: 49618.53125
2025-09-24 19:59:51 [INFO]  g_protos_std: 1.0071618556976318
2025-09-24 19:59:59 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8353
2025-09-24 19:59:59 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:59:59 [INFO]  Round 18 starts--------|
2025-09-24 19:59:59 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:59:59 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:00:37 [INFO]  Epoch 90 loss: 198.87599420547485; train accuracy: 0.9107881433823529; test accuracy: 0.4902
2025-09-24 20:00:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_90.pth
2025-09-24 20:00:37 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:01:14 [INFO]  Epoch 91 loss: 218.76120281219482; train accuracy: 0.9165326286764706; test accuracy: 0.4888
2025-09-24 20:01:14 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:01:51 [INFO]  Epoch 92 loss: 218.13103675842285; train accuracy: 0.9052734375; test accuracy: 0.4944
2025-09-24 20:01:51 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:02:28 [INFO]  Epoch 93 loss: 218.24492120742798; train accuracy: 0.9010225183823529; test accuracy: 0.5153
2025-09-24 20:02:28 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:03:05 [INFO]  Epoch 94 loss: 211.01860666275024; train accuracy: 0.9175091911764706; test accuracy: 0.4894
2025-09-24 20:03:05 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:03:05 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:03:05 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:03:05 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:03:46 [INFO]  Epoch 90 loss: 207.86417484283447; train accuracy: 0.9099392361111112; test accuracy: 0.5545
2025-09-24 20:03:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_90.pth
2025-09-24 20:03:46 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:04:27 [INFO]  Epoch 91 loss: 226.19507312774658; train accuracy: 0.8553059895833334; test accuracy: 0.5326
2025-09-24 20:04:27 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:05:08 [INFO]  Epoch 92 loss: 232.27140045166016; train accuracy: 0.9341362847222222; test accuracy: 0.5754
2025-09-24 20:05:08 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:05:47 [INFO]  Epoch 93 loss: 223.4225459098816; train accuracy: 0.8956705729166666; test accuracy: 0.5803
2025-09-24 20:05:47 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:06:28 [INFO]  Epoch 94 loss: 236.45489072799683; train accuracy: 0.8759765625; test accuracy: 0.5367
2025-09-24 20:06:28 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:06:28 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:06:28 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:06:28 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:07:30 [INFO]  Epoch 90 loss: 315.0685405731201; train accuracy: 0.9286099137931034; test accuracy: 0.6902
2025-09-24 20:07:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_90.pth
2025-09-24 20:07:31 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:08:34 [INFO]  Epoch 91 loss: 340.16046619415283; train accuracy: 0.9411368534482759; test accuracy: 0.6971
2025-09-24 20:08:34 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:09:38 [INFO]  Epoch 92 loss: 335.41768646240234; train accuracy: 0.9090786637931034; test accuracy: 0.6969
2025-09-24 20:09:38 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:10:41 [INFO]  Epoch 93 loss: 338.0470824241638; train accuracy: 0.9258149245689655; test accuracy: 0.725
2025-09-24 20:10:41 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:11:45 [INFO]  Epoch 94 loss: 339.72283411026; train accuracy: 0.9294517780172413; test accuracy: 0.6932
2025-09-24 20:11:45 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:11:45 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:11:45 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:11:45 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:12:04 [INFO]  Epoch 90 loss: 99.34976148605347; train accuracy: 0.927978515625; test accuracy: 0.2674
2025-09-24 20:12:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_90.pth
2025-09-24 20:12:04 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:12:25 [INFO]  Epoch 91 loss: 105.38369655609131; train accuracy: 0.9150390625; test accuracy: 0.2993
2025-09-24 20:12:25 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:12:45 [INFO]  Epoch 92 loss: 104.83543634414673; train accuracy: 0.9273681640625; test accuracy: 0.3184
2025-09-24 20:12:45 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:06 [INFO]  Epoch 93 loss: 102.70045375823975; train accuracy: 0.941650390625; test accuracy: 0.3001
2025-09-24 20:13:06 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:26 [INFO]  Epoch 94 loss: 105.67516469955444; train accuracy: 0.9122314453125; test accuracy: 0.2869
2025-09-24 20:13:26 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:13:26 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:13:26 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:13:26 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:13:32 [INFO]  Epoch 90 loss: 20.81108522415161; train accuracy: 0.962890625; test accuracy: 0.1027
2025-09-24 20:13:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_90.pth
2025-09-24 20:13:33 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:39 [INFO]  Epoch 91 loss: 21.49999713897705; train accuracy: 0.9654947916666666; test accuracy: 0.1044
2025-09-24 20:13:39 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:45 [INFO]  Epoch 92 loss: 21.615886688232422; train accuracy: 0.962890625; test accuracy: 0.102
2025-09-24 20:13:45 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:51 [INFO]  Epoch 93 loss: 21.542144298553467; train accuracy: 0.9641927083333334; test accuracy: 0.101
2025-09-24 20:13:51 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:58 [INFO]  Epoch 94 loss: 21.549595832824707; train accuracy: 0.96484375; test accuracy: 0.1125
2025-09-24 20:13:58 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:13:58 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:13:58 [INFO]  Round 18 Finish--------|
2025-09-24 20:13:58 [INFO]  Model variance: mean: 0.004563086200505495, sum: 50987.703125
2025-09-24 20:13:58 [INFO]  g_protos_std: 1.0072370767593384
2025-09-24 20:14:07 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8344
2025-09-24 20:14:07 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:14:07 [INFO]  Round 19 starts--------|
2025-09-24 20:14:07 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:14:07 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:14:46 [INFO]  Epoch 95 loss: 195.2767744064331; train accuracy: 0.9134880514705882; test accuracy: 0.5045
2025-09-24 20:14:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_95.pth
2025-09-24 20:14:46 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:15:26 [INFO]  Epoch 96 loss: 224.75043535232544; train accuracy: 0.9060202205882353; test accuracy: 0.488
2025-09-24 20:15:26 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:16:06 [INFO]  Epoch 97 loss: 208.0566544532776; train accuracy: 0.8948759191176471; test accuracy: 0.4868
2025-09-24 20:16:06 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:16:45 [INFO]  Epoch 98 loss: 216.92823934555054; train accuracy: 0.9329044117647058; test accuracy: 0.5028
2025-09-24 20:16:45 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:17:24 [INFO]  Epoch 99 loss: 213.13238096237183; train accuracy: 0.8921760110294118; test accuracy: 0.4937
2025-09-24 20:17:24 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:17:24 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:17:24 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:17:24 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:18:07 [INFO]  Epoch 95 loss: 206.93297290802002; train accuracy: 0.9236111111111112; test accuracy: 0.5628
2025-09-24 20:18:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_95.pth
2025-09-24 20:18:07 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:18:50 [INFO]  Epoch 96 loss: 228.95697259902954; train accuracy: 0.9070095486111112; test accuracy: 0.5206
2025-09-24 20:18:50 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:19:34 [INFO]  Epoch 97 loss: 228.48118019104004; train accuracy: 0.8866102430555556; test accuracy: 0.5301
2025-09-24 20:19:34 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:20:15 [INFO]  Epoch 98 loss: 227.82431030273438; train accuracy: 0.8722873263888888; test accuracy: 0.5098
2025-09-24 20:20:15 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:20:57 [INFO]  Epoch 99 loss: 221.44129180908203; train accuracy: 0.9336480034722222; test accuracy: 0.5834
2025-09-24 20:20:57 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:20:57 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:20:57 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:20:57 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:22:02 [INFO]  Epoch 95 loss: 311.7752480506897; train accuracy: 0.9516769935344828; test accuracy: 0.7198
2025-09-24 20:22:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_95.pth
2025-09-24 20:22:03 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:23:08 [INFO]  Epoch 96 loss: 336.5325918197632; train accuracy: 0.922918911637931; test accuracy: 0.6865
2025-09-24 20:23:08 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:24:11 [INFO]  Epoch 97 loss: 331.66926288604736; train accuracy: 0.9036907327586207; test accuracy: 0.6961
2025-09-24 20:24:11 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:25:17 [INFO]  Epoch 98 loss: 327.06477308273315; train accuracy: 0.939453125; test accuracy: 0.7088
2025-09-24 20:25:17 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:26:22 [INFO]  Epoch 99 loss: 336.6013379096985; train accuracy: 0.9217403017241379; test accuracy: 0.6778
2025-09-24 20:26:22 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:26:22 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:26:22 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:26:22 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:26:43 [INFO]  Epoch 95 loss: 100.0339183807373; train accuracy: 0.93115234375; test accuracy: 0.2926
2025-09-24 20:26:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_95.pth
2025-09-24 20:26:43 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:27:04 [INFO]  Epoch 96 loss: 105.1101279258728; train accuracy: 0.945068359375; test accuracy: 0.3046
2025-09-24 20:27:04 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:27:24 [INFO]  Epoch 97 loss: 106.26765966415405; train accuracy: 0.9447021484375; test accuracy: 0.3059
2025-09-24 20:27:24 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:27:45 [INFO]  Epoch 98 loss: 104.7953839302063; train accuracy: 0.8729248046875; test accuracy: 0.2711
2025-09-24 20:27:45 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:28:05 [INFO]  Epoch 99 loss: 104.08293581008911; train accuracy: 0.9346923828125; test accuracy: 0.3093
2025-09-24 20:28:05 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:28:05 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:28:05 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:28:05 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:28:12 [INFO]  Epoch 95 loss: 20.84187602996826; train accuracy: 0.9674479166666666; test accuracy: 0.1131
2025-09-24 20:28:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_95.pth
2025-09-24 20:28:12 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:28:19 [INFO]  Epoch 96 loss: 21.411911964416504; train accuracy: 0.9713541666666666; test accuracy: 0.1049
2025-09-24 20:28:19 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:28:26 [INFO]  Epoch 97 loss: 21.493321895599365; train accuracy: 0.9654947916666666; test accuracy: 0.1011
2025-09-24 20:28:26 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:28:33 [INFO]  Epoch 98 loss: 21.487653255462646; train accuracy: 0.9661458333333334; test accuracy: 0.1005
2025-09-24 20:28:33 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:28:39 [INFO]  Epoch 99 loss: 21.50672483444214; train accuracy: 0.9661458333333334; test accuracy: 0.1068
2025-09-24 20:28:39 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:28:39 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:28:39 [INFO]  Round 19 Finish--------|
2025-09-24 20:28:39 [INFO]  Model variance: mean: 0.004683592356741428, sum: 52334.234375
2025-09-24 20:28:39 [INFO]  g_protos_std: 1.0073150396347046
2025-09-24 20:28:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8453
2025-09-24 20:28:48 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:28:48 [INFO]  Round 20 starts--------|
2025-09-24 20:28:48 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:28:48 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:29:25 [INFO]  Epoch 100 loss: 195.04860258102417; train accuracy: 0.8644301470588235; test accuracy: 0.4643
2025-09-24 20:29:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_100.pth
2025-09-24 20:29:26 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:30:03 [INFO]  Epoch 101 loss: 216.78296661376953; train accuracy: 0.9086052389705882; test accuracy: 0.4924
2025-09-24 20:30:03 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:30:41 [INFO]  Epoch 102 loss: 219.05677556991577; train accuracy: 0.9305491727941176; test accuracy: 0.5069
2025-09-24 20:30:41 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:31:20 [INFO]  Epoch 103 loss: 213.7950987815857; train accuracy: 0.830078125; test accuracy: 0.4498
2025-09-24 20:31:20 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:31:59 [INFO]  Epoch 104 loss: 209.58836030960083; train accuracy: 0.8202550551470589; test accuracy: 0.4346
2025-09-24 20:31:59 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:31:59 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:31:59 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:31:59 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:32:41 [INFO]  Epoch 100 loss: 208.44924926757812; train accuracy: 0.9169921875; test accuracy: 0.5267
2025-09-24 20:32:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_100.pth
2025-09-24 20:32:41 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:33:23 [INFO]  Epoch 101 loss: 230.93049144744873; train accuracy: 0.83740234375; test accuracy: 0.5018
2025-09-24 20:33:23 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:34:04 [INFO]  Epoch 102 loss: 229.2831163406372; train accuracy: 0.9117838541666666; test accuracy: 0.5638
2025-09-24 20:34:04 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:34:46 [INFO]  Epoch 103 loss: 225.18521642684937; train accuracy: 0.9205186631944444; test accuracy: 0.5259
2025-09-24 20:34:46 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:35:28 [INFO]  Epoch 104 loss: 225.8098521232605; train accuracy: 0.8219401041666666; test accuracy: 0.5542
2025-09-24 20:35:28 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:35:28 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:35:28 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:35:28 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:36:33 [INFO]  Epoch 100 loss: 307.7353563308716; train accuracy: 0.9475686961206896; test accuracy: 0.7083
2025-09-24 20:36:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_100.pth
2025-09-24 20:36:34 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:37:37 [INFO]  Epoch 101 loss: 337.19442081451416; train accuracy: 0.8781990840517241; test accuracy: 0.6634
2025-09-24 20:37:37 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:38:42 [INFO]  Epoch 102 loss: 337.25605869293213; train accuracy: 0.9308661099137931; test accuracy: 0.6881
2025-09-24 20:38:42 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:39:46 [INFO]  Epoch 103 loss: 332.9058427810669; train accuracy: 0.9321120689655172; test accuracy: 0.6596
2025-09-24 20:39:46 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:40:53 [INFO]  Epoch 104 loss: 330.78622674942017; train accuracy: 0.9394194504310345; test accuracy: 0.7151
2025-09-24 20:40:53 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:40:53 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:40:53 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:40:53 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:41:13 [INFO]  Epoch 100 loss: 99.50134706497192; train accuracy: 0.9410400390625; test accuracy: 0.2917
2025-09-24 20:41:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_100.pth
2025-09-24 20:41:13 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:41:35 [INFO]  Epoch 101 loss: 104.33411931991577; train accuracy: 0.91943359375; test accuracy: 0.2741
2025-09-24 20:41:35 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:41:54 [INFO]  Epoch 102 loss: 105.19879150390625; train accuracy: 0.9388427734375; test accuracy: 0.3065
2025-09-24 20:41:54 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:42:14 [INFO]  Epoch 103 loss: 105.44265127182007; train accuracy: 0.951416015625; test accuracy: 0.3018
2025-09-24 20:42:14 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:42:34 [INFO]  Epoch 104 loss: 103.23288536071777; train accuracy: 0.900634765625; test accuracy: 0.2632
2025-09-24 20:42:34 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:42:34 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:42:34 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:42:34 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:42:41 [INFO]  Epoch 100 loss: 20.79598903656006; train accuracy: 0.96484375; test accuracy: 0.1055
2025-09-24 20:42:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_100.pth
2025-09-24 20:42:41 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:42:47 [INFO]  Epoch 101 loss: 21.675023078918457; train accuracy: 0.9602864583333334; test accuracy: 0.1026
2025-09-24 20:42:47 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:42:53 [INFO]  Epoch 102 loss: 21.470711708068848; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 20:42:53 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:43:00 [INFO]  Epoch 103 loss: 21.64191770553589; train accuracy: 0.9661458333333334; test accuracy: 0.1004
2025-09-24 20:43:00 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:43:06 [INFO]  Epoch 104 loss: 21.543172359466553; train accuracy: 0.9609375; test accuracy: 0.1055
2025-09-24 20:43:06 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:43:06 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:43:06 [INFO]  Round 20 Finish--------|
2025-09-24 20:43:06 [INFO]  Model variance: mean: 0.00480117741972208, sum: 53648.125
2025-09-24 20:43:06 [INFO]  g_protos_std: 1.0073858499526978
2025-09-24 20:43:15 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8484
2025-09-24 20:43:15 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:43:15 [INFO]  Round 21 starts--------|
2025-09-24 20:43:15 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:43:15 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:43:55 [INFO]  Epoch 105 loss: 197.42740106582642; train accuracy: 0.9100988051470589; test accuracy: 0.505
2025-09-24 20:43:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_105.pth
2025-09-24 20:43:55 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:44:34 [INFO]  Epoch 106 loss: 212.8416304588318; train accuracy: 0.8924632352941176; test accuracy: 0.4843
2025-09-24 20:44:34 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:45:15 [INFO]  Epoch 107 loss: 202.87638807296753; train accuracy: 0.9006778492647058; test accuracy: 0.4837
2025-09-24 20:45:15 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:45:56 [INFO]  Epoch 108 loss: 213.32132053375244; train accuracy: 0.9024586397058824; test accuracy: 0.4639
2025-09-24 20:45:56 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:46:36 [INFO]  Epoch 109 loss: 214.60885381698608; train accuracy: 0.8997587316176471; test accuracy: 0.4855
2025-09-24 20:46:36 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:46:36 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:46:36 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:46:36 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:47:17 [INFO]  Epoch 105 loss: 204.93324899673462; train accuracy: 0.9258897569444444; test accuracy: 0.5406
2025-09-24 20:47:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_105.pth
2025-09-24 20:47:18 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:48:00 [INFO]  Epoch 106 loss: 221.55517530441284; train accuracy: 0.9109157986111112; test accuracy: 0.5523
2025-09-24 20:48:00 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:48:41 [INFO]  Epoch 107 loss: 218.54142475128174; train accuracy: 0.9178602430555556; test accuracy: 0.6082
2025-09-24 20:48:41 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:49:24 [INFO]  Epoch 108 loss: 217.84750604629517; train accuracy: 0.8907877604166666; test accuracy: 0.5633
2025-09-24 20:49:24 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:50:06 [INFO]  Epoch 109 loss: 221.4934220314026; train accuracy: 0.9020724826388888; test accuracy: 0.5273
2025-09-24 20:50:06 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:50:06 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:50:06 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:50:06 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:51:11 [INFO]  Epoch 105 loss: 310.27533435821533; train accuracy: 0.9439655172413793; test accuracy: 0.7101
2025-09-24 20:51:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_105.pth
2025-09-24 20:51:12 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:52:16 [INFO]  Epoch 106 loss: 336.88233375549316; train accuracy: 0.925713900862069; test accuracy: 0.7003
2025-09-24 20:52:16 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:53:21 [INFO]  Epoch 107 loss: 336.4576458930969; train accuracy: 0.8971915409482759; test accuracy: 0.7163
2025-09-24 20:53:21 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:54:25 [INFO]  Epoch 108 loss: 328.7503294944763; train accuracy: 0.9286099137931034; test accuracy: 0.7137
2025-09-24 20:54:25 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:55:32 [INFO]  Epoch 109 loss: 332.72785472869873; train accuracy: 0.9470635775862069; test accuracy: 0.7068
2025-09-24 20:55:32 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:55:32 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:55:32 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:55:32 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:55:53 [INFO]  Epoch 105 loss: 99.17799520492554; train accuracy: 0.93603515625; test accuracy: 0.2892
2025-09-24 20:55:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_105.pth
2025-09-24 20:55:53 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:56:13 [INFO]  Epoch 106 loss: 103.43956232070923; train accuracy: 0.9453125; test accuracy: 0.3254
2025-09-24 20:56:13 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:56:33 [INFO]  Epoch 107 loss: 106.89900827407837; train accuracy: 0.873046875; test accuracy: 0.2736
2025-09-24 20:56:33 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:56:53 [INFO]  Epoch 108 loss: 104.18103075027466; train accuracy: 0.9327392578125; test accuracy: 0.3189
2025-09-24 20:56:53 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:13 [INFO]  Epoch 109 loss: 104.56400966644287; train accuracy: 0.945068359375; test accuracy: 0.3035
2025-09-24 20:57:13 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:57:13 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:57:13 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:57:13 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:57:19 [INFO]  Epoch 105 loss: 20.80711603164673; train accuracy: 0.9654947916666666; test accuracy: 0.1033
2025-09-24 20:57:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_105.pth
2025-09-24 20:57:20 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:27 [INFO]  Epoch 106 loss: 21.33215618133545; train accuracy: 0.9661458333333334; test accuracy: 0.1058
2025-09-24 20:57:27 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:33 [INFO]  Epoch 107 loss: 21.498173236846924; train accuracy: 0.9641927083333334; test accuracy: 0.1017
2025-09-24 20:57:33 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:40 [INFO]  Epoch 108 loss: 21.614229679107666; train accuracy: 0.9622395833333334; test accuracy: 0.1005
2025-09-24 20:57:40 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:46 [INFO]  Epoch 109 loss: 21.65661907196045; train accuracy: 0.9635416666666666; test accuracy: 0.1017
2025-09-24 20:57:46 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:57:46 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:57:46 [INFO]  Round 21 Finish--------|
2025-09-24 20:57:46 [INFO]  Model variance: mean: 0.004914994817227125, sum: 54919.9140625
2025-09-24 20:57:46 [INFO]  g_protos_std: 1.0074602365493774
2025-09-24 20:57:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.85
2025-09-24 20:57:55 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:57:55 [INFO]  Round 22 starts--------|
2025-09-24 20:57:55 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:57:55 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:58:35 [INFO]  Epoch 110 loss: 196.56246614456177; train accuracy: 0.9398552389705882; test accuracy: 0.5093
2025-09-24 20:58:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_110.pth
2025-09-24 20:58:35 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:59:15 [INFO]  Epoch 111 loss: 215.8893895149231; train accuracy: 0.9282513786764706; test accuracy: 0.5121
2025-09-24 20:59:15 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:59:53 [INFO]  Epoch 112 loss: 215.87540531158447; train accuracy: 0.9076286764705882; test accuracy: 0.4757
2025-09-24 20:59:53 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:00:34 [INFO]  Epoch 113 loss: 215.46544885635376; train accuracy: 0.9241153492647058; test accuracy: 0.5048
2025-09-24 21:00:34 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:01:13 [INFO]  Epoch 114 loss: 215.0709195137024; train accuracy: 0.9095243566176471; test accuracy: 0.4636
2025-09-24 21:01:13 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:01:13 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:01:13 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:01:13 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:01:54 [INFO]  Epoch 110 loss: 205.93539476394653; train accuracy: 0.9104275173611112; test accuracy: 0.4973
2025-09-24 21:01:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_110.pth
2025-09-24 21:01:55 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:02:36 [INFO]  Epoch 111 loss: 227.45799732208252; train accuracy: 0.9375542534722222; test accuracy: 0.5559
2025-09-24 21:02:36 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:03:16 [INFO]  Epoch 112 loss: 222.32198286056519; train accuracy: 0.9363064236111112; test accuracy: 0.549
2025-09-24 21:03:16 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:03:57 [INFO]  Epoch 113 loss: 226.5037326812744; train accuracy: 0.9091796875; test accuracy: 0.5307
2025-09-24 21:03:57 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:04:38 [INFO]  Epoch 114 loss: 223.5084195137024; train accuracy: 0.8870442708333334; test accuracy: 0.5572
2025-09-24 21:04:38 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:04:38 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:04:38 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:04:38 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:05:43 [INFO]  Epoch 110 loss: 309.0733494758606; train accuracy: 0.9582435344827587; test accuracy: 0.7092
2025-09-24 21:05:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_110.pth
2025-09-24 21:05:43 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:06:48 [INFO]  Epoch 111 loss: 326.2731604576111; train accuracy: 0.9291823814655172; test accuracy: 0.6845
2025-09-24 21:06:48 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:07:52 [INFO]  Epoch 112 loss: 324.97945737838745; train accuracy: 0.9415072737068966; test accuracy: 0.7196
2025-09-24 21:07:52 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:08:56 [INFO]  Epoch 113 loss: 329.92271757125854; train accuracy: 0.9396888469827587; test accuracy: 0.7106
2025-09-24 21:08:56 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:10:01 [INFO]  Epoch 114 loss: 339.14706897735596; train accuracy: 0.9467268318965517; test accuracy: 0.7257
2025-09-24 21:10:01 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:10:01 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:10:01 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:10:01 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:10:21 [INFO]  Epoch 110 loss: 99.49661588668823; train accuracy: 0.9039306640625; test accuracy: 0.2865
2025-09-24 21:10:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_110.pth
2025-09-24 21:10:21 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:10:42 [INFO]  Epoch 111 loss: 103.18283462524414; train accuracy: 0.9508056640625; test accuracy: 0.3325
2025-09-24 21:10:42 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:11:01 [INFO]  Epoch 112 loss: 103.01272630691528; train accuracy: 0.9365234375; test accuracy: 0.3007
2025-09-24 21:11:01 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:11:21 [INFO]  Epoch 113 loss: 103.88966178894043; train accuracy: 0.9217529296875; test accuracy: 0.3092
2025-09-24 21:11:21 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:11:42 [INFO]  Epoch 114 loss: 103.83303833007812; train accuracy: 0.92529296875; test accuracy: 0.3088
2025-09-24 21:11:42 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:11:42 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:11:42 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:11:42 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:11:48 [INFO]  Epoch 110 loss: 20.78934144973755; train accuracy: 0.9615885416666666; test accuracy: 0.1009
2025-09-24 21:11:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_110.pth
2025-09-24 21:11:49 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:11:55 [INFO]  Epoch 111 loss: 21.52586603164673; train accuracy: 0.96484375; test accuracy: 0.1048
2025-09-24 21:11:55 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:12:02 [INFO]  Epoch 112 loss: 21.372328281402588; train accuracy: 0.9615885416666666; test accuracy: 0.1182
2025-09-24 21:12:02 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:12:08 [INFO]  Epoch 113 loss: 21.57326602935791; train accuracy: 0.9635416666666666; test accuracy: 0.1035
2025-09-24 21:12:08 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:12:15 [INFO]  Epoch 114 loss: 21.515028476715088; train accuracy: 0.962890625; test accuracy: 0.1011
2025-09-24 21:12:15 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:12:15 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:12:15 [INFO]  Round 22 Finish--------|
2025-09-24 21:12:15 [INFO]  Model variance: mean: 0.005026465747505426, sum: 56165.484375
2025-09-24 21:12:15 [INFO]  g_protos_std: 1.0075249671936035
2025-09-24 21:12:24 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8502
2025-09-24 21:12:24 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:12:24 [INFO]  Round 23 starts--------|
2025-09-24 21:12:24 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:12:24 [INFO]  Epoch 115: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:13:03 [INFO]  Epoch 115 loss: 197.27612590789795; train accuracy: 0.9195197610294118; test accuracy: 0.4994
2025-09-24 21:13:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_115.pth
2025-09-24 21:13:04 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:13:42 [INFO]  Epoch 116 loss: 214.98863315582275; train accuracy: 0.9263556985294118; test accuracy: 0.5062
2025-09-24 21:13:42 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:14:23 [INFO]  Epoch 117 loss: 210.77468729019165; train accuracy: 0.8532858455882353; test accuracy: 0.4476
2025-09-24 21:14:23 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:15:03 [INFO]  Epoch 118 loss: 214.5655083656311; train accuracy: 0.9243451286764706; test accuracy: 0.5189
2025-09-24 21:15:03 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:15:42 [INFO]  Epoch 119 loss: 214.1640214920044; train accuracy: 0.9484145220588235; test accuracy: 0.5238
2025-09-24 21:15:42 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:15:42 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:15:42 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:15:42 [INFO]  Epoch 115: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:16:25 [INFO]  Epoch 115 loss: 203.52041387557983; train accuracy: 0.8898111979166666; test accuracy: 0.5332
2025-09-24 21:16:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_115.pth
2025-09-24 21:16:25 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:17:07 [INFO]  Epoch 116 loss: 220.8486680984497; train accuracy: 0.9086371527777778; test accuracy: 0.5272
2025-09-24 21:17:07 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:17:48 [INFO]  Epoch 117 loss: 217.3482003211975; train accuracy: 0.9001193576388888; test accuracy: 0.5678
2025-09-24 21:17:48 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:18:29 [INFO]  Epoch 118 loss: 215.98419380187988; train accuracy: 0.8976779513888888; test accuracy: 0.5655
2025-09-24 21:18:29 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:19:11 [INFO]  Epoch 119 loss: 214.0215072631836; train accuracy: 0.9435763888888888; test accuracy: 0.5319
2025-09-24 21:19:11 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:19:11 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:19:11 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:19:11 [INFO]  Epoch 115: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:20:13 [INFO]  Epoch 115 loss: 305.4762005805969; train accuracy: 0.938543911637931; test accuracy: 0.7189
2025-09-24 21:20:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_115.pth
2025-09-24 21:20:14 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:21:19 [INFO]  Epoch 116 loss: 331.92835998535156; train accuracy: 0.9408337823275862; test accuracy: 0.6839
2025-09-24 21:21:19 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:22:23 [INFO]  Epoch 117 loss: 329.8952350616455; train accuracy: 0.9370622306034483; test accuracy: 0.7376
2025-09-24 21:22:23 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:23:31 [INFO]  Epoch 118 loss: 325.6626935005188; train accuracy: 0.959051724137931; test accuracy: 0.7112
2025-09-24 21:23:31 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:24:37 [INFO]  Epoch 119 loss: 320.4814438819885; train accuracy: 0.9206290409482759; test accuracy: 0.7186
2025-09-24 21:24:37 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:24:37 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:24:37 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:24:37 [INFO]  Epoch 115: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:24:56 [INFO]  Epoch 115 loss: 98.81581926345825; train accuracy: 0.9088134765625; test accuracy: 0.2986
2025-09-24 21:24:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_115.pth
2025-09-24 21:24:57 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:25:17 [INFO]  Epoch 116 loss: 103.51176643371582; train accuracy: 0.935791015625; test accuracy: 0.3117
2025-09-24 21:25:17 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:25:38 [INFO]  Epoch 117 loss: 105.90333271026611; train accuracy: 0.9500732421875; test accuracy: 0.3304
2025-09-24 21:25:38 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:25:58 [INFO]  Epoch 118 loss: 103.8534255027771; train accuracy: 0.9610595703125; test accuracy: 0.3107
2025-09-24 21:25:58 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:26:17 [INFO]  Epoch 119 loss: 103.17178010940552; train accuracy: 0.9482421875; test accuracy: 0.304
2025-09-24 21:26:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:26:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:26:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:26:17 [INFO]  Epoch 115: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:26:23 [INFO]  Epoch 115 loss: 20.807794094085693; train accuracy: 0.9641927083333334; test accuracy: 0.1009
2025-09-24 21:26:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_115.pth
2025-09-24 21:26:23 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:26:30 [INFO]  Epoch 116 loss: 21.472906589508057; train accuracy: 0.966796875; test accuracy: 0.1062
2025-09-24 21:26:30 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:26:36 [INFO]  Epoch 117 loss: 21.402336597442627; train accuracy: 0.96484375; test accuracy: 0.1041
2025-09-24 21:26:36 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:26:42 [INFO]  Epoch 118 loss: 21.503945350646973; train accuracy: 0.9635416666666666; test accuracy: 0.101
2025-09-24 21:26:42 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:26:49 [INFO]  Epoch 119 loss: 21.37452220916748; train accuracy: 0.9674479166666666; test accuracy: 0.1029
2025-09-24 21:26:49 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:26:49 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:26:49 [INFO]  Round 23 Finish--------|
2025-09-24 21:26:49 [INFO]  Model variance: mean: 0.005135731305927038, sum: 57386.4140625
2025-09-24 21:26:49 [INFO]  g_protos_std: 1.0076072216033936
2025-09-24 21:26:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8468
2025-09-24 21:26:58 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:26:58 [INFO]  Round 24 starts--------|
2025-09-24 21:26:58 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:26:58 [INFO]  Epoch 120: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:27:36 [INFO]  Epoch 120 loss: 195.365336894989; train accuracy: 0.8732192095588235; test accuracy: 0.4781
2025-09-24 21:27:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_120.pth
2025-09-24 21:27:37 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:28:13 [INFO]  Epoch 121 loss: 212.740225315094; train accuracy: 0.9254365808823529; test accuracy: 0.4976
2025-09-24 21:28:13 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:28:50 [INFO]  Epoch 122 loss: 208.3379201889038; train accuracy: 0.9123391544117647; test accuracy: 0.4716
2025-09-24 21:28:50 [INFO]  Epoch 123: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:29:29 [INFO]  Epoch 123 loss: 208.8465461730957; train accuracy: 0.8828125; test accuracy: 0.4983
2025-09-24 21:29:29 [INFO]  Epoch 124: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:30:07 [INFO]  Epoch 124 loss: 210.72270917892456; train accuracy: 0.9373851102941176; test accuracy: 0.5101
2025-09-24 21:30:07 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:30:07 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:30:07 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:30:07 [INFO]  Epoch 120: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:30:47 [INFO]  Epoch 120 loss: 203.00110530853271; train accuracy: 0.9461263020833334; test accuracy: 0.5609
2025-09-24 21:30:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_120.pth
2025-09-24 21:30:47 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:31:27 [INFO]  Epoch 121 loss: 217.7607865333557; train accuracy: 0.9122178819444444; test accuracy: 0.5494
2025-09-24 21:31:27 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:32:09 [INFO]  Epoch 122 loss: 222.16598796844482; train accuracy: 0.9271375868055556; test accuracy: 0.5479
2025-09-24 21:32:09 [INFO]  Epoch 123: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:32:50 [INFO]  Epoch 123 loss: 223.18685245513916; train accuracy: 0.9153103298611112; test accuracy: 0.5289
2025-09-24 21:32:50 [INFO]  Epoch 124: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:33:30 [INFO]  Epoch 124 loss: 220.57914400100708; train accuracy: 0.9199761284722222; test accuracy: 0.5717
2025-09-24 21:33:30 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:33:30 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:33:30 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:33:30 [INFO]  Epoch 120: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:34:35 [INFO]  Epoch 120 loss: 305.0367774963379; train accuracy: 0.9443359375; test accuracy: 0.6812
2025-09-24 21:34:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_120.pth
2025-09-24 21:34:36 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:35:41 [INFO]  Epoch 121 loss: 337.16897344589233; train accuracy: 0.9636651400862069; test accuracy: 0.7275
2025-09-24 21:35:41 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:36:45 [INFO]  Epoch 122 loss: 324.652636051178; train accuracy: 0.9346039870689655; test accuracy: 0.69
2025-09-24 21:36:45 [INFO]  Epoch 123: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:37:49 [INFO]  Epoch 123 loss: 327.08212184906006; train accuracy: 0.9468615301724138; test accuracy: 0.722
2025-09-24 21:37:49 [INFO]  Epoch 124: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:38:53 [INFO]  Epoch 124 loss: 331.4242925643921; train accuracy: 0.9468615301724138; test accuracy: 0.6806
2025-09-24 21:38:53 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:38:53 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:38:53 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:38:54 [INFO]  Epoch 120: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:39:13 [INFO]  Epoch 120 loss: 98.06181240081787; train accuracy: 0.9498291015625; test accuracy: 0.3074
2025-09-24 21:39:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_120.pth
2025-09-24 21:39:14 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:39:36 [INFO]  Epoch 121 loss: 103.63766527175903; train accuracy: 0.9285888671875; test accuracy: 0.3116
2025-09-24 21:39:36 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:39:55 [INFO]  Epoch 122 loss: 103.27927494049072; train accuracy: 0.9598388671875; test accuracy: 0.3239
2025-09-24 21:39:55 [INFO]  Epoch 123: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:40:16 [INFO]  Epoch 123 loss: 104.5748062133789; train accuracy: 0.9571533203125; test accuracy: 0.2837
2025-09-24 21:40:16 [INFO]  Epoch 124: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:40:37 [INFO]  Epoch 124 loss: 102.9656891822815; train accuracy: 0.954833984375; test accuracy: 0.3298
2025-09-24 21:40:37 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:40:37 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:40:37 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:40:37 [INFO]  Epoch 120: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:40:44 [INFO]  Epoch 120 loss: 20.797075271606445; train accuracy: 0.9661458333333334; test accuracy: 0.1029
2025-09-24 21:40:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_120.pth
2025-09-24 21:40:44 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:40:51 [INFO]  Epoch 121 loss: 21.325538158416748; train accuracy: 0.9674479166666666; test accuracy: 0.1036
2025-09-24 21:40:51 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:40:57 [INFO]  Epoch 122 loss: 21.41758108139038; train accuracy: 0.966796875; test accuracy: 0.105
2025-09-24 21:40:57 [INFO]  Epoch 123: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:41:04 [INFO]  Epoch 123 loss: 21.46756649017334; train accuracy: 0.9654947916666666; test accuracy: 0.1272
2025-09-24 21:41:04 [INFO]  Epoch 124: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:41:10 [INFO]  Epoch 124 loss: 21.66707420349121; train accuracy: 0.966796875; test accuracy: 0.1035
2025-09-24 21:41:10 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:41:10 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:41:10 [INFO]  Round 24 Finish--------|
2025-09-24 21:41:10 [INFO]  Model variance: mean: 0.005241615232080221, sum: 58569.5546875
2025-09-24 21:41:10 [INFO]  g_protos_std: 1.00767183303833
2025-09-24 21:41:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8511
2025-09-24 21:41:19 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:41:19 [INFO]  Round 25 starts--------|
2025-09-24 21:41:19 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:41:19 [INFO]  Epoch 125: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:41:57 [INFO]  Epoch 125 loss: 193.99704790115356; train accuracy: 0.9113051470588235; test accuracy: 0.5086
2025-09-24 21:41:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_125.pth
2025-09-24 21:41:57 [INFO]  Epoch 126: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:42:36 [INFO]  Epoch 126 loss: 204.016921043396; train accuracy: 0.8936695772058824; test accuracy: 0.4905
2025-09-24 21:42:36 [INFO]  Epoch 127: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:43:14 [INFO]  Epoch 127 loss: 205.5595941543579; train accuracy: 0.8505284926470589; test accuracy: 0.465
2025-09-24 21:43:14 [INFO]  Epoch 128: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:43:53 [INFO]  Epoch 128 loss: 213.73596811294556; train accuracy: 0.8941865808823529; test accuracy: 0.4723
2025-09-24 21:43:53 [INFO]  Epoch 129: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:44:33 [INFO]  Epoch 129 loss: 208.3498649597168; train accuracy: 0.9009076286764706; test accuracy: 0.5157
2025-09-24 21:44:33 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:44:33 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:44:33 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:44:33 [INFO]  Epoch 125: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:45:14 [INFO]  Epoch 125 loss: 203.01529359817505; train accuracy: 0.9073893229166666; test accuracy: 0.5664
2025-09-24 21:45:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_125.pth
2025-09-24 21:45:15 [INFO]  Epoch 126: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:45:56 [INFO]  Epoch 126 loss: 221.73346185684204; train accuracy: 0.9054904513888888; test accuracy: 0.5656
2025-09-24 21:45:56 [INFO]  Epoch 127: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:46:38 [INFO]  Epoch 127 loss: 218.4671335220337; train accuracy: 0.9392361111111112; test accuracy: 0.57
2025-09-24 21:46:38 [INFO]  Epoch 128: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:47:18 [INFO]  Epoch 128 loss: 220.2172613143921; train accuracy: 0.91845703125; test accuracy: 0.5241
2025-09-24 21:47:18 [INFO]  Epoch 129: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:47:57 [INFO]  Epoch 129 loss: 224.18016529083252; train accuracy: 0.9219292534722222; test accuracy: 0.523
2025-09-24 21:47:57 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:47:57 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:47:57 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:47:57 [INFO]  Epoch 125: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:49:00 [INFO]  Epoch 125 loss: 309.0225410461426; train accuracy: 0.9447063577586207; test accuracy: 0.7218
2025-09-24 21:49:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_125.pth
2025-09-24 21:49:01 [INFO]  Epoch 126: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:50:05 [INFO]  Epoch 126 loss: 332.27855253219604; train accuracy: 0.9579741379310345; test accuracy: 0.7165
2025-09-24 21:50:05 [INFO]  Epoch 127: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:51:07 [INFO]  Epoch 127 loss: 327.5181875228882; train accuracy: 0.9373316271551724; test accuracy: 0.7075
2025-09-24 21:51:07 [INFO]  Epoch 128: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:52:09 [INFO]  Epoch 128 loss: 322.09534788131714; train accuracy: 0.9344356142241379; test accuracy: 0.6986
2025-09-24 21:52:09 [INFO]  Epoch 129: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:53:12 [INFO]  Epoch 129 loss: 328.8755979537964; train accuracy: 0.9600956357758621; test accuracy: 0.7235
2025-09-24 21:53:12 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:53:12 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:53:12 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:53:12 [INFO]  Epoch 125: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:53:34 [INFO]  Epoch 125 loss: 98.21860408782959; train accuracy: 0.916259765625; test accuracy: 0.3179
2025-09-24 21:53:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_125.pth
2025-09-24 21:53:34 [INFO]  Epoch 126: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:53:54 [INFO]  Epoch 126 loss: 101.94632053375244; train accuracy: 0.9591064453125; test accuracy: 0.3205
2025-09-24 21:53:54 [INFO]  Epoch 127: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:54:14 [INFO]  Epoch 127 loss: 103.06657075881958; train accuracy: 0.956298828125; test accuracy: 0.3407
2025-09-24 21:54:14 [INFO]  Epoch 128: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:54:35 [INFO]  Epoch 128 loss: 102.37868309020996; train accuracy: 0.951904296875; test accuracy: 0.318
2025-09-24 21:54:35 [INFO]  Epoch 129: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:54:55 [INFO]  Epoch 129 loss: 104.20181608200073; train accuracy: 0.91845703125; test accuracy: 0.2922
2025-09-24 21:54:55 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:54:55 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:54:55 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:54:55 [INFO]  Epoch 125: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:55:01 [INFO]  Epoch 125 loss: 20.772265434265137; train accuracy: 0.9674479166666666; test accuracy: 0.1054
2025-09-24 21:55:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_125.pth
2025-09-24 21:55:01 [INFO]  Epoch 126: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:55:08 [INFO]  Epoch 126 loss: 21.261227130889893; train accuracy: 0.96484375; test accuracy: 0.1018
2025-09-24 21:55:08 [INFO]  Epoch 127: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:55:14 [INFO]  Epoch 127 loss: 21.476089477539062; train accuracy: 0.9654947916666666; test accuracy: 0.1128
2025-09-24 21:55:14 [INFO]  Epoch 128: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:55:20 [INFO]  Epoch 128 loss: 21.350598335266113; train accuracy: 0.96484375; test accuracy: 0.1015
2025-09-24 21:55:20 [INFO]  Epoch 129: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:55:27 [INFO]  Epoch 129 loss: 21.458054065704346; train accuracy: 0.9635416666666666; test accuracy: 0.1002
2025-09-24 21:55:27 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:55:27 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:55:27 [INFO]  Round 25 Finish--------|
2025-09-24 21:55:27 [INFO]  Model variance: mean: 0.00534679414704442, sum: 59744.8203125
2025-09-24 21:55:27 [INFO]  g_protos_std: 1.0077458620071411
2025-09-24 21:55:36 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8494
2025-09-24 21:55:36 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:55:36 [INFO]  Round 26 starts--------|
2025-09-24 21:55:36 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:55:36 [INFO]  Epoch 130: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:56:15 [INFO]  Epoch 130 loss: 195.28278493881226; train accuracy: 0.9306640625; test accuracy: 0.5123
2025-09-24 21:56:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_130.pth
2025-09-24 21:56:16 [INFO]  Epoch 131: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:56:56 [INFO]  Epoch 131 loss: 206.10056972503662; train accuracy: 0.9221622242647058; test accuracy: 0.5043
2025-09-24 21:56:56 [INFO]  Epoch 132: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:57:35 [INFO]  Epoch 132 loss: 205.70893144607544; train accuracy: 0.9423828125; test accuracy: 0.5333
2025-09-24 21:57:35 [INFO]  Epoch 133: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:58:12 [INFO]  Epoch 133 loss: 205.66189622879028; train accuracy: 0.8921760110294118; test accuracy: 0.4714
2025-09-24 21:58:12 [INFO]  Epoch 134: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:58:51 [INFO]  Epoch 134 loss: 209.55024814605713; train accuracy: 0.8959099264705882; test accuracy: 0.5062
2025-09-24 21:58:51 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:58:51 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:58:51 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:58:51 [INFO]  Epoch 130: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:59:33 [INFO]  Epoch 130 loss: 203.0807318687439; train accuracy: 0.9476996527777778; test accuracy: 0.6034
2025-09-24 21:59:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_130.pth
2025-09-24 21:59:33 [INFO]  Epoch 131: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:00:12 [INFO]  Epoch 131 loss: 218.75113439559937; train accuracy: 0.9479709201388888; test accuracy: 0.5721
2025-09-24 22:00:12 [INFO]  Epoch 132: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:00:55 [INFO]  Epoch 132 loss: 218.6770043373108; train accuracy: 0.9324544270833334; test accuracy: 0.5751
2025-09-24 22:00:55 [INFO]  Epoch 133: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:01:35 [INFO]  Epoch 133 loss: 223.47363233566284; train accuracy: 0.9367947048611112; test accuracy: 0.5647
2025-09-24 22:01:35 [INFO]  Epoch 134: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:02:16 [INFO]  Epoch 134 loss: 213.88060903549194; train accuracy: 0.9329969618055556; test accuracy: 0.5554
2025-09-24 22:02:16 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:02:16 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:02:16 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:02:16 [INFO]  Epoch 130: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:03:20 [INFO]  Epoch 130 loss: 309.87291622161865; train accuracy: 0.9636314655172413; test accuracy: 0.7323
2025-09-24 22:03:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_130.pth
2025-09-24 22:03:21 [INFO]  Epoch 131: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:04:26 [INFO]  Epoch 131 loss: 323.8157215118408; train accuracy: 0.9563240840517241; test accuracy: 0.7191
2025-09-24 22:04:26 [INFO]  Epoch 132: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:05:30 [INFO]  Epoch 132 loss: 323.86893367767334; train accuracy: 0.91015625; test accuracy: 0.6708
2025-09-24 22:05:30 [INFO]  Epoch 133: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:06:35 [INFO]  Epoch 133 loss: 324.53881072998047; train accuracy: 0.9446053340517241; test accuracy: 0.7361
2025-09-24 22:06:35 [INFO]  Epoch 134: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:07:40 [INFO]  Epoch 134 loss: 323.64505195617676; train accuracy: 0.9698275862068966; test accuracy: 0.7284
2025-09-24 22:07:40 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:07:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:07:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:07:40 [INFO]  Epoch 130: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:07:59 [INFO]  Epoch 130 loss: 98.58399486541748; train accuracy: 0.9600830078125; test accuracy: 0.3214
2025-09-24 22:08:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_130.pth
2025-09-24 22:08:00 [INFO]  Epoch 131: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:08:20 [INFO]  Epoch 131 loss: 103.73214054107666; train accuracy: 0.938720703125; test accuracy: 0.3451
2025-09-24 22:08:20 [INFO]  Epoch 132: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:08:40 [INFO]  Epoch 132 loss: 104.67411422729492; train accuracy: 0.9505615234375; test accuracy: 0.325
2025-09-24 22:08:40 [INFO]  Epoch 133: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:01 [INFO]  Epoch 133 loss: 102.02528285980225; train accuracy: 0.9627685546875; test accuracy: 0.3243
2025-09-24 22:09:01 [INFO]  Epoch 134: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:21 [INFO]  Epoch 134 loss: 103.19115972518921; train accuracy: 0.9365234375; test accuracy: 0.31
2025-09-24 22:09:21 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:09:21 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:09:21 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:09:21 [INFO]  Epoch 130: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:09:28 [INFO]  Epoch 130 loss: 20.80535364151001; train accuracy: 0.9661458333333334; test accuracy: 0.103
2025-09-24 22:09:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_130.pth
2025-09-24 22:09:28 [INFO]  Epoch 131: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:35 [INFO]  Epoch 131 loss: 21.25150728225708; train accuracy: 0.9680989583333334; test accuracy: 0.1256
2025-09-24 22:09:35 [INFO]  Epoch 132: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:42 [INFO]  Epoch 132 loss: 21.43438959121704; train accuracy: 0.9661458333333334; test accuracy: 0.117
2025-09-24 22:09:42 [INFO]  Epoch 133: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:48 [INFO]  Epoch 133 loss: 21.362488269805908; train accuracy: 0.9641927083333334; test accuracy: 0.1027
2025-09-24 22:09:48 [INFO]  Epoch 134: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:54 [INFO]  Epoch 134 loss: 21.700432300567627; train accuracy: 0.9622395833333334; test accuracy: 0.1007
2025-09-24 22:09:54 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:09:54 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:09:54 [INFO]  Round 26 Finish--------|
2025-09-24 22:09:54 [INFO]  Model variance: mean: 0.00544998561963439, sum: 60897.87890625
2025-09-24 22:09:54 [INFO]  g_protos_std: 1.0078200101852417
2025-09-24 22:10:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8573
2025-09-24 22:10:03 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:10:03 [INFO]  Round 27 starts--------|
2025-09-24 22:10:03 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:10:03 [INFO]  Epoch 135: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:10:43 [INFO]  Epoch 135 loss: 192.02236127853394; train accuracy: 0.9060776654411765; test accuracy: 0.5023
2025-09-24 22:10:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_135.pth
2025-09-24 22:10:44 [INFO]  Epoch 136: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:11:23 [INFO]  Epoch 136 loss: 205.70592164993286; train accuracy: 0.9381893382352942; test accuracy: 0.539
2025-09-24 22:11:23 [INFO]  Epoch 137: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:12:03 [INFO]  Epoch 137 loss: 206.37455940246582; train accuracy: 0.9269301470588235; test accuracy: 0.5224
2025-09-24 22:12:03 [INFO]  Epoch 138: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:12:43 [INFO]  Epoch 138 loss: 212.41429615020752; train accuracy: 0.8798253676470589; test accuracy: 0.4804
2025-09-24 22:12:43 [INFO]  Epoch 139: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:13:23 [INFO]  Epoch 139 loss: 205.16627979278564; train accuracy: 0.9296875; test accuracy: 0.5151
2025-09-24 22:13:23 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:13:23 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:13:23 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:13:23 [INFO]  Epoch 135: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:14:05 [INFO]  Epoch 135 loss: 202.6395239830017; train accuracy: 0.9318576388888888; test accuracy: 0.5401
2025-09-24 22:14:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_135.pth
2025-09-24 22:14:06 [INFO]  Epoch 136: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:14:48 [INFO]  Epoch 136 loss: 213.8471336364746; train accuracy: 0.9303927951388888; test accuracy: 0.5557
2025-09-24 22:14:48 [INFO]  Epoch 137: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:15:30 [INFO]  Epoch 137 loss: 219.02808141708374; train accuracy: 0.9385308159722222; test accuracy: 0.6253
2025-09-24 22:15:30 [INFO]  Epoch 138: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:16:12 [INFO]  Epoch 138 loss: 230.65740442276; train accuracy: 0.9289822048611112; test accuracy: 0.56
2025-09-24 22:16:12 [INFO]  Epoch 139: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:16:55 [INFO]  Epoch 139 loss: 224.1121802330017; train accuracy: 0.9293619791666666; test accuracy: 0.569
2025-09-24 22:16:55 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:16:55 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:16:55 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:16:55 [INFO]  Epoch 135: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:18:00 [INFO]  Epoch 135 loss: 303.66575479507446; train accuracy: 0.9263200431034483; test accuracy: 0.6731
2025-09-24 22:18:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_135.pth
2025-09-24 22:18:01 [INFO]  Epoch 136: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:19:03 [INFO]  Epoch 136 loss: 329.1878652572632; train accuracy: 0.9194841056034483; test accuracy: 0.6813
2025-09-24 22:19:03 [INFO]  Epoch 137: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:20:05 [INFO]  Epoch 137 loss: 323.9902138710022; train accuracy: 0.9347050107758621; test accuracy: 0.7344
2025-09-24 22:20:05 [INFO]  Epoch 138: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:21:08 [INFO]  Epoch 138 loss: 321.93875455856323; train accuracy: 0.9641029094827587; test accuracy: 0.704
2025-09-24 22:21:08 [INFO]  Epoch 139: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:22:12 [INFO]  Epoch 139 loss: 322.6614475250244; train accuracy: 0.9647090517241379; test accuracy: 0.7081
2025-09-24 22:22:12 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:22:12 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:22:12 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:22:12 [INFO]  Epoch 135: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:22:31 [INFO]  Epoch 135 loss: 99.57272243499756; train accuracy: 0.9432373046875; test accuracy: 0.3109
2025-09-24 22:22:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_135.pth
2025-09-24 22:22:32 [INFO]  Epoch 136: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:22:52 [INFO]  Epoch 136 loss: 100.24153232574463; train accuracy: 0.9105224609375; test accuracy: 0.3394
2025-09-24 22:22:52 [INFO]  Epoch 137: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:23:12 [INFO]  Epoch 137 loss: 101.91702365875244; train accuracy: 0.87841796875; test accuracy: 0.2857
2025-09-24 22:23:12 [INFO]  Epoch 138: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:23:32 [INFO]  Epoch 138 loss: 105.38990831375122; train accuracy: 0.833984375; test accuracy: 0.2888
2025-09-24 22:23:32 [INFO]  Epoch 139: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:23:52 [INFO]  Epoch 139 loss: 103.78585720062256; train accuracy: 0.9420166015625; test accuracy: 0.305
2025-09-24 22:23:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:23:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:23:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:23:52 [INFO]  Epoch 135: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:23:58 [INFO]  Epoch 135 loss: 20.754773139953613; train accuracy: 0.9635416666666666; test accuracy: 0.1017
2025-09-24 22:23:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_135.pth
2025-09-24 22:23:59 [INFO]  Epoch 136: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:24:05 [INFO]  Epoch 136 loss: 21.318746089935303; train accuracy: 0.9661458333333334; test accuracy: 0.1129
2025-09-24 22:24:05 [INFO]  Epoch 137: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:24:11 [INFO]  Epoch 137 loss: 21.36538314819336; train accuracy: 0.9641927083333334; test accuracy: 0.1095
2025-09-24 22:24:11 [INFO]  Epoch 138: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:24:17 [INFO]  Epoch 138 loss: 21.112181186676025; train accuracy: 0.970703125; test accuracy: 0.1027
2025-09-24 22:24:17 [INFO]  Epoch 139: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:24:23 [INFO]  Epoch 139 loss: 21.512611389160156; train accuracy: 0.96484375; test accuracy: 0.104
2025-09-24 22:24:23 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:24:23 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:24:23 [INFO]  Round 27 Finish--------|
2025-09-24 22:24:23 [INFO]  Model variance: mean: 0.005551772657781839, sum: 62035.23828125
2025-09-24 22:24:23 [INFO]  g_protos_std: 1.007887363433838
2025-09-24 22:24:32 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8503
2025-09-24 22:24:32 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:24:32 [INFO]  Round 28 starts--------|
2025-09-24 22:24:32 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:24:32 [INFO]  Epoch 140: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:25:10 [INFO]  Epoch 140 loss: 196.10492038726807; train accuracy: 0.9298598345588235; test accuracy: 0.5117
2025-09-24 22:25:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_140.pth
2025-09-24 22:25:11 [INFO]  Epoch 141: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:25:48 [INFO]  Epoch 141 loss: 213.58669185638428; train accuracy: 0.9226792279411765; test accuracy: 0.5337
2025-09-24 22:25:48 [INFO]  Epoch 142: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:26:26 [INFO]  Epoch 142 loss: 210.7610182762146; train accuracy: 0.9296300551470589; test accuracy: 0.5035
2025-09-24 22:26:26 [INFO]  Epoch 143: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:27:05 [INFO]  Epoch 143 loss: 213.5068120956421; train accuracy: 0.8663258272058824; test accuracy: 0.4759
2025-09-24 22:27:05 [INFO]  Epoch 144: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:27:43 [INFO]  Epoch 144 loss: 209.82427310943604; train accuracy: 0.9343405330882353; test accuracy: 0.5397
2025-09-24 22:27:43 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:27:43 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:27:43 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:27:44 [INFO]  Epoch 140: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:28:23 [INFO]  Epoch 140 loss: 204.2032651901245; train accuracy: 0.9158528645833334; test accuracy: 0.5211
2025-09-24 22:28:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_140.pth
2025-09-24 22:28:24 [INFO]  Epoch 141: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:29:04 [INFO]  Epoch 141 loss: 215.22580099105835; train accuracy: 0.8731011284722222; test accuracy: 0.5372
2025-09-24 22:29:04 [INFO]  Epoch 142: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:29:44 [INFO]  Epoch 142 loss: 216.8948678970337; train accuracy: 0.9591471354166666; test accuracy: 0.5994
2025-09-24 22:29:44 [INFO]  Epoch 143: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:30:25 [INFO]  Epoch 143 loss: 217.7374906539917; train accuracy: 0.9461263020833334; test accuracy: 0.5355
2025-09-24 22:30:25 [INFO]  Epoch 144: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:31:05 [INFO]  Epoch 144 loss: 224.0333390235901; train accuracy: 0.92724609375; test accuracy: 0.5846
2025-09-24 22:31:05 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:31:05 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:31:05 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:31:05 [INFO]  Epoch 140: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:32:07 [INFO]  Epoch 140 loss: 303.0890712738037; train accuracy: 0.9574016702586207; test accuracy: 0.7059
2025-09-24 22:32:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_140.pth
2025-09-24 22:32:07 [INFO]  Epoch 141: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:33:06 [INFO]  Epoch 141 loss: 322.95732736587524; train accuracy: 0.9267914870689655; test accuracy: 0.6926
2025-09-24 22:33:06 [INFO]  Epoch 142: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:34:06 [INFO]  Epoch 142 loss: 326.76682472229004; train accuracy: 0.9096511314655172; test accuracy: 0.6763
2025-09-24 22:34:06 [INFO]  Epoch 143: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:35:08 [INFO]  Epoch 143 loss: 330.14304637908936; train accuracy: 0.9492524245689655; test accuracy: 0.6949
2025-09-24 22:35:08 [INFO]  Epoch 144: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:36:09 [INFO]  Epoch 144 loss: 323.9804310798645; train accuracy: 0.9610721982758621; test accuracy: 0.7207
2025-09-24 22:36:09 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:36:09 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:36:09 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:36:09 [INFO]  Epoch 140: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:36:28 [INFO]  Epoch 140 loss: 98.26055192947388; train accuracy: 0.9664306640625; test accuracy: 0.3325
2025-09-24 22:36:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_140.pth
2025-09-24 22:36:29 [INFO]  Epoch 141: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:36:50 [INFO]  Epoch 141 loss: 101.83513450622559; train accuracy: 0.9649658203125; test accuracy: 0.3266
2025-09-24 22:36:50 [INFO]  Epoch 142: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:37:09 [INFO]  Epoch 142 loss: 105.77860403060913; train accuracy: 0.94873046875; test accuracy: 0.3271
2025-09-24 22:37:09 [INFO]  Epoch 143: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:37:29 [INFO]  Epoch 143 loss: 101.68259048461914; train accuracy: 0.96875; test accuracy: 0.325
2025-09-24 22:37:29 [INFO]  Epoch 144: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:37:49 [INFO]  Epoch 144 loss: 102.10563135147095; train accuracy: 0.9576416015625; test accuracy: 0.3558
2025-09-24 22:37:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:37:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:37:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:37:49 [INFO]  Epoch 140: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:37:55 [INFO]  Epoch 140 loss: 20.748050689697266; train accuracy: 0.96484375; test accuracy: 0.1049
2025-09-24 22:37:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_140.pth
2025-09-24 22:37:55 [INFO]  Epoch 141: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:38:02 [INFO]  Epoch 141 loss: 21.377837657928467; train accuracy: 0.9609375; test accuracy: 0.1044
2025-09-24 22:38:02 [INFO]  Epoch 142: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:38:09 [INFO]  Epoch 142 loss: 21.32658863067627; train accuracy: 0.9654947916666666; test accuracy: 0.1044
2025-09-24 22:38:09 [INFO]  Epoch 143: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:38:15 [INFO]  Epoch 143 loss: 21.298072814941406; train accuracy: 0.9635416666666666; test accuracy: 0.1035
2025-09-24 22:38:15 [INFO]  Epoch 144: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:38:21 [INFO]  Epoch 144 loss: 21.218478202819824; train accuracy: 0.9654947916666666; test accuracy: 0.1065
2025-09-24 22:38:21 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:38:21 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:38:21 [INFO]  Round 28 Finish--------|
2025-09-24 22:38:21 [INFO]  Model variance: mean: 0.005651331506669521, sum: 63147.70703125
2025-09-24 22:38:21 [INFO]  g_protos_std: 1.007956624031067
2025-09-24 22:38:30 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8487
2025-09-24 22:38:30 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:38:30 [INFO]  Round 29 starts--------|
2025-09-24 22:38:30 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:38:30 [INFO]  Epoch 145: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:39:11 [INFO]  Epoch 145 loss: 194.12181425094604; train accuracy: 0.9397403492647058; test accuracy: 0.5163
2025-09-24 22:39:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_145.pth
2025-09-24 22:39:11 [INFO]  Epoch 146: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:39:50 [INFO]  Epoch 146 loss: 207.55998849868774; train accuracy: 0.8547794117647058; test accuracy: 0.4754
2025-09-24 22:39:50 [INFO]  Epoch 147: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:40:28 [INFO]  Epoch 147 loss: 209.33629941940308; train accuracy: 0.9173368566176471; test accuracy: 0.5163
2025-09-24 22:40:28 [INFO]  Epoch 148: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:41:06 [INFO]  Epoch 148 loss: 210.4673719406128; train accuracy: 0.9158432904411765; test accuracy: 0.5
2025-09-24 22:41:06 [INFO]  Epoch 149: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:41:45 [INFO]  Epoch 149 loss: 211.82493352890015; train accuracy: 0.9328469669117647; test accuracy: 0.5108
2025-09-24 22:41:45 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:41:45 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:41:45 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:41:45 [INFO]  Epoch 145: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:42:28 [INFO]  Epoch 145 loss: 204.14677953720093; train accuracy: 0.9192708333333334; test accuracy: 0.5255
2025-09-24 22:42:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_145.pth
2025-09-24 22:42:28 [INFO]  Epoch 146: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:43:08 [INFO]  Epoch 146 loss: 216.69053030014038; train accuracy: 0.9117296006944444; test accuracy: 0.5279
2025-09-24 22:43:08 [INFO]  Epoch 147: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:43:49 [INFO]  Epoch 147 loss: 213.24094152450562; train accuracy: 0.9136827256944444; test accuracy: 0.5703
2025-09-24 22:43:49 [INFO]  Epoch 148: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:44:30 [INFO]  Epoch 148 loss: 216.88864946365356; train accuracy: 0.8855794270833334; test accuracy: 0.5275
2025-09-24 22:44:30 [INFO]  Epoch 149: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:45:11 [INFO]  Epoch 149 loss: 217.13844442367554; train accuracy: 0.9354383680555556; test accuracy: 0.5722
2025-09-24 22:45:11 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:45:11 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:45:11 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:45:11 [INFO]  Epoch 145: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:46:16 [INFO]  Epoch 145 loss: 303.2222104072571; train accuracy: 0.9541015625; test accuracy: 0.7359
2025-09-24 22:46:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_145.pth
2025-09-24 22:46:17 [INFO]  Epoch 146: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:47:21 [INFO]  Epoch 146 loss: 325.66108226776123; train accuracy: 0.9430563038793104; test accuracy: 0.6614
2025-09-24 22:47:21 [INFO]  Epoch 147: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:48:27 [INFO]  Epoch 147 loss: 335.04269552230835; train accuracy: 0.9672346443965517; test accuracy: 0.7008
2025-09-24 22:48:27 [INFO]  Epoch 148: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:49:32 [INFO]  Epoch 148 loss: 323.09439754486084; train accuracy: 0.9584792564655172; test accuracy: 0.7406
2025-09-24 22:49:32 [INFO]  Epoch 149: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:50:38 [INFO]  Epoch 149 loss: 322.037269115448; train accuracy: 0.9583445581896551; test accuracy: 0.7293
2025-09-24 22:50:38 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:50:38 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:50:38 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:50:38 [INFO]  Epoch 145: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:50:59 [INFO]  Epoch 145 loss: 98.67394495010376; train accuracy: 0.94580078125; test accuracy: 0.3168
2025-09-24 22:50:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_145.pth
2025-09-24 22:50:59 [INFO]  Epoch 146: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:51:20 [INFO]  Epoch 146 loss: 102.05743789672852; train accuracy: 0.9283447265625; test accuracy: 0.2989
2025-09-24 22:51:20 [INFO]  Epoch 147: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:51:40 [INFO]  Epoch 147 loss: 104.7180323600769; train accuracy: 0.9576416015625; test accuracy: 0.3125
2025-09-24 22:51:40 [INFO]  Epoch 148: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:00 [INFO]  Epoch 148 loss: 103.72540712356567; train accuracy: 0.9539794921875; test accuracy: 0.3136
2025-09-24 22:52:00 [INFO]  Epoch 149: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:21 [INFO]  Epoch 149 loss: 101.49611806869507; train accuracy: 0.921630859375; test accuracy: 0.3069
2025-09-24 22:52:21 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:52:21 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:52:21 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:52:21 [INFO]  Epoch 145: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:52:27 [INFO]  Epoch 145 loss: 20.728773593902588; train accuracy: 0.9635416666666666; test accuracy: 0.102
2025-09-24 22:52:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_145.pth
2025-09-24 22:52:28 [INFO]  Epoch 146: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:34 [INFO]  Epoch 146 loss: 21.36569118499756; train accuracy: 0.9654947916666666; test accuracy: 0.1003
2025-09-24 22:52:34 [INFO]  Epoch 147: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:41 [INFO]  Epoch 147 loss: 21.45418643951416; train accuracy: 0.9622395833333334; test accuracy: 0.1013
2025-09-24 22:52:41 [INFO]  Epoch 148: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:47 [INFO]  Epoch 148 loss: 21.116854667663574; train accuracy: 0.9661458333333334; test accuracy: 0.1154
2025-09-24 22:52:47 [INFO]  Epoch 149: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:54 [INFO]  Epoch 149 loss: 21.237460136413574; train accuracy: 0.962890625; test accuracy: 0.1173
2025-09-24 22:52:54 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:52:54 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:52:54 [INFO]  Round 29 Finish--------|
2025-09-24 22:52:54 [INFO]  Model variance: mean: 0.005747630260884762, sum: 64223.7421875
2025-09-24 22:52:54 [INFO]  g_protos_std: 1.008026123046875
2025-09-24 22:53:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8545
2025-09-24 22:53:03 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:53:03 [INFO]  Round 30 starts--------|
2025-09-24 22:53:03 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:53:03 [INFO]  Epoch 150: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:53:41 [INFO]  Epoch 150 loss: 194.3563632965088; train accuracy: 0.9256089154411765; test accuracy: 0.5057
2025-09-24 22:53:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_150.pth
2025-09-24 22:53:42 [INFO]  Epoch 151: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:54:21 [INFO]  Epoch 151 loss: 201.34490299224854; train accuracy: 0.9273897058823529; test accuracy: 0.5151
2025-09-24 22:54:21 [INFO]  Epoch 152: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:55:02 [INFO]  Epoch 152 loss: 209.1372537612915; train accuracy: 0.9457146139705882; test accuracy: 0.5217
2025-09-24 22:55:02 [INFO]  Epoch 153: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:55:41 [INFO]  Epoch 153 loss: 206.0840358734131; train accuracy: 0.9165326286764706; test accuracy: 0.5501
2025-09-24 22:55:41 [INFO]  Epoch 154: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:56:21 [INFO]  Epoch 154 loss: 202.3662657737732; train accuracy: 0.9286534926470589; test accuracy: 0.5269
2025-09-24 22:56:21 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:56:21 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:56:21 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:56:21 [INFO]  Epoch 150: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:57:03 [INFO]  Epoch 150 loss: 202.1213240623474; train accuracy: 0.9138997395833334; test accuracy: 0.5887
2025-09-24 22:57:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_150.pth
2025-09-24 22:57:04 [INFO]  Epoch 151: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:57:44 [INFO]  Epoch 151 loss: 214.83445501327515; train accuracy: 0.8973524305555556; test accuracy: 0.5292
2025-09-24 22:57:44 [INFO]  Epoch 152: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:58:25 [INFO]  Epoch 152 loss: 217.7315354347229; train accuracy: 0.93310546875; test accuracy: 0.5489
2025-09-24 22:58:25 [INFO]  Epoch 153: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:59:07 [INFO]  Epoch 153 loss: 214.4907865524292; train accuracy: 0.9307183159722222; test accuracy: 0.5607
2025-09-24 22:59:07 [INFO]  Epoch 154: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:59:48 [INFO]  Epoch 154 loss: 214.2544388771057; train accuracy: 0.95458984375; test accuracy: 0.6051
2025-09-24 22:59:48 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:59:48 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:59:48 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:59:48 [INFO]  Epoch 150: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:00:53 [INFO]  Epoch 150 loss: 303.4583034515381; train accuracy: 0.9586813038793104; test accuracy: 0.7084
2025-09-24 23:00:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_150.pth
2025-09-24 23:00:53 [INFO]  Epoch 151: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:01:58 [INFO]  Epoch 151 loss: 325.9696478843689; train accuracy: 0.959893588362069; test accuracy: 0.6953
2025-09-24 23:01:58 [INFO]  Epoch 152: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:03:02 [INFO]  Epoch 152 loss: 316.81975269317627; train accuracy: 0.9166554418103449; test accuracy: 0.6953
2025-09-24 23:03:02 [INFO]  Epoch 153: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:04:08 [INFO]  Epoch 153 loss: 325.76459312438965; train accuracy: 0.9053744612068966; test accuracy: 0.6573
2025-09-24 23:04:08 [INFO]  Epoch 154: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:05:11 [INFO]  Epoch 154 loss: 319.59840631484985; train accuracy: 0.9624191810344828; test accuracy: 0.7201
2025-09-24 23:05:11 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:05:11 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:05:11 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:05:11 [INFO]  Epoch 150: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:05:32 [INFO]  Epoch 150 loss: 98.56388998031616; train accuracy: 0.9658203125; test accuracy: 0.3132
2025-09-24 23:05:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_150.pth
2025-09-24 23:05:33 [INFO]  Epoch 151: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:05:52 [INFO]  Epoch 151 loss: 102.6287031173706; train accuracy: 0.9625244140625; test accuracy: 0.3276
2025-09-24 23:05:52 [INFO]  Epoch 152: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:06:12 [INFO]  Epoch 152 loss: 101.38167238235474; train accuracy: 0.96875; test accuracy: 0.3191
2025-09-24 23:06:12 [INFO]  Epoch 153: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:06:32 [INFO]  Epoch 153 loss: 102.53864908218384; train accuracy: 0.955810546875; test accuracy: 0.3122
2025-09-24 23:06:32 [INFO]  Epoch 154: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:06:53 [INFO]  Epoch 154 loss: 100.88892364501953; train accuracy: 0.87841796875; test accuracy: 0.3402
2025-09-24 23:06:53 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:06:53 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:06:53 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:06:53 [INFO]  Epoch 150: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:06:59 [INFO]  Epoch 150 loss: 20.758567333221436; train accuracy: 0.9654947916666666; test accuracy: 0.1066
2025-09-24 23:07:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_150.pth
2025-09-24 23:07:00 [INFO]  Epoch 151: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:07:06 [INFO]  Epoch 151 loss: 21.36346435546875; train accuracy: 0.9615885416666666; test accuracy: 0.1001
2025-09-24 23:07:06 [INFO]  Epoch 152: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:07:12 [INFO]  Epoch 152 loss: 21.46268129348755; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 23:07:12 [INFO]  Epoch 153: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:07:19 [INFO]  Epoch 153 loss: 21.559631824493408; train accuracy: 0.9622395833333334; test accuracy: 0.1004
2025-09-24 23:07:19 [INFO]  Epoch 154: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:07:25 [INFO]  Epoch 154 loss: 21.478177547454834; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 23:07:25 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:07:25 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:07:25 [INFO]  Round 30 Finish--------|
2025-09-24 23:07:25 [INFO]  Model variance: mean: 0.005843524821102619, sum: 65295.265625
2025-09-24 23:07:25 [INFO]  g_protos_std: 1.0081052780151367
2025-09-24 23:07:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8566
2025-09-24 23:07:34 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:07:34 [INFO]  Round 31 starts--------|
2025-09-24 23:07:34 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:07:34 [INFO]  Epoch 155: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:08:14 [INFO]  Epoch 155 loss: 188.6612639427185; train accuracy: 0.9302045036764706; test accuracy: 0.5202
2025-09-24 23:08:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_155.pth
2025-09-24 23:08:15 [INFO]  Epoch 156: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:08:54 [INFO]  Epoch 156 loss: 204.12864637374878; train accuracy: 0.9232536764705882; test accuracy: 0.5057
2025-09-24 23:08:54 [INFO]  Epoch 157: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:09:35 [INFO]  Epoch 157 loss: 208.08049297332764; train accuracy: 0.9361213235294118; test accuracy: 0.4955
2025-09-24 23:09:35 [INFO]  Epoch 158: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:10:15 [INFO]  Epoch 158 loss: 209.2072615623474; train accuracy: 0.9425551470588235; test accuracy: 0.5365
2025-09-24 23:10:15 [INFO]  Epoch 159: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:10:53 [INFO]  Epoch 159 loss: 208.1507978439331; train accuracy: 0.9166475183823529; test accuracy: 0.4894
2025-09-24 23:10:53 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:10:53 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:10:53 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:10:53 [INFO]  Epoch 155: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:11:35 [INFO]  Epoch 155 loss: 200.20197200775146; train accuracy: 0.9533962673611112; test accuracy: 0.6018
2025-09-24 23:11:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_155.pth
2025-09-24 23:11:35 [INFO]  Epoch 156: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:12:16 [INFO]  Epoch 156 loss: 210.10864543914795; train accuracy: 0.9098849826388888; test accuracy: 0.5818
2025-09-24 23:12:16 [INFO]  Epoch 157: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:12:57 [INFO]  Epoch 157 loss: 211.59727096557617; train accuracy: 0.9473741319444444; test accuracy: 0.6277
2025-09-24 23:12:57 [INFO]  Epoch 158: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:13:36 [INFO]  Epoch 158 loss: 213.14490938186646; train accuracy: 0.9085828993055556; test accuracy: 0.5789
2025-09-24 23:13:36 [INFO]  Epoch 159: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:14:17 [INFO]  Epoch 159 loss: 218.3988094329834; train accuracy: 0.9447699652777778; test accuracy: 0.5842
2025-09-24 23:14:17 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:14:17 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:14:17 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:14:17 [INFO]  Epoch 155: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:15:20 [INFO]  Epoch 155 loss: 302.6285367012024; train accuracy: 0.9597925646551724; test accuracy: 0.6696
2025-09-24 23:15:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_155.pth
2025-09-24 23:15:21 [INFO]  Epoch 156: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:16:26 [INFO]  Epoch 156 loss: 315.8450312614441; train accuracy: 0.9386112607758621; test accuracy: 0.7347
2025-09-24 23:16:26 [INFO]  Epoch 157: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:17:31 [INFO]  Epoch 157 loss: 323.0796585083008; train accuracy: 0.9479727909482759; test accuracy: 0.6938
2025-09-24 23:17:31 [INFO]  Epoch 158: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:18:34 [INFO]  Epoch 158 loss: 316.0368447303772; train accuracy: 0.9640018857758621; test accuracy: 0.7113
2025-09-24 23:18:34 [INFO]  Epoch 159: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:19:40 [INFO]  Epoch 159 loss: 315.2314143180847; train accuracy: 0.9643049568965517; test accuracy: 0.7131
2025-09-24 23:19:40 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:19:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:19:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:19:40 [INFO]  Epoch 155: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:20:00 [INFO]  Epoch 155 loss: 97.76890230178833; train accuracy: 0.9368896484375; test accuracy: 0.3158
2025-09-24 23:20:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_155.pth
2025-09-24 23:20:01 [INFO]  Epoch 156: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:20:20 [INFO]  Epoch 156 loss: 98.72032165527344; train accuracy: 0.97705078125; test accuracy: 0.3664
2025-09-24 23:20:20 [INFO]  Epoch 157: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:20:41 [INFO]  Epoch 157 loss: 100.98641157150269; train accuracy: 0.9595947265625; test accuracy: 0.3495
2025-09-24 23:20:41 [INFO]  Epoch 158: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:21:02 [INFO]  Epoch 158 loss: 100.31228923797607; train accuracy: 0.9581298828125; test accuracy: 0.317
2025-09-24 23:21:02 [INFO]  Epoch 159: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:21:22 [INFO]  Epoch 159 loss: 104.81597089767456; train accuracy: 0.9207763671875; test accuracy: 0.2759
2025-09-24 23:21:22 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:21:22 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:21:22 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:21:23 [INFO]  Epoch 155: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:21:29 [INFO]  Epoch 155 loss: 20.7369065284729; train accuracy: 0.9661458333333334; test accuracy: 0.1025
2025-09-24 23:21:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_155.pth
2025-09-24 23:21:29 [INFO]  Epoch 156: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:21:35 [INFO]  Epoch 156 loss: 21.51302671432495; train accuracy: 0.9622395833333334; test accuracy: 0.1061
2025-09-24 23:21:35 [INFO]  Epoch 157: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:21:42 [INFO]  Epoch 157 loss: 21.56814670562744; train accuracy: 0.96484375; test accuracy: 0.1082
2025-09-24 23:21:42 [INFO]  Epoch 158: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:21:48 [INFO]  Epoch 158 loss: 21.255260944366455; train accuracy: 0.962890625; test accuracy: 0.1158
2025-09-24 23:21:48 [INFO]  Epoch 159: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:21:55 [INFO]  Epoch 159 loss: 21.17197561264038; train accuracy: 0.9654947916666666; test accuracy: 0.1113
2025-09-24 23:21:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:21:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:21:55 [INFO]  Round 31 Finish--------|
2025-09-24 23:21:55 [INFO]  Model variance: mean: 0.005937272682785988, sum: 66342.796875
2025-09-24 23:21:55 [INFO]  g_protos_std: 1.0081777572631836
2025-09-24 23:22:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8503
2025-09-24 23:22:04 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:22:04 [INFO]  Round 32 starts--------|
2025-09-24 23:22:04 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:22:04 [INFO]  Epoch 160: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:22:45 [INFO]  Epoch 160 loss: 193.90140390396118; train accuracy: 0.8927504595588235; test accuracy: 0.5007
2025-09-24 23:22:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_160.pth
2025-09-24 23:22:45 [INFO]  Epoch 161: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:23:25 [INFO]  Epoch 161 loss: 204.90310907363892; train accuracy: 0.8930376838235294; test accuracy: 0.5059
2025-09-24 23:23:25 [INFO]  Epoch 162: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:24:04 [INFO]  Epoch 162 loss: 199.39076328277588; train accuracy: 0.9370978860294118; test accuracy: 0.4967
2025-09-24 23:24:04 [INFO]  Epoch 163: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:24:43 [INFO]  Epoch 163 loss: 203.16882848739624; train accuracy: 0.9421530330882353; test accuracy: 0.5022
2025-09-24 23:24:43 [INFO]  Epoch 164: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:25:22 [INFO]  Epoch 164 loss: 214.92041158676147; train accuracy: 0.9491613051470589; test accuracy: 0.5287
2025-09-24 23:25:22 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:25:22 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:25:22 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:25:22 [INFO]  Epoch 160: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:26:04 [INFO]  Epoch 160 loss: 203.17893743515015; train accuracy: 0.9259440104166666; test accuracy: 0.5522
2025-09-24 23:26:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_160.pth
2025-09-24 23:26:05 [INFO]  Epoch 161: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:26:48 [INFO]  Epoch 161 loss: 207.9828815460205; train accuracy: 0.9510091145833334; test accuracy: 0.5877
2025-09-24 23:26:48 [INFO]  Epoch 162: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:27:30 [INFO]  Epoch 162 loss: 210.01442623138428; train accuracy: 0.8937174479166666; test accuracy: 0.5331
2025-09-24 23:27:30 [INFO]  Epoch 163: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:28:11 [INFO]  Epoch 163 loss: 214.54556703567505; train accuracy: 0.9176432291666666; test accuracy: 0.5381
2025-09-24 23:28:11 [INFO]  Epoch 164: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:28:53 [INFO]  Epoch 164 loss: 211.41518020629883; train accuracy: 0.9319118923611112; test accuracy: 0.5708
2025-09-24 23:28:53 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:28:53 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:28:53 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:28:53 [INFO]  Epoch 160: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:30:00 [INFO]  Epoch 160 loss: 300.3887343406677; train accuracy: 0.9558526400862069; test accuracy: 0.6939
2025-09-24 23:30:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_160.pth
2025-09-24 23:30:01 [INFO]  Epoch 161: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:31:07 [INFO]  Epoch 161 loss: 315.7938714027405; train accuracy: 0.9548760775862069; test accuracy: 0.7194
2025-09-24 23:31:07 [INFO]  Epoch 162: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:32:12 [INFO]  Epoch 162 loss: 319.31793880462646; train accuracy: 0.9272966056034483; test accuracy: 0.7019
2025-09-24 23:32:12 [INFO]  Epoch 163: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:33:18 [INFO]  Epoch 163 loss: 320.6612596511841; train accuracy: 0.9310681573275862; test accuracy: 0.7465
2025-09-24 23:33:18 [INFO]  Epoch 164: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:34:24 [INFO]  Epoch 164 loss: 322.03646898269653; train accuracy: 0.9664601293103449; test accuracy: 0.713
2025-09-24 23:34:24 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:34:24 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:34:24 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:34:24 [INFO]  Epoch 160: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:34:44 [INFO]  Epoch 160 loss: 96.62468719482422; train accuracy: 0.929931640625; test accuracy: 0.3272
2025-09-24 23:34:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_160.pth
2025-09-24 23:34:45 [INFO]  Epoch 161: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:35:04 [INFO]  Epoch 161 loss: 100.82898759841919; train accuracy: 0.9769287109375; test accuracy: 0.3356
2025-09-24 23:35:04 [INFO]  Epoch 162: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:35:24 [INFO]  Epoch 162 loss: 103.53876113891602; train accuracy: 0.929443359375; test accuracy: 0.3146
2025-09-24 23:35:24 [INFO]  Epoch 163: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:35:44 [INFO]  Epoch 163 loss: 101.28399467468262; train accuracy: 0.94873046875; test accuracy: 0.3363
2025-09-24 23:35:44 [INFO]  Epoch 164: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:05 [INFO]  Epoch 164 loss: 103.52990388870239; train accuracy: 0.9486083984375; test accuracy: 0.2978
2025-09-24 23:36:05 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:36:05 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:36:05 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:36:05 [INFO]  Epoch 160: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:36:12 [INFO]  Epoch 160 loss: 20.78233575820923; train accuracy: 0.966796875; test accuracy: 0.1142
2025-09-24 23:36:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_160.pth
2025-09-24 23:36:13 [INFO]  Epoch 161: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:19 [INFO]  Epoch 161 loss: 21.17635488510132; train accuracy: 0.9635416666666666; test accuracy: 0.1041
2025-09-24 23:36:19 [INFO]  Epoch 162: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:25 [INFO]  Epoch 162 loss: 21.348143577575684; train accuracy: 0.9641927083333334; test accuracy: 0.1008
2025-09-24 23:36:25 [INFO]  Epoch 163: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:31 [INFO]  Epoch 163 loss: 21.469829559326172; train accuracy: 0.962890625; test accuracy: 0.1004
2025-09-24 23:36:31 [INFO]  Epoch 164: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:37 [INFO]  Epoch 164 loss: 21.576704025268555; train accuracy: 0.962890625; test accuracy: 0.1105
2025-09-24 23:36:37 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:36:37 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:36:37 [INFO]  Round 32 Finish--------|
2025-09-24 23:36:37 [INFO]  Model variance: mean: 0.006030522286891937, sum: 67384.765625
2025-09-24 23:36:37 [INFO]  g_protos_std: 1.0082471370697021
2025-09-24 23:36:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8581
2025-09-24 23:36:46 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:36:46 [INFO]  Round 33 starts--------|
2025-09-24 23:36:46 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:36:46 [INFO]  Epoch 165: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:37:23 [INFO]  Epoch 165 loss: 192.14125394821167; train accuracy: 0.8771829044117647; test accuracy: 0.4964
2025-09-24 23:37:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_165.pth
2025-09-24 23:37:23 [INFO]  Epoch 166: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:38:00 [INFO]  Epoch 166 loss: 208.73966121673584; train accuracy: 0.9276769301470589; test accuracy: 0.524
2025-09-24 23:38:00 [INFO]  Epoch 167: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:38:37 [INFO]  Epoch 167 loss: 198.73850917816162; train accuracy: 0.884765625; test accuracy: 0.5107
2025-09-24 23:38:37 [INFO]  Epoch 168: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:39:12 [INFO]  Epoch 168 loss: 205.9288969039917; train accuracy: 0.8926355698529411; test accuracy: 0.5044
2025-09-24 23:39:12 [INFO]  Epoch 169: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:39:49 [INFO]  Epoch 169 loss: 209.53598833084106; train accuracy: 0.9194623161764706; test accuracy: 0.5263
2025-09-24 23:39:49 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:39:49 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:39:49 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:39:49 [INFO]  Epoch 165: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:40:27 [INFO]  Epoch 165 loss: 201.44803714752197; train accuracy: 0.9410807291666666; test accuracy: 0.5922
2025-09-24 23:40:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_165.pth
2025-09-24 23:40:27 [INFO]  Epoch 166: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:41:06 [INFO]  Epoch 166 loss: 213.05968141555786; train accuracy: 0.9205729166666666; test accuracy: 0.5685
2025-09-24 23:41:06 [INFO]  Epoch 167: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:41:46 [INFO]  Epoch 167 loss: 214.74375915527344; train accuracy: 0.8995225694444444; test accuracy: 0.5721
2025-09-24 23:41:46 [INFO]  Epoch 168: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:42:28 [INFO]  Epoch 168 loss: 209.36606168746948; train accuracy: 0.892578125; test accuracy: 0.5531
2025-09-24 23:42:28 [INFO]  Epoch 169: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:43:10 [INFO]  Epoch 169 loss: 207.76791667938232; train accuracy: 0.9495985243055556; test accuracy: 0.5797
2025-09-24 23:43:10 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:43:10 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:43:10 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:43:10 [INFO]  Epoch 165: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:44:15 [INFO]  Epoch 165 loss: 301.2755970954895; train accuracy: 0.9476023706896551; test accuracy: 0.7073
2025-09-24 23:44:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_165.pth
2025-09-24 23:44:16 [INFO]  Epoch 166: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:45:19 [INFO]  Epoch 166 loss: 316.45547676086426; train accuracy: 0.9607354525862069; test accuracy: 0.7032
2025-09-24 23:45:19 [INFO]  Epoch 167: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:46:24 [INFO]  Epoch 167 loss: 318.5874037742615; train accuracy: 0.9647090517241379; test accuracy: 0.7097
2025-09-24 23:46:24 [INFO]  Epoch 168: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:47:30 [INFO]  Epoch 168 loss: 319.2580375671387; train accuracy: 0.9679418103448276; test accuracy: 0.7193
2025-09-24 23:47:30 [INFO]  Epoch 169: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:48:36 [INFO]  Epoch 169 loss: 321.1369891166687; train accuracy: 0.9477707435344828; test accuracy: 0.7237
2025-09-24 23:48:36 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:48:36 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:48:36 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:48:36 [INFO]  Epoch 165: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:48:56 [INFO]  Epoch 165 loss: 98.8093433380127; train accuracy: 0.9642333984375; test accuracy: 0.3135
2025-09-24 23:48:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_165.pth
2025-09-24 23:48:56 [INFO]  Epoch 166: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:49:16 [INFO]  Epoch 166 loss: 100.58389711380005; train accuracy: 0.9478759765625; test accuracy: 0.3298
2025-09-24 23:49:16 [INFO]  Epoch 167: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:49:37 [INFO]  Epoch 167 loss: 101.1209545135498; train accuracy: 0.958984375; test accuracy: 0.3318
2025-09-24 23:49:37 [INFO]  Epoch 168: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:49:57 [INFO]  Epoch 168 loss: 104.50149011611938; train accuracy: 0.978515625; test accuracy: 0.3412
2025-09-24 23:49:57 [INFO]  Epoch 169: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:50:17 [INFO]  Epoch 169 loss: 102.01749229431152; train accuracy: 0.943603515625; test accuracy: 0.3509
2025-09-24 23:50:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:50:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:50:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:50:17 [INFO]  Epoch 165: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:50:23 [INFO]  Epoch 165 loss: 20.77689218521118; train accuracy: 0.9654947916666666; test accuracy: 0.1038
2025-09-24 23:50:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_165.pth
2025-09-24 23:50:24 [INFO]  Epoch 166: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:50:31 [INFO]  Epoch 166 loss: 21.455520153045654; train accuracy: 0.962890625; test accuracy: 0.1007
2025-09-24 23:50:31 [INFO]  Epoch 167: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:50:38 [INFO]  Epoch 167 loss: 21.411179542541504; train accuracy: 0.966796875; test accuracy: 0.1029
2025-09-24 23:50:38 [INFO]  Epoch 168: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:50:44 [INFO]  Epoch 168 loss: 21.358123302459717; train accuracy: 0.9641927083333334; test accuracy: 0.1032
2025-09-24 23:50:44 [INFO]  Epoch 169: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:50:50 [INFO]  Epoch 169 loss: 21.312781810760498; train accuracy: 0.9641927083333334; test accuracy: 0.101
2025-09-24 23:50:50 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:50:50 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:50:50 [INFO]  Round 33 Finish--------|
2025-09-24 23:50:50 [INFO]  Model variance: mean: 0.006120725069195032, sum: 68392.6875
2025-09-24 23:50:50 [INFO]  g_protos_std: 1.0083175897598267
2025-09-24 23:50:59 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8546
2025-09-24 23:50:59 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:50:59 [INFO]  Round 34 starts--------|
2025-09-24 23:50:59 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:50:59 [INFO]  Epoch 170: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:51:38 [INFO]  Epoch 170 loss: 190.96636247634888; train accuracy: 0.9458295036764706; test accuracy: 0.5134
2025-09-24 23:51:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_170.pth
2025-09-24 23:51:39 [INFO]  Epoch 171: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:52:18 [INFO]  Epoch 171 loss: 204.8817844390869; train accuracy: 0.8917738970588235; test accuracy: 0.5047
2025-09-24 23:52:18 [INFO]  Epoch 172: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:52:56 [INFO]  Epoch 172 loss: 213.7027907371521; train accuracy: 0.9345128676470589; test accuracy: 0.5098
2025-09-24 23:52:56 [INFO]  Epoch 173: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:53:34 [INFO]  Epoch 173 loss: 204.72490310668945; train accuracy: 0.9483570772058824; test accuracy: 0.528
2025-09-24 23:53:34 [INFO]  Epoch 174: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:54:15 [INFO]  Epoch 174 loss: 207.60552835464478; train accuracy: 0.9157858455882353; test accuracy: 0.5317
2025-09-24 23:54:15 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:54:15 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:54:15 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:54:15 [INFO]  Epoch 170: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:54:56 [INFO]  Epoch 170 loss: 202.47897100448608; train accuracy: 0.9328342013888888; test accuracy: 0.548
2025-09-24 23:54:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_170.pth
2025-09-24 23:54:57 [INFO]  Epoch 171: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:55:37 [INFO]  Epoch 171 loss: 223.65272521972656; train accuracy: 0.9398871527777778; test accuracy: 0.5997
2025-09-24 23:55:37 [INFO]  Epoch 172: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:56:16 [INFO]  Epoch 172 loss: 210.0302119255066; train accuracy: 0.9609375; test accuracy: 0.5865
2025-09-24 23:56:16 [INFO]  Epoch 173: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:56:56 [INFO]  Epoch 173 loss: 219.7780041694641; train accuracy: 0.8866644965277778; test accuracy: 0.5446
2025-09-24 23:56:56 [INFO]  Epoch 174: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:57:37 [INFO]  Epoch 174 loss: 217.60876846313477; train accuracy: 0.9015842013888888; test accuracy: 0.5203
2025-09-24 23:57:37 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:57:37 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:57:37 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:57:37 [INFO]  Epoch 170: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:58:41 [INFO]  Epoch 170 loss: 302.24596214294434; train accuracy: 0.9571322737068966; test accuracy: 0.7145
2025-09-24 23:58:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_170.pth
2025-09-24 23:58:41 [INFO]  Epoch 171: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:59:44 [INFO]  Epoch 171 loss: 319.1373453140259; train accuracy: 0.9636988146551724; test accuracy: 0.7045
2025-09-24 23:59:44 [INFO]  Epoch 172: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:00:47 [INFO]  Epoch 172 loss: 321.59486198425293; train accuracy: 0.9596578663793104; test accuracy: 0.7021
2025-09-25 00:00:47 [INFO]  Epoch 173: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:01:50 [INFO]  Epoch 173 loss: 321.9948515892029; train accuracy: 0.9330212823275862; test accuracy: 0.6937
2025-09-25 00:01:50 [INFO]  Epoch 174: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:02:53 [INFO]  Epoch 174 loss: 318.473237991333; train accuracy: 0.9414399245689655; test accuracy: 0.69
2025-09-25 00:02:53 [INFO]  Client 2 Finish Local Training--------|
2025-09-25 00:02:53 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-25 00:02:53 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-25 00:02:53 [INFO]  Epoch 170: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:03:13 [INFO]  Epoch 170 loss: 97.73906564712524; train accuracy: 0.9783935546875; test accuracy: 0.3535
2025-09-25 00:03:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_170.pth
2025-09-25 00:03:14 [INFO]  Epoch 171: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:03:32 [INFO]  Epoch 171 loss: 99.92070960998535; train accuracy: 0.951416015625; test accuracy: 0.3262
2025-09-25 00:03:32 [INFO]  Epoch 172: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:03:52 [INFO]  Epoch 172 loss: 100.36297464370728; train accuracy: 0.95458984375; test accuracy: 0.3258
2025-09-25 00:03:52 [INFO]  Epoch 173: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:04:12 [INFO]  Epoch 173 loss: 101.495041847229; train accuracy: 0.938720703125; test accuracy: 0.3219
2025-09-25 00:04:12 [INFO]  Epoch 174: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:04:32 [INFO]  Epoch 174 loss: 101.86030054092407; train accuracy: 0.9544677734375; test accuracy: 0.3009
2025-09-25 00:04:32 [INFO]  Client 3 Finish Local Training--------|
2025-09-25 00:04:32 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-25 00:04:32 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-25 00:04:32 [INFO]  Epoch 170: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:04:38 [INFO]  Epoch 170 loss: 20.804187297821045; train accuracy: 0.9674479166666666; test accuracy: 0.1026
2025-09-25 00:04:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_170.pth
2025-09-25 00:04:39 [INFO]  Epoch 171: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:04:45 [INFO]  Epoch 171 loss: 21.359774589538574; train accuracy: 0.9602864583333334; test accuracy: 0.1002
2025-09-25 00:04:45 [INFO]  Epoch 172: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:04:51 [INFO]  Epoch 172 loss: 21.330442428588867; train accuracy: 0.962890625; test accuracy: 0.1002
2025-09-25 00:04:51 [INFO]  Epoch 173: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:04:56 [INFO]  Epoch 173 loss: 21.117321014404297; train accuracy: 0.96875; test accuracy: 0.1021
2025-09-25 00:04:56 [INFO]  Epoch 174: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:05:03 [INFO]  Epoch 174 loss: 21.463186740875244; train accuracy: 0.9654947916666666; test accuracy: 0.1097
2025-09-25 00:05:03 [INFO]  Client 4 Finish Local Training--------|
2025-09-25 00:05:03 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-25 00:05:03 [INFO]  Round 34 Finish--------|
2025-09-25 00:05:03 [INFO]  Model variance: mean: 0.006210042629390955, sum: 69390.71875
2025-09-25 00:05:03 [INFO]  g_protos_std: 1.0083831548690796
2025-09-25 00:05:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8559
2025-09-25 00:05:11 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-25 00:05:11 [INFO]  Round 35 starts--------|
2025-09-25 00:05:11 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-25 00:05:11 [INFO]  Epoch 175: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:05:50 [INFO]  Epoch 175 loss: 191.18418884277344; train accuracy: 0.9149241727941176; test accuracy: 0.5193
2025-09-25 00:05:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_175.pth
2025-09-25 00:05:51 [INFO]  Epoch 176: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:06:27 [INFO]  Epoch 176 loss: 205.56410551071167; train accuracy: 0.8973460477941176; test accuracy: 0.4596
2025-09-25 00:06:27 [INFO]  Epoch 177: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:07:09 [INFO]  Epoch 177 loss: 200.4273009300232; train accuracy: 0.9115349264705882; test accuracy: 0.5275
2025-09-25 00:07:09 [INFO]  Epoch 178: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:07:49 [INFO]  Epoch 178 loss: 208.07159805297852; train accuracy: 0.9352022058823529; test accuracy: 0.5224
2025-09-25 00:07:49 [INFO]  Epoch 179: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:08:28 [INFO]  Epoch 179 loss: 206.5630669593811; train accuracy: 0.9113051470588235; test accuracy: 0.4892
2025-09-25 00:08:28 [INFO]  Client 0 Finish Local Training--------|
2025-09-25 00:08:28 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-25 00:08:28 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-25 00:08:28 [INFO]  Epoch 175: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:09:12 [INFO]  Epoch 175 loss: 203.49777936935425; train accuracy: 0.9406467013888888; test accuracy: 0.5328
2025-09-25 00:09:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_175.pth
2025-09-25 00:09:12 [INFO]  Epoch 176: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:09:54 [INFO]  Epoch 176 loss: 214.14110279083252; train accuracy: 0.9308268229166666; test accuracy: 0.5823
2025-09-25 00:09:54 [INFO]  Epoch 177: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:10:36 [INFO]  Epoch 177 loss: 214.46578884124756; train accuracy: 0.93310546875; test accuracy: 0.595
2025-09-25 00:10:36 [INFO]  Epoch 178: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:11:17 [INFO]  Epoch 178 loss: 211.28265810012817; train accuracy: 0.9181857638888888; test accuracy: 0.566
2025-09-25 00:11:17 [INFO]  Epoch 179: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:11:59 [INFO]  Epoch 179 loss: 210.4980502128601; train accuracy: 0.9406467013888888; test accuracy: 0.5542
2025-09-25 00:11:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-25 00:11:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-25 00:11:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-25 00:11:59 [INFO]  Epoch 175: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:13:03 [INFO]  Epoch 175 loss: 303.03776264190674; train accuracy: 0.9376683728448276; test accuracy: 0.6677
2025-09-25 00:13:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_175.pth
2025-09-25 00:13:03 [INFO]  Epoch 176: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:14:08 [INFO]  Epoch 176 loss: 316.0244951248169; train accuracy: 0.9470972521551724; test accuracy: 0.7105
2025-09-25 00:14:08 [INFO]  Epoch 177: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:15:13 [INFO]  Epoch 177 loss: 323.62510919570923; train accuracy: 0.9593547952586207; test accuracy: 0.7348
2025-09-25 00:15:13 [INFO]  Epoch 178: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:16:16 [INFO]  Epoch 178 loss: 319.7545747756958; train accuracy: 0.961004849137931; test accuracy: 0.7099
2025-09-25 00:16:16 [INFO]  Epoch 179: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:17:20 [INFO]  Epoch 179 loss: 321.3994917869568; train accuracy: 0.9387122844827587; test accuracy: 0.683
2025-09-25 00:17:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-25 00:17:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-25 00:17:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-25 00:17:20 [INFO]  Epoch 175: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:17:42 [INFO]  Epoch 175 loss: 96.93653917312622; train accuracy: 0.9552001953125; test accuracy: 0.327
2025-09-25 00:17:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_175.pth
2025-09-25 00:17:42 [INFO]  Epoch 176: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:18:02 [INFO]  Epoch 176 loss: 99.9030327796936; train accuracy: 0.9674072265625; test accuracy: 0.2906
2025-09-25 00:18:02 [INFO]  Epoch 177: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:18:21 [INFO]  Epoch 177 loss: 102.01714038848877; train accuracy: 0.9415283203125; test accuracy: 0.3417
2025-09-25 00:18:21 [INFO]  Epoch 178: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:18:41 [INFO]  Epoch 178 loss: 104.63114547729492; train accuracy: 0.96728515625; test accuracy: 0.328
2025-09-25 00:18:41 [INFO]  Epoch 179: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:19:00 [INFO]  Epoch 179 loss: 101.8186526298523; train accuracy: 0.966064453125; test accuracy: 0.329
2025-09-25 00:19:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-25 00:19:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-25 00:19:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-25 00:19:00 [INFO]  Epoch 175: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:19:07 [INFO]  Epoch 175 loss: 20.76341438293457; train accuracy: 0.9622395833333334; test accuracy: 0.1091
2025-09-25 00:19:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_175.pth
2025-09-25 00:19:07 [INFO]  Epoch 176: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:19:14 [INFO]  Epoch 176 loss: 21.299051761627197; train accuracy: 0.96875; test accuracy: 0.1001
2025-09-25 00:19:14 [INFO]  Epoch 177: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:19:20 [INFO]  Epoch 177 loss: 21.22110939025879; train accuracy: 0.9615885416666666; test accuracy: 0.1001
2025-09-25 00:19:20 [INFO]  Epoch 178: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:19:26 [INFO]  Epoch 178 loss: 21.34890079498291; train accuracy: 0.96484375; test accuracy: 0.1012
2025-09-25 00:19:26 [INFO]  Epoch 179: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:19:33 [INFO]  Epoch 179 loss: 21.246939659118652; train accuracy: 0.9635416666666666; test accuracy: 0.116
2025-09-25 00:19:33 [INFO]  Client 4 Finish Local Training--------|
2025-09-25 00:19:33 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-25 00:19:33 [INFO]  Round 35 Finish--------|
2025-09-25 00:19:33 [INFO]  Model variance: mean: 0.006296892184764147, sum: 70361.171875
2025-09-25 00:19:33 [INFO]  g_protos_std: 1.008449912071228
2025-09-25 00:19:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8592
2025-09-25 00:19:42 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-25 00:19:42 [INFO]  Round 36 starts--------|
2025-09-25 00:19:42 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-25 00:19:42 [INFO]  Epoch 180: Running in Stage 1 - Global Alignment Only.
