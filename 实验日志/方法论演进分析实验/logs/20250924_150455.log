2025-09-24 15:04:56 [INFO]  Load config from ./configs/CIFAR10_alpha0.5.yaml
2025-09-24 15:04:56 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.5', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.5}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:58 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:58 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:59 [INFO]  OneshotOurs
2025-09-24 15:04:59 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 15:04:59 [INFO]  Round 0 starts--------|
2025-09-24 15:04:59 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:09 [INFO]  generating sample per sample
2025-09-24 15:05:09 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:16 [INFO]  Epoch 0 loss: 746.712739944458; train accuracy: 0.21119225543478262; test accuracy: 0.2129
2025-09-24 15:06:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_0.pth
2025-09-24 15:06:17 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:23 [INFO]  Epoch 1 loss: 691.2767810821533; train accuracy: 0.2630208333333333; test accuracy: 0.2653
2025-09-24 15:07:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:29 [INFO]  Epoch 2 loss: 668.6093645095825; train accuracy: 0.2591428894927536; test accuracy: 0.259
2025-09-24 15:08:29 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:36 [INFO]  Epoch 3 loss: 646.4749546051025; train accuracy: 0.3233695652173913; test accuracy: 0.3232
2025-09-24 15:09:36 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:40 [INFO]  Epoch 4 loss: 619.2393426895142; train accuracy: 0.41697803442028986; test accuracy: 0.413
2025-09-24 15:10:40 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:10:40 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:10:40 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:10:46 [INFO]  generating sample per sample
2025-09-24 15:10:46 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:34 [INFO]  Epoch 0 loss: 611.538836479187; train accuracy: 0.13124302455357142; test accuracy: 0.1331
2025-09-24 15:11:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_0.pth
2025-09-24 15:11:34 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:22 [INFO]  Epoch 1 loss: 568.3001775741577; train accuracy: 0.236083984375; test accuracy: 0.2414
2025-09-24 15:12:22 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:15 [INFO]  Epoch 2 loss: 554.7224426269531; train accuracy: 0.2650669642857143; test accuracy: 0.2671
2025-09-24 15:13:15 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:08 [INFO]  Epoch 3 loss: 536.4905757904053; train accuracy: 0.31581333705357145; test accuracy: 0.3204
2025-09-24 15:14:08 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:58 [INFO]  Epoch 4 loss: 515.1746044158936; train accuracy: 0.36973353794642855; test accuracy: 0.3678
2025-09-24 15:14:58 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:14:58 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:14:58 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:15:06 [INFO]  generating sample per sample
2025-09-24 15:15:06 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:55 [INFO]  Epoch 0 loss: 571.5081071853638; train accuracy: 0.220703125; test accuracy: 0.2285
2025-09-24 15:15:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_0.pth
2025-09-24 15:15:56 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:43 [INFO]  Epoch 1 loss: 528.7372741699219; train accuracy: 0.19966947115384615; test accuracy: 0.1976
2025-09-24 15:16:43 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:32 [INFO]  Epoch 2 loss: 511.5413236618042; train accuracy: 0.21484375; test accuracy: 0.2168
2025-09-24 15:17:32 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:23 [INFO]  Epoch 3 loss: 495.7805299758911; train accuracy: 0.33736478365384615; test accuracy: 0.3371
2025-09-24 15:18:23 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:14 [INFO]  Epoch 4 loss: 476.6891899108887; train accuracy: 0.3621168870192308; test accuracy: 0.3639
2025-09-24 15:19:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:19:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:19:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:19:24 [INFO]  generating sample per sample
2025-09-24 15:19:24 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:23 [INFO]  Epoch 0 loss: 694.5190877914429; train accuracy: 0.175445556640625; test accuracy: 0.175
2025-09-24 15:20:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_0.pth
2025-09-24 15:20:23 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:20 [INFO]  Epoch 1 loss: 649.3918313980103; train accuracy: 0.228424072265625; test accuracy: 0.2328
2025-09-24 15:21:20 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:16 [INFO]  Epoch 2 loss: 618.0324563980103; train accuracy: 0.29742431640625; test accuracy: 0.298
2025-09-24 15:22:16 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:15 [INFO]  Epoch 3 loss: 603.6190004348755; train accuracy: 0.264984130859375; test accuracy: 0.2683
2025-09-24 15:23:15 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:14 [INFO]  Epoch 4 loss: 579.7247457504272; train accuracy: 0.321624755859375; test accuracy: 0.3196
2025-09-24 15:24:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:24:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:24:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:24:19 [INFO]  generating sample per sample
2025-09-24 15:24:19 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:52 [INFO]  Epoch 0 loss: 391.6456871032715; train accuracy: 0.14012276785714287; test accuracy: 0.1362
2025-09-24 15:24:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_0.pth
2025-09-24 15:24:52 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:24 [INFO]  Epoch 1 loss: 367.4617681503296; train accuracy: 0.11981026785714285; test accuracy: 0.1249
2025-09-24 15:25:24 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:57 [INFO]  Epoch 2 loss: 355.32350158691406; train accuracy: 0.2502232142857143; test accuracy: 0.2503
2025-09-24 15:25:57 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:30 [INFO]  Epoch 3 loss: 349.92152404785156; train accuracy: 0.32572544642857143; test accuracy: 0.3253
2025-09-24 15:26:30 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:03 [INFO]  Epoch 4 loss: 337.2259922027588; train accuracy: 0.2947544642857143; test accuracy: 0.2933
2025-09-24 15:27:03 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:27:03 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:27:03 [INFO]  Round 0 Finish--------|
2025-09-24 15:27:03 [INFO]  Model variance: mean: 0.0014517024392262101, sum: 16221.2529296875
2025-09-24 15:27:03 [INFO]  g_protos_std: 1.0057899951934814
2025-09-24 15:27:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6723
2025-09-24 15:27:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:27:09 [INFO]  Round 1 starts--------|
2025-09-24 15:27:09 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:27:09 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:13 [INFO]  Epoch 5 loss: 600.9919843673706; train accuracy: 0.434867527173913; test accuracy: 0.4291
2025-09-24 15:28:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_5.pth
2025-09-24 15:28:14 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:10 [INFO]  Epoch 6 loss: 576.4696416854858; train accuracy: 0.5428272192028986; test accuracy: 0.5396
2025-09-24 15:29:10 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:11 [INFO]  Epoch 7 loss: 577.5913944244385; train accuracy: 0.5609997735507246; test accuracy: 0.5536
2025-09-24 15:30:11 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:09 [INFO]  Epoch 8 loss: 565.175274848938; train accuracy: 0.5853996829710145; test accuracy: 0.5724
2025-09-24 15:31:09 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:16 [INFO]  Epoch 9 loss: 547.9436411857605; train accuracy: 0.6672044836956522; test accuracy: 0.6588
2025-09-24 15:32:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:32:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:32:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:32:16 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:07 [INFO]  Epoch 5 loss: 501.80119705200195; train accuracy: 0.5469796316964286; test accuracy: 0.548
2025-09-24 15:33:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_5.pth
2025-09-24 15:33:08 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:01 [INFO]  Epoch 6 loss: 489.59813499450684; train accuracy: 0.45326450892857145; test accuracy: 0.4527
2025-09-24 15:34:01 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:51 [INFO]  Epoch 7 loss: 481.2495446205139; train accuracy: 0.5487234933035714; test accuracy: 0.5477
2025-09-24 15:34:51 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:44 [INFO]  Epoch 8 loss: 462.69037103652954; train accuracy: 0.5326102120535714; test accuracy: 0.5346
2025-09-24 15:35:44 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:39 [INFO]  Epoch 9 loss: 465.09892988204956; train accuracy: 0.5827287946428571; test accuracy: 0.58
2025-09-24 15:36:39 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:36:39 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:36:39 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:36:39 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:27 [INFO]  Epoch 5 loss: 470.91007804870605; train accuracy: 0.43787560096153844; test accuracy: 0.4339
2025-09-24 15:37:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_5.pth
2025-09-24 15:37:27 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:18 [INFO]  Epoch 6 loss: 462.3457975387573; train accuracy: 0.42769681490384615; test accuracy: 0.425
2025-09-24 15:38:18 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:06 [INFO]  Epoch 7 loss: 449.38240242004395; train accuracy: 0.44681490384615385; test accuracy: 0.4452
2025-09-24 15:39:06 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:55 [INFO]  Epoch 8 loss: 436.96748971939087; train accuracy: 0.4708909254807692; test accuracy: 0.4673
2025-09-24 15:39:55 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:44 [INFO]  Epoch 9 loss: 432.9274797439575; train accuracy: 0.5678335336538461; test accuracy: 0.5622
2025-09-24 15:40:44 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:40:44 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:40:44 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:40:44 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:46 [INFO]  Epoch 5 loss: 567.8930263519287; train accuracy: 0.4764404296875; test accuracy: 0.4732
2025-09-24 15:41:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_5.pth
2025-09-24 15:41:46 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:46 [INFO]  Epoch 6 loss: 555.7796568870544; train accuracy: 0.404510498046875; test accuracy: 0.407
2025-09-24 15:42:46 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:46 [INFO]  Epoch 7 loss: 536.7308783531189; train accuracy: 0.54339599609375; test accuracy: 0.5408
2025-09-24 15:43:46 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:47 [INFO]  Epoch 8 loss: 521.8196821212769; train accuracy: 0.631072998046875; test accuracy: 0.6217
2025-09-24 15:44:47 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:46 [INFO]  Epoch 9 loss: 518.2229323387146; train accuracy: 0.61663818359375; test accuracy: 0.6084
2025-09-24 15:45:46 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:45:46 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:45:46 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:45:46 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:20 [INFO]  Epoch 5 loss: 328.6106939315796; train accuracy: 0.26266741071428573; test accuracy: 0.259
2025-09-24 15:46:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_5.pth
2025-09-24 15:46:21 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:55 [INFO]  Epoch 6 loss: 334.1690511703491; train accuracy: 0.31478794642857144; test accuracy: 0.3136
2025-09-24 15:46:55 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:30 [INFO]  Epoch 7 loss: 327.7681465148926; train accuracy: 0.36685267857142856; test accuracy: 0.3713
2025-09-24 15:47:30 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:02 [INFO]  Epoch 8 loss: 316.95659160614014; train accuracy: 0.42276785714285714; test accuracy: 0.4244
2025-09-24 15:48:02 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:36 [INFO]  Epoch 9 loss: 311.6248083114624; train accuracy: 0.42081473214285714; test accuracy: 0.416
2025-09-24 15:48:36 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:48:36 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:48:36 [INFO]  Round 1 Finish--------|
2025-09-24 15:48:36 [INFO]  Model variance: mean: 0.0022066207602620125, sum: 24656.673828125
2025-09-24 15:48:36 [INFO]  g_protos_std: 1.0057586431503296
2025-09-24 15:48:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.767
2025-09-24 15:48:42 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:48:42 [INFO]  Round 2 starts--------|
2025-09-24 15:48:42 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:48:42 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:48 [INFO]  Epoch 10 loss: 540.5908365249634; train accuracy: 0.6204427083333334; test accuracy: 0.6079
2025-09-24 15:49:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_10.pth
2025-09-24 15:49:48 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:53 [INFO]  Epoch 11 loss: 539.7578959465027; train accuracy: 0.6601845561594203; test accuracy: 0.648
2025-09-24 15:50:53 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:57 [INFO]  Epoch 12 loss: 524.3948521614075; train accuracy: 0.6701766304347826; test accuracy: 0.6516
2025-09-24 15:51:57 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:00 [INFO]  Epoch 13 loss: 519.8165621757507; train accuracy: 0.6939821105072463; test accuracy: 0.6759
2025-09-24 15:53:00 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:01 [INFO]  Epoch 14 loss: 515.5532269477844; train accuracy: 0.685546875; test accuracy: 0.6706
2025-09-24 15:54:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:54:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:54:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:54:01 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:55 [INFO]  Epoch 10 loss: 449.99702978134155; train accuracy: 0.6430315290178571; test accuracy: 0.628
2025-09-24 15:54:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_10.pth
2025-09-24 15:54:55 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:47 [INFO]  Epoch 11 loss: 449.7536516189575; train accuracy: 0.6209542410714286; test accuracy: 0.6058
2025-09-24 15:55:47 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:37 [INFO]  Epoch 12 loss: 448.0439910888672; train accuracy: 0.609619140625; test accuracy: 0.5977
2025-09-24 15:56:37 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:29 [INFO]  Epoch 13 loss: 441.12576484680176; train accuracy: 0.6250697544642857; test accuracy: 0.605
2025-09-24 15:57:29 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:21 [INFO]  Epoch 14 loss: 437.95510721206665; train accuracy: 0.6285574776785714; test accuracy: 0.6145
2025-09-24 15:58:21 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:58:21 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:58:21 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:58:21 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:10 [INFO]  Epoch 10 loss: 422.5499029159546; train accuracy: 0.5474759615384616; test accuracy: 0.5335
2025-09-24 15:59:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_10.pth
2025-09-24 15:59:11 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:57 [INFO]  Epoch 11 loss: 420.33325576782227; train accuracy: 0.5985576923076923; test accuracy: 0.591
2025-09-24 15:59:57 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:43 [INFO]  Epoch 12 loss: 417.06572437286377; train accuracy: 0.6304462139423077; test accuracy: 0.6153
2025-09-24 16:00:43 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:33 [INFO]  Epoch 13 loss: 412.6916732788086; train accuracy: 0.6078725961538461; test accuracy: 0.5993
2025-09-24 16:01:33 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:22 [INFO]  Epoch 14 loss: 415.27723503112793; train accuracy: 0.5062349759615384; test accuracy: 0.4988
2025-09-24 16:02:22 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:02:22 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:02:22 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:02:22 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:19 [INFO]  Epoch 10 loss: 507.67379999160767; train accuracy: 0.649139404296875; test accuracy: 0.631
2025-09-24 16:03:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_10.pth
2025-09-24 16:03:20 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:17 [INFO]  Epoch 11 loss: 506.1054644584656; train accuracy: 0.666473388671875; test accuracy: 0.6515
2025-09-24 16:04:17 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:16 [INFO]  Epoch 12 loss: 498.6717281341553; train accuracy: 0.704986572265625; test accuracy: 0.6885
2025-09-24 16:05:16 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:14 [INFO]  Epoch 13 loss: 485.1875476837158; train accuracy: 0.651885986328125; test accuracy: 0.6406
2025-09-24 16:06:14 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:08 [INFO]  Epoch 14 loss: 488.88094425201416; train accuracy: 0.675811767578125; test accuracy: 0.6604
2025-09-24 16:07:08 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:07:08 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:07:08 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:07:08 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:41 [INFO]  Epoch 10 loss: 303.54629135131836; train accuracy: 0.48197544642857143; test accuracy: 0.4762
2025-09-24 16:07:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_10.pth
2025-09-24 16:07:42 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:15 [INFO]  Epoch 11 loss: 303.01525592803955; train accuracy: 0.521484375; test accuracy: 0.5212
2025-09-24 16:08:15 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:48 [INFO]  Epoch 12 loss: 294.66556215286255; train accuracy: 0.46729910714285716; test accuracy: 0.4655
2025-09-24 16:08:48 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:20 [INFO]  Epoch 13 loss: 296.22150802612305; train accuracy: 0.5563616071428571; test accuracy: 0.5445
2025-09-24 16:09:20 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:51 [INFO]  Epoch 14 loss: 289.8771004676819; train accuracy: 0.5808035714285714; test accuracy: 0.5689
2025-09-24 16:09:51 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:09:51 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:09:51 [INFO]  Round 2 Finish--------|
2025-09-24 16:09:51 [INFO]  Model variance: mean: 0.0028123201336711645, sum: 31424.73046875
2025-09-24 16:09:51 [INFO]  g_protos_std: 1.0057390928268433
2025-09-24 16:09:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8113
2025-09-24 16:09:57 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:09:57 [INFO]  Round 3 starts--------|
2025-09-24 16:09:57 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:09:57 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:56 [INFO]  Epoch 15 loss: 511.46937465667725; train accuracy: 0.634369338768116; test accuracy: 0.6188
2025-09-24 16:10:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_15.pth
2025-09-24 16:10:56 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:54 [INFO]  Epoch 16 loss: 503.0943102836609; train accuracy: 0.6528532608695652; test accuracy: 0.6294
2025-09-24 16:11:54 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:54 [INFO]  Epoch 17 loss: 496.65883588790894; train accuracy: 0.6915760869565217; test accuracy: 0.6671
2025-09-24 16:12:54 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:52 [INFO]  Epoch 18 loss: 496.48202657699585; train accuracy: 0.7353940217391305; test accuracy: 0.7064
2025-09-24 16:13:52 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:14:52 [INFO]  Epoch 19 loss: 493.86753273010254; train accuracy: 0.7484997735507246; test accuracy: 0.7206
2025-09-24 16:14:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:14:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:14:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:14:52 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:40 [INFO]  Epoch 15 loss: 431.0278286933899; train accuracy: 0.6736537388392857; test accuracy: 0.6539
2025-09-24 16:15:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_15.pth
2025-09-24 16:15:41 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:30 [INFO]  Epoch 16 loss: 418.9141893386841; train accuracy: 0.6688058035714286; test accuracy: 0.6565
2025-09-24 16:16:30 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:20 [INFO]  Epoch 17 loss: 424.0489468574524; train accuracy: 0.6856863839285714; test accuracy: 0.661
2025-09-24 16:17:20 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:08 [INFO]  Epoch 18 loss: 424.2791323661804; train accuracy: 0.6907087053571429; test accuracy: 0.6713
2025-09-24 16:18:08 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:59 [INFO]  Epoch 19 loss: 406.56571865081787; train accuracy: 0.7120186941964286; test accuracy: 0.6882
2025-09-24 16:18:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:18:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:18:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:18:59 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:48 [INFO]  Epoch 15 loss: 396.1644778251648; train accuracy: 0.6830303485576923; test accuracy: 0.6629
2025-09-24 16:19:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_15.pth
2025-09-24 16:19:49 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:35 [INFO]  Epoch 16 loss: 402.6938376426697; train accuracy: 0.6921950120192307; test accuracy: 0.6732
2025-09-24 16:20:35 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:20 [INFO]  Epoch 17 loss: 392.08791875839233; train accuracy: 0.6603064903846154; test accuracy: 0.6503
2025-09-24 16:21:20 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:07 [INFO]  Epoch 18 loss: 392.60983085632324; train accuracy: 0.6758563701923077; test accuracy: 0.6592
2025-09-24 16:22:07 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:53 [INFO]  Epoch 19 loss: 387.4151177406311; train accuracy: 0.6702223557692307; test accuracy: 0.6512
2025-09-24 16:22:53 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:22:53 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:22:53 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:22:53 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:50 [INFO]  Epoch 15 loss: 475.07455110549927; train accuracy: 0.68914794921875; test accuracy: 0.6629
2025-09-24 16:23:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_15.pth
2025-09-24 16:23:51 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:52 [INFO]  Epoch 16 loss: 474.7917938232422; train accuracy: 0.71502685546875; test accuracy: 0.6977
2025-09-24 16:24:52 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:55 [INFO]  Epoch 17 loss: 471.39598989486694; train accuracy: 0.74371337890625; test accuracy: 0.7168
2025-09-24 16:25:55 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:57 [INFO]  Epoch 18 loss: 475.60859632492065; train accuracy: 0.72442626953125; test accuracy: 0.7004
2025-09-24 16:26:57 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:00 [INFO]  Epoch 19 loss: 464.1505432128906; train accuracy: 0.685943603515625; test accuracy: 0.6599
2025-09-24 16:31:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:31:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:31:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:31:00 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:33 [INFO]  Epoch 15 loss: 286.60326862335205; train accuracy: 0.6351004464285714; test accuracy: 0.6159
2025-09-24 16:31:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_15.pth
2025-09-24 16:31:34 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:40 [INFO]  Epoch 16 loss: 286.60799741744995; train accuracy: 0.5931919642857143; test accuracy: 0.5878
2025-09-24 16:52:40 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:14 [INFO]  Epoch 17 loss: 284.1428837776184; train accuracy: 0.5904017857142857; test accuracy: 0.5737
2025-09-24 16:53:14 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:47 [INFO]  Epoch 18 loss: 276.58042335510254; train accuracy: 0.5813058035714286; test accuracy: 0.5635
2025-09-24 16:53:47 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:21 [INFO]  Epoch 19 loss: 288.061927318573; train accuracy: 0.6421875; test accuracy: 0.6167
2025-09-24 16:54:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:54:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:54:22 [INFO]  Round 3 Finish--------|
2025-09-24 16:54:22 [INFO]  Model variance: mean: 0.0033288265112787485, sum: 37196.1484375
2025-09-24 16:54:22 [INFO]  g_protos_std: 1.0057605504989624
2025-09-24 16:54:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8406
2025-09-24 16:54:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:54:27 [INFO]  Round 4 starts--------|
2025-09-24 16:54:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:54:27 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:55:32 [INFO]  Epoch 20 loss: 497.459810256958; train accuracy: 0.7173346920289855; test accuracy: 0.6938
2025-09-24 16:55:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_20.pth
2025-09-24 16:55:32 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:56:37 [INFO]  Epoch 21 loss: 486.6986413002014; train accuracy: 0.7815330615942029; test accuracy: 0.7503
2025-09-24 16:56:37 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:57:45 [INFO]  Epoch 22 loss: 481.9764108657837; train accuracy: 0.7809952445652174; test accuracy: 0.7492
2025-09-24 16:57:45 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:51 [INFO]  Epoch 23 loss: 476.2630076408386; train accuracy: 0.7794384057971014; test accuracy: 0.7451
2025-09-24 16:58:51 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:54 [INFO]  Epoch 24 loss: 474.05463695526123; train accuracy: 0.7744565217391305; test accuracy: 0.7418
2025-09-24 16:59:54 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:59:54 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:59:54 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:59:55 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:00:47 [INFO]  Epoch 20 loss: 406.4222068786621; train accuracy: 0.6666434151785714; test accuracy: 0.6443
2025-09-24 17:00:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_20.pth
2025-09-24 17:00:48 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:01:41 [INFO]  Epoch 21 loss: 417.7891273498535; train accuracy: 0.7443498883928571; test accuracy: 0.7178
2025-09-24 17:01:41 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:32 [INFO]  Epoch 22 loss: 397.58179569244385; train accuracy: 0.7579520089285714; test accuracy: 0.73
2025-09-24 17:02:32 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:22 [INFO]  Epoch 23 loss: 401.03741359710693; train accuracy: 0.7284458705357143; test accuracy: 0.6966
2025-09-24 17:03:22 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:11 [INFO]  Epoch 24 loss: 404.7075595855713; train accuracy: 0.7004743303571429; test accuracy: 0.6694
2025-09-24 17:04:11 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:04:11 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:04:11 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:04:11 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:59 [INFO]  Epoch 20 loss: 377.0295715332031; train accuracy: 0.7052659254807693; test accuracy: 0.6821
2025-09-24 17:04:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_20.pth
2025-09-24 17:04:59 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:47 [INFO]  Epoch 21 loss: 387.1162705421448; train accuracy: 0.6772085336538461; test accuracy: 0.6538
2025-09-24 17:05:47 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:31 [INFO]  Epoch 22 loss: 384.1408886909485; train accuracy: 0.7100360576923077; test accuracy: 0.6829
2025-09-24 17:06:31 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:07:17 [INFO]  Epoch 23 loss: 371.79918098449707; train accuracy: 0.6988055889423077; test accuracy: 0.6701
2025-09-24 17:07:17 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:01 [INFO]  Epoch 24 loss: 370.73272132873535; train accuracy: 0.6900916466346154; test accuracy: 0.6682
2025-09-24 17:08:01 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:08:01 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:08:01 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:08:01 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:56 [INFO]  Epoch 20 loss: 464.1896867752075; train accuracy: 0.751129150390625; test accuracy: 0.7227
2025-09-24 17:08:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_20.pth
2025-09-24 17:08:56 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:09:53 [INFO]  Epoch 21 loss: 463.303147315979; train accuracy: 0.697509765625; test accuracy: 0.6707
2025-09-24 17:09:53 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:10:48 [INFO]  Epoch 22 loss: 457.4868392944336; train accuracy: 0.71832275390625; test accuracy: 0.6922
2025-09-24 17:10:48 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:11:42 [INFO]  Epoch 23 loss: 457.57301092147827; train accuracy: 0.76275634765625; test accuracy: 0.7322
2025-09-24 17:11:42 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:35 [INFO]  Epoch 24 loss: 443.9651699066162; train accuracy: 0.79388427734375; test accuracy: 0.7621
2025-09-24 17:12:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:12:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:12:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:12:35 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:06 [INFO]  Epoch 20 loss: 273.67469787597656; train accuracy: 0.6752790178571428; test accuracy: 0.6494
2025-09-24 17:13:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_20.pth
2025-09-24 17:13:07 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:37 [INFO]  Epoch 21 loss: 273.1880054473877; train accuracy: 0.6939732142857142; test accuracy: 0.6644
2025-09-24 17:13:37 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:14:08 [INFO]  Epoch 22 loss: 274.37944650650024; train accuracy: 0.7266183035714285; test accuracy: 0.6932
2025-09-24 17:14:08 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:14:40 [INFO]  Epoch 23 loss: 260.9232940673828; train accuracy: 0.6689174107142857; test accuracy: 0.6396
2025-09-24 17:14:40 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:15:09 [INFO]  Epoch 24 loss: 265.96738719940186; train accuracy: 0.6836495535714285; test accuracy: 0.6547
2025-09-24 17:15:09 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:15:09 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:15:09 [INFO]  Round 4 Finish--------|
2025-09-24 17:15:09 [INFO]  Model variance: mean: 0.0037863734178245068, sum: 42308.75390625
2025-09-24 17:15:09 [INFO]  g_protos_std: 1.0058069229125977
2025-09-24 17:15:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8547
2025-09-24 17:15:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:15:14 [INFO]  Round 5 starts--------|
2025-09-24 17:15:14 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:15:14 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:14 [INFO]  Epoch 25 loss: 476.430570602417; train accuracy: 0.7343466938405797; test accuracy: 0.7093
2025-09-24 17:16:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_25.pth
2025-09-24 17:16:14 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:17:11 [INFO]  Epoch 26 loss: 473.98247241973877; train accuracy: 0.7468863224637681; test accuracy: 0.7177
2025-09-24 17:17:11 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:18:09 [INFO]  Epoch 27 loss: 469.62464904785156; train accuracy: 0.7973278985507246; test accuracy: 0.7588
2025-09-24 17:18:09 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:19:09 [INFO]  Epoch 28 loss: 467.31696796417236; train accuracy: 0.8136039402173914; test accuracy: 0.7747
2025-09-24 17:19:09 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:07 [INFO]  Epoch 29 loss: 461.4891724586487; train accuracy: 0.6912364130434783; test accuracy: 0.6644
2025-09-24 17:20:07 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:20:07 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:20:07 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:20:07 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:52 [INFO]  Epoch 25 loss: 406.3691701889038; train accuracy: 0.801025390625; test accuracy: 0.762
2025-09-24 17:20:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_25.pth
2025-09-24 17:20:52 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:21:34 [INFO]  Epoch 26 loss: 408.7847099304199; train accuracy: 0.7819126674107143; test accuracy: 0.7489
2025-09-24 17:21:34 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:22:16 [INFO]  Epoch 27 loss: 380.978223323822; train accuracy: 0.7598005022321429; test accuracy: 0.7223
2025-09-24 17:22:16 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:23:00 [INFO]  Epoch 28 loss: 392.01905488967896; train accuracy: 0.7945033482142857; test accuracy: 0.7547
2025-09-24 17:23:00 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:23:44 [INFO]  Epoch 29 loss: 383.9439778327942; train accuracy: 0.8201381138392857; test accuracy: 0.7774
2025-09-24 17:23:44 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:23:44 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:23:44 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:23:44 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:24:23 [INFO]  Epoch 25 loss: 369.0813093185425; train accuracy: 0.7321213942307693; test accuracy: 0.6998
2025-09-24 17:24:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_25.pth
2025-09-24 17:24:23 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:25:06 [INFO]  Epoch 26 loss: 369.04601192474365; train accuracy: 0.76708984375; test accuracy: 0.7375
2025-09-24 17:25:06 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:25:51 [INFO]  Epoch 27 loss: 363.21415758132935; train accuracy: 0.7518028846153846; test accuracy: 0.7157
2025-09-24 17:25:51 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:26:36 [INFO]  Epoch 28 loss: 365.2789354324341; train accuracy: 0.7053034855769231; test accuracy: 0.6779
2025-09-24 17:26:36 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:27:20 [INFO]  Epoch 29 loss: 361.6478819847107; train accuracy: 0.8131009615384616; test accuracy: 0.7721
2025-09-24 17:27:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:27:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:27:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:27:20 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:28:14 [INFO]  Epoch 25 loss: 449.5565719604492; train accuracy: 0.76531982421875; test accuracy: 0.7335
2025-09-24 17:28:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_25.pth
2025-09-24 17:28:15 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:29:09 [INFO]  Epoch 26 loss: 438.5625467300415; train accuracy: 0.7744140625; test accuracy: 0.7428
2025-09-24 17:29:09 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:02 [INFO]  Epoch 27 loss: 436.22742891311646; train accuracy: 0.73291015625; test accuracy: 0.7039
2025-09-24 17:30:02 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:54 [INFO]  Epoch 28 loss: 434.8888096809387; train accuracy: 0.733489990234375; test accuracy: 0.7025
2025-09-24 17:30:54 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:46 [INFO]  Epoch 29 loss: 434.1850748062134; train accuracy: 0.79766845703125; test accuracy: 0.7593
2025-09-24 17:31:46 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:31:46 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:31:46 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:31:46 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:16 [INFO]  Epoch 25 loss: 265.3482766151428; train accuracy: 0.6423549107142857; test accuracy: 0.6199
2025-09-24 17:32:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_25.pth
2025-09-24 17:32:16 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:49 [INFO]  Epoch 26 loss: 260.38195419311523; train accuracy: 0.6446428571428572; test accuracy: 0.6197
2025-09-24 17:32:49 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:18 [INFO]  Epoch 27 loss: 262.0511302947998; train accuracy: 0.6545758928571429; test accuracy: 0.6215
2025-09-24 17:33:18 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:49 [INFO]  Epoch 28 loss: 255.298677444458; train accuracy: 0.7511160714285714; test accuracy: 0.7174
2025-09-24 17:33:49 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:18 [INFO]  Epoch 29 loss: 254.31902742385864; train accuracy: 0.6678571428571428; test accuracy: 0.6435
2025-09-24 17:34:18 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:34:18 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:34:18 [INFO]  Round 5 Finish--------|
2025-09-24 17:34:18 [INFO]  Model variance: mean: 0.004203071817755699, sum: 46964.921875
2025-09-24 17:34:18 [INFO]  g_protos_std: 1.0058784484863281
2025-09-24 17:34:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8679
2025-09-24 17:34:23 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:34:23 [INFO]  Round 6 starts--------|
2025-09-24 17:34:23 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:34:23 [INFO]  Epoch 30: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:35:22 [INFO]  Epoch 30 loss: 460.225133895874; train accuracy: 0.804885643115942; test accuracy: 0.7588
2025-09-24 17:35:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_30.pth
2025-09-24 17:35:22 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:36:20 [INFO]  Epoch 31 loss: 452.7048215866089; train accuracy: 0.8368999094202898; test accuracy: 0.7926
2025-09-24 17:36:20 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:20 [INFO]  Epoch 32 loss: 461.69178104400635; train accuracy: 0.8120187952898551; test accuracy: 0.7629
2025-09-24 17:37:20 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:38:20 [INFO]  Epoch 33 loss: 450.1730537414551; train accuracy: 0.8092164855072463; test accuracy: 0.7627
2025-09-24 17:38:20 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:39:20 [INFO]  Epoch 34 loss: 457.23183965682983; train accuracy: 0.8405514039855072; test accuracy: 0.7865
2025-09-24 17:39:20 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:39:20 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:39:20 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:39:20 [INFO]  Epoch 30: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:40:07 [INFO]  Epoch 30 loss: 379.48013067245483; train accuracy: 0.7214006696428571; test accuracy: 0.6883
2025-09-24 17:40:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_30.pth
2025-09-24 17:40:08 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:40:56 [INFO]  Epoch 31 loss: 385.3620343208313; train accuracy: 0.7532435825892857; test accuracy: 0.7143
2025-09-24 17:40:56 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:41:45 [INFO]  Epoch 32 loss: 381.7345814704895; train accuracy: 0.7548828125; test accuracy: 0.72
2025-09-24 17:41:45 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:42:35 [INFO]  Epoch 33 loss: 381.221342086792; train accuracy: 0.7856794084821429; test accuracy: 0.7478
2025-09-24 17:42:35 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:43:25 [INFO]  Epoch 34 loss: 376.1071209907532; train accuracy: 0.79833984375; test accuracy: 0.7544
2025-09-24 17:43:25 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:43:25 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:43:25 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:43:25 [INFO]  Epoch 30: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:44:10 [INFO]  Epoch 30 loss: 356.5620799064636; train accuracy: 0.7650991586538461; test accuracy: 0.7306
2025-09-24 17:44:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_30.pth
2025-09-24 17:44:11 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:44:56 [INFO]  Epoch 31 loss: 358.73172998428345; train accuracy: 0.7234825721153846; test accuracy: 0.6951
2025-09-24 17:44:56 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:45:42 [INFO]  Epoch 32 loss: 356.5303649902344; train accuracy: 0.7550330528846154; test accuracy: 0.7134
2025-09-24 17:45:42 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:46:26 [INFO]  Epoch 33 loss: 362.60469341278076; train accuracy: 0.7039888822115384; test accuracy: 0.6755
2025-09-24 17:46:26 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:47:11 [INFO]  Epoch 34 loss: 357.47989320755005; train accuracy: 0.7150315504807693; test accuracy: 0.6827
2025-09-24 17:47:11 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:47:11 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:47:11 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:47:11 [INFO]  Epoch 30: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:48:07 [INFO]  Epoch 30 loss: 423.87036895751953; train accuracy: 0.767059326171875; test accuracy: 0.7356
2025-09-24 17:48:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_30.pth
2025-09-24 17:48:07 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:49:05 [INFO]  Epoch 31 loss: 433.70692777633667; train accuracy: 0.826171875; test accuracy: 0.7791
2025-09-24 17:49:05 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:50:00 [INFO]  Epoch 32 loss: 442.7848606109619; train accuracy: 0.8275146484375; test accuracy: 0.7866
2025-09-24 17:50:00 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:50:54 [INFO]  Epoch 33 loss: 435.8005847930908; train accuracy: 0.81292724609375; test accuracy: 0.767
2025-09-24 17:50:54 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:51:49 [INFO]  Epoch 34 loss: 421.08472537994385; train accuracy: 0.82220458984375; test accuracy: 0.7729
2025-09-24 17:51:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:51:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:51:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:51:49 [INFO]  Epoch 30: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:52:20 [INFO]  Epoch 30 loss: 254.8840913772583; train accuracy: 0.75546875; test accuracy: 0.7158
2025-09-24 17:52:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_30.pth
2025-09-24 17:52:20 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:52:52 [INFO]  Epoch 31 loss: 251.825092792511; train accuracy: 0.734375; test accuracy: 0.7014
2025-09-24 17:52:52 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:53:23 [INFO]  Epoch 32 loss: 254.20221853256226; train accuracy: 0.7068080357142857; test accuracy: 0.6769
2025-09-24 17:53:23 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:53:54 [INFO]  Epoch 33 loss: 253.20464372634888; train accuracy: 0.7121651785714286; test accuracy: 0.6713
2025-09-24 17:53:54 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:54:25 [INFO]  Epoch 34 loss: 252.82112407684326; train accuracy: 0.687109375; test accuracy: 0.6548
2025-09-24 17:54:25 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:54:25 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:54:25 [INFO]  Round 6 Finish--------|
2025-09-24 17:54:25 [INFO]  Model variance: mean: 0.0045855604112148285, sum: 51238.83203125
2025-09-24 17:54:25 [INFO]  g_protos_std: 1.0059391260147095
2025-09-24 17:54:30 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8736
2025-09-24 17:54:30 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:54:30 [INFO]  Round 7 starts--------|
2025-09-24 17:54:30 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:54:30 [INFO]  Epoch 35: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:55:27 [INFO]  Epoch 35 loss: 443.32736587524414; train accuracy: 0.8780004528985508; test accuracy: 0.8249
2025-09-24 17:55:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_35.pth
2025-09-24 17:55:27 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:56:23 [INFO]  Epoch 36 loss: 445.4962134361267; train accuracy: 0.8211050724637681; test accuracy: 0.7751
2025-09-24 17:56:23 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:57:20 [INFO]  Epoch 37 loss: 452.36010551452637; train accuracy: 0.8352298460144928; test accuracy: 0.7827
2025-09-24 17:57:20 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:58:15 [INFO]  Epoch 38 loss: 452.8356680870056; train accuracy: 0.8369848278985508; test accuracy: 0.7805
2025-09-24 17:58:15 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:11 [INFO]  Epoch 39 loss: 447.532084941864; train accuracy: 0.8485903532608695; test accuracy: 0.797
2025-09-24 17:59:11 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:59:11 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:59:11 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:59:11 [INFO]  Epoch 35: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:58 [INFO]  Epoch 35 loss: 373.7406129837036; train accuracy: 0.8135114397321429; test accuracy: 0.7687
2025-09-24 17:59:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_35.pth
2025-09-24 17:59:59 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:00:47 [INFO]  Epoch 36 loss: 367.0356388092041; train accuracy: 0.811279296875; test accuracy: 0.7574
2025-09-24 18:00:47 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:01:35 [INFO]  Epoch 37 loss: 377.4771251678467; train accuracy: 0.8031877790178571; test accuracy: 0.7523
2025-09-24 18:01:35 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:02:23 [INFO]  Epoch 38 loss: 370.9671106338501; train accuracy: 0.7960728236607143; test accuracy: 0.7518
2025-09-24 18:02:23 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:03:09 [INFO]  Epoch 39 loss: 373.3322548866272; train accuracy: 0.8013392857142857; test accuracy: 0.7545
2025-09-24 18:03:09 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 18:03:09 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 18:03:09 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 18:03:09 [INFO]  Epoch 35: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:03:56 [INFO]  Epoch 35 loss: 357.48980236053467; train accuracy: 0.7859450120192307; test accuracy: 0.744
2025-09-24 18:03:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_35.pth
2025-09-24 18:03:56 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:04:43 [INFO]  Epoch 36 loss: 349.0336928367615; train accuracy: 0.7586012620192307; test accuracy: 0.7172
2025-09-24 18:04:43 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:05:31 [INFO]  Epoch 37 loss: 352.40911054611206; train accuracy: 0.7817758413461539; test accuracy: 0.7371
2025-09-24 18:05:31 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:06:19 [INFO]  Epoch 38 loss: 354.1215891838074; train accuracy: 0.7572115384615384; test accuracy: 0.7179
2025-09-24 18:06:19 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:07:05 [INFO]  Epoch 39 loss: 344.8760986328125; train accuracy: 0.7412484975961539; test accuracy: 0.7041
2025-09-24 18:07:05 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 18:07:05 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 18:07:05 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 18:07:05 [INFO]  Epoch 35: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:08:00 [INFO]  Epoch 35 loss: 425.14594316482544; train accuracy: 0.7926025390625; test accuracy: 0.7513
2025-09-24 18:08:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_35.pth
2025-09-24 18:08:01 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:08:59 [INFO]  Epoch 36 loss: 418.52692890167236; train accuracy: 0.829681396484375; test accuracy: 0.7822
2025-09-24 18:08:59 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:09:56 [INFO]  Epoch 37 loss: 419.6542024612427; train accuracy: 0.779693603515625; test accuracy: 0.7321
2025-09-24 18:09:56 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:10:54 [INFO]  Epoch 38 loss: 420.6778197288513; train accuracy: 0.811126708984375; test accuracy: 0.769
2025-09-24 18:10:54 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:11:50 [INFO]  Epoch 39 loss: 407.9990029335022; train accuracy: 0.768890380859375; test accuracy: 0.7259
2025-09-24 18:11:50 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 18:11:50 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 18:11:50 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 18:11:50 [INFO]  Epoch 35: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:12:23 [INFO]  Epoch 35 loss: 246.35458612442017; train accuracy: 0.7087611607142857; test accuracy: 0.6724
2025-09-24 18:12:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_35.pth
2025-09-24 18:12:24 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:12:56 [INFO]  Epoch 36 loss: 248.46564149856567; train accuracy: 0.7971540178571429; test accuracy: 0.7477
2025-09-24 18:12:56 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:13:28 [INFO]  Epoch 37 loss: 248.3791904449463; train accuracy: 0.7347098214285714; test accuracy: 0.6918
2025-09-24 18:13:28 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:14:01 [INFO]  Epoch 38 loss: 245.90664863586426; train accuracy: 0.8044084821428571; test accuracy: 0.7503
2025-09-24 18:14:01 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:14:32 [INFO]  Epoch 39 loss: 254.17582368850708; train accuracy: 0.6905691964285714; test accuracy: 0.6561
2025-09-24 18:14:32 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 18:14:32 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 18:14:32 [INFO]  Round 7 Finish--------|
2025-09-24 18:14:32 [INFO]  Model variance: mean: 0.0049416678957641125, sum: 55217.9609375
2025-09-24 18:14:32 [INFO]  g_protos_std: 1.0060046911239624
2025-09-24 18:14:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8871
2025-09-24 18:14:38 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 18:14:38 [INFO]  Round 8 starts--------|
2025-09-24 18:14:38 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 18:14:38 [INFO]  Epoch 40: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:15:39 [INFO]  Epoch 40 loss: 443.74897480010986; train accuracy: 0.8074615036231884; test accuracy: 0.7577
2025-09-24 18:15:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_40.pth
2025-09-24 18:15:39 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:16:42 [INFO]  Epoch 41 loss: 436.80167722702026; train accuracy: 0.8363054800724637; test accuracy: 0.7891
2025-09-24 18:16:42 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:17:44 [INFO]  Epoch 42 loss: 441.76676893234253; train accuracy: 0.8527230525362319; test accuracy: 0.8008
2025-09-24 18:17:44 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:18:44 [INFO]  Epoch 43 loss: 435.2265815734863; train accuracy: 0.8470901268115942; test accuracy: 0.7951
2025-09-24 18:18:44 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:19:47 [INFO]  Epoch 44 loss: 425.4531636238098; train accuracy: 0.8813688858695652; test accuracy: 0.8271
2025-09-24 18:19:47 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 18:19:47 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 18:19:47 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 18:19:47 [INFO]  Epoch 40: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:20:37 [INFO]  Epoch 40 loss: 358.28093910217285; train accuracy: 0.8376813616071429; test accuracy: 0.7838
2025-09-24 18:20:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_40.pth
2025-09-24 18:20:37 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:21:25 [INFO]  Epoch 41 loss: 362.8601927757263; train accuracy: 0.8442034040178571; test accuracy: 0.7882
2025-09-24 18:21:25 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:22:16 [INFO]  Epoch 42 loss: 378.06696796417236; train accuracy: 0.8357979910714286; test accuracy: 0.7794
2025-09-24 18:22:16 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:23:08 [INFO]  Epoch 43 loss: 371.7774004936218; train accuracy: 0.7715192522321429; test accuracy: 0.7252
2025-09-24 18:23:08 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:23:59 [INFO]  Epoch 44 loss: 374.2811007499695; train accuracy: 0.8470633370535714; test accuracy: 0.7919
2025-09-24 18:23:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 18:23:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 18:23:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 18:23:59 [INFO]  Epoch 40: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:24:47 [INFO]  Epoch 40 loss: 338.5714302062988; train accuracy: 0.8260591947115384; test accuracy: 0.7757
2025-09-24 18:24:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_40.pth
2025-09-24 18:24:48 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:25:36 [INFO]  Epoch 41 loss: 355.4705276489258; train accuracy: 0.7738506610576923; test accuracy: 0.7315
2025-09-24 18:25:36 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:26:23 [INFO]  Epoch 42 loss: 333.09717750549316; train accuracy: 0.8420973557692307; test accuracy: 0.7929
2025-09-24 18:26:23 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:27:11 [INFO]  Epoch 43 loss: 329.67551469802856; train accuracy: 0.8168194110576923; test accuracy: 0.7636
2025-09-24 18:27:11 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:27:58 [INFO]  Epoch 44 loss: 343.8058204650879; train accuracy: 0.7707331730769231; test accuracy: 0.7243
2025-09-24 18:27:58 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 18:27:58 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 18:27:58 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 18:27:58 [INFO]  Epoch 40: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:28:56 [INFO]  Epoch 40 loss: 414.4012670516968; train accuracy: 0.771270751953125; test accuracy: 0.7221
2025-09-24 18:28:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_40.pth
2025-09-24 18:28:56 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:29:56 [INFO]  Epoch 41 loss: 416.7698698043823; train accuracy: 0.824005126953125; test accuracy: 0.7778
2025-09-24 18:29:56 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:30:54 [INFO]  Epoch 42 loss: 415.45760774612427; train accuracy: 0.875701904296875; test accuracy: 0.8149
2025-09-24 18:30:54 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:31:54 [INFO]  Epoch 43 loss: 406.2265691757202; train accuracy: 0.819000244140625; test accuracy: 0.7616
2025-09-24 18:31:54 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:32:56 [INFO]  Epoch 44 loss: 416.1565971374512; train accuracy: 0.81597900390625; test accuracy: 0.7639
2025-09-24 18:32:56 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 18:32:56 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 18:32:56 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 18:32:56 [INFO]  Epoch 40: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:33:32 [INFO]  Epoch 40 loss: 250.59205961227417; train accuracy: 0.7658482142857143; test accuracy: 0.7136
2025-09-24 18:33:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_40.pth
2025-09-24 18:33:32 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:34:06 [INFO]  Epoch 41 loss: 244.27636337280273; train accuracy: 0.773828125; test accuracy: 0.7219
2025-09-24 18:34:06 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:34:44 [INFO]  Epoch 42 loss: 243.19396543502808; train accuracy: 0.7790178571428571; test accuracy: 0.7246
2025-09-24 18:34:44 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:52:29 [INFO]  Epoch 43 loss: 245.24639511108398; train accuracy: 0.7895089285714286; test accuracy: 0.7324
2025-09-24 18:52:29 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:53:04 [INFO]  Epoch 44 loss: 245.55238389968872; train accuracy: 0.8122209821428571; test accuracy: 0.7546
2025-09-24 18:53:04 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 18:53:04 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 18:53:04 [INFO]  Round 8 Finish--------|
2025-09-24 18:53:04 [INFO]  Model variance: mean: 0.0052770283073186874, sum: 58965.2578125
2025-09-24 18:53:04 [INFO]  g_protos_std: 1.006072998046875
2025-09-24 18:53:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.89
2025-09-24 18:53:10 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 18:53:10 [INFO]  Round 9 starts--------|
2025-09-24 18:53:10 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 18:53:10 [INFO]  Epoch 45: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:54:20 [INFO]  Epoch 45 loss: 431.115017414093; train accuracy: 0.8396739130434783; test accuracy: 0.7893
2025-09-24 18:54:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_45.pth
2025-09-24 18:54:20 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:55:31 [INFO]  Epoch 46 loss: 426.38028955459595; train accuracy: 0.886124320652174; test accuracy: 0.8239
2025-09-24 18:55:31 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:56:40 [INFO]  Epoch 47 loss: 445.7408661842346; train accuracy: 0.833786231884058; test accuracy: 0.7836
2025-09-24 18:56:40 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:57:43 [INFO]  Epoch 48 loss: 434.80348205566406; train accuracy: 0.845306838768116; test accuracy: 0.7897
2025-09-24 18:57:43 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:58:49 [INFO]  Epoch 49 loss: 432.83470916748047; train accuracy: 0.8668195199275363; test accuracy: 0.8088
2025-09-24 18:58:49 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 18:58:49 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 18:58:49 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 18:58:49 [INFO]  Epoch 45: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:59:42 [INFO]  Epoch 45 loss: 362.41315031051636; train accuracy: 0.8240443638392857; test accuracy: 0.7714
2025-09-24 18:59:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_45.pth
2025-09-24 18:59:43 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:00:38 [INFO]  Epoch 46 loss: 367.8099627494812; train accuracy: 0.8288225446428571; test accuracy: 0.7748
2025-09-24 19:00:38 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:01:31 [INFO]  Epoch 47 loss: 355.9363055229187; train accuracy: 0.8231375558035714; test accuracy: 0.7672
2025-09-24 19:01:31 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:02:24 [INFO]  Epoch 48 loss: 363.80604696273804; train accuracy: 0.81640625; test accuracy: 0.7645
2025-09-24 19:02:24 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:03:17 [INFO]  Epoch 49 loss: 358.89940547943115; train accuracy: 0.8166155133928571; test accuracy: 0.7606
2025-09-24 19:03:17 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:03:17 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:03:17 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:03:17 [INFO]  Epoch 45: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:04:08 [INFO]  Epoch 45 loss: 330.30969429016113; train accuracy: 0.7391451322115384; test accuracy: 0.6975
2025-09-24 19:04:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_45.pth
2025-09-24 19:04:09 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:05:00 [INFO]  Epoch 46 loss: 332.2214159965515; train accuracy: 0.7904146634615384; test accuracy: 0.7404
2025-09-24 19:05:00 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:05:49 [INFO]  Epoch 47 loss: 346.36185359954834; train accuracy: 0.8246694711538461; test accuracy: 0.7702
2025-09-24 19:05:49 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:06:40 [INFO]  Epoch 48 loss: 340.56956338882446; train accuracy: 0.8206505408653846; test accuracy: 0.7717
2025-09-24 19:06:40 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:07:30 [INFO]  Epoch 49 loss: 334.5315566062927; train accuracy: 0.8491586538461539; test accuracy: 0.7914
2025-09-24 19:07:30 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:07:30 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:07:30 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:07:30 [INFO]  Epoch 45: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:08:30 [INFO]  Epoch 45 loss: 407.1716504096985; train accuracy: 0.81842041015625; test accuracy: 0.7617
2025-09-24 19:08:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_45.pth
2025-09-24 19:08:31 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:09:31 [INFO]  Epoch 46 loss: 415.9862914085388; train accuracy: 0.855255126953125; test accuracy: 0.7914
2025-09-24 19:09:31 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:10:31 [INFO]  Epoch 47 loss: 411.13046169281006; train accuracy: 0.8388671875; test accuracy: 0.7773
2025-09-24 19:10:31 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:11:33 [INFO]  Epoch 48 loss: 392.2888660430908; train accuracy: 0.859832763671875; test accuracy: 0.8021
2025-09-24 19:11:33 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:12:34 [INFO]  Epoch 49 loss: 402.00085401535034; train accuracy: 0.86163330078125; test accuracy: 0.8004
2025-09-24 19:12:34 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:12:34 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:12:34 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:12:34 [INFO]  Epoch 45: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:13:09 [INFO]  Epoch 45 loss: 235.92751836776733; train accuracy: 0.7703683035714286; test accuracy: 0.7175
2025-09-24 19:13:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_45.pth
2025-09-24 19:13:10 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:13:44 [INFO]  Epoch 46 loss: 242.02057218551636; train accuracy: 0.80625; test accuracy: 0.7508
2025-09-24 19:13:44 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:14:19 [INFO]  Epoch 47 loss: 242.13708066940308; train accuracy: 0.8001116071428571; test accuracy: 0.7398
2025-09-24 19:14:19 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:14:53 [INFO]  Epoch 48 loss: 240.99889087677002; train accuracy: 0.7729352678571428; test accuracy: 0.7184
2025-09-24 19:14:53 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:15:27 [INFO]  Epoch 49 loss: 243.57586288452148; train accuracy: 0.7972098214285714; test accuracy: 0.7324
2025-09-24 19:15:27 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:15:27 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:15:27 [INFO]  Round 9 Finish--------|
2025-09-24 19:15:27 [INFO]  Model variance: mean: 0.005593460518866777, sum: 62501.05859375
2025-09-24 19:15:27 [INFO]  g_protos_std: 1.006134271621704
2025-09-24 19:15:33 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8962
2025-09-24 19:15:33 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:15:33 [INFO]  Round 10 starts--------|
2025-09-24 19:15:33 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:15:33 [INFO]  Epoch 50: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:16:37 [INFO]  Epoch 50 loss: 425.25040340423584; train accuracy: 0.8558933423913043; test accuracy: 0.7965
2025-09-24 19:16:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_50.pth
2025-09-24 19:16:38 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:17:39 [INFO]  Epoch 51 loss: 422.8873167037964; train accuracy: 0.8709805253623188; test accuracy: 0.8106
2025-09-24 19:17:39 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:18:43 [INFO]  Epoch 52 loss: 427.03290367126465; train accuracy: 0.8376075634057971; test accuracy: 0.7817
2025-09-24 19:18:43 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:19:45 [INFO]  Epoch 53 loss: 424.22011518478394; train accuracy: 0.8757359601449275; test accuracy: 0.8074
2025-09-24 19:19:45 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:20:48 [INFO]  Epoch 54 loss: 418.60063219070435; train accuracy: 0.8981544384057971; test accuracy: 0.8278
2025-09-24 19:20:48 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:20:48 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:20:48 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:20:48 [INFO]  Epoch 50: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:21:44 [INFO]  Epoch 50 loss: 354.3065128326416; train accuracy: 0.7935267857142857; test accuracy: 0.7397
2025-09-24 19:21:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_50.pth
2025-09-24 19:21:44 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:22:36 [INFO]  Epoch 51 loss: 355.59208583831787; train accuracy: 0.841064453125; test accuracy: 0.7793
2025-09-24 19:22:36 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:23:28 [INFO]  Epoch 52 loss: 354.6014986038208; train accuracy: 0.8687569754464286; test accuracy: 0.8026
2025-09-24 19:23:28 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:24:22 [INFO]  Epoch 53 loss: 346.1572518348694; train accuracy: 0.8340890066964286; test accuracy: 0.7785
2025-09-24 19:24:22 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:25:13 [INFO]  Epoch 54 loss: 346.5709991455078; train accuracy: 0.8504813058035714; test accuracy: 0.7836
2025-09-24 19:25:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:25:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:25:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:25:13 [INFO]  Epoch 50: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:26:00 [INFO]  Epoch 50 loss: 337.16703271865845; train accuracy: 0.7678034855769231; test accuracy: 0.7237
2025-09-24 19:26:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_50.pth
2025-09-24 19:26:01 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:26:47 [INFO]  Epoch 51 loss: 327.8253126144409; train accuracy: 0.8250075120192307; test accuracy: 0.7703
2025-09-24 19:26:47 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:27:34 [INFO]  Epoch 52 loss: 329.1148142814636; train accuracy: 0.8712815504807693; test accuracy: 0.8075
2025-09-24 19:27:34 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:28:20 [INFO]  Epoch 53 loss: 324.2358317375183; train accuracy: 0.8524263822115384; test accuracy: 0.7865
2025-09-24 19:28:20 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:29:09 [INFO]  Epoch 54 loss: 321.8058376312256; train accuracy: 0.859375; test accuracy: 0.7976
2025-09-24 19:29:09 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:29:09 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:29:09 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:29:09 [INFO]  Epoch 50: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:30:07 [INFO]  Epoch 50 loss: 400.82148265838623; train accuracy: 0.877227783203125; test accuracy: 0.8153
2025-09-24 19:30:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_50.pth
2025-09-24 19:30:07 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:31:06 [INFO]  Epoch 51 loss: 407.8563652038574; train accuracy: 0.83905029296875; test accuracy: 0.7814
2025-09-24 19:31:06 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:32:01 [INFO]  Epoch 52 loss: 394.62296628952026; train accuracy: 0.869354248046875; test accuracy: 0.8065
2025-09-24 19:32:01 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:32:55 [INFO]  Epoch 53 loss: 410.58535051345825; train accuracy: 0.806610107421875; test accuracy: 0.7486
2025-09-24 19:32:55 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:33:51 [INFO]  Epoch 54 loss: 398.7301878929138; train accuracy: 0.873199462890625; test accuracy: 0.8108
2025-09-24 19:33:51 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:33:51 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:33:51 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:33:51 [INFO]  Epoch 50: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:34:22 [INFO]  Epoch 50 loss: 232.62306880950928; train accuracy: 0.7739397321428572; test accuracy: 0.7194
2025-09-24 19:34:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_50.pth
2025-09-24 19:34:22 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:34:55 [INFO]  Epoch 51 loss: 230.01736497879028; train accuracy: 0.7928571428571428; test accuracy: 0.7309
2025-09-24 19:34:55 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:35:24 [INFO]  Epoch 52 loss: 226.6747636795044; train accuracy: 0.8141741071428571; test accuracy: 0.7545
2025-09-24 19:35:24 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:35:56 [INFO]  Epoch 53 loss: 231.4348702430725; train accuracy: 0.7714285714285715; test accuracy: 0.7127
2025-09-24 19:35:56 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:36:29 [INFO]  Epoch 54 loss: 232.67199277877808; train accuracy: 0.8233816964285714; test accuracy: 0.7535
2025-09-24 19:36:29 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:36:29 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:36:29 [INFO]  Round 10 Finish--------|
2025-09-24 19:36:29 [INFO]  Model variance: mean: 0.005899712443351746, sum: 65923.1015625
2025-09-24 19:36:29 [INFO]  g_protos_std: 1.0062376260757446
2025-09-24 19:36:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9007
2025-09-24 19:36:35 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:36:35 [INFO]  Round 11 starts--------|
2025-09-24 19:36:35 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:36:35 [INFO]  Epoch 55: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:37:41 [INFO]  Epoch 55 loss: 426.75609064102173; train accuracy: 0.9096184329710145; test accuracy: 0.8378
2025-09-24 19:37:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_55.pth
2025-09-24 19:37:41 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:38:43 [INFO]  Epoch 56 loss: 426.596884727478; train accuracy: 0.8806046195652174; test accuracy: 0.8161
2025-09-24 19:38:43 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:39:44 [INFO]  Epoch 57 loss: 427.8796000480652; train accuracy: 0.8920686141304348; test accuracy: 0.8285
2025-09-24 19:39:44 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:40:44 [INFO]  Epoch 58 loss: 408.19356298446655; train accuracy: 0.8894644474637681; test accuracy: 0.823
2025-09-24 19:40:44 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:41:45 [INFO]  Epoch 59 loss: 416.9845881462097; train accuracy: 0.8878509963768116; test accuracy: 0.8238
2025-09-24 19:41:45 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:41:45 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:41:45 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:41:45 [INFO]  Epoch 55: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:42:34 [INFO]  Epoch 55 loss: 342.6083688735962; train accuracy: 0.8542829241071429; test accuracy: 0.7865
2025-09-24 19:42:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_55.pth
2025-09-24 19:42:35 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:43:26 [INFO]  Epoch 56 loss: 351.1672058105469; train accuracy: 0.8738490513392857; test accuracy: 0.8048
2025-09-24 19:43:26 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:44:16 [INFO]  Epoch 57 loss: 353.09009981155396; train accuracy: 0.8379255022321429; test accuracy: 0.7765
2025-09-24 19:44:16 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:07 [INFO]  Epoch 58 loss: 350.9918546676636; train accuracy: 0.7685895647321429; test accuracy: 0.7122
2025-09-24 19:45:07 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:58 [INFO]  Epoch 59 loss: 357.2645983695984; train accuracy: 0.8682686941964286; test accuracy: 0.7989
2025-09-24 19:45:58 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:45:58 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:45:58 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:45:58 [INFO]  Epoch 55: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:46:45 [INFO]  Epoch 55 loss: 323.7698645591736; train accuracy: 0.8537409855769231; test accuracy: 0.7893
2025-09-24 19:46:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_55.pth
2025-09-24 19:46:45 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:47:31 [INFO]  Epoch 56 loss: 331.73651027679443; train accuracy: 0.8137770432692307; test accuracy: 0.754
2025-09-24 19:47:31 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:48:18 [INFO]  Epoch 57 loss: 327.2173881530762; train accuracy: 0.8194861778846154; test accuracy: 0.7614
2025-09-24 19:48:18 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:49:05 [INFO]  Epoch 58 loss: 328.2144260406494; train accuracy: 0.8568960336538461; test accuracy: 0.795
2025-09-24 19:49:05 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:49:53 [INFO]  Epoch 59 loss: 325.6492328643799; train accuracy: 0.8269981971153846; test accuracy: 0.7651
2025-09-24 19:49:53 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:49:53 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:49:53 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:49:53 [INFO]  Epoch 55: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:50:48 [INFO]  Epoch 55 loss: 385.1722483634949; train accuracy: 0.820343017578125; test accuracy: 0.7629
2025-09-24 19:50:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_55.pth
2025-09-24 19:50:48 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:51:46 [INFO]  Epoch 56 loss: 408.4835329055786; train accuracy: 0.861541748046875; test accuracy: 0.797
2025-09-24 19:51:46 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:52:45 [INFO]  Epoch 57 loss: 411.6933813095093; train accuracy: 0.86065673828125; test accuracy: 0.7912
2025-09-24 19:52:45 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:53:43 [INFO]  Epoch 58 loss: 390.41747522354126; train accuracy: 0.870361328125; test accuracy: 0.8034
2025-09-24 19:53:43 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:54:38 [INFO]  Epoch 59 loss: 389.33371353149414; train accuracy: 0.874359130859375; test accuracy: 0.8032
2025-09-24 19:54:38 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:54:38 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:54:38 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:54:38 [INFO]  Epoch 55: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:55:10 [INFO]  Epoch 55 loss: 243.31395053863525; train accuracy: 0.7743861607142857; test accuracy: 0.7132
2025-09-24 19:55:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_55.pth
2025-09-24 19:55:10 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:55:43 [INFO]  Epoch 56 loss: 234.08732795715332; train accuracy: 0.7724330357142857; test accuracy: 0.7118
2025-09-24 19:55:43 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:56:14 [INFO]  Epoch 57 loss: 231.56999683380127; train accuracy: 0.8546316964285714; test accuracy: 0.7807
2025-09-24 19:56:14 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:56:45 [INFO]  Epoch 58 loss: 230.11648035049438; train accuracy: 0.809375; test accuracy: 0.7413
2025-09-24 19:56:45 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:57:18 [INFO]  Epoch 59 loss: 230.67039489746094; train accuracy: 0.8469308035714286; test accuracy: 0.7746
2025-09-24 19:57:18 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:57:18 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:57:18 [INFO]  Round 11 Finish--------|
2025-09-24 19:57:18 [INFO]  Model variance: mean: 0.00618581660091877, sum: 69120.015625
2025-09-24 19:57:18 [INFO]  g_protos_std: 1.0062869787216187
2025-09-24 19:57:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9051
2025-09-24 19:57:23 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:57:23 [INFO]  Round 12 starts--------|
2025-09-24 19:57:23 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:57:23 [INFO]  Epoch 60: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:58:23 [INFO]  Epoch 60 loss: 421.6627883911133; train accuracy: 0.8770097373188406; test accuracy: 0.8138
2025-09-24 19:58:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_60.pth
2025-09-24 19:58:23 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:59:25 [INFO]  Epoch 61 loss: 425.2680115699768; train accuracy: 0.8716315670289855; test accuracy: 0.8087
2025-09-24 19:59:25 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:00:27 [INFO]  Epoch 62 loss: 403.4977607727051; train accuracy: 0.8566009963768116; test accuracy: 0.7987
2025-09-24 20:00:27 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:01:30 [INFO]  Epoch 63 loss: 412.85178804397583; train accuracy: 0.8820199275362319; test accuracy: 0.818
2025-09-24 20:01:30 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:02:31 [INFO]  Epoch 64 loss: 422.1105070114136; train accuracy: 0.8799252717391305; test accuracy: 0.8116
2025-09-24 20:02:31 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:02:31 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:02:31 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:02:31 [INFO]  Epoch 60: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:03:20 [INFO]  Epoch 60 loss: 343.5012183189392; train accuracy: 0.8443777901785714; test accuracy: 0.7749
2025-09-24 20:03:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_60.pth
2025-09-24 20:03:21 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:04:13 [INFO]  Epoch 61 loss: 345.8511896133423; train accuracy: 0.8369140625; test accuracy: 0.7708
2025-09-24 20:04:13 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:05:04 [INFO]  Epoch 62 loss: 347.3690857887268; train accuracy: 0.8630719866071429; test accuracy: 0.7873
2025-09-24 20:05:04 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:05:54 [INFO]  Epoch 63 loss: 346.6508297920227; train accuracy: 0.9001813616071429; test accuracy: 0.8248
2025-09-24 20:05:54 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:06:47 [INFO]  Epoch 64 loss: 337.20731925964355; train accuracy: 0.8595145089285714; test accuracy: 0.7937
2025-09-24 20:06:47 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:06:47 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:06:47 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:06:47 [INFO]  Epoch 60: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:07:34 [INFO]  Epoch 60 loss: 326.26398849487305; train accuracy: 0.8308293269230769; test accuracy: 0.766
2025-09-24 20:07:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_60.pth
2025-09-24 20:07:35 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:08:22 [INFO]  Epoch 61 loss: 315.0050296783447; train accuracy: 0.8524263822115384; test accuracy: 0.7931
2025-09-24 20:08:22 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:09:09 [INFO]  Epoch 62 loss: 323.03990268707275; train accuracy: 0.8238807091346154; test accuracy: 0.7578
2025-09-24 20:09:09 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:09:58 [INFO]  Epoch 63 loss: 322.86799812316895; train accuracy: 0.8083683894230769; test accuracy: 0.7483
2025-09-24 20:09:58 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:10:45 [INFO]  Epoch 64 loss: 321.808443069458; train accuracy: 0.8359375; test accuracy: 0.7713
2025-09-24 20:10:45 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:10:45 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:10:45 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:10:45 [INFO]  Epoch 60: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:11:42 [INFO]  Epoch 60 loss: 386.33365297317505; train accuracy: 0.880462646484375; test accuracy: 0.8134
2025-09-24 20:11:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_60.pth
2025-09-24 20:11:43 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:12:41 [INFO]  Epoch 61 loss: 385.7613015174866; train accuracy: 0.86688232421875; test accuracy: 0.7974
2025-09-24 20:12:41 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:40 [INFO]  Epoch 62 loss: 392.78111696243286; train accuracy: 0.85968017578125; test accuracy: 0.7963
2025-09-24 20:13:40 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:14:38 [INFO]  Epoch 63 loss: 388.5751962661743; train accuracy: 0.819671630859375; test accuracy: 0.7594
2025-09-24 20:14:38 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:15:36 [INFO]  Epoch 64 loss: 379.37143182754517; train accuracy: 0.866302490234375; test accuracy: 0.7973
2025-09-24 20:15:36 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:15:36 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:15:36 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:15:36 [INFO]  Epoch 60: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:16:09 [INFO]  Epoch 60 loss: 222.3666410446167; train accuracy: 0.8492745535714286; test accuracy: 0.7762
2025-09-24 20:16:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_60.pth
2025-09-24 20:16:09 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:16:43 [INFO]  Epoch 61 loss: 229.03022003173828; train accuracy: 0.8074776785714286; test accuracy: 0.7411
2025-09-24 20:16:43 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:17:15 [INFO]  Epoch 62 loss: 230.15086841583252; train accuracy: 0.7727120535714286; test accuracy: 0.7061
2025-09-24 20:17:15 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:17:51 [INFO]  Epoch 63 loss: 231.62361574172974; train accuracy: 0.8150111607142857; test accuracy: 0.7428
2025-09-24 20:17:51 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:18:28 [INFO]  Epoch 64 loss: 217.60412454605103; train accuracy: 0.8458705357142857; test accuracy: 0.7588
2025-09-24 20:18:28 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:18:28 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:18:28 [INFO]  Round 12 Finish--------|
2025-09-24 20:18:28 [INFO]  Model variance: mean: 0.006465059705078602, sum: 72240.265625
2025-09-24 20:18:28 [INFO]  g_protos_std: 1.006378173828125
2025-09-24 20:18:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9087
2025-09-24 20:18:34 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:18:34 [INFO]  Round 13 starts--------|
2025-09-24 20:18:34 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:18:34 [INFO]  Epoch 65: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:19:40 [INFO]  Epoch 65 loss: 416.36955547332764; train accuracy: 0.8883322010869565; test accuracy: 0.8204
2025-09-24 20:19:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_65.pth
2025-09-24 20:19:41 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:20:45 [INFO]  Epoch 66 loss: 412.00748443603516; train accuracy: 0.8559499547101449; test accuracy: 0.7992
2025-09-24 20:20:45 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:21:47 [INFO]  Epoch 67 loss: 404.6157841682434; train accuracy: 0.9095052083333334; test accuracy: 0.8367
2025-09-24 20:21:47 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:22:53 [INFO]  Epoch 68 loss: 418.9851760864258; train accuracy: 0.9046365489130435; test accuracy: 0.8321
2025-09-24 20:22:53 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:23:57 [INFO]  Epoch 69 loss: 403.10169744491577; train accuracy: 0.8768399003623188; test accuracy: 0.8097
2025-09-24 20:23:57 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:23:57 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:23:57 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:23:57 [INFO]  Epoch 65: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:24:48 [INFO]  Epoch 65 loss: 334.03525257110596; train accuracy: 0.8512486049107143; test accuracy: 0.7895
2025-09-24 20:24:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_65.pth
2025-09-24 20:24:49 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:25:39 [INFO]  Epoch 66 loss: 336.28162479400635; train accuracy: 0.8890904017857143; test accuracy: 0.8159
2025-09-24 20:25:39 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:26:31 [INFO]  Epoch 67 loss: 337.77295303344727; train accuracy: 0.8783830915178571; test accuracy: 0.801
2025-09-24 20:26:31 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:27:20 [INFO]  Epoch 68 loss: 335.12524127960205; train accuracy: 0.7840401785714286; test accuracy: 0.7139
2025-09-24 20:27:20 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:28:13 [INFO]  Epoch 69 loss: 339.0045471191406; train accuracy: 0.8590262276785714; test accuracy: 0.787
2025-09-24 20:28:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:28:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:28:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:28:13 [INFO]  Epoch 65: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:28:59 [INFO]  Epoch 65 loss: 320.67520809173584; train accuracy: 0.8467548076923077; test accuracy: 0.7801
2025-09-24 20:29:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_65.pth
2025-09-24 20:29:00 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:29:44 [INFO]  Epoch 66 loss: 319.6872420310974; train accuracy: 0.8516000600961539; test accuracy: 0.7823
2025-09-24 20:29:44 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:30:28 [INFO]  Epoch 67 loss: 315.0862126350403; train accuracy: 0.8395057091346154; test accuracy: 0.768
2025-09-24 20:30:28 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:31:16 [INFO]  Epoch 68 loss: 304.1538028717041; train accuracy: 0.8606896033653846; test accuracy: 0.7902
2025-09-24 20:31:16 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:32:06 [INFO]  Epoch 69 loss: 314.7430171966553; train accuracy: 0.7693058894230769; test accuracy: 0.7082
2025-09-24 20:32:06 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:32:06 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:32:06 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:32:06 [INFO]  Epoch 65: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:33:05 [INFO]  Epoch 65 loss: 394.1619300842285; train accuracy: 0.82958984375; test accuracy: 0.7678
2025-09-24 20:33:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_65.pth
2025-09-24 20:33:06 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:34:06 [INFO]  Epoch 66 loss: 381.57068634033203; train accuracy: 0.88470458984375; test accuracy: 0.8127
2025-09-24 20:34:06 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:35:06 [INFO]  Epoch 67 loss: 393.509503364563; train accuracy: 0.90863037109375; test accuracy: 0.8292
2025-09-24 20:35:06 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:36:03 [INFO]  Epoch 68 loss: 374.5101556777954; train accuracy: 0.874053955078125; test accuracy: 0.7978
2025-09-24 20:36:03 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:37:01 [INFO]  Epoch 69 loss: 372.13525342941284; train accuracy: 0.9136962890625; test accuracy: 0.8332
2025-09-24 20:37:01 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:37:01 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:37:01 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:37:01 [INFO]  Epoch 65: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:37:35 [INFO]  Epoch 65 loss: 217.05957221984863; train accuracy: 0.8452008928571428; test accuracy: 0.7652
2025-09-24 20:37:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_65.pth
2025-09-24 20:37:35 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:38:08 [INFO]  Epoch 66 loss: 226.06336164474487; train accuracy: 0.8660714285714286; test accuracy: 0.7819
2025-09-24 20:38:08 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:38:40 [INFO]  Epoch 67 loss: 224.07299709320068; train accuracy: 0.7421875; test accuracy: 0.6801
2025-09-24 20:38:40 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:39:13 [INFO]  Epoch 68 loss: 222.81008625030518; train accuracy: 0.8273995535714286; test accuracy: 0.7478
2025-09-24 20:39:13 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:39:46 [INFO]  Epoch 69 loss: 223.95718097686768; train accuracy: 0.8255022321428571; test accuracy: 0.7423
2025-09-24 20:39:46 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:39:46 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:39:46 [INFO]  Round 13 Finish--------|
2025-09-24 20:39:46 [INFO]  Model variance: mean: 0.006733012851327658, sum: 75234.359375
2025-09-24 20:39:46 [INFO]  g_protos_std: 1.0064696073532104
2025-09-24 20:39:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.909
2025-09-24 20:39:51 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:39:51 [INFO]  Round 14 starts--------|
2025-09-24 20:39:51 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:39:51 [INFO]  Epoch 70: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:40:54 [INFO]  Epoch 70 loss: 413.96749544143677; train accuracy: 0.8937952898550725; test accuracy: 0.8223
2025-09-24 20:40:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_70.pth
2025-09-24 20:40:54 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:41:57 [INFO]  Epoch 71 loss: 406.56737899780273; train accuracy: 0.8744904891304348; test accuracy: 0.8036
2025-09-24 20:41:57 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:43:00 [INFO]  Epoch 72 loss: 408.21598625183105; train accuracy: 0.9274513134057971; test accuracy: 0.8498
2025-09-24 20:43:00 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:44:05 [INFO]  Epoch 73 loss: 404.0084238052368; train accuracy: 0.8915874094202898; test accuracy: 0.8197
2025-09-24 20:44:05 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:45:09 [INFO]  Epoch 74 loss: 402.38386154174805; train accuracy: 0.882218070652174; test accuracy: 0.8085
2025-09-24 20:45:09 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:45:09 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:45:09 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:45:09 [INFO]  Epoch 70: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:46:01 [INFO]  Epoch 70 loss: 334.8075017929077; train accuracy: 0.8646414620535714; test accuracy: 0.7937
2025-09-24 20:46:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_70.pth
2025-09-24 20:46:02 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:46:52 [INFO]  Epoch 71 loss: 346.3225712776184; train accuracy: 0.847900390625; test accuracy: 0.7823
2025-09-24 20:46:52 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:47:41 [INFO]  Epoch 72 loss: 339.2357921600342; train accuracy: 0.816650390625; test accuracy: 0.7534
2025-09-24 20:47:41 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:48:33 [INFO]  Epoch 73 loss: 326.7105989456177; train accuracy: 0.8644670758928571; test accuracy: 0.7859
2025-09-24 20:48:33 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:49:25 [INFO]  Epoch 74 loss: 331.47661781311035; train accuracy: 0.8604910714285714; test accuracy: 0.7879
2025-09-24 20:49:25 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:49:25 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:49:25 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:49:25 [INFO]  Epoch 70: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:50:14 [INFO]  Epoch 70 loss: 315.757333278656; train accuracy: 0.80908203125; test accuracy: 0.7474
2025-09-24 20:50:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_70.pth
2025-09-24 20:50:15 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:51:02 [INFO]  Epoch 71 loss: 312.4498825073242; train accuracy: 0.8529522235576923; test accuracy: 0.7851
2025-09-24 20:51:02 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:51:49 [INFO]  Epoch 72 loss: 314.82482147216797; train accuracy: 0.8366887019230769; test accuracy: 0.7677
2025-09-24 20:51:49 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:52:37 [INFO]  Epoch 73 loss: 318.49164152145386; train accuracy: 0.89013671875; test accuracy: 0.8151
2025-09-24 20:52:37 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:53:25 [INFO]  Epoch 74 loss: 311.0955333709717; train accuracy: 0.8766902043269231; test accuracy: 0.8082
2025-09-24 20:53:25 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:53:25 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:53:25 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:53:25 [INFO]  Epoch 70: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:54:23 [INFO]  Epoch 70 loss: 379.856972694397; train accuracy: 0.864990234375; test accuracy: 0.797
2025-09-24 20:54:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_70.pth
2025-09-24 20:54:24 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:55:23 [INFO]  Epoch 71 loss: 382.6178002357483; train accuracy: 0.912109375; test accuracy: 0.8353
2025-09-24 20:55:23 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:56:23 [INFO]  Epoch 72 loss: 387.1689682006836; train accuracy: 0.855865478515625; test accuracy: 0.7864
2025-09-24 20:56:23 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:22 [INFO]  Epoch 73 loss: 376.70689582824707; train accuracy: 0.8631591796875; test accuracy: 0.7914
2025-09-24 20:57:22 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:58:20 [INFO]  Epoch 74 loss: 388.77246856689453; train accuracy: 0.8521728515625; test accuracy: 0.7838
2025-09-24 20:58:20 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:58:20 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:58:20 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:58:20 [INFO]  Epoch 70: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:58:52 [INFO]  Epoch 70 loss: 213.05561208724976; train accuracy: 0.8510044642857143; test accuracy: 0.7676
2025-09-24 20:58:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_70.pth
2025-09-24 20:58:53 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:59:26 [INFO]  Epoch 71 loss: 220.0143690109253; train accuracy: 0.855859375; test accuracy: 0.7717
2025-09-24 20:59:26 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:59:59 [INFO]  Epoch 72 loss: 224.06238985061646; train accuracy: 0.7989955357142857; test accuracy: 0.7273
2025-09-24 20:59:59 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:00:31 [INFO]  Epoch 73 loss: 218.23262071609497; train accuracy: 0.8215959821428571; test accuracy: 0.7465
2025-09-24 21:00:31 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:01:05 [INFO]  Epoch 74 loss: 218.097806930542; train accuracy: 0.7845424107142858; test accuracy: 0.7075
2025-09-24 21:01:05 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:01:05 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:01:05 [INFO]  Round 14 Finish--------|
2025-09-24 21:01:05 [INFO]  Model variance: mean: 0.006988177075982094, sum: 78085.5546875
2025-09-24 21:01:05 [INFO]  g_protos_std: 1.0065382719039917
2025-09-24 21:01:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.911
2025-09-24 21:01:11 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:01:11 [INFO]  Round 15 starts--------|
2025-09-24 21:01:11 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:01:11 [INFO]  Epoch 75: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:02:13 [INFO]  Epoch 75 loss: 400.1571054458618; train accuracy: 0.9134963768115942; test accuracy: 0.8368
2025-09-24 21:02:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_75.pth
2025-09-24 21:02:13 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:03:14 [INFO]  Epoch 76 loss: 401.3599429130554; train accuracy: 0.912307518115942; test accuracy: 0.835
2025-09-24 21:03:14 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:04:15 [INFO]  Epoch 77 loss: 385.00419521331787; train accuracy: 0.9054008152173914; test accuracy: 0.8289
2025-09-24 21:04:15 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:05:16 [INFO]  Epoch 78 loss: 397.656325340271; train accuracy: 0.8690557065217391; test accuracy: 0.8015
2025-09-24 21:05:16 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:06:17 [INFO]  Epoch 79 loss: 398.1565980911255; train accuracy: 0.9053158967391305; test accuracy: 0.83
2025-09-24 21:06:17 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:06:17 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:06:17 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:06:17 [INFO]  Epoch 75: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:07:05 [INFO]  Epoch 75 loss: 339.66723012924194; train accuracy: 0.8562360491071429; test accuracy: 0.7909
2025-09-24 21:07:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_75.pth
2025-09-24 21:07:05 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:07:57 [INFO]  Epoch 76 loss: 342.0002827644348; train accuracy: 0.8857073102678571; test accuracy: 0.8082
2025-09-24 21:07:57 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:08:48 [INFO]  Epoch 77 loss: 339.3833632469177; train accuracy: 0.9002859933035714; test accuracy: 0.8179
2025-09-24 21:08:48 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:09:39 [INFO]  Epoch 78 loss: 332.88885974884033; train accuracy: 0.8766741071428571; test accuracy: 0.7998
2025-09-24 21:09:39 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:10:30 [INFO]  Epoch 79 loss: 335.67834663391113; train accuracy: 0.9187709263392857; test accuracy: 0.8301
2025-09-24 21:10:30 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:10:30 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:10:30 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:10:30 [INFO]  Epoch 75: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:11:16 [INFO]  Epoch 75 loss: 315.6987028121948; train accuracy: 0.8561448317307693; test accuracy: 0.7881
2025-09-24 21:11:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_75.pth
2025-09-24 21:11:17 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:12:06 [INFO]  Epoch 76 loss: 312.6763939857483; train accuracy: 0.8830754206730769; test accuracy: 0.8059
2025-09-24 21:12:06 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:12:54 [INFO]  Epoch 77 loss: 312.2603368759155; train accuracy: 0.8822490985576923; test accuracy: 0.8055
2025-09-24 21:12:54 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:13:41 [INFO]  Epoch 78 loss: 302.412296295166; train accuracy: 0.90771484375; test accuracy: 0.8273
2025-09-24 21:13:41 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:14:26 [INFO]  Epoch 79 loss: 311.1541862487793; train accuracy: 0.8954326923076923; test accuracy: 0.8136
2025-09-24 21:14:26 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:14:26 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:14:26 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:14:27 [INFO]  Epoch 75: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:15:24 [INFO]  Epoch 75 loss: 379.40193223953247; train accuracy: 0.862945556640625; test accuracy: 0.7941
2025-09-24 21:15:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_75.pth
2025-09-24 21:15:25 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:16:22 [INFO]  Epoch 76 loss: 378.3329772949219; train accuracy: 0.9296875; test accuracy: 0.8484
2025-09-24 21:16:22 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:17:18 [INFO]  Epoch 77 loss: 376.04692697525024; train accuracy: 0.89031982421875; test accuracy: 0.8127
2025-09-24 21:17:18 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:18:16 [INFO]  Epoch 78 loss: 379.82548332214355; train accuracy: 0.898345947265625; test accuracy: 0.8211
2025-09-24 21:18:16 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:19:14 [INFO]  Epoch 79 loss: 375.7849311828613; train accuracy: 0.868927001953125; test accuracy: 0.7925
2025-09-24 21:19:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:19:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:19:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:19:14 [INFO]  Epoch 75: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:19:47 [INFO]  Epoch 75 loss: 222.26573991775513; train accuracy: 0.828125; test accuracy: 0.7442
2025-09-24 21:19:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_75.pth
2025-09-24 21:19:48 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:20:21 [INFO]  Epoch 76 loss: 219.57763957977295; train accuracy: 0.8638950892857142; test accuracy: 0.7746
2025-09-24 21:20:21 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:20:56 [INFO]  Epoch 77 loss: 217.33035707473755; train accuracy: 0.8482142857142857; test accuracy: 0.7608
2025-09-24 21:20:56 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:21:29 [INFO]  Epoch 78 loss: 222.45169925689697; train accuracy: 0.8407924107142857; test accuracy: 0.756
2025-09-24 21:21:29 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:22:02 [INFO]  Epoch 79 loss: 212.4629921913147; train accuracy: 0.8194754464285714; test accuracy: 0.7413
2025-09-24 21:22:02 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:22:02 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:22:02 [INFO]  Round 15 Finish--------|
2025-09-24 21:22:02 [INFO]  Model variance: mean: 0.007235885597765446, sum: 80853.4375
2025-09-24 21:22:02 [INFO]  g_protos_std: 1.0066184997558594
2025-09-24 21:22:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9143
2025-09-24 21:22:08 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:22:08 [INFO]  Round 16 starts--------|
2025-09-24 21:22:08 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:22:08 [INFO]  Epoch 80: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:23:11 [INFO]  Epoch 80 loss: 402.52683305740356; train accuracy: 0.9233186141304348; test accuracy: 0.8419
2025-09-24 21:23:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_80.pth
2025-09-24 21:23:12 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:24:15 [INFO]  Epoch 81 loss: 397.7262177467346; train accuracy: 0.8998245018115942; test accuracy: 0.8332
2025-09-24 21:24:15 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:25:16 [INFO]  Epoch 82 loss: 399.93690252304077; train accuracy: 0.9159307065217391; test accuracy: 0.8373
2025-09-24 21:25:16 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:26:19 [INFO]  Epoch 83 loss: 399.79453802108765; train accuracy: 0.9202898550724637; test accuracy: 0.8452
2025-09-24 21:26:19 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:27:22 [INFO]  Epoch 84 loss: 401.1736493110657; train accuracy: 0.9185348731884058; test accuracy: 0.842
2025-09-24 21:27:22 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:27:22 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:27:22 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:27:22 [INFO]  Epoch 80: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:28:09 [INFO]  Epoch 80 loss: 327.2355489730835; train accuracy: 0.860595703125; test accuracy: 0.7792
2025-09-24 21:28:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_80.pth
2025-09-24 21:28:09 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:28:57 [INFO]  Epoch 81 loss: 325.68582344055176; train accuracy: 0.9099818638392857; test accuracy: 0.8245
2025-09-24 21:28:57 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:29:48 [INFO]  Epoch 82 loss: 324.29228925704956; train accuracy: 0.90283203125; test accuracy: 0.8182
2025-09-24 21:29:48 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:30:40 [INFO]  Epoch 83 loss: 331.06862783432007; train accuracy: 0.8342982700892857; test accuracy: 0.7633
2025-09-24 21:30:40 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:31:30 [INFO]  Epoch 84 loss: 324.72200441360474; train accuracy: 0.8798828125; test accuracy: 0.7957
2025-09-24 21:31:30 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:31:30 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:31:30 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:31:30 [INFO]  Epoch 80: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:32:18 [INFO]  Epoch 80 loss: 312.33197832107544; train accuracy: 0.9062875600961539; test accuracy: 0.8218
2025-09-24 21:32:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_80.pth
2025-09-24 21:32:19 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:33:07 [INFO]  Epoch 81 loss: 309.6393213272095; train accuracy: 0.8645958533653846; test accuracy: 0.7877
2025-09-24 21:33:07 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:33:53 [INFO]  Epoch 82 loss: 302.71594619750977; train accuracy: 0.8887094350961539; test accuracy: 0.8086
2025-09-24 21:33:53 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:34:42 [INFO]  Epoch 83 loss: 304.52564668655396; train accuracy: 0.8509990985576923; test accuracy: 0.7796
2025-09-24 21:34:42 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:35:28 [INFO]  Epoch 84 loss: 309.5079369544983; train accuracy: 0.8825871394230769; test accuracy: 0.8009
2025-09-24 21:35:28 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:35:28 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:35:28 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:35:28 [INFO]  Epoch 80: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:36:28 [INFO]  Epoch 80 loss: 366.5762915611267; train accuracy: 0.911651611328125; test accuracy: 0.8283
2025-09-24 21:36:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_80.pth
2025-09-24 21:36:28 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:37:27 [INFO]  Epoch 81 loss: 370.0414400100708; train accuracy: 0.881500244140625; test accuracy: 0.8054
2025-09-24 21:37:27 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:38:24 [INFO]  Epoch 82 loss: 363.3040361404419; train accuracy: 0.92852783203125; test accuracy: 0.8395
2025-09-24 21:38:24 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:39:22 [INFO]  Epoch 83 loss: 372.805947303772; train accuracy: 0.9014892578125; test accuracy: 0.8155
2025-09-24 21:39:22 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:40:24 [INFO]  Epoch 84 loss: 371.1230220794678; train accuracy: 0.9075927734375; test accuracy: 0.8188
2025-09-24 21:40:24 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:40:24 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:40:24 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:40:24 [INFO]  Epoch 80: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:40:58 [INFO]  Epoch 80 loss: 200.62219524383545; train accuracy: 0.8571428571428571; test accuracy: 0.7641
2025-09-24 21:40:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_80.pth
2025-09-24 21:40:59 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:41:33 [INFO]  Epoch 81 loss: 219.53354263305664; train accuracy: 0.851171875; test accuracy: 0.7575
2025-09-24 21:41:33 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:42:07 [INFO]  Epoch 82 loss: 219.77988719940186; train accuracy: 0.8491071428571428; test accuracy: 0.762
2025-09-24 21:42:07 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:42:41 [INFO]  Epoch 83 loss: 221.6200680732727; train accuracy: 0.84375; test accuracy: 0.7605
2025-09-24 21:42:41 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:43:14 [INFO]  Epoch 84 loss: 214.2504415512085; train accuracy: 0.8536830357142857; test accuracy: 0.7644
2025-09-24 21:43:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:43:14 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:43:14 [INFO]  Round 16 Finish--------|
2025-09-24 21:43:14 [INFO]  Model variance: mean: 0.0074764140881598, sum: 83541.09375
2025-09-24 21:43:14 [INFO]  g_protos_std: 1.0067120790481567
2025-09-24 21:43:20 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9128
2025-09-24 21:43:20 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:43:20 [INFO]  Round 17 starts--------|
2025-09-24 21:43:20 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:43:20 [INFO]  Epoch 85: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:44:24 [INFO]  Epoch 85 loss: 399.8891644477844; train accuracy: 0.916411911231884; test accuracy: 0.8427
2025-09-24 21:44:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_85.pth
2025-09-24 21:44:24 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:45:27 [INFO]  Epoch 86 loss: 398.9957036972046; train accuracy: 0.9248754528985508; test accuracy: 0.8456
2025-09-24 21:45:27 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:46:31 [INFO]  Epoch 87 loss: 401.9638419151306; train accuracy: 0.8885303442028986; test accuracy: 0.8157
2025-09-24 21:46:31 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:47:35 [INFO]  Epoch 88 loss: 392.818076133728; train accuracy: 0.9144870923913043; test accuracy: 0.8383
2025-09-24 21:47:35 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:48:39 [INFO]  Epoch 89 loss: 403.73021602630615; train accuracy: 0.8900871829710145; test accuracy: 0.8126
2025-09-24 21:48:39 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:48:39 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:48:39 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:48:39 [INFO]  Epoch 85: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:49:29 [INFO]  Epoch 85 loss: 327.37450885772705; train accuracy: 0.8760114397321429; test accuracy: 0.7994
2025-09-24 21:49:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_85.pth
2025-09-24 21:49:29 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:50:22 [INFO]  Epoch 86 loss: 335.5264072418213; train accuracy: 0.9219098772321429; test accuracy: 0.8362
2025-09-24 21:50:22 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:51:12 [INFO]  Epoch 87 loss: 334.3174834251404; train accuracy: 0.8919154575892857; test accuracy: 0.8035
2025-09-24 21:51:12 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:52:02 [INFO]  Epoch 88 loss: 320.9416151046753; train accuracy: 0.9083775111607143; test accuracy: 0.8199
2025-09-24 21:52:02 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:52:53 [INFO]  Epoch 89 loss: 324.96421098709106; train accuracy: 0.9105747767857143; test accuracy: 0.8218
2025-09-24 21:52:53 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:52:53 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:52:53 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:52:53 [INFO]  Epoch 85: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:53:42 [INFO]  Epoch 85 loss: 297.1704611778259; train accuracy: 0.9025691105769231; test accuracy: 0.8128
2025-09-24 21:53:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_85.pth
2025-09-24 21:53:43 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:54:30 [INFO]  Epoch 86 loss: 317.4559144973755; train accuracy: 0.8684269831730769; test accuracy: 0.7936
2025-09-24 21:54:30 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:55:17 [INFO]  Epoch 87 loss: 300.6515107154846; train accuracy: 0.9112454927884616; test accuracy: 0.8256
2025-09-24 21:55:17 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:56:04 [INFO]  Epoch 88 loss: 310.1785306930542; train accuracy: 0.9007286658653846; test accuracy: 0.8159
2025-09-24 21:56:04 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:56:49 [INFO]  Epoch 89 loss: 304.87375688552856; train accuracy: 0.8819486177884616; test accuracy: 0.7985
2025-09-24 21:56:49 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:56:49 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:56:49 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:56:49 [INFO]  Epoch 85: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:57:46 [INFO]  Epoch 85 loss: 379.5102915763855; train accuracy: 0.8914794921875; test accuracy: 0.8166
2025-09-24 21:57:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_85.pth
2025-09-24 21:57:47 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:58:48 [INFO]  Epoch 86 loss: 360.52111196517944; train accuracy: 0.9044189453125; test accuracy: 0.824
2025-09-24 21:58:48 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:59:45 [INFO]  Epoch 87 loss: 365.1619725227356; train accuracy: 0.919158935546875; test accuracy: 0.8365
2025-09-24 21:59:45 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:00:44 [INFO]  Epoch 88 loss: 359.1448702812195; train accuracy: 0.8919677734375; test accuracy: 0.8125
2025-09-24 22:00:44 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:01:43 [INFO]  Epoch 89 loss: 359.38048553466797; train accuracy: 0.88909912109375; test accuracy: 0.8077
2025-09-24 22:01:43 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:01:43 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:01:43 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:01:43 [INFO]  Epoch 85: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:02:17 [INFO]  Epoch 85 loss: 213.03939199447632; train accuracy: 0.8768973214285715; test accuracy: 0.7779
2025-09-24 22:02:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_85.pth
2025-09-24 22:02:18 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:02:53 [INFO]  Epoch 86 loss: 225.40374422073364; train accuracy: 0.8469866071428571; test accuracy: 0.7628
2025-09-24 22:02:53 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:03:25 [INFO]  Epoch 87 loss: 211.18642473220825; train accuracy: 0.8584821428571429; test accuracy: 0.7638
2025-09-24 22:03:25 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:03:59 [INFO]  Epoch 88 loss: 213.5947299003601; train accuracy: 0.7953125; test accuracy: 0.7094
2025-09-24 22:03:59 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:04:34 [INFO]  Epoch 89 loss: 209.47754430770874; train accuracy: 0.8430245535714286; test accuracy: 0.7541
2025-09-24 22:04:34 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:04:34 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:04:34 [INFO]  Round 17 Finish--------|
2025-09-24 22:04:34 [INFO]  Model variance: mean: 0.007708114106208086, sum: 86130.09375
2025-09-24 22:04:34 [INFO]  g_protos_std: 1.0067869424819946
2025-09-24 22:04:39 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9173
2025-09-24 22:04:39 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:04:39 [INFO]  Round 18 starts--------|
2025-09-24 22:04:39 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:04:39 [INFO]  Epoch 90: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:05:41 [INFO]  Epoch 90 loss: 390.580361366272; train accuracy: 0.9391417572463768; test accuracy: 0.8564
2025-09-24 22:05:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_90.pth
2025-09-24 22:05:42 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:06:43 [INFO]  Epoch 91 loss: 396.1907591819763; train accuracy: 0.9111752717391305; test accuracy: 0.8313
2025-09-24 22:06:43 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:07:45 [INFO]  Epoch 92 loss: 391.8794231414795; train accuracy: 0.9036175271739131; test accuracy: 0.8236
2025-09-24 22:07:45 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:08:48 [INFO]  Epoch 93 loss: 392.3293375968933; train accuracy: 0.9114583333333334; test accuracy: 0.8306
2025-09-24 22:08:48 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:47 [INFO]  Epoch 94 loss: 390.87855863571167; train accuracy: 0.9237432065217391; test accuracy: 0.8433
2025-09-24 22:09:47 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:09:47 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:09:47 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:09:47 [INFO]  Epoch 90: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:10:39 [INFO]  Epoch 90 loss: 331.44802951812744; train accuracy: 0.8736049107142857; test accuracy: 0.7954
2025-09-24 22:10:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_90.pth
2025-09-24 22:10:39 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:11:29 [INFO]  Epoch 91 loss: 320.87995767593384; train accuracy: 0.9052734375; test accuracy: 0.818
2025-09-24 22:11:29 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:12:21 [INFO]  Epoch 92 loss: 317.6872854232788; train accuracy: 0.9177594866071429; test accuracy: 0.8283
2025-09-24 22:12:21 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:13:13 [INFO]  Epoch 93 loss: 322.59051609039307; train accuracy: 0.8904157366071429; test accuracy: 0.8067
2025-09-24 22:13:13 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:14:03 [INFO]  Epoch 94 loss: 312.2952013015747; train accuracy: 0.9099818638392857; test accuracy: 0.8244
2025-09-24 22:14:03 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:14:03 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:14:03 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:14:03 [INFO]  Epoch 90: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:14:49 [INFO]  Epoch 90 loss: 312.8702073097229; train accuracy: 0.89404296875; test accuracy: 0.8095
2025-09-24 22:14:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_90.pth
2025-09-24 22:14:49 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:15:38 [INFO]  Epoch 91 loss: 298.4504818916321; train accuracy: 0.8965219350961539; test accuracy: 0.8146
2025-09-24 22:15:38 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:16:27 [INFO]  Epoch 92 loss: 305.22440099716187; train accuracy: 0.8900991586538461; test accuracy: 0.8087
2025-09-24 22:16:27 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:17:14 [INFO]  Epoch 93 loss: 293.5189003944397; train accuracy: 0.9137995793269231; test accuracy: 0.8235
2025-09-24 22:17:14 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:18:01 [INFO]  Epoch 94 loss: 302.605215549469; train accuracy: 0.8710561899038461; test accuracy: 0.7851
2025-09-24 22:18:01 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:18:01 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:18:01 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:18:01 [INFO]  Epoch 90: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:18:59 [INFO]  Epoch 90 loss: 364.27722930908203; train accuracy: 0.901611328125; test accuracy: 0.8158
2025-09-24 22:19:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_90.pth
2025-09-24 22:19:00 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:19:56 [INFO]  Epoch 91 loss: 370.9726324081421; train accuracy: 0.912261962890625; test accuracy: 0.8282
2025-09-24 22:19:56 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:20:53 [INFO]  Epoch 92 loss: 365.58310317993164; train accuracy: 0.895233154296875; test accuracy: 0.812
2025-09-24 22:20:53 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:21:50 [INFO]  Epoch 93 loss: 368.6102933883667; train accuracy: 0.9400634765625; test accuracy: 0.8427
2025-09-24 22:21:50 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:22:50 [INFO]  Epoch 94 loss: 366.2070646286011; train accuracy: 0.92742919921875; test accuracy: 0.8378
2025-09-24 22:22:50 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:22:50 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:22:50 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:22:50 [INFO]  Epoch 90: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:23:21 [INFO]  Epoch 90 loss: 220.35095882415771; train accuracy: 0.8774553571428572; test accuracy: 0.7782
2025-09-24 22:23:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_90.pth
2025-09-24 22:23:22 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:23:54 [INFO]  Epoch 91 loss: 212.37302207946777; train accuracy: 0.8400669642857143; test accuracy: 0.7518
2025-09-24 22:23:54 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:24:27 [INFO]  Epoch 92 loss: 213.36875677108765; train accuracy: 0.81015625; test accuracy: 0.7177
2025-09-24 22:24:27 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:24:59 [INFO]  Epoch 93 loss: 207.85289573669434; train accuracy: 0.8904575892857143; test accuracy: 0.7883
2025-09-24 22:24:59 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:25:31 [INFO]  Epoch 94 loss: 211.5188865661621; train accuracy: 0.8861049107142858; test accuracy: 0.784
2025-09-24 22:25:31 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:25:31 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:25:31 [INFO]  Round 18 Finish--------|
2025-09-24 22:25:32 [INFO]  Model variance: mean: 0.007934937253594398, sum: 88664.609375
2025-09-24 22:25:32 [INFO]  g_protos_std: 1.0068778991699219
2025-09-24 22:25:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9176
2025-09-24 22:25:37 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:25:37 [INFO]  Round 19 starts--------|
2025-09-24 22:25:37 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:25:37 [INFO]  Epoch 95: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:26:36 [INFO]  Epoch 95 loss: 384.9857769012451; train accuracy: 0.9071274909420289; test accuracy: 0.8281
2025-09-24 22:26:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_95.pth
2025-09-24 22:26:36 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:27:38 [INFO]  Epoch 96 loss: 397.4213514328003; train accuracy: 0.9124490489130435; test accuracy: 0.8313
2025-09-24 22:27:38 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:28:39 [INFO]  Epoch 97 loss: 393.02180433273315; train accuracy: 0.9043251811594203; test accuracy: 0.8287
2025-09-24 22:28:39 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:29:39 [INFO]  Epoch 98 loss: 389.92546701431274; train accuracy: 0.9293195199275363; test accuracy: 0.8497
2025-09-24 22:29:39 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:30:41 [INFO]  Epoch 99 loss: 394.08752822875977; train accuracy: 0.920318161231884; test accuracy: 0.8454
2025-09-24 22:30:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:30:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:30:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:30:41 [INFO]  Epoch 95: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:31:30 [INFO]  Epoch 95 loss: 327.8194489479065; train accuracy: 0.9101213727678571; test accuracy: 0.8213
2025-09-24 22:31:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_95.pth
2025-09-24 22:31:31 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:32:18 [INFO]  Epoch 96 loss: 319.6484341621399; train accuracy: 0.93603515625; test accuracy: 0.8374
2025-09-24 22:32:18 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:33:06 [INFO]  Epoch 97 loss: 312.36808490753174; train accuracy: 0.9426967075892857; test accuracy: 0.8492
2025-09-24 22:33:06 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:33:55 [INFO]  Epoch 98 loss: 324.6988272666931; train accuracy: 0.914306640625; test accuracy: 0.8216
2025-09-24 22:33:55 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:34:41 [INFO]  Epoch 99 loss: 325.3645706176758; train accuracy: 0.9270368303571429; test accuracy: 0.8347
2025-09-24 22:34:41 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:34:41 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:34:41 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:34:41 [INFO]  Epoch 95: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:35:25 [INFO]  Epoch 95 loss: 302.68064975738525; train accuracy: 0.8757512019230769; test accuracy: 0.7933
2025-09-24 22:35:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_95.pth
2025-09-24 22:35:26 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:36:12 [INFO]  Epoch 96 loss: 302.56495237350464; train accuracy: 0.8858548677884616; test accuracy: 0.7929
2025-09-24 22:36:12 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:36:56 [INFO]  Epoch 97 loss: 291.04783296585083; train accuracy: 0.8851787860576923; test accuracy: 0.8031
2025-09-24 22:36:56 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:37:41 [INFO]  Epoch 98 loss: 296.1670160293579; train accuracy: 0.8955078125; test accuracy: 0.8144
2025-09-24 22:37:41 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:38:28 [INFO]  Epoch 99 loss: 289.84360694885254; train accuracy: 0.9278470552884616; test accuracy: 0.8312
2025-09-24 22:38:28 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:38:28 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:38:28 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:38:28 [INFO]  Epoch 95: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:39:29 [INFO]  Epoch 95 loss: 377.104612827301; train accuracy: 0.93292236328125; test accuracy: 0.8448
2025-09-24 22:39:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_95.pth
2025-09-24 22:39:29 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:40:28 [INFO]  Epoch 96 loss: 360.31205701828003; train accuracy: 0.896240234375; test accuracy: 0.8151
2025-09-24 22:40:28 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:41:24 [INFO]  Epoch 97 loss: 362.4527859687805; train accuracy: 0.924713134765625; test accuracy: 0.8392
2025-09-24 22:41:24 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:42:22 [INFO]  Epoch 98 loss: 363.30994176864624; train accuracy: 0.910430908203125; test accuracy: 0.8209
2025-09-24 22:42:22 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:43:18 [INFO]  Epoch 99 loss: 355.35249757766724; train accuracy: 0.930084228515625; test accuracy: 0.8426
2025-09-24 22:43:18 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:43:18 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:43:18 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:43:18 [INFO]  Epoch 95: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:43:50 [INFO]  Epoch 95 loss: 206.84077835083008; train accuracy: 0.80703125; test accuracy: 0.7239
2025-09-24 22:43:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_95.pth
2025-09-24 22:43:51 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:44:23 [INFO]  Epoch 96 loss: 211.16566801071167; train accuracy: 0.7904575892857143; test accuracy: 0.7097
2025-09-24 22:44:23 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:44:54 [INFO]  Epoch 97 loss: 210.85163688659668; train accuracy: 0.8409040178571429; test accuracy: 0.7457
2025-09-24 22:44:54 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:45:24 [INFO]  Epoch 98 loss: 217.54463052749634; train accuracy: 0.8497767857142857; test accuracy: 0.7547
2025-09-24 22:45:24 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:45:55 [INFO]  Epoch 99 loss: 199.06969451904297; train accuracy: 0.9001674107142857; test accuracy: 0.7907
2025-09-24 22:45:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:45:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:45:55 [INFO]  Round 19 Finish--------|
2025-09-24 22:45:55 [INFO]  Model variance: mean: 0.00815522950142622, sum: 91126.140625
2025-09-24 22:45:55 [INFO]  g_protos_std: 1.0069681406021118
2025-09-24 22:46:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9183
2025-09-24 22:46:01 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:46:01 [INFO]  Round 20 starts--------|
2025-09-24 22:46:01 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:46:01 [INFO]  Epoch 100: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:47:03 [INFO]  Epoch 100 loss: 396.0434856414795; train accuracy: 0.9270550271739131; test accuracy: 0.839
2025-09-24 22:47:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_100.pth
2025-09-24 22:47:03 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:48:07 [INFO]  Epoch 101 loss: 397.4193468093872; train accuracy: 0.9204313858695652; test accuracy: 0.8397
2025-09-24 22:48:07 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:49:09 [INFO]  Epoch 102 loss: 389.78263092041016; train accuracy: 0.9350656702898551; test accuracy: 0.8506
2025-09-24 22:49:09 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:50:09 [INFO]  Epoch 103 loss: 392.0541076660156; train accuracy: 0.9022022192028986; test accuracy: 0.8233
2025-09-24 22:50:09 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:51:08 [INFO]  Epoch 104 loss: 385.4574017524719; train accuracy: 0.9149399909420289; test accuracy: 0.8312
2025-09-24 22:51:08 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:51:08 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:51:08 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:51:08 [INFO]  Epoch 100: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:51:58 [INFO]  Epoch 100 loss: 313.92275285720825; train accuracy: 0.86328125; test accuracy: 0.7789
2025-09-24 22:51:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_100.pth
2025-09-24 22:51:59 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:50 [INFO]  Epoch 101 loss: 321.3932075500488; train accuracy: 0.9193638392857143; test accuracy: 0.826
2025-09-24 22:52:50 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:53:40 [INFO]  Epoch 102 loss: 319.29145765304565; train accuracy: 0.9073660714285714; test accuracy: 0.8186
2025-09-24 22:53:40 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:54:31 [INFO]  Epoch 103 loss: 311.59228229522705; train accuracy: 0.9360002790178571; test accuracy: 0.8411
2025-09-24 22:54:31 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:55:20 [INFO]  Epoch 104 loss: 316.94044971466064; train accuracy: 0.8992047991071429; test accuracy: 0.8171
2025-09-24 22:55:20 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:55:20 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:55:20 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:55:20 [INFO]  Epoch 100: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:56:08 [INFO]  Epoch 100 loss: 291.69734477996826; train accuracy: 0.9137620192307693; test accuracy: 0.8152
2025-09-24 22:56:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_100.pth
2025-09-24 22:56:08 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:56:57 [INFO]  Epoch 101 loss: 299.4658942222595; train accuracy: 0.8656475360576923; test accuracy: 0.7781
2025-09-24 22:56:57 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:57:47 [INFO]  Epoch 102 loss: 299.93497610092163; train accuracy: 0.8697791466346154; test accuracy: 0.7868
2025-09-24 22:57:47 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:58:35 [INFO]  Epoch 103 loss: 305.9341721534729; train accuracy: 0.9150766225961539; test accuracy: 0.8204
2025-09-24 22:58:35 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:59:24 [INFO]  Epoch 104 loss: 306.71921396255493; train accuracy: 0.9173302283653846; test accuracy: 0.8176
2025-09-24 22:59:24 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:59:24 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:59:24 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:59:24 [INFO]  Epoch 100: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:00:21 [INFO]  Epoch 100 loss: 374.64567518234253; train accuracy: 0.913238525390625; test accuracy: 0.82
2025-09-24 23:00:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_100.pth
2025-09-24 23:00:21 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:01:18 [INFO]  Epoch 101 loss: 359.32617235183716; train accuracy: 0.92364501953125; test accuracy: 0.8332
2025-09-24 23:01:18 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:02:17 [INFO]  Epoch 102 loss: 375.86811447143555; train accuracy: 0.881072998046875; test accuracy: 0.8031
2025-09-24 23:02:17 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:03:14 [INFO]  Epoch 103 loss: 357.83400201797485; train accuracy: 0.92755126953125; test accuracy: 0.8358
2025-09-24 23:03:14 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:04:12 [INFO]  Epoch 104 loss: 360.1951470375061; train accuracy: 0.936920166015625; test accuracy: 0.8483
2025-09-24 23:04:12 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:04:12 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:04:12 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:04:12 [INFO]  Epoch 100: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:04:45 [INFO]  Epoch 100 loss: 204.0820837020874; train accuracy: 0.89453125; test accuracy: 0.7868
2025-09-24 23:04:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_100.pth
2025-09-24 23:04:46 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:05:19 [INFO]  Epoch 101 loss: 201.03851509094238; train accuracy: 0.9196986607142857; test accuracy: 0.8059
2025-09-24 23:05:19 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:05:51 [INFO]  Epoch 102 loss: 207.97623014450073; train accuracy: 0.8983816964285715; test accuracy: 0.7873
2025-09-24 23:05:51 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:06:23 [INFO]  Epoch 103 loss: 212.52980756759644; train accuracy: 0.8559709821428572; test accuracy: 0.7597
2025-09-24 23:06:23 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:06:56 [INFO]  Epoch 104 loss: 206.62493467330933; train accuracy: 0.9040178571428571; test accuracy: 0.795
2025-09-24 23:06:56 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:06:56 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:06:56 [INFO]  Round 20 Finish--------|
2025-09-24 23:06:56 [INFO]  Model variance: mean: 0.008367870934307575, sum: 93502.1875
2025-09-24 23:06:56 [INFO]  g_protos_std: 1.0070363283157349
2025-09-24 23:07:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9231
2025-09-24 23:07:02 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:07:02 [INFO]  Round 21 starts--------|
2025-09-24 23:07:02 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:07:02 [INFO]  Epoch 105: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:08:05 [INFO]  Epoch 105 loss: 389.2696967124939; train accuracy: 0.9142889492753623; test accuracy: 0.835
2025-09-24 23:08:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_105.pth
2025-09-24 23:08:05 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:09:07 [INFO]  Epoch 106 loss: 400.7729277610779; train accuracy: 0.9205729166666666; test accuracy: 0.8385
2025-09-24 23:09:07 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:10:08 [INFO]  Epoch 107 loss: 383.9998445510864; train accuracy: 0.9309046648550725; test accuracy: 0.8535
2025-09-24 23:10:08 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:11:07 [INFO]  Epoch 108 loss: 383.2898554801941; train accuracy: 0.9216485507246377; test accuracy: 0.8384
2025-09-24 23:11:07 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:12:09 [INFO]  Epoch 109 loss: 387.8947739601135; train accuracy: 0.9290647644927537; test accuracy: 0.8456
2025-09-24 23:12:09 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:12:09 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:12:09 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:12:09 [INFO]  Epoch 105: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:12:59 [INFO]  Epoch 105 loss: 317.6341257095337; train accuracy: 0.8862653459821429; test accuracy: 0.8035
2025-09-24 23:12:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_105.pth
2025-09-24 23:12:59 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:13:51 [INFO]  Epoch 106 loss: 324.70998764038086; train accuracy: 0.8670828683035714; test accuracy: 0.7772
2025-09-24 23:13:51 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:14:38 [INFO]  Epoch 107 loss: 330.5746455192566; train accuracy: 0.9124581473214286; test accuracy: 0.8155
2025-09-24 23:14:38 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:15:28 [INFO]  Epoch 108 loss: 317.1316418647766; train accuracy: 0.897216796875; test accuracy: 0.813
2025-09-24 23:15:28 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:16:19 [INFO]  Epoch 109 loss: 319.0907998085022; train accuracy: 0.9168178013392857; test accuracy: 0.8169
2025-09-24 23:16:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:16:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:16:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:16:19 [INFO]  Epoch 105: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:17:06 [INFO]  Epoch 105 loss: 310.66571855545044; train accuracy: 0.8822866586538461; test accuracy: 0.7967
2025-09-24 23:17:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_105.pth
2025-09-24 23:17:06 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:17:53 [INFO]  Epoch 106 loss: 296.97867727279663; train accuracy: 0.8971228966346154; test accuracy: 0.8048
2025-09-24 23:17:53 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:18:40 [INFO]  Epoch 107 loss: 292.92967319488525; train accuracy: 0.9073016826923077; test accuracy: 0.8192
2025-09-24 23:18:40 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:19:27 [INFO]  Epoch 108 loss: 295.66137409210205; train accuracy: 0.8793569711538461; test accuracy: 0.796
2025-09-24 23:19:27 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:20:14 [INFO]  Epoch 109 loss: 296.4363327026367; train accuracy: 0.8799579326923077; test accuracy: 0.7966
2025-09-24 23:20:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:20:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:20:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:20:14 [INFO]  Epoch 105: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:21:13 [INFO]  Epoch 105 loss: 367.7288107872009; train accuracy: 0.882965087890625; test accuracy: 0.8002
2025-09-24 23:21:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_105.pth
2025-09-24 23:21:13 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:22:11 [INFO]  Epoch 106 loss: 353.4503240585327; train accuracy: 0.91802978515625; test accuracy: 0.8245
2025-09-24 23:22:11 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:23:10 [INFO]  Epoch 107 loss: 364.4578366279602; train accuracy: 0.919769287109375; test accuracy: 0.8325
2025-09-24 23:23:10 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:24:07 [INFO]  Epoch 108 loss: 358.57430028915405; train accuracy: 0.9290771484375; test accuracy: 0.8407
2025-09-24 23:24:07 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:25:05 [INFO]  Epoch 109 loss: 357.50957584381104; train accuracy: 0.926727294921875; test accuracy: 0.8407
2025-09-24 23:25:05 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:25:05 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:25:05 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:25:05 [INFO]  Epoch 105: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:25:39 [INFO]  Epoch 105 loss: 197.6820158958435; train accuracy: 0.9271205357142858; test accuracy: 0.8046
2025-09-24 23:25:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_105.pth
2025-09-24 23:25:39 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:26:12 [INFO]  Epoch 106 loss: 197.36358785629272; train accuracy: 0.8756696428571429; test accuracy: 0.7704
2025-09-24 23:26:12 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:26:44 [INFO]  Epoch 107 loss: 211.77769470214844; train accuracy: 0.8792410714285714; test accuracy: 0.7683
2025-09-24 23:26:44 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:27:16 [INFO]  Epoch 108 loss: 210.83667659759521; train accuracy: 0.8633928571428572; test accuracy: 0.7589
2025-09-24 23:27:16 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:27:49 [INFO]  Epoch 109 loss: 215.1878695487976; train accuracy: 0.8849330357142857; test accuracy: 0.7722
2025-09-24 23:27:49 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:27:49 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:27:49 [INFO]  Round 21 Finish--------|
2025-09-24 23:27:49 [INFO]  Model variance: mean: 0.008574954234063625, sum: 95816.125
2025-09-24 23:27:49 [INFO]  g_protos_std: 1.0071086883544922
2025-09-24 23:27:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9222
2025-09-24 23:27:55 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:27:55 [INFO]  Round 22 starts--------|
2025-09-24 23:27:55 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:27:55 [INFO]  Epoch 110: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:28:53 [INFO]  Epoch 110 loss: 387.1379065513611; train accuracy: 0.9293478260869565; test accuracy: 0.8408
2025-09-24 23:28:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_110.pth
2025-09-24 23:28:53 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:29:52 [INFO]  Epoch 111 loss: 393.2833070755005; train accuracy: 0.9171478713768116; test accuracy: 0.8317
2025-09-24 23:29:52 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:30:51 [INFO]  Epoch 112 loss: 383.2391142845154; train accuracy: 0.9266304347826086; test accuracy: 0.8376
2025-09-24 23:30:51 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:31:49 [INFO]  Epoch 113 loss: 380.36418628692627; train accuracy: 0.9460484601449275; test accuracy: 0.8554
2025-09-24 23:31:49 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:32:47 [INFO]  Epoch 114 loss: 386.9614267349243; train accuracy: 0.9286967844202898; test accuracy: 0.8449
2025-09-24 23:32:47 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:32:47 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:32:47 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:32:47 [INFO]  Epoch 110: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:33:37 [INFO]  Epoch 110 loss: 309.0878267288208; train accuracy: 0.9215959821428571; test accuracy: 0.83
2025-09-24 23:33:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_110.pth
2025-09-24 23:33:37 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:34:25 [INFO]  Epoch 111 loss: 330.20862674713135; train accuracy: 0.9181431361607143; test accuracy: 0.8212
2025-09-24 23:34:25 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:35:11 [INFO]  Epoch 112 loss: 314.16511249542236; train accuracy: 0.8831612723214286; test accuracy: 0.7913
2025-09-24 23:35:11 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:00 [INFO]  Epoch 113 loss: 318.1718306541443; train accuracy: 0.9127720424107143; test accuracy: 0.8137
2025-09-24 23:36:00 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:47 [INFO]  Epoch 114 loss: 310.79990434646606; train accuracy: 0.9318498883928571; test accuracy: 0.833
2025-09-24 23:36:47 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:36:47 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:36:47 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:36:47 [INFO]  Epoch 110: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:37:32 [INFO]  Epoch 110 loss: 289.51008892059326; train accuracy: 0.9056490384615384; test accuracy: 0.8153
2025-09-24 23:37:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_110.pth
2025-09-24 23:37:32 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:38:15 [INFO]  Epoch 111 loss: 295.4402070045471; train accuracy: 0.9201472355769231; test accuracy: 0.8282
2025-09-24 23:38:15 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:38:58 [INFO]  Epoch 112 loss: 310.80872440338135; train accuracy: 0.9133864182692307; test accuracy: 0.8152
2025-09-24 23:38:58 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:39:39 [INFO]  Epoch 113 loss: 299.4774217605591; train accuracy: 0.9080904447115384; test accuracy: 0.8126
2025-09-24 23:39:39 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:40:20 [INFO]  Epoch 114 loss: 286.0206594467163; train accuracy: 0.9048978365384616; test accuracy: 0.8212
2025-09-24 23:40:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:40:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:40:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:40:20 [INFO]  Epoch 110: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:41:11 [INFO]  Epoch 110 loss: 368.45616912841797; train accuracy: 0.8896484375; test accuracy: 0.8023
2025-09-24 23:41:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_110.pth
2025-09-24 23:41:11 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:42:09 [INFO]  Epoch 111 loss: 359.5874819755554; train accuracy: 0.93658447265625; test accuracy: 0.8493
2025-09-24 23:42:09 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:43:05 [INFO]  Epoch 112 loss: 352.8452157974243; train accuracy: 0.91156005859375; test accuracy: 0.8227
2025-09-24 23:43:05 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:43:59 [INFO]  Epoch 113 loss: 357.0708589553833; train accuracy: 0.9354248046875; test accuracy: 0.8437
2025-09-24 23:43:59 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:44:51 [INFO]  Epoch 114 loss: 357.9014849662781; train accuracy: 0.934844970703125; test accuracy: 0.8425
2025-09-24 23:44:51 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:44:51 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:44:51 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:44:51 [INFO]  Epoch 110: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:45:23 [INFO]  Epoch 110 loss: 195.99265670776367; train accuracy: 0.8881696428571428; test accuracy: 0.7794
2025-09-24 23:45:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_110.pth
2025-09-24 23:45:23 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:45:56 [INFO]  Epoch 111 loss: 202.25916242599487; train accuracy: 0.9060267857142857; test accuracy: 0.7893
2025-09-24 23:45:56 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:46:28 [INFO]  Epoch 112 loss: 202.0963373184204; train accuracy: 0.8631138392857143; test accuracy: 0.7595
2025-09-24 23:46:28 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:46:59 [INFO]  Epoch 113 loss: 207.8871364593506; train accuracy: 0.9068080357142857; test accuracy: 0.794
2025-09-24 23:46:59 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:47:32 [INFO]  Epoch 114 loss: 211.32552337646484; train accuracy: 0.8528459821428571; test accuracy: 0.7531
2025-09-24 23:47:32 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:47:32 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:47:32 [INFO]  Round 22 Finish--------|
2025-09-24 23:47:32 [INFO]  Model variance: mean: 0.008778365328907967, sum: 98089.03125
2025-09-24 23:47:32 [INFO]  g_protos_std: 1.0071991682052612
2025-09-24 23:47:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9229
2025-09-24 23:47:37 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:47:37 [INFO]  Round 23 starts--------|
2025-09-24 23:47:37 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:47:37 [INFO]  Epoch 115: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:48:41 [INFO]  Epoch 115 loss: 365.48703384399414; train accuracy: 0.9081465126811594; test accuracy: 0.8302
2025-09-24 23:48:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_115.pth
2025-09-24 23:48:42 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:49:49 [INFO]  Epoch 116 loss: 387.72584533691406; train accuracy: 0.9362828351449275; test accuracy: 0.8489
2025-09-24 23:49:49 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:50:52 [INFO]  Epoch 117 loss: 375.38739681243896; train accuracy: 0.9298573369565217; test accuracy: 0.8429
2025-09-24 23:50:52 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:51:55 [INFO]  Epoch 118 loss: 387.658652305603; train accuracy: 0.8987205615942029; test accuracy: 0.8176
2025-09-24 23:51:55 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:52:57 [INFO]  Epoch 119 loss: 381.81387090682983; train accuracy: 0.8933990036231884; test accuracy: 0.809
2025-09-24 23:52:57 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:52:57 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:52:57 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:52:57 [INFO]  Epoch 115: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:53:46 [INFO]  Epoch 115 loss: 304.28086137771606; train accuracy: 0.9390345982142857; test accuracy: 0.8366
2025-09-24 23:53:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_115.pth
2025-09-24 23:53:47 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:54:39 [INFO]  Epoch 116 loss: 314.0591812133789; train accuracy: 0.8849748883928571; test accuracy: 0.7985
2025-09-24 23:54:39 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:55:30 [INFO]  Epoch 117 loss: 312.83485221862793; train accuracy: 0.9169573102678571; test accuracy: 0.8222
2025-09-24 23:55:30 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:56:21 [INFO]  Epoch 118 loss: 305.59078454971313; train accuracy: 0.9325823102678571; test accuracy: 0.8365
2025-09-24 23:56:21 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:57:11 [INFO]  Epoch 119 loss: 315.5194630622864; train accuracy: 0.8621651785714286; test accuracy: 0.7748
2025-09-24 23:57:11 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:57:11 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:57:11 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:57:11 [INFO]  Epoch 115: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:57:57 [INFO]  Epoch 115 loss: 291.94044494628906; train accuracy: 0.9012545072115384; test accuracy: 0.8109
2025-09-24 23:57:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_115.pth
2025-09-24 23:57:57 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:58:42 [INFO]  Epoch 116 loss: 293.17498540878296; train accuracy: 0.8485952524038461; test accuracy: 0.7639
2025-09-24 23:58:42 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:59:30 [INFO]  Epoch 117 loss: 294.21197414398193; train accuracy: 0.9198843149038461; test accuracy: 0.8252
2025-09-24 23:59:30 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:00:17 [INFO]  Epoch 118 loss: 296.4784059524536; train accuracy: 0.89501953125; test accuracy: 0.8051
2025-09-25 00:00:17 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:01:06 [INFO]  Epoch 119 loss: 283.0526514053345; train accuracy: 0.9293870192307693; test accuracy: 0.8327
2025-09-25 00:01:06 [INFO]  Client 2 Finish Local Training--------|
2025-09-25 00:01:06 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-25 00:01:06 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-25 00:01:06 [INFO]  Epoch 115: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:02:04 [INFO]  Epoch 115 loss: 361.0567350387573; train accuracy: 0.905303955078125; test accuracy: 0.8155
2025-09-25 00:02:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_115.pth
2025-09-25 00:02:05 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:03:02 [INFO]  Epoch 116 loss: 357.3895354270935; train accuracy: 0.924285888671875; test accuracy: 0.8389
2025-09-25 00:03:02 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:03:58 [INFO]  Epoch 117 loss: 361.10468578338623; train accuracy: 0.937652587890625; test accuracy: 0.8463
2025-09-25 00:03:58 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:04:54 [INFO]  Epoch 118 loss: 363.8380651473999; train accuracy: 0.9449462890625; test accuracy: 0.8488
2025-09-25 00:04:54 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:05:52 [INFO]  Epoch 119 loss: 355.7608599662781; train accuracy: 0.935577392578125; test accuracy: 0.8437
2025-09-25 00:05:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-25 00:05:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-25 00:05:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-25 00:05:52 [INFO]  Epoch 115: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:06:25 [INFO]  Epoch 115 loss: 202.255784034729; train accuracy: 0.8944754464285715; test accuracy: 0.781
2025-09-25 00:06:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_115.pth
2025-09-25 00:06:26 [INFO]  Epoch 116: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:06:58 [INFO]  Epoch 116 loss: 213.02980756759644; train accuracy: 0.8698660714285714; test accuracy: 0.7631
2025-09-25 00:06:58 [INFO]  Epoch 117: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:07:32 [INFO]  Epoch 117 loss: 203.14400386810303; train accuracy: 0.898046875; test accuracy: 0.7847
2025-09-25 00:07:32 [INFO]  Epoch 118: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:08:03 [INFO]  Epoch 118 loss: 201.60015296936035; train accuracy: 0.8422991071428572; test accuracy: 0.7452
2025-09-25 00:08:03 [INFO]  Epoch 119: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:08:35 [INFO]  Epoch 119 loss: 208.68906784057617; train accuracy: 0.8702008928571429; test accuracy: 0.7644
2025-09-25 00:08:35 [INFO]  Client 4 Finish Local Training--------|
2025-09-25 00:08:35 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-25 00:08:35 [INFO]  Round 23 Finish--------|
2025-09-25 00:08:35 [INFO]  Model variance: mean: 0.008976279757916927, sum: 100300.515625
2025-09-25 00:08:35 [INFO]  g_protos_std: 1.007289171218872
2025-09-25 00:08:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.9204
2025-09-25 00:08:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-25 00:08:41 [INFO]  Round 24 starts--------|
2025-09-25 00:08:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-25 00:08:41 [INFO]  Epoch 120: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:09:41 [INFO]  Epoch 120 loss: 377.90407609939575; train accuracy: 0.9313858695652174; test accuracy: 0.8426
2025-09-25 00:09:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_120.pth
2025-09-25 00:09:41 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:10:44 [INFO]  Epoch 121 loss: 376.22030448913574; train accuracy: 0.9568897192028986; test accuracy: 0.8654
2025-09-25 00:10:44 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:11:44 [INFO]  Epoch 122 loss: 372.67873096466064; train accuracy: 0.9248188405797102; test accuracy: 0.8374
2025-09-25 00:11:44 [INFO]  Epoch 123: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:12:43 [INFO]  Epoch 123 loss: 377.6647963523865; train accuracy: 0.9438122735507246; test accuracy: 0.8568
2025-09-25 00:12:43 [INFO]  Epoch 124: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:13:44 [INFO]  Epoch 124 loss: 365.00275135040283; train accuracy: 0.9373867753623188; test accuracy: 0.8457
2025-09-25 00:13:44 [INFO]  Client 0 Finish Local Training--------|
2025-09-25 00:13:44 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-25 00:13:44 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-25 00:13:44 [INFO]  Epoch 120: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:14:34 [INFO]  Epoch 120 loss: 309.8759832382202; train accuracy: 0.8826032366071429; test accuracy: 0.7864
2025-09-25 00:14:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_120.pth
2025-09-25 00:14:35 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:15:25 [INFO]  Epoch 121 loss: 309.88511085510254; train accuracy: 0.8992396763392857; test accuracy: 0.8088
2025-09-25 00:15:25 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:16:14 [INFO]  Epoch 122 loss: 308.6177716255188; train accuracy: 0.924560546875; test accuracy: 0.825
2025-09-25 00:16:14 [INFO]  Epoch 123: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:17:05 [INFO]  Epoch 123 loss: 305.3960027694702; train accuracy: 0.9292689732142857; test accuracy: 0.8284
2025-09-25 00:17:05 [INFO]  Epoch 124: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:17:56 [INFO]  Epoch 124 loss: 308.96300888061523; train accuracy: 0.9501953125; test accuracy: 0.8503
2025-09-25 00:17:56 [INFO]  Client 1 Finish Local Training--------|
2025-09-25 00:17:56 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-25 00:17:56 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-25 00:17:56 [INFO]  Epoch 120: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:18:45 [INFO]  Epoch 120 loss: 292.44710063934326; train accuracy: 0.9177433894230769; test accuracy: 0.8198
2025-09-25 00:18:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_120.pth
2025-09-25 00:18:45 [INFO]  Epoch 121: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:19:33 [INFO]  Epoch 121 loss: 288.6478672027588; train accuracy: 0.9023061899038461; test accuracy: 0.8038
2025-09-25 00:19:33 [INFO]  Epoch 122: Running in Stage 2 - Local Task Fine-tuning.
