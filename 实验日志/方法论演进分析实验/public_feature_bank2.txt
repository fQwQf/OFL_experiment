2025-09-24 15:04:19 [INFO]  Load config from ./configs/CIFAR10_alpha0.05.yaml
2025-09-24 15:04:19 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.05', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:21 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:21 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 15:04:21 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:21 [INFO]  OneshotOurs
2025-09-24 15:04:22 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 15:04:22 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 15:04:22 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 15:04:25 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 15:04:27 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 15:04:29 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 15:04:31 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 15:04:33 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 15:04:35 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 15:04:37 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 15:04:38 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 15:04:41 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 15:04:42 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 15:04:44 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 15:04:46 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 15:04:48 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 15:04:50 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 15:04:52 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 15:04:54 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 15:04:55 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 15:04:57 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 15:04:59 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 15:05:01 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 15:05:01 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 15:05:02 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 15:05:02 [INFO]  Two-stage training enabled: Alignment epochs set to 1.
2025-09-24 15:05:02 [INFO]  Round 0 starts--------|
2025-09-24 15:05:02 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:06 [INFO]  generating sample per sample
2025-09-24 15:05:06 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:05:32 [INFO]  Epoch 0 loss: 192.20743656158447; train accuracy: 0.0; test accuracy: 0.1022
2025-09-24 15:05:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_0.pth
2025-09-24 15:05:33 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:05:59 [INFO]  Epoch 1 loss: 266.792688369751; train accuracy: 0.33631310096153844; test accuracy: 0.1041
2025-09-24 15:05:59 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:25 [INFO]  Epoch 2 loss: 240.86826133728027; train accuracy: 0.328125; test accuracy: 0.1
2025-09-24 15:06:25 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:51 [INFO]  Epoch 3 loss: 237.40636920928955; train accuracy: 0.46341646634615385; test accuracy: 0.1501
2025-09-24 15:06:51 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:15 [INFO]  Epoch 4 loss: 234.8013744354248; train accuracy: 0.470703125; test accuracy: 0.142
2025-09-24 15:07:15 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:07:15 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:07:15 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:07:19 [INFO]  generating sample per sample
2025-09-24 15:07:19 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:07:44 [INFO]  Epoch 0 loss: 191.921049118042; train accuracy: 0.3278996394230769; test accuracy: 0.0999
2025-09-24 15:07:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_0.pth
2025-09-24 15:07:45 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:12 [INFO]  Epoch 1 loss: 252.55113792419434; train accuracy: 0.44486177884615385; test accuracy: 0.1444
2025-09-24 15:08:12 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:38 [INFO]  Epoch 2 loss: 237.029203414917; train accuracy: 0.3336838942307692; test accuracy: 0.1036
2025-09-24 15:08:38 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:05 [INFO]  Epoch 3 loss: 232.50027465820312; train accuracy: 0.4411057692307692; test accuracy: 0.1371
2025-09-24 15:09:05 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:29 [INFO]  Epoch 4 loss: 228.3464584350586; train accuracy: 0.45958533653846156; test accuracy: 0.1437
2025-09-24 15:09:29 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:09:29 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:09:29 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:09:33 [INFO]  generating sample per sample
2025-09-24 15:09:33 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:10:01 [INFO]  Epoch 0 loss: 206.65519380569458; train accuracy: 0.00020926339285714285; test accuracy: 0.1
2025-09-24 15:10:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_0.pth
2025-09-24 15:10:01 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:29 [INFO]  Epoch 1 loss: 283.01118564605713; train accuracy: 0.3047572544642857; test accuracy: 0.1
2025-09-24 15:10:29 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:53 [INFO]  Epoch 2 loss: 250.0613031387329; train accuracy: 0.44956752232142855; test accuracy: 0.167
2025-09-24 15:10:53 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:20 [INFO]  Epoch 3 loss: 243.37026405334473; train accuracy: 0.36056082589285715; test accuracy: 0.1257
2025-09-24 15:11:20 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:45 [INFO]  Epoch 4 loss: 238.25845432281494; train accuracy: 0.37890625; test accuracy: 0.1692
2025-09-24 15:11:45 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:11:45 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:11:45 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:11:46 [INFO]  generating sample per sample
2025-09-24 15:11:46 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:11:55 [INFO]  Epoch 0 loss: 67.26980781555176; train accuracy: 0.0; test accuracy: 0.0989
2025-09-24 15:11:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_0.pth
2025-09-24 15:11:55 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:07 [INFO]  Epoch 1 loss: 123.13772296905518; train accuracy: 0.9613715277777778; test accuracy: 0.1
2025-09-24 15:12:07 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:17 [INFO]  Epoch 2 loss: 70.71087694168091; train accuracy: 0.9615885416666666; test accuracy: 0.1
2025-09-24 15:12:17 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:27 [INFO]  Epoch 3 loss: 67.29984664916992; train accuracy: 0.9611545138888888; test accuracy: 0.1
2025-09-24 15:12:27 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:38 [INFO]  Epoch 4 loss: 66.64592027664185; train accuracy: 0.9615885416666666; test accuracy: 0.1
2025-09-24 15:12:38 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:12:38 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:12:38 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:12:39 [INFO]  generating sample per sample
2025-09-24 15:12:39 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:12:49 [INFO]  Epoch 0 loss: 59.9317512512207; train accuracy: 0.938720703125; test accuracy: 0.1021
2025-09-24 15:12:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_0.pth
2025-09-24 15:12:50 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:01 [INFO]  Epoch 1 loss: 74.52070808410645; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:13:01 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:12 [INFO]  Epoch 2 loss: 58.02033567428589; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:13:12 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:22 [INFO]  Epoch 3 loss: 56.70834302902222; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:13:22 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:32 [INFO]  Epoch 4 loss: 56.31531095504761; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:13:32 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:13:32 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:13:32 [INFO]  Round 0 Finish--------|
2025-09-24 15:13:32 [INFO]  Model variance: mean: 0.001092793419957161, sum: 12210.8212890625
2025-09-24 15:13:32 [INFO]  g_protos_std: 1.0062520503997803
2025-09-24 15:13:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3125
2025-09-24 15:13:37 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:13:37 [INFO]  Round 1 starts--------|
2025-09-24 15:13:37 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:13:37 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:14:03 [INFO]  Epoch 5 loss: 180.91812229156494; train accuracy: 0.44493689903846156; test accuracy: 0.138
2025-09-24 15:14:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_5.pth
2025-09-24 15:14:03 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:29 [INFO]  Epoch 6 loss: 231.9915256500244; train accuracy: 0.3506610576923077; test accuracy: 0.1113
2025-09-24 15:14:29 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:55 [INFO]  Epoch 7 loss: 229.55696296691895; train accuracy: 0.39302884615384615; test accuracy: 0.1234
2025-09-24 15:14:55 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:18 [INFO]  Epoch 8 loss: 227.17693614959717; train accuracy: 0.5295973557692307; test accuracy: 0.1622
2025-09-24 15:15:18 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:44 [INFO]  Epoch 9 loss: 225.39135551452637; train accuracy: 0.4745342548076923; test accuracy: 0.1538
2025-09-24 15:15:44 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:15:44 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:15:44 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:15:44 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:16:09 [INFO]  Epoch 5 loss: 180.77062225341797; train accuracy: 0.4003155048076923; test accuracy: 0.1236
2025-09-24 15:16:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_5.pth
2025-09-24 15:16:09 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:34 [INFO]  Epoch 6 loss: 225.27510929107666; train accuracy: 0.44936899038461536; test accuracy: 0.1373
2025-09-24 15:16:34 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:01 [INFO]  Epoch 7 loss: 224.58319664001465; train accuracy: 0.5814302884615384; test accuracy: 0.1802
2025-09-24 15:17:01 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:28 [INFO]  Epoch 8 loss: 223.5308141708374; train accuracy: 0.6026141826923077; test accuracy: 0.1828
2025-09-24 15:17:28 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:55 [INFO]  Epoch 9 loss: 220.56491661071777; train accuracy: 0.5030799278846154; test accuracy: 0.1524
2025-09-24 15:17:55 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:17:55 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:17:55 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:17:55 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:18:20 [INFO]  Epoch 5 loss: 190.65892696380615; train accuracy: 0.3461216517857143; test accuracy: 0.1464
2025-09-24 15:18:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_5.pth
2025-09-24 15:18:21 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:49 [INFO]  Epoch 6 loss: 230.4436297416687; train accuracy: 0.6865234375; test accuracy: 0.2496
2025-09-24 15:18:49 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:16 [INFO]  Epoch 7 loss: 229.47275686264038; train accuracy: 0.5809151785714286; test accuracy: 0.2232
2025-09-24 15:19:16 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:41 [INFO]  Epoch 8 loss: 223.10939693450928; train accuracy: 0.5565011160714286; test accuracy: 0.1982
2025-09-24 15:19:41 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:07 [INFO]  Epoch 9 loss: 220.87817859649658; train accuracy: 0.6026088169642857; test accuracy: 0.2303
2025-09-24 15:20:07 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:20:07 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:20:07 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:20:07 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:20:17 [INFO]  Epoch 5 loss: 63.29682636260986; train accuracy: 0.9611545138888888; test accuracy: 0.1
2025-09-24 15:20:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_5.pth
2025-09-24 15:20:17 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:27 [INFO]  Epoch 6 loss: 66.05108547210693; train accuracy: 0.9609375; test accuracy: 0.1
2025-09-24 15:20:27 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:36 [INFO]  Epoch 7 loss: 65.84921312332153; train accuracy: 0.9359809027777778; test accuracy: 0.1187
2025-09-24 15:20:36 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:47 [INFO]  Epoch 8 loss: 65.86652374267578; train accuracy: 0.9615885416666666; test accuracy: 0.1002
2025-09-24 15:20:47 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:57 [INFO]  Epoch 9 loss: 65.63735818862915; train accuracy: 0.9624565972222222; test accuracy: 0.1174
2025-09-24 15:20:57 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:20:57 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:20:57 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:20:57 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:21:06 [INFO]  Epoch 5 loss: 56.16247510910034; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:21:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_5.pth
2025-09-24 15:21:06 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:15 [INFO]  Epoch 6 loss: 56.08672857284546; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:21:15 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:25 [INFO]  Epoch 7 loss: 56.00005865097046; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:21:25 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:34 [INFO]  Epoch 8 loss: 55.92765188217163; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:21:34 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:43 [INFO]  Epoch 9 loss: 55.868284702301025; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:21:43 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:21:43 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:21:43 [INFO]  Round 1 Finish--------|
2025-09-24 15:21:43 [INFO]  Model variance: mean: 0.00132139609195292, sum: 14765.216796875
2025-09-24 15:21:43 [INFO]  g_protos_std: 1.006271481513977
2025-09-24 15:21:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3867
2025-09-24 15:21:48 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:21:48 [INFO]  Round 2 starts--------|
2025-09-24 15:21:48 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:21:48 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:22:11 [INFO]  Epoch 10 loss: 178.8579330444336; train accuracy: 0.5890174278846154; test accuracy: 0.187
2025-09-24 15:22:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_10.pth
2025-09-24 15:22:12 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:36 [INFO]  Epoch 11 loss: 220.36395835876465; train accuracy: 0.5554387019230769; test accuracy: 0.1666
2025-09-24 15:22:36 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:01 [INFO]  Epoch 12 loss: 221.88111782073975; train accuracy: 0.5698617788461539; test accuracy: 0.1812
2025-09-24 15:23:01 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:25 [INFO]  Epoch 13 loss: 220.03730392456055; train accuracy: 0.6089242788461539; test accuracy: 0.2011
2025-09-24 15:23:25 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:48 [INFO]  Epoch 14 loss: 217.5977201461792; train accuracy: 0.4748347355769231; test accuracy: 0.1519
2025-09-24 15:23:48 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:23:48 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:23:48 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:23:48 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:24:13 [INFO]  Epoch 10 loss: 178.35670804977417; train accuracy: 0.4987980769230769; test accuracy: 0.1505
2025-09-24 15:24:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_10.pth
2025-09-24 15:24:13 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:37 [INFO]  Epoch 11 loss: 216.10901832580566; train accuracy: 0.5979567307692307; test accuracy: 0.1827
2025-09-24 15:24:37 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:02 [INFO]  Epoch 12 loss: 215.1780300140381; train accuracy: 0.6209435096153846; test accuracy: 0.1864
2025-09-24 15:25:02 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:25 [INFO]  Epoch 13 loss: 214.10458946228027; train accuracy: 0.6300330528846154; test accuracy: 0.1945
2025-09-24 15:25:25 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:50 [INFO]  Epoch 14 loss: 214.24095630645752; train accuracy: 0.6370943509615384; test accuracy: 0.1932
2025-09-24 15:25:50 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:25:50 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:25:50 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:25:50 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:26:13 [INFO]  Epoch 10 loss: 184.63225555419922; train accuracy: 0.40408761160714285; test accuracy: 0.1951
2025-09-24 15:26:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_10.pth
2025-09-24 15:26:14 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:41 [INFO]  Epoch 11 loss: 212.31142234802246; train accuracy: 0.6801060267857143; test accuracy: 0.2621
2025-09-24 15:26:41 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:06 [INFO]  Epoch 12 loss: 215.50478410720825; train accuracy: 0.7184012276785714; test accuracy: 0.2848
2025-09-24 15:27:06 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:31 [INFO]  Epoch 13 loss: 209.96961879730225; train accuracy: 0.7413504464285714; test accuracy: 0.2951
2025-09-24 15:27:31 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:57 [INFO]  Epoch 14 loss: 208.97073221206665; train accuracy: 0.7677176339285714; test accuracy: 0.2719
2025-09-24 15:27:57 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:27:57 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:27:57 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:27:57 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:28:07 [INFO]  Epoch 10 loss: 62.88818311691284; train accuracy: 0.9626736111111112; test accuracy: 0.1126
2025-09-24 15:28:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_10.pth
2025-09-24 15:28:07 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:18 [INFO]  Epoch 11 loss: 65.69261884689331; train accuracy: 0.9624565972222222; test accuracy: 0.1004
2025-09-24 15:28:18 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:27 [INFO]  Epoch 12 loss: 65.49421834945679; train accuracy: 0.9618055555555556; test accuracy: 0.1016
2025-09-24 15:28:27 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:36 [INFO]  Epoch 13 loss: 65.4469780921936; train accuracy: 0.9615885416666666; test accuracy: 0.1016
2025-09-24 15:28:36 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:45 [INFO]  Epoch 14 loss: 65.24523067474365; train accuracy: 0.9615885416666666; test accuracy: 0.101
2025-09-24 15:28:45 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:28:45 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:28:45 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:28:45 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:28:52 [INFO]  Epoch 10 loss: 55.83721303939819; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:28:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_10.pth
2025-09-24 15:28:53 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:00 [INFO]  Epoch 11 loss: 55.820836544036865; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:29:00 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:07 [INFO]  Epoch 12 loss: 55.789910316467285; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:29:07 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:14 [INFO]  Epoch 13 loss: 55.7684645652771; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:29:14 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:21 [INFO]  Epoch 14 loss: 55.74396467208862; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:29:21 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:29:21 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:29:21 [INFO]  Round 2 Finish--------|
2025-09-24 15:29:21 [INFO]  Model variance: mean: 0.0015173929277807474, sum: 16955.275390625
2025-09-24 15:29:21 [INFO]  g_protos_std: 1.0063064098358154
2025-09-24 15:29:25 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4228
2025-09-24 15:29:25 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:29:25 [INFO]  Round 3 starts--------|
2025-09-24 15:29:25 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:29:25 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:29:47 [INFO]  Epoch 15 loss: 177.15233325958252; train accuracy: 0.5830078125; test accuracy: 0.1847
2025-09-24 15:29:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_15.pth
2025-09-24 15:29:48 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:13 [INFO]  Epoch 16 loss: 216.31545495986938; train accuracy: 0.49263822115384615; test accuracy: 0.1542
2025-09-24 15:30:13 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:35 [INFO]  Epoch 17 loss: 215.29610872268677; train accuracy: 0.6505408653846154; test accuracy: 0.2062
2025-09-24 15:30:35 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:57 [INFO]  Epoch 18 loss: 213.66943502426147; train accuracy: 0.6452073317307693; test accuracy: 0.2057
2025-09-24 15:30:57 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:18 [INFO]  Epoch 19 loss: 212.82085132598877; train accuracy: 0.6283804086538461; test accuracy: 0.2045
2025-09-24 15:31:18 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:31:18 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:31:18 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:31:18 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:31:43 [INFO]  Epoch 15 loss: 176.54154205322266; train accuracy: 0.7240084134615384; test accuracy: 0.2182
2025-09-24 15:31:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_15.pth
2025-09-24 15:31:43 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:08 [INFO]  Epoch 16 loss: 212.99185705184937; train accuracy: 0.6945612980769231; test accuracy: 0.2145
2025-09-24 15:32:08 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:31 [INFO]  Epoch 17 loss: 212.53937292099; train accuracy: 0.6458082932692307; test accuracy: 0.1959
2025-09-24 15:32:31 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:51 [INFO]  Epoch 18 loss: 210.18243408203125; train accuracy: 0.5706881009615384; test accuracy: 0.1792
2025-09-24 15:32:51 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:13 [INFO]  Epoch 19 loss: 208.06277990341187; train accuracy: 0.6298828125; test accuracy: 0.1983
2025-09-24 15:33:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:33:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:33:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:33:13 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:33:39 [INFO]  Epoch 15 loss: 179.8335304260254; train accuracy: 0.8317522321428571; test accuracy: 0.3274
2025-09-24 15:33:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_15.pth
2025-09-24 15:33:39 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:04 [INFO]  Epoch 16 loss: 198.93685865402222; train accuracy: 0.8201032366071429; test accuracy: 0.3329
2025-09-24 15:34:04 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:29 [INFO]  Epoch 17 loss: 201.9241452217102; train accuracy: 0.7180524553571429; test accuracy: 0.3301
2025-09-24 15:34:29 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:54 [INFO]  Epoch 18 loss: 198.5131320953369; train accuracy: 0.7781110491071429; test accuracy: 0.3372
2025-09-24 15:34:54 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:21 [INFO]  Epoch 19 loss: 203.90476751327515; train accuracy: 0.5440150669642857; test accuracy: 0.2219
2025-09-24 15:35:21 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:35:21 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:35:21 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:35:21 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:35:31 [INFO]  Epoch 15 loss: 62.75718879699707; train accuracy: 0.9618055555555556; test accuracy: 0.1004
2025-09-24 15:35:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_15.pth
2025-09-24 15:35:31 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:41 [INFO]  Epoch 16 loss: 65.36072874069214; train accuracy: 0.9652777777777778; test accuracy: 0.1209
2025-09-24 15:35:41 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:51 [INFO]  Epoch 17 loss: 65.17604732513428; train accuracy: 0.9615885416666666; test accuracy: 0.1008
2025-09-24 15:35:51 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:01 [INFO]  Epoch 18 loss: 65.1263198852539; train accuracy: 0.9615885416666666; test accuracy: 0.1
2025-09-24 15:36:01 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:11 [INFO]  Epoch 19 loss: 65.21106576919556; train accuracy: 0.9618055555555556; test accuracy: 0.1007
2025-09-24 15:36:11 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:36:11 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:36:11 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:36:11 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:36:21 [INFO]  Epoch 15 loss: 55.732837200164795; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:36:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_15.pth
2025-09-24 15:36:22 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:31 [INFO]  Epoch 16 loss: 55.723228454589844; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:36:31 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:39 [INFO]  Epoch 17 loss: 55.708123207092285; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:36:39 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:49 [INFO]  Epoch 18 loss: 55.69537687301636; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:36:49 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:58 [INFO]  Epoch 19 loss: 55.684382915496826; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:36:58 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:36:58 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:36:58 [INFO]  Round 3 Finish--------|
2025-09-24 15:36:58 [INFO]  Model variance: mean: 0.0016903805080801249, sum: 18888.23046875
2025-09-24 15:36:58 [INFO]  g_protos_std: 1.0063438415527344
2025-09-24 15:37:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4525
2025-09-24 15:37:03 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:37:03 [INFO]  Round 4 starts--------|
2025-09-24 15:37:03 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:37:04 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:37:28 [INFO]  Epoch 20 loss: 175.2968316078186; train accuracy: 0.6457331730769231; test accuracy: 0.2089
2025-09-24 15:37:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_20.pth
2025-09-24 15:37:29 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:53 [INFO]  Epoch 21 loss: 209.62725448608398; train accuracy: 0.7073317307692307; test accuracy: 0.2397
2025-09-24 15:37:53 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:16 [INFO]  Epoch 22 loss: 208.29313135147095; train accuracy: 0.6355168269230769; test accuracy: 0.1968
2025-09-24 15:38:16 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:41 [INFO]  Epoch 23 loss: 208.59488487243652; train accuracy: 0.5386117788461539; test accuracy: 0.1703
2025-09-24 15:38:41 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:08 [INFO]  Epoch 24 loss: 205.08980989456177; train accuracy: 0.7096604567307693; test accuracy: 0.2838
2025-09-24 15:39:08 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:39:08 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:39:08 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:39:08 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:39:34 [INFO]  Epoch 20 loss: 173.9879002571106; train accuracy: 0.7420372596153846; test accuracy: 0.224
2025-09-24 15:39:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_20.pth
2025-09-24 15:39:34 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:59 [INFO]  Epoch 21 loss: 206.63256359100342; train accuracy: 0.697265625; test accuracy: 0.2745
2025-09-24 15:39:59 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:22 [INFO]  Epoch 22 loss: 202.31000137329102; train accuracy: 0.7705078125; test accuracy: 0.2744
2025-09-24 15:40:22 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:47 [INFO]  Epoch 23 loss: 201.880455493927; train accuracy: 0.7459435096153846; test accuracy: 0.3147
2025-09-24 15:40:47 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:13 [INFO]  Epoch 24 loss: 203.1792435646057; train accuracy: 0.8104717548076923; test accuracy: 0.3157
2025-09-24 15:41:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:41:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:41:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:41:13 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:41:40 [INFO]  Epoch 20 loss: 177.00809001922607; train accuracy: 0.8756975446428571; test accuracy: 0.3867
2025-09-24 15:41:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_20.pth
2025-09-24 15:41:40 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:05 [INFO]  Epoch 21 loss: 198.0500030517578; train accuracy: 0.7093331473214286; test accuracy: 0.3193
2025-09-24 15:42:05 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:31 [INFO]  Epoch 22 loss: 195.46919679641724; train accuracy: 0.8082449776785714; test accuracy: 0.3301
2025-09-24 15:42:31 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:57 [INFO]  Epoch 23 loss: 196.04805755615234; train accuracy: 0.8689313616071429; test accuracy: 0.4102
2025-09-24 15:42:57 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:23 [INFO]  Epoch 24 loss: 194.80632781982422; train accuracy: 0.8717912946428571; test accuracy: 0.3799
2025-09-24 15:43:23 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:43:23 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:43:23 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:43:23 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:43:34 [INFO]  Epoch 20 loss: 62.66295576095581; train accuracy: 0.9613715277777778; test accuracy: 0.1007
2025-09-24 15:43:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_20.pth
2025-09-24 15:43:35 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:45 [INFO]  Epoch 21 loss: 65.21500873565674; train accuracy: 0.9618055555555556; test accuracy: 0.1014
2025-09-24 15:43:45 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:55 [INFO]  Epoch 22 loss: 65.03410196304321; train accuracy: 0.9613715277777778; test accuracy: 0.1002
2025-09-24 15:43:55 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:05 [INFO]  Epoch 23 loss: 65.07449388504028; train accuracy: 0.9618055555555556; test accuracy: 0.1372
2025-09-24 15:44:05 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:15 [INFO]  Epoch 24 loss: 64.87937355041504; train accuracy: 0.9611545138888888; test accuracy: 0.1007
2025-09-24 15:44:15 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:44:15 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:44:15 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:44:15 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:44:24 [INFO]  Epoch 20 loss: 55.67671012878418; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:44:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_20.pth
2025-09-24 15:44:24 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:33 [INFO]  Epoch 21 loss: 55.67094135284424; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:44:33 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:41 [INFO]  Epoch 22 loss: 55.66318416595459; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:44:41 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:50 [INFO]  Epoch 23 loss: 55.65428924560547; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:44:50 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:59 [INFO]  Epoch 24 loss: 55.647891998291016; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:44:59 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:44:59 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:44:59 [INFO]  Round 4 Finish--------|
2025-09-24 15:44:59 [INFO]  Model variance: mean: 0.001849350635893643, sum: 20664.5546875
2025-09-24 15:44:59 [INFO]  g_protos_std: 1.0063810348510742
2025-09-24 15:45:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4991
2025-09-24 15:45:04 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:45:04 [INFO]  Round 5 starts--------|
2025-09-24 15:45:04 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:45:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:45:28 [INFO]  Epoch 25 loss: 173.36978960037231; train accuracy: 0.6605318509615384; test accuracy: 0.2162
2025-09-24 15:45:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_25.pth
2025-09-24 15:45:28 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:52 [INFO]  Epoch 26 loss: 202.03875160217285; train accuracy: 0.7682542067307693; test accuracy: 0.296
2025-09-24 15:45:52 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:16 [INFO]  Epoch 27 loss: 207.96045446395874; train accuracy: 0.4094801682692308; test accuracy: 0.124
2025-09-24 15:46:16 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:39 [INFO]  Epoch 28 loss: 204.81400537490845; train accuracy: 0.6013371394230769; test accuracy: 0.2374
2025-09-24 15:46:39 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:03 [INFO]  Epoch 29 loss: 203.0826473236084; train accuracy: 0.5053335336538461; test accuracy: 0.1691
2025-09-24 15:47:03 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:47:03 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:47:03 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:47:03 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:47:27 [INFO]  Epoch 25 loss: 173.43097066879272; train accuracy: 0.6944110576923077; test accuracy: 0.2099
2025-09-24 15:47:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_25.pth
2025-09-24 15:47:27 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:50 [INFO]  Epoch 26 loss: 199.7132544517517; train accuracy: 0.7915414663461539; test accuracy: 0.2572
2025-09-24 15:47:50 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:13 [INFO]  Epoch 27 loss: 202.5758719444275; train accuracy: 0.7463191105769231; test accuracy: 0.2558
2025-09-24 15:48:13 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:38 [INFO]  Epoch 28 loss: 200.14697408676147; train accuracy: 0.7883864182692307; test accuracy: 0.2653
2025-09-24 15:48:38 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:03 [INFO]  Epoch 29 loss: 198.06944942474365; train accuracy: 0.7817758413461539; test accuracy: 0.2711
2025-09-24 15:49:03 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:49:03 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:49:03 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:49:03 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:49:30 [INFO]  Epoch 25 loss: 175.06763696670532; train accuracy: 0.7154017857142857; test accuracy: 0.29
2025-09-24 15:49:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_25.pth
2025-09-24 15:49:30 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:57 [INFO]  Epoch 26 loss: 198.47871828079224; train accuracy: 0.7579520089285714; test accuracy: 0.3187
2025-09-24 15:49:57 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:24 [INFO]  Epoch 27 loss: 191.88062477111816; train accuracy: 0.7906668526785714; test accuracy: 0.3537
2025-09-24 15:50:24 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:50 [INFO]  Epoch 28 loss: 188.84665060043335; train accuracy: 0.8412388392857143; test accuracy: 0.3641
2025-09-24 15:50:50 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:16 [INFO]  Epoch 29 loss: 192.50546216964722; train accuracy: 0.8988560267857143; test accuracy: 0.4
2025-09-24 15:51:16 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:51:16 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:51:16 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:51:16 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:51:25 [INFO]  Epoch 25 loss: 62.60111045837402; train accuracy: 0.9607204861111112; test accuracy: 0.1166
2025-09-24 15:51:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_25.pth
2025-09-24 15:51:25 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:35 [INFO]  Epoch 26 loss: 64.78155660629272; train accuracy: 0.6927083333333334; test accuracy: 0.1626
2025-09-24 15:51:35 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:45 [INFO]  Epoch 27 loss: 65.05585718154907; train accuracy: 0.9615885416666666; test accuracy: 0.1233
2025-09-24 15:51:45 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:53 [INFO]  Epoch 28 loss: 65.07010841369629; train accuracy: 0.9613715277777778; test accuracy: 0.1
2025-09-24 15:51:53 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:04 [INFO]  Epoch 29 loss: 65.00520992279053; train accuracy: 0.9611545138888888; test accuracy: 0.1002
2025-09-24 15:52:04 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:52:04 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:52:04 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:52:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:52:13 [INFO]  Epoch 25 loss: 55.643187046051025; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:52:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_25.pth
2025-09-24 15:52:13 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:23 [INFO]  Epoch 26 loss: 55.63983392715454; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:52:23 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:33 [INFO]  Epoch 27 loss: 55.634056091308594; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:52:33 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:42 [INFO]  Epoch 28 loss: 55.62830591201782; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:52:42 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:50 [INFO]  Epoch 29 loss: 55.62464237213135; train accuracy: 1.0; test accuracy: 0.1
2025-09-24 15:52:50 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:52:50 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:52:50 [INFO]  Round 5 Finish--------|
2025-09-24 15:52:50 [INFO]  Model variance: mean: 0.0019932386931031942, sum: 22272.353515625
2025-09-24 15:52:50 [INFO]  g_protos_std: 1.0064114332199097
2025-09-24 15:52:56 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5013
2025-09-24 15:52:56 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml


2025-09-24 15:04:24 [INFO]  Load config from ./configs/CIFAR10_alpha0.05.yaml
2025-09-24 15:04:24 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.05', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:26 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:26 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:27 [INFO]  OneshotOurs
2025-09-24 15:04:27 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 15:04:27 [INFO]  Round 0 starts--------|
2025-09-24 15:04:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:04:35 [INFO]  generating sample per sample
2025-09-24 15:04:35 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:05:24 [INFO]  Epoch 0 loss: 569.6653490066528; train accuracy: 0.20158503605769232; test accuracy: 0.2016
2025-09-24 15:05:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_0.pth
2025-09-24 15:05:24 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:13 [INFO]  Epoch 1 loss: 529.2922439575195; train accuracy: 0.19658954326923078; test accuracy: 0.1967
2025-09-24 15:06:13 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:03 [INFO]  Epoch 2 loss: 512.6424264907837; train accuracy: 0.31557992788461536; test accuracy: 0.3044
2025-09-24 15:07:03 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:51 [INFO]  Epoch 3 loss: 502.52149295806885; train accuracy: 0.3450270432692308; test accuracy: 0.3327
2025-09-24 15:07:51 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:39 [INFO]  Epoch 4 loss: 483.14548110961914; train accuracy: 0.3039362980769231; test accuracy: 0.2962
2025-09-24 15:08:39 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:08:39 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:08:39 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:08:41 [INFO]  generating sample per sample
2025-09-24 15:08:41 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:55 [INFO]  Epoch 0 loss: 142.47080326080322; train accuracy: 0.10172526041666667; test accuracy: 0.1049
2025-09-24 15:08:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_0.pth
2025-09-24 15:08:55 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:09 [INFO]  Epoch 1 loss: 130.71312713623047; train accuracy: 0.14680989583333334; test accuracy: 0.1432
2025-09-24 15:09:09 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:22 [INFO]  Epoch 2 loss: 129.252685546875; train accuracy: 0.11962890625; test accuracy: 0.1172
2025-09-24 15:09:22 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:35 [INFO]  Epoch 3 loss: 127.56806755065918; train accuracy: 0.21354166666666666; test accuracy: 0.2199
2025-09-24 15:09:35 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:48 [INFO]  Epoch 4 loss: 124.21241760253906; train accuracy: 0.13981119791666666; test accuracy: 0.142
2025-09-24 15:09:48 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:09:48 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:09:48 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:09:50 [INFO]  generating sample per sample
2025-09-24 15:09:50 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:01 [INFO]  Epoch 0 loss: 120.86428546905518; train accuracy: 0.1046875; test accuracy: 0.1011
2025-09-24 15:10:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_0.pth
2025-09-24 15:10:02 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:13 [INFO]  Epoch 1 loss: 109.40191078186035; train accuracy: 0.163671875; test accuracy: 0.1571
2025-09-24 15:10:13 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:24 [INFO]  Epoch 2 loss: 106.62244033813477; train accuracy: 0.13359375; test accuracy: 0.1271
2025-09-24 15:10:24 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:34 [INFO]  Epoch 3 loss: 104.25531101226807; train accuracy: 0.1140625; test accuracy: 0.1148
2025-09-24 15:10:34 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:43 [INFO]  Epoch 4 loss: 104.02848815917969; train accuracy: 0.2228515625; test accuracy: 0.2149
2025-09-24 15:10:43 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:10:43 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:10:43 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:10:47 [INFO]  generating sample per sample
2025-09-24 15:10:47 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:23 [INFO]  Epoch 0 loss: 468.32903575897217; train accuracy: 0.14276413690476192; test accuracy: 0.1432
2025-09-24 15:11:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_0.pth
2025-09-24 15:11:24 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:57 [INFO]  Epoch 1 loss: 436.67695331573486; train accuracy: 0.17317708333333334; test accuracy: 0.1764
2025-09-24 15:11:57 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:32 [INFO]  Epoch 2 loss: 418.4742784500122; train accuracy: 0.27622767857142855; test accuracy: 0.2828
2025-09-24 15:12:32 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:14 [INFO]  Epoch 3 loss: 415.8127908706665; train accuracy: 0.22809709821428573; test accuracy: 0.2287
2025-09-24 15:13:14 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:54 [INFO]  Epoch 4 loss: 401.8333930969238; train accuracy: 0.3455171130952381; test accuracy: 0.3451
2025-09-24 15:13:54 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:13:54 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:13:54 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:13:58 [INFO]  generating sample per sample
2025-09-24 15:13:58 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:24 [INFO]  Epoch 0 loss: 307.13542461395264; train accuracy: 0.13794849537037038; test accuracy: 0.1434
2025-09-24 15:14:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_0.pth
2025-09-24 15:14:24 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:51 [INFO]  Epoch 1 loss: 287.07435131073; train accuracy: 0.1685474537037037; test accuracy: 0.1741
2025-09-24 15:14:51 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:18 [INFO]  Epoch 2 loss: 276.2002058029175; train accuracy: 0.1925636574074074; test accuracy: 0.192
2025-09-24 15:15:18 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:45 [INFO]  Epoch 3 loss: 271.9665050506592; train accuracy: 0.20775462962962962; test accuracy: 0.2095
2025-09-24 15:15:45 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:12 [INFO]  Epoch 4 loss: 267.869460105896; train accuracy: 0.25904224537037035; test accuracy: 0.2677
2025-09-24 15:16:12 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:16:12 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:16:12 [INFO]  Round 0 Finish--------|
2025-09-24 15:16:12 [INFO]  Model variance: mean: 0.0009824271546676755, sum: 10977.59375
2025-09-24 15:16:12 [INFO]  g_protos_std: 1.0058329105377197
2025-09-24 15:16:17 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6137
2025-09-24 15:16:17 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:16:17 [INFO]  Round 1 starts--------|
2025-09-24 15:16:17 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:16:17 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:06 [INFO]  Epoch 5 loss: 472.50429248809814; train accuracy: 0.3656475360576923; test accuracy: 0.3638
2025-09-24 15:17:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_5.pth
2025-09-24 15:17:06 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:56 [INFO]  Epoch 6 loss: 460.3672208786011; train accuracy: 0.4159405048076923; test accuracy: 0.4076
2025-09-24 15:17:56 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:46 [INFO]  Epoch 7 loss: 461.71435260772705; train accuracy: 0.4821589543269231; test accuracy: 0.4753
2025-09-24 15:18:46 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:35 [INFO]  Epoch 8 loss: 443.4462790489197; train accuracy: 0.5461613581730769; test accuracy: 0.5304
2025-09-24 15:19:35 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:22 [INFO]  Epoch 9 loss: 433.18280363082886; train accuracy: 0.5674579326923077; test accuracy: 0.5574
2025-09-24 15:20:22 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:20:22 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:20:22 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:20:22 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:36 [INFO]  Epoch 5 loss: 122.15483093261719; train accuracy: 0.24104817708333334; test accuracy: 0.234
2025-09-24 15:20:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_5.pth
2025-09-24 15:20:36 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:49 [INFO]  Epoch 6 loss: 122.32505989074707; train accuracy: 0.16634114583333334; test accuracy: 0.1646
2025-09-24 15:20:49 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:01 [INFO]  Epoch 7 loss: 121.76562404632568; train accuracy: 0.20426432291666666; test accuracy: 0.2003
2025-09-24 15:21:01 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:13 [INFO]  Epoch 8 loss: 120.01788711547852; train accuracy: 0.2737630208333333; test accuracy: 0.2758
2025-09-24 15:21:13 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:26 [INFO]  Epoch 9 loss: 117.64519786834717; train accuracy: 0.19954427083333334; test accuracy: 0.1982
2025-09-24 15:21:26 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:21:26 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:21:26 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:21:26 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:37 [INFO]  Epoch 5 loss: 103.8121109008789; train accuracy: 0.1474609375; test accuracy: 0.1433
2025-09-24 15:21:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_5.pth
2025-09-24 15:21:37 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:48 [INFO]  Epoch 6 loss: 101.26595687866211; train accuracy: 0.218359375; test accuracy: 0.2053
2025-09-24 15:21:48 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:58 [INFO]  Epoch 7 loss: 102.63699531555176; train accuracy: 0.2423828125; test accuracy: 0.2316
2025-09-24 15:21:58 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:08 [INFO]  Epoch 8 loss: 100.60397052764893; train accuracy: 0.24140625; test accuracy: 0.2355
2025-09-24 15:22:08 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:18 [INFO]  Epoch 9 loss: 99.26838207244873; train accuracy: 0.1732421875; test accuracy: 0.1753
2025-09-24 15:22:18 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:22:18 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:22:18 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:22:18 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:55 [INFO]  Epoch 5 loss: 392.5968551635742; train accuracy: 0.28994605654761907; test accuracy: 0.2936
2025-09-24 15:22:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_5.pth
2025-09-24 15:22:55 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:32 [INFO]  Epoch 6 loss: 377.07444190979004; train accuracy: 0.3718843005952381; test accuracy: 0.3717
2025-09-24 15:23:32 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:09 [INFO]  Epoch 7 loss: 376.5504331588745; train accuracy: 0.3640252976190476; test accuracy: 0.3542
2025-09-24 15:24:09 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:45 [INFO]  Epoch 8 loss: 368.40441703796387; train accuracy: 0.5161830357142857; test accuracy: 0.509
2025-09-24 15:24:45 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:22 [INFO]  Epoch 9 loss: 359.58567810058594; train accuracy: 0.44777715773809523; test accuracy: 0.445
2025-09-24 15:25:22 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:25:22 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:25:22 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:25:22 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:46 [INFO]  Epoch 5 loss: 256.39177322387695; train accuracy: 0.265625; test accuracy: 0.2702
2025-09-24 15:25:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_5.pth
2025-09-24 15:25:46 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:09 [INFO]  Epoch 6 loss: 260.2035799026489; train accuracy: 0.2506510416666667; test accuracy: 0.2511
2025-09-24 15:26:09 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:36 [INFO]  Epoch 7 loss: 253.75082111358643; train accuracy: 0.3125; test accuracy: 0.3137
2025-09-24 15:26:36 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:59 [INFO]  Epoch 8 loss: 258.1643257141113; train accuracy: 0.3029513888888889; test accuracy: 0.3046
2025-09-24 15:26:59 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:22 [INFO]  Epoch 9 loss: 244.78666877746582; train accuracy: 0.3167679398148148; test accuracy: 0.3207
2025-09-24 15:27:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:27:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:27:22 [INFO]  Round 1 Finish--------|
2025-09-24 15:27:22 [INFO]  Model variance: mean: 0.0014825551770627499, sum: 16566.0
2025-09-24 15:27:22 [INFO]  g_protos_std: 1.005828619003296
2025-09-24 15:27:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7225
2025-09-24 15:27:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:27:27 [INFO]  Round 2 starts--------|
2025-09-24 15:27:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:27:27 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:09 [INFO]  Epoch 10 loss: 421.91072607040405; train accuracy: 0.6570012019230769; test accuracy: 0.64
2025-09-24 15:28:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_10.pth
2025-09-24 15:28:10 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:49 [INFO]  Epoch 11 loss: 419.7035264968872; train accuracy: 0.5552884615384616; test accuracy: 0.5445
2025-09-24 15:28:49 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:23 [INFO]  Epoch 12 loss: 422.0054450035095; train accuracy: 0.5769981971153846; test accuracy: 0.5601
2025-09-24 15:29:23 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:04 [INFO]  Epoch 13 loss: 413.98438358306885; train accuracy: 0.6885141225961539; test accuracy: 0.6742
2025-09-24 15:30:04 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:43 [INFO]  Epoch 14 loss: 407.3045415878296; train accuracy: 0.6508037860576923; test accuracy: 0.6311
2025-09-24 15:30:43 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:30:43 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:30:43 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:30:43 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:54 [INFO]  Epoch 10 loss: 117.46306133270264; train accuracy: 0.27734375; test accuracy: 0.2808
2025-09-24 15:30:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_10.pth
2025-09-24 15:30:54 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:05 [INFO]  Epoch 11 loss: 118.82538032531738; train accuracy: 0.1865234375; test accuracy: 0.192
2025-09-24 15:31:05 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:16 [INFO]  Epoch 12 loss: 116.82957553863525; train accuracy: 0.2555338541666667; test accuracy: 0.2421
2025-09-24 15:31:16 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:28 [INFO]  Epoch 13 loss: 114.42125225067139; train accuracy: 0.19759114583333334; test accuracy: 0.1903
2025-09-24 15:31:28 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:41 [INFO]  Epoch 14 loss: 115.72066688537598; train accuracy: 0.16487630208333334; test accuracy: 0.1657
2025-09-24 15:31:41 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:31:41 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:31:41 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:31:41 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:52 [INFO]  Epoch 10 loss: 97.73335456848145; train accuracy: 0.2435546875; test accuracy: 0.2347
2025-09-24 15:31:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_10.pth
2025-09-24 15:31:52 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:02 [INFO]  Epoch 11 loss: 99.55436611175537; train accuracy: 0.2521484375; test accuracy: 0.2394
2025-09-24 15:32:02 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:13 [INFO]  Epoch 12 loss: 97.4606237411499; train accuracy: 0.2087890625; test accuracy: 0.2093
2025-09-24 15:32:13 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:23 [INFO]  Epoch 13 loss: 96.98217010498047; train accuracy: 0.19140625; test accuracy: 0.1781
2025-09-24 15:32:23 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:32 [INFO]  Epoch 14 loss: 95.67533779144287; train accuracy: 0.2443359375; test accuracy: 0.2463
2025-09-24 15:32:32 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:32:32 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:32:32 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:32:32 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:07 [INFO]  Epoch 10 loss: 357.0120325088501; train accuracy: 0.5734281994047619; test accuracy: 0.5643
2025-09-24 15:33:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_10.pth
2025-09-24 15:33:07 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:42 [INFO]  Epoch 11 loss: 346.70419216156006; train accuracy: 0.525390625; test accuracy: 0.5196
2025-09-24 15:33:42 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:19 [INFO]  Epoch 12 loss: 345.32642126083374; train accuracy: 0.6572730654761905; test accuracy: 0.6384
2025-09-24 15:34:19 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:56 [INFO]  Epoch 13 loss: 347.7501139640808; train accuracy: 0.6189546130952381; test accuracy: 0.6052
2025-09-24 15:34:56 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:33 [INFO]  Epoch 14 loss: 333.99999380111694; train accuracy: 0.6170944940476191; test accuracy: 0.6044
2025-09-24 15:35:33 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:35:33 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:35:33 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:35:33 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:59 [INFO]  Epoch 10 loss: 247.86561107635498; train accuracy: 0.2506510416666667; test accuracy: 0.244
2025-09-24 15:35:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_10.pth
2025-09-24 15:35:59 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:23 [INFO]  Epoch 11 loss: 236.3780574798584; train accuracy: 0.39185474537037035; test accuracy: 0.3847
2025-09-24 15:36:23 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:48 [INFO]  Epoch 12 loss: 238.67415046691895; train accuracy: 0.45883969907407407; test accuracy: 0.4531
2025-09-24 15:36:48 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:13 [INFO]  Epoch 13 loss: 232.87931966781616; train accuracy: 0.3880931712962963; test accuracy: 0.3877
2025-09-24 15:37:13 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:38 [INFO]  Epoch 14 loss: 228.86697340011597; train accuracy: 0.5753038194444444; test accuracy: 0.565
2025-09-24 15:37:38 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:37:38 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:37:38 [INFO]  Round 2 Finish--------|
2025-09-24 15:37:38 [INFO]  Model variance: mean: 0.0018937276909127831, sum: 21160.421875
2025-09-24 15:37:38 [INFO]  g_protos_std: 1.0058245658874512
2025-09-24 15:37:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7712
2025-09-24 15:37:44 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:37:44 [INFO]  Round 3 starts--------|
2025-09-24 15:37:44 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:37:44 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:31 [INFO]  Epoch 15 loss: 406.0816659927368; train accuracy: 0.5998722956730769; test accuracy: 0.5887
2025-09-24 15:38:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_15.pth
2025-09-24 15:38:31 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:18 [INFO]  Epoch 16 loss: 399.2029891014099; train accuracy: 0.6636868990384616; test accuracy: 0.6426
2025-09-24 15:39:18 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:07 [INFO]  Epoch 17 loss: 398.70667839050293; train accuracy: 0.6301081730769231; test accuracy: 0.6082
2025-09-24 15:40:07 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:54 [INFO]  Epoch 18 loss: 401.17709398269653; train accuracy: 0.6378831129807693; test accuracy: 0.618
2025-09-24 15:40:54 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:39 [INFO]  Epoch 19 loss: 393.0880093574524; train accuracy: 0.6990309495192307; test accuracy: 0.6719
2025-09-24 15:41:39 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:41:39 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:41:39 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:41:39 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:51 [INFO]  Epoch 15 loss: 111.84805202484131; train accuracy: 0.23974609375; test accuracy: 0.2432
2025-09-24 15:41:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_15.pth
2025-09-24 15:41:51 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:04 [INFO]  Epoch 16 loss: 113.34221839904785; train accuracy: 0.2957356770833333; test accuracy: 0.287
2025-09-24 15:42:04 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:17 [INFO]  Epoch 17 loss: 115.65180587768555; train accuracy: 0.2731119791666667; test accuracy: 0.2607
2025-09-24 15:42:17 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:29 [INFO]  Epoch 18 loss: 115.71937656402588; train accuracy: 0.2620442708333333; test accuracy: 0.252
2025-09-24 15:42:29 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:42 [INFO]  Epoch 19 loss: 114.3296890258789; train accuracy: 0.2867838541666667; test accuracy: 0.285
2025-09-24 15:42:42 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:42:42 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:42:42 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:42:42 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:52 [INFO]  Epoch 15 loss: 97.55350685119629; train accuracy: 0.2611328125; test accuracy: 0.2481
2025-09-24 15:42:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_15.pth
2025-09-24 15:42:52 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:04 [INFO]  Epoch 16 loss: 95.6133165359497; train accuracy: 0.2365234375; test accuracy: 0.2263
2025-09-24 15:43:04 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:14 [INFO]  Epoch 17 loss: 93.56439876556396; train accuracy: 0.2736328125; test accuracy: 0.2657
2025-09-24 15:43:14 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:25 [INFO]  Epoch 18 loss: 95.66731262207031; train accuracy: 0.293359375; test accuracy: 0.2675
2025-09-24 15:43:25 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:37 [INFO]  Epoch 19 loss: 95.29977798461914; train accuracy: 0.2982421875; test accuracy: 0.2876
2025-09-24 15:43:37 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:43:37 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:43:37 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:43:37 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:14 [INFO]  Epoch 15 loss: 327.3961000442505; train accuracy: 0.6020740327380952; test accuracy: 0.5847
2025-09-24 15:44:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_15.pth
2025-09-24 15:44:14 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:52 [INFO]  Epoch 16 loss: 332.62688875198364; train accuracy: 0.6786644345238095; test accuracy: 0.6645
2025-09-24 15:44:52 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:29 [INFO]  Epoch 17 loss: 323.255331993103; train accuracy: 0.7042875744047619; test accuracy: 0.6798
2025-09-24 15:45:29 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:08 [INFO]  Epoch 18 loss: 330.7389569282532; train accuracy: 0.6913132440476191; test accuracy: 0.6665
2025-09-24 15:46:08 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:45 [INFO]  Epoch 19 loss: 328.7764015197754; train accuracy: 0.6858258928571429; test accuracy: 0.6621
2025-09-24 15:46:45 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:46:45 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:46:45 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:46:45 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:10 [INFO]  Epoch 15 loss: 227.35360050201416; train accuracy: 0.4859664351851852; test accuracy: 0.4761
2025-09-24 15:47:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_15.pth
2025-09-24 15:47:11 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:36 [INFO]  Epoch 16 loss: 227.30363941192627; train accuracy: 0.6119791666666666; test accuracy: 0.5908
2025-09-24 15:47:36 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:00 [INFO]  Epoch 17 loss: 224.14679479599; train accuracy: 0.5046296296296297; test accuracy: 0.4942
2025-09-24 15:48:00 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:24 [INFO]  Epoch 18 loss: 222.53701496124268; train accuracy: 0.5601128472222222; test accuracy: 0.5446
2025-09-24 15:48:24 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:50 [INFO]  Epoch 19 loss: 221.69412231445312; train accuracy: 0.5275607638888888; test accuracy: 0.5089
2025-09-24 15:48:50 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:48:50 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:48:50 [INFO]  Round 3 Finish--------|
2025-09-24 15:48:50 [INFO]  Model variance: mean: 0.0022417735308408737, sum: 25049.46875
2025-09-24 15:48:50 [INFO]  g_protos_std: 1.0058214664459229
2025-09-24 15:48:56 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8004
2025-09-24 15:48:56 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:48:56 [INFO]  Round 4 starts--------|
2025-09-24 15:48:56 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:48:56 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:43 [INFO]  Epoch 20 loss: 393.11700773239136; train accuracy: 0.6546724759615384; test accuracy: 0.6272
2025-09-24 15:49:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_20.pth
2025-09-24 15:49:43 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:28 [INFO]  Epoch 21 loss: 383.10910415649414; train accuracy: 0.7548828125; test accuracy: 0.721
2025-09-24 15:50:28 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:13 [INFO]  Epoch 22 loss: 380.5278687477112; train accuracy: 0.7290790264423077; test accuracy: 0.7021
2025-09-24 15:51:13 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:57 [INFO]  Epoch 23 loss: 373.0837802886963; train accuracy: 0.7517653245192307; test accuracy: 0.7254
2025-09-24 15:51:57 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:43 [INFO]  Epoch 24 loss: 377.26330280303955; train accuracy: 0.7494365985576923; test accuracy: 0.7135
2025-09-24 15:52:43 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:52:43 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:52:43 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:52:43 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:56 [INFO]  Epoch 20 loss: 109.93725204467773; train accuracy: 0.3531901041666667; test accuracy: 0.3423
2025-09-24 15:52:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_20.pth
2025-09-24 15:52:56 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:08 [INFO]  Epoch 21 loss: 110.36145496368408; train accuracy: 0.3465169270833333; test accuracy: 0.3246
2025-09-24 15:53:08 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:20 [INFO]  Epoch 22 loss: 109.12119102478027; train accuracy: 0.3497721354166667; test accuracy: 0.3367
2025-09-24 15:53:20 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:32 [INFO]  Epoch 23 loss: 109.82010173797607; train accuracy: 0.3995768229166667; test accuracy: 0.3875
2025-09-24 15:53:32 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:44 [INFO]  Epoch 24 loss: 108.62972164154053; train accuracy: 0.4060872395833333; test accuracy: 0.3737
2025-09-24 15:53:44 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:53:44 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:53:44 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:53:44 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:55 [INFO]  Epoch 20 loss: 92.01112365722656; train accuracy: 0.31796875; test accuracy: 0.296
2025-09-24 15:53:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_20.pth
2025-09-24 15:53:56 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:06 [INFO]  Epoch 21 loss: 94.56805992126465; train accuracy: 0.36171875; test accuracy: 0.3385
2025-09-24 15:54:06 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:16 [INFO]  Epoch 22 loss: 95.08390140533447; train accuracy: 0.2759765625; test accuracy: 0.2596
2025-09-24 15:54:16 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:27 [INFO]  Epoch 23 loss: 92.20915603637695; train accuracy: 0.3083984375; test accuracy: 0.3023
2025-09-24 15:54:27 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:38 [INFO]  Epoch 24 loss: 94.59010601043701; train accuracy: 0.353515625; test accuracy: 0.3395
2025-09-24 15:54:38 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:54:38 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:54:38 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:54:38 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:15 [INFO]  Epoch 20 loss: 319.0000123977661; train accuracy: 0.7143787202380952; test accuracy: 0.6838
2025-09-24 15:55:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_20.pth
2025-09-24 15:55:15 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:51 [INFO]  Epoch 21 loss: 319.07935190200806; train accuracy: 0.7193545386904762; test accuracy: 0.6916
2025-09-24 15:55:51 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:28 [INFO]  Epoch 22 loss: 318.9711046218872; train accuracy: 0.654296875; test accuracy: 0.6294
2025-09-24 15:56:28 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:04 [INFO]  Epoch 23 loss: 314.25026512145996; train accuracy: 0.5912853422619048; test accuracy: 0.5661
2025-09-24 15:57:04 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:40 [INFO]  Epoch 24 loss: 311.66130018234253; train accuracy: 0.6962890625; test accuracy: 0.6649
2025-09-24 15:57:40 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:57:40 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:57:40 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:57:40 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:04 [INFO]  Epoch 20 loss: 220.54885244369507; train accuracy: 0.5881076388888888; test accuracy: 0.5663
2025-09-24 15:58:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_20.pth
2025-09-24 15:58:04 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:28 [INFO]  Epoch 21 loss: 221.81046152114868; train accuracy: 0.6211660879629629; test accuracy: 0.5994
2025-09-24 15:58:28 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:53 [INFO]  Epoch 22 loss: 215.95483827590942; train accuracy: 0.5391348379629629; test accuracy: 0.5234
2025-09-24 15:58:53 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:16 [INFO]  Epoch 23 loss: 217.48315334320068; train accuracy: 0.5264033564814815; test accuracy: 0.5094
2025-09-24 15:59:16 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:39 [INFO]  Epoch 24 loss: 213.0639100074768; train accuracy: 0.5902054398148148; test accuracy: 0.567
2025-09-24 15:59:39 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:59:39 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:59:39 [INFO]  Round 4 Finish--------|
2025-09-24 15:59:39 [INFO]  Model variance: mean: 0.002558648819103837, sum: 28590.21875
2025-09-24 15:59:39 [INFO]  g_protos_std: 1.0058481693267822
2025-09-24 15:59:45 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8192
2025-09-24 15:59:45 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:59:45 [INFO]  Round 5 starts--------|
2025-09-24 15:59:45 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:59:45 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:28 [INFO]  Epoch 25 loss: 371.2910189628601; train accuracy: 0.7581129807692307; test accuracy: 0.7224
2025-09-24 16:00:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_25.pth
2025-09-24 16:00:28 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:11 [INFO]  Epoch 26 loss: 363.6572222709656; train accuracy: 0.72265625; test accuracy: 0.6937
2025-09-24 16:01:11 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:55 [INFO]  Epoch 27 loss: 370.30357360839844; train accuracy: 0.7969501201923077; test accuracy: 0.7581
2025-09-24 16:01:55 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:40 [INFO]  Epoch 28 loss: 369.41517639160156; train accuracy: 0.7620567908653846; test accuracy: 0.7255
2025-09-24 16:02:40 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:26 [INFO]  Epoch 29 loss: 368.887414932251; train accuracy: 0.7539813701923077; test accuracy: 0.7212
2025-09-24 16:03:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:03:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:03:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:03:26 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:38 [INFO]  Epoch 25 loss: 110.5230360031128; train accuracy: 0.4552408854166667; test accuracy: 0.425
2025-09-24 16:03:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_25.pth
2025-09-24 16:03:39 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:51 [INFO]  Epoch 26 loss: 105.43740558624268; train accuracy: 0.46826171875; test accuracy: 0.4379
2025-09-24 16:03:51 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:03 [INFO]  Epoch 27 loss: 106.85997581481934; train accuracy: 0.3859049479166667; test accuracy: 0.365
2025-09-24 16:04:03 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:15 [INFO]  Epoch 28 loss: 106.43740749359131; train accuracy: 0.3658854166666667; test accuracy: 0.3524
2025-09-24 16:04:15 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:27 [INFO]  Epoch 29 loss: 110.85409641265869; train accuracy: 0.4275716145833333; test accuracy: 0.4048
2025-09-24 16:04:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:04:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:04:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:04:27 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:39 [INFO]  Epoch 25 loss: 91.87172317504883; train accuracy: 0.2796875; test accuracy: 0.2618
2025-09-24 16:04:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_25.pth
2025-09-24 16:04:39 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:50 [INFO]  Epoch 26 loss: 90.1095609664917; train accuracy: 0.332421875; test accuracy: 0.3101
2025-09-24 16:04:50 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:01 [INFO]  Epoch 27 loss: 90.81994247436523; train accuracy: 0.2984375; test accuracy: 0.2785
2025-09-24 16:05:01 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:12 [INFO]  Epoch 28 loss: 90.6674747467041; train accuracy: 0.4169921875; test accuracy: 0.3744
2025-09-24 16:05:12 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:23 [INFO]  Epoch 29 loss: 88.07818126678467; train accuracy: 0.339453125; test accuracy: 0.3185
2025-09-24 16:05:23 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:05:23 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:05:23 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:05:23 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:58 [INFO]  Epoch 25 loss: 313.8586721420288; train accuracy: 0.6591331845238095; test accuracy: 0.6332
2025-09-24 16:05:58 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_25.pth
2025-09-24 16:05:58 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:33 [INFO]  Epoch 26 loss: 312.497266292572; train accuracy: 0.6357421875; test accuracy: 0.6081
2025-09-24 16:06:33 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:07 [INFO]  Epoch 27 loss: 309.98550748825073; train accuracy: 0.7414434523809523; test accuracy: 0.7088
2025-09-24 16:07:07 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:42 [INFO]  Epoch 28 loss: 304.45698976516724; train accuracy: 0.7239583333333334; test accuracy: 0.6887
2025-09-24 16:07:42 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:20 [INFO]  Epoch 29 loss: 303.7290234565735; train accuracy: 0.7352585565476191; test accuracy: 0.695
2025-09-24 16:08:20 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:08:20 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:08:20 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:08:20 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:46 [INFO]  Epoch 25 loss: 205.73643732070923; train accuracy: 0.6511140046296297; test accuracy: 0.6214
2025-09-24 16:08:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_25.pth
2025-09-24 16:08:46 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:09 [INFO]  Epoch 26 loss: 212.26934432983398; train accuracy: 0.6435908564814815; test accuracy: 0.6197
2025-09-24 16:09:09 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:31 [INFO]  Epoch 27 loss: 214.80386972427368; train accuracy: 0.6426504629629629; test accuracy: 0.6161
2025-09-24 16:09:31 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:52 [INFO]  Epoch 28 loss: 207.19636297225952; train accuracy: 0.6659432870370371; test accuracy: 0.6381
2025-09-24 16:09:52 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:14 [INFO]  Epoch 29 loss: 205.53018045425415; train accuracy: 0.67578125; test accuracy: 0.6478
2025-09-24 16:10:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:10:14 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:10:14 [INFO]  Round 5 Finish--------|
2025-09-24 16:10:14 [INFO]  Model variance: mean: 0.0028420439921319485, sum: 31756.86328125
2025-09-24 16:10:14 [INFO]  g_protos_std: 1.0058730840682983
2025-09-24 16:10:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8346
2025-09-24 16:10:19 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml


2025-09-24 15:04:28 [INFO]  Load config from ./configs/CIFAR10_alpha0.1.yaml
2025-09-24 15:04:28 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.1', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.1}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:30 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:30 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 15:04:30 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:31 [INFO]  OneshotOurs
2025-09-24 15:04:31 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 15:04:31 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 15:04:32 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 15:04:34 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 15:04:36 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 15:04:38 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 15:04:40 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 15:04:42 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 15:04:44 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 15:04:46 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 15:04:48 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 15:04:49 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 15:04:51 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 15:04:53 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 15:04:55 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 15:04:57 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 15:04:59 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 15:05:00 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 15:05:02 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 15:05:04 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 15:05:06 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 15:05:08 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 15:05:10 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 15:05:10 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 15:05:11 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 15:05:11 [INFO]  Two-stage training enabled: Alignment epochs set to 1.
2025-09-24 15:05:11 [INFO]  Round 0 starts--------|
2025-09-24 15:05:11 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:17 [INFO]  generating sample per sample
2025-09-24 15:05:17 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:05:50 [INFO]  Epoch 0 loss: 249.7390694618225; train accuracy: 0.003963694852941176; test accuracy: 0.1
2025-09-24 15:05:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_0.pth
2025-09-24 15:05:50 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:23 [INFO]  Epoch 1 loss: 356.60999298095703; train accuracy: 0.3245634191176471; test accuracy: 0.1254
2025-09-24 15:06:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:55 [INFO]  Epoch 2 loss: 328.4556760787964; train accuracy: 0.39803538602941174; test accuracy: 0.2268
2025-09-24 15:06:55 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:27 [INFO]  Epoch 3 loss: 322.3189506530762; train accuracy: 0.4120519301470588; test accuracy: 0.2234
2025-09-24 15:07:27 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:01 [INFO]  Epoch 4 loss: 318.999680519104; train accuracy: 0.3493221507352941; test accuracy: 0.1366
2025-09-24 15:08:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:08:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:08:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:08:06 [INFO]  generating sample per sample
2025-09-24 15:08:06 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:08:40 [INFO]  Epoch 0 loss: 263.9524230957031; train accuracy: 0.23795572916666666; test accuracy: 0.0979
2025-09-24 15:08:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_0.pth
2025-09-24 15:08:40 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:15 [INFO]  Epoch 1 loss: 366.79730319976807; train accuracy: 0.3275282118055556; test accuracy: 0.2025
2025-09-24 15:09:15 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:50 [INFO]  Epoch 2 loss: 346.78671741485596; train accuracy: 0.3514539930555556; test accuracy: 0.1618
2025-09-24 15:09:50 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:22 [INFO]  Epoch 3 loss: 343.9357089996338; train accuracy: 0.4300130208333333; test accuracy: 0.1938
2025-09-24 15:10:22 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:51 [INFO]  Epoch 4 loss: 332.6708917617798; train accuracy: 0.3709852430555556; test accuracy: 0.1782
2025-09-24 15:10:51 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:10:51 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:10:51 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:10:57 [INFO]  generating sample per sample
2025-09-24 15:10:57 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:11:45 [INFO]  Epoch 0 loss: 417.41118335723877; train accuracy: 0.10816271551724138; test accuracy: 0.0794
2025-09-24 15:11:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_0.pth
2025-09-24 15:11:45 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:31 [INFO]  Epoch 1 loss: 589.1502408981323; train accuracy: 0.18622036637931033; test accuracy: 0.1269
2025-09-24 15:12:31 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:23 [INFO]  Epoch 2 loss: 547.1013317108154; train accuracy: 0.37351831896551724; test accuracy: 0.2844
2025-09-24 15:13:23 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:14 [INFO]  Epoch 3 loss: 523.825795173645; train accuracy: 0.44073275862068967; test accuracy: 0.3295
2025-09-24 15:14:14 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:06 [INFO]  Epoch 4 loss: 503.0039210319519; train accuracy: 0.45969154094827586; test accuracy: 0.33
2025-09-24 15:15:06 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:15:06 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:15:06 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:15:08 [INFO]  generating sample per sample
2025-09-24 15:15:08 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:15:24 [INFO]  Epoch 0 loss: 118.80098628997803; train accuracy: 0.0; test accuracy: 0.1
2025-09-24 15:15:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_0.pth
2025-09-24 15:15:25 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:41 [INFO]  Epoch 1 loss: 183.2868938446045; train accuracy: 0.427734375; test accuracy: 0.0935
2025-09-24 15:15:41 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:57 [INFO]  Epoch 2 loss: 139.71093463897705; train accuracy: 0.2890625; test accuracy: 0.1139
2025-09-24 15:15:57 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:14 [INFO]  Epoch 3 loss: 135.5022144317627; train accuracy: 0.414794921875; test accuracy: 0.1543
2025-09-24 15:16:14 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:29 [INFO]  Epoch 4 loss: 133.57602882385254; train accuracy: 0.356201171875; test accuracy: 0.1591
2025-09-24 15:16:29 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:16:29 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:16:29 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:16:30 [INFO]  generating sample per sample
2025-09-24 15:16:30 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:16:35 [INFO]  Epoch 0 loss: 22.724289417266846; train accuracy: 0.0234375; test accuracy: 0.0958
2025-09-24 15:16:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_0.pth
2025-09-24 15:16:35 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:41 [INFO]  Epoch 1 loss: 32.32416915893555; train accuracy: 0.9153645833333334; test accuracy: 0.0992
2025-09-24 15:16:41 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:45 [INFO]  Epoch 2 loss: 28.81474208831787; train accuracy: 0.9615885416666666; test accuracy: 0.1
2025-09-24 15:16:45 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:51 [INFO]  Epoch 3 loss: 25.165142059326172; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 15:16:51 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:56 [INFO]  Epoch 4 loss: 23.48849058151245; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 15:16:56 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:16:56 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:16:56 [INFO]  Round 0 Finish--------|
2025-09-24 15:16:56 [INFO]  Model variance: mean: 0.0011533640790730715, sum: 12887.634765625
2025-09-24 15:16:56 [INFO]  g_protos_std: 1.006218671798706
2025-09-24 15:17:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4538
2025-09-24 15:17:01 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:17:01 [INFO]  Round 1 starts--------|
2025-09-24 15:17:01 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:17:01 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:17:33 [INFO]  Epoch 5 loss: 234.05870962142944; train accuracy: 0.41934742647058826; test accuracy: 0.1962
2025-09-24 15:17:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_5.pth
2025-09-24 15:17:33 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:05 [INFO]  Epoch 6 loss: 311.05858612060547; train accuracy: 0.44152113970588236; test accuracy: 0.2006
2025-09-24 15:18:05 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:36 [INFO]  Epoch 7 loss: 306.9680299758911; train accuracy: 0.4332490808823529; test accuracy: 0.1768
2025-09-24 15:18:36 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:05 [INFO]  Epoch 8 loss: 302.6181745529175; train accuracy: 0.4931640625; test accuracy: 0.2188
2025-09-24 15:19:05 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:35 [INFO]  Epoch 9 loss: 295.3625297546387; train accuracy: 0.4944852941176471; test accuracy: 0.2249
2025-09-24 15:19:35 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:19:35 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:19:35 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:19:35 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:20:08 [INFO]  Epoch 5 loss: 247.13538694381714; train accuracy: 0.2857530381944444; test accuracy: 0.1792
2025-09-24 15:20:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_5.pth
2025-09-24 15:20:09 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:41 [INFO]  Epoch 6 loss: 327.35936737060547; train accuracy: 0.34716796875; test accuracy: 0.1969
2025-09-24 15:20:41 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:15 [INFO]  Epoch 7 loss: 324.75744342803955; train accuracy: 0.40869140625; test accuracy: 0.2319
2025-09-24 15:21:15 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:47 [INFO]  Epoch 8 loss: 316.2979850769043; train accuracy: 0.5067816840277778; test accuracy: 0.2762
2025-09-24 15:21:47 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:18 [INFO]  Epoch 9 loss: 314.5745334625244; train accuracy: 0.6247287326388888; test accuracy: 0.341
2025-09-24 15:22:18 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:22:18 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:22:18 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:22:18 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:23:10 [INFO]  Epoch 5 loss: 377.71751642227173; train accuracy: 0.5268049568965517; test accuracy: 0.3869
2025-09-24 15:23:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_5.pth
2025-09-24 15:23:11 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:00 [INFO]  Epoch 6 loss: 476.63308477401733; train accuracy: 0.38190328663793105; test accuracy: 0.2785
2025-09-24 15:24:00 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:52 [INFO]  Epoch 7 loss: 451.900297164917; train accuracy: 0.5343480603448276; test accuracy: 0.3849
2025-09-24 15:24:52 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:43 [INFO]  Epoch 8 loss: 450.3306498527527; train accuracy: 0.6430495689655172; test accuracy: 0.4621
2025-09-24 15:25:43 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:34 [INFO]  Epoch 9 loss: 451.2130002975464; train accuracy: 0.5697400323275862; test accuracy: 0.4043
2025-09-24 15:26:34 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:26:34 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:26:34 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:26:34 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:26:50 [INFO]  Epoch 5 loss: 110.4087462425232; train accuracy: 0.5546875; test accuracy: 0.1061
2025-09-24 15:26:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_5.pth
2025-09-24 15:26:51 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:06 [INFO]  Epoch 6 loss: 130.28873348236084; train accuracy: 0.2802734375; test accuracy: 0.1099
2025-09-24 15:27:06 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:22 [INFO]  Epoch 7 loss: 129.11658191680908; train accuracy: 0.4354248046875; test accuracy: 0.1384
2025-09-24 15:27:22 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:38 [INFO]  Epoch 8 loss: 125.73445463180542; train accuracy: 0.56982421875; test accuracy: 0.1122
2025-09-24 15:27:38 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:55 [INFO]  Epoch 9 loss: 127.5736494064331; train accuracy: 0.574951171875; test accuracy: 0.1198
2025-09-24 15:27:55 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:27:55 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:27:55 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:27:55 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:28:01 [INFO]  Epoch 5 loss: 21.837228775024414; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 15:28:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_5.pth
2025-09-24 15:28:01 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:06 [INFO]  Epoch 6 loss: 23.25357723236084; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 15:28:06 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:11 [INFO]  Epoch 7 loss: 23.03349208831787; train accuracy: 0.962890625; test accuracy: 0.1
2025-09-24 15:28:11 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:17 [INFO]  Epoch 8 loss: 22.687702655792236; train accuracy: 0.9622395833333334; test accuracy: 0.1
2025-09-24 15:28:17 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:22 [INFO]  Epoch 9 loss: 22.674650192260742; train accuracy: 0.9700520833333334; test accuracy: 0.1
2025-09-24 15:28:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:28:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:28:22 [INFO]  Round 1 Finish--------|
2025-09-24 15:28:22 [INFO]  Model variance: mean: 0.001528104767203331, sum: 17074.96875
2025-09-24 15:28:22 [INFO]  g_protos_std: 1.0062068700790405
2025-09-24 15:28:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5319
2025-09-24 15:28:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:28:27 [INFO]  Round 2 starts--------|
2025-09-24 15:28:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:28:27 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:28:53 [INFO]  Epoch 10 loss: 228.84330701828003; train accuracy: 0.4742647058823529; test accuracy: 0.2139
2025-09-24 15:28:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_10.pth
2025-09-24 15:28:55 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:19 [INFO]  Epoch 11 loss: 292.7948212623596; train accuracy: 0.4515165441176471; test accuracy: 0.2306
2025-09-24 15:29:19 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:47 [INFO]  Epoch 12 loss: 292.27836322784424; train accuracy: 0.48816636029411764; test accuracy: 0.2188
2025-09-24 15:29:47 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:18 [INFO]  Epoch 13 loss: 289.4166350364685; train accuracy: 0.6459099264705882; test accuracy: 0.3476
2025-09-24 15:30:18 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:48 [INFO]  Epoch 14 loss: 284.4958071708679; train accuracy: 0.6532628676470589; test accuracy: 0.3363
2025-09-24 15:30:48 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:30:48 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:30:48 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:30:48 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:31:20 [INFO]  Epoch 10 loss: 238.292950630188; train accuracy: 0.5228949652777778; test accuracy: 0.3127
2025-09-24 15:31:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_10.pth
2025-09-24 15:31:20 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:54 [INFO]  Epoch 11 loss: 308.6419219970703; train accuracy: 0.6304796006944444; test accuracy: 0.3323
2025-09-24 15:31:54 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:27 [INFO]  Epoch 12 loss: 306.97715854644775; train accuracy: 0.5707465277777778; test accuracy: 0.3298
2025-09-24 15:32:27 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:57 [INFO]  Epoch 13 loss: 301.8800640106201; train accuracy: 0.6201714409722222; test accuracy: 0.3399
2025-09-24 15:32:57 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:32 [INFO]  Epoch 14 loss: 294.26896238327026; train accuracy: 0.6600477430555556; test accuracy: 0.3647
2025-09-24 15:33:32 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:33:32 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:33:32 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:33:32 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:34:26 [INFO]  Epoch 10 loss: 356.9254994392395; train accuracy: 0.6199824892241379; test accuracy: 0.4472
2025-09-24 15:34:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_10.pth
2025-09-24 15:34:26 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:20 [INFO]  Epoch 11 loss: 430.496301651001; train accuracy: 0.5935816271551724; test accuracy: 0.4221
2025-09-24 15:35:20 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:14 [INFO]  Epoch 12 loss: 430.0027780532837; train accuracy: 0.7183795797413793; test accuracy: 0.4985
2025-09-24 15:36:14 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:09 [INFO]  Epoch 13 loss: 421.14458894729614; train accuracy: 0.7515153556034483; test accuracy: 0.5295
2025-09-24 15:37:09 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:00 [INFO]  Epoch 14 loss: 430.1682620048523; train accuracy: 0.7917901400862069; test accuracy: 0.5539
2025-09-24 15:38:00 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:38:00 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:38:00 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:38:00 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:38:17 [INFO]  Epoch 10 loss: 108.05468559265137; train accuracy: 0.634765625; test accuracy: 0.161
2025-09-24 15:38:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_10.pth
2025-09-24 15:38:18 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:36 [INFO]  Epoch 11 loss: 125.16490125656128; train accuracy: 0.6787109375; test accuracy: 0.2025
2025-09-24 15:38:36 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:53 [INFO]  Epoch 12 loss: 123.52337837219238; train accuracy: 0.6353759765625; test accuracy: 0.1421
2025-09-24 15:38:53 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:10 [INFO]  Epoch 13 loss: 124.74092388153076; train accuracy: 0.7528076171875; test accuracy: 0.206
2025-09-24 15:39:10 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:27 [INFO]  Epoch 14 loss: 121.79448413848877; train accuracy: 0.6314697265625; test accuracy: 0.1423
2025-09-24 15:39:27 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:39:27 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:39:27 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:39:28 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:39:33 [INFO]  Epoch 10 loss: 21.35039234161377; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 15:39:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_10.pth
2025-09-24 15:39:33 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:39 [INFO]  Epoch 11 loss: 22.313961505889893; train accuracy: 0.966796875; test accuracy: 0.1005
2025-09-24 15:39:39 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:44 [INFO]  Epoch 12 loss: 22.306599617004395; train accuracy: 0.9700520833333334; test accuracy: 0.1
2025-09-24 15:39:44 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:49 [INFO]  Epoch 13 loss: 22.218222618103027; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 15:39:49 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:55 [INFO]  Epoch 14 loss: 22.2318377494812; train accuracy: 0.966796875; test accuracy: 0.1001
2025-09-24 15:39:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:39:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:39:55 [INFO]  Round 2 Finish--------|
2025-09-24 15:39:55 [INFO]  Model variance: mean: 0.0018462833249941468, sum: 20630.28125
2025-09-24 15:39:55 [INFO]  g_protos_std: 1.0062203407287598
2025-09-24 15:40:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5988
2025-09-24 15:40:00 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:40:00 [INFO]  Round 3 starts--------|
2025-09-24 15:40:00 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:40:00 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:40:35 [INFO]  Epoch 15 loss: 224.43191146850586; train accuracy: 0.5571001838235294; test accuracy: 0.2691
2025-09-24 15:40:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_15.pth
2025-09-24 15:40:35 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:17 [INFO]  Epoch 16 loss: 278.6641516685486; train accuracy: 0.6718175551470589; test accuracy: 0.354
2025-09-24 15:41:17 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:58 [INFO]  Epoch 17 loss: 275.3071346282959; train accuracy: 0.5814568014705882; test accuracy: 0.2828
2025-09-24 15:41:58 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:43 [INFO]  Epoch 18 loss: 272.6315288543701; train accuracy: 0.5411879595588235; test accuracy: 0.2816
2025-09-24 15:42:43 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:26 [INFO]  Epoch 19 loss: 270.78666830062866; train accuracy: 0.6897403492647058; test accuracy: 0.3626
2025-09-24 15:43:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:43:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:43:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:43:26 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:44:10 [INFO]  Epoch 15 loss: 234.1968207359314; train accuracy: 0.7188042534722222; test accuracy: 0.3832
2025-09-24 15:44:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_15.pth
2025-09-24 15:44:10 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:53 [INFO]  Epoch 16 loss: 296.14825963974; train accuracy: 0.6165907118055556; test accuracy: 0.3281
2025-09-24 15:44:53 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:35 [INFO]  Epoch 17 loss: 284.49557638168335; train accuracy: 0.7084418402777778; test accuracy: 0.3866
2025-09-24 15:45:35 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:19 [INFO]  Epoch 18 loss: 285.53703260421753; train accuracy: 0.66357421875; test accuracy: 0.3787
2025-09-24 15:46:19 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:03 [INFO]  Epoch 19 loss: 283.7477765083313; train accuracy: 0.5559353298611112; test accuracy: 0.3028
2025-09-24 15:47:03 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:47:03 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:47:03 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:47:03 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:48:11 [INFO]  Epoch 15 loss: 348.4212746620178; train accuracy: 0.6876010237068966; test accuracy: 0.4779
2025-09-24 15:48:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_15.pth
2025-09-24 15:48:11 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:22 [INFO]  Epoch 16 loss: 414.7922568321228; train accuracy: 0.8189318426724138; test accuracy: 0.5719
2025-09-24 15:49:22 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:32 [INFO]  Epoch 17 loss: 407.7281336784363; train accuracy: 0.8415274784482759; test accuracy: 0.5857
2025-09-24 15:50:32 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:40 [INFO]  Epoch 18 loss: 408.7122287750244; train accuracy: 0.677667025862069; test accuracy: 0.4817
2025-09-24 15:51:40 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:49 [INFO]  Epoch 19 loss: 402.17960834503174; train accuracy: 0.8372171336206896; test accuracy: 0.5859
2025-09-24 15:52:49 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:52:49 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:52:49 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:52:49 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:53:11 [INFO]  Epoch 15 loss: 106.20969104766846; train accuracy: 0.7742919921875; test accuracy: 0.2412
2025-09-24 15:53:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_15.pth
2025-09-24 15:53:11 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:32 [INFO]  Epoch 16 loss: 120.92967700958252; train accuracy: 0.794189453125; test accuracy: 0.2293
2025-09-24 15:53:32 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:53 [INFO]  Epoch 17 loss: 119.91599464416504; train accuracy: 0.777587890625; test accuracy: 0.2356
2025-09-24 15:53:53 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:14 [INFO]  Epoch 18 loss: 121.75048732757568; train accuracy: 0.798828125; test accuracy: 0.2199
2025-09-24 15:54:14 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:35 [INFO]  Epoch 19 loss: 120.0098443031311; train accuracy: 0.6365966796875; test accuracy: 0.2181
2025-09-24 15:54:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:54:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:54:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:54:35 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:54:42 [INFO]  Epoch 15 loss: 21.090219974517822; train accuracy: 0.9635416666666666; test accuracy: 0.1
2025-09-24 15:54:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_15.pth
2025-09-24 15:54:42 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:49 [INFO]  Epoch 16 loss: 22.112759590148926; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 15:54:49 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:55 [INFO]  Epoch 17 loss: 22.039754390716553; train accuracy: 0.962890625; test accuracy: 0.1001
2025-09-24 15:54:55 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:02 [INFO]  Epoch 18 loss: 22.10292959213257; train accuracy: 0.966796875; test accuracy: 0.1
2025-09-24 15:55:02 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:08 [INFO]  Epoch 19 loss: 21.936262130737305; train accuracy: 0.9622395833333334; test accuracy: 0.1
2025-09-24 15:55:08 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:55:08 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:55:08 [INFO]  Round 3 Finish--------|
2025-09-24 15:55:08 [INFO]  Model variance: mean: 0.0021200100891292095, sum: 23688.890625
2025-09-24 15:55:08 [INFO]  g_protos_std: 1.0062510967254639
2025-09-24 15:55:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6423
2025-09-24 15:55:18 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:55:18 [INFO]  Round 4 starts--------|
2025-09-24 15:55:18 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:55:18 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:55:57 [INFO]  Epoch 20 loss: 220.23460817337036; train accuracy: 0.6676815257352942; test accuracy: 0.3265
2025-09-24 15:55:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_20.pth
2025-09-24 15:55:57 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:40 [INFO]  Epoch 21 loss: 270.4254484176636; train accuracy: 0.6988166360294118; test accuracy: 0.3486
2025-09-24 15:56:40 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:22 [INFO]  Epoch 22 loss: 266.2601971626282; train accuracy: 0.712890625; test accuracy: 0.3621
2025-09-24 15:57:22 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:02 [INFO]  Epoch 23 loss: 265.10137367248535; train accuracy: 0.7491957720588235; test accuracy: 0.3946
2025-09-24 15:58:02 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:42 [INFO]  Epoch 24 loss: 262.82434368133545; train accuracy: 0.7178883272058824; test accuracy: 0.3973
2025-09-24 15:58:42 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:58:42 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:58:42 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:58:42 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:59:25 [INFO]  Epoch 20 loss: 231.2903971672058; train accuracy: 0.5885416666666666; test accuracy: 0.342
2025-09-24 15:59:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_20.pth
2025-09-24 15:59:25 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:08 [INFO]  Epoch 21 loss: 274.26326036453247; train accuracy: 0.6104058159722222; test accuracy: 0.3352
2025-09-24 16:00:08 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:51 [INFO]  Epoch 22 loss: 279.850839138031; train accuracy: 0.6795247395833334; test accuracy: 0.3891
2025-09-24 16:00:51 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:35 [INFO]  Epoch 23 loss: 283.09374809265137; train accuracy: 0.6912434895833334; test accuracy: 0.3799
2025-09-24 16:01:35 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:19 [INFO]  Epoch 24 loss: 272.5702247619629; train accuracy: 0.7776150173611112; test accuracy: 0.4511
2025-09-24 16:02:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:02:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:02:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:02:19 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:03:27 [INFO]  Epoch 20 loss: 342.8611798286438; train accuracy: 0.8049232219827587; test accuracy: 0.5611
2025-09-24 16:03:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_20.pth
2025-09-24 16:03:27 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:35 [INFO]  Epoch 21 loss: 401.07765531539917; train accuracy: 0.8245218211206896; test accuracy: 0.5746
2025-09-24 16:04:35 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:42 [INFO]  Epoch 22 loss: 395.0085029602051; train accuracy: 0.8014547413793104; test accuracy: 0.5618
2025-09-24 16:05:42 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:48 [INFO]  Epoch 23 loss: 392.2410469055176; train accuracy: 0.7407058189655172; test accuracy: 0.5247
2025-09-24 16:06:48 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:54 [INFO]  Epoch 24 loss: 392.84196281433105; train accuracy: 0.8444908405172413; test accuracy: 0.5873
2025-09-24 16:07:54 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:07:54 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:07:54 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:07:54 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:08:14 [INFO]  Epoch 20 loss: 105.23397922515869; train accuracy: 0.7879638671875; test accuracy: 0.2225
2025-09-24 16:08:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_20.pth
2025-09-24 16:08:15 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:37 [INFO]  Epoch 21 loss: 117.46828556060791; train accuracy: 0.7646484375; test accuracy: 0.2252
2025-09-24 16:08:37 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:58 [INFO]  Epoch 22 loss: 120.79213285446167; train accuracy: 0.8033447265625; test accuracy: 0.2447
2025-09-24 16:08:58 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:18 [INFO]  Epoch 23 loss: 118.25249338150024; train accuracy: 0.7503662109375; test accuracy: 0.2028
2025-09-24 16:09:18 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:38 [INFO]  Epoch 24 loss: 117.17687273025513; train accuracy: 0.7066650390625; test accuracy: 0.1766
2025-09-24 16:09:38 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:09:38 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:09:38 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:09:38 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:09:45 [INFO]  Epoch 20 loss: 20.991969108581543; train accuracy: 0.9641927083333334; test accuracy: 0.1
2025-09-24 16:09:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_20.pth
2025-09-24 16:09:45 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:52 [INFO]  Epoch 21 loss: 21.933143138885498; train accuracy: 0.9654947916666666; test accuracy: 0.1
2025-09-24 16:09:52 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:58 [INFO]  Epoch 22 loss: 21.972224712371826; train accuracy: 0.9635416666666666; test accuracy: 0.1011
2025-09-24 16:09:58 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:04 [INFO]  Epoch 23 loss: 21.888742446899414; train accuracy: 0.96484375; test accuracy: 0.1001
2025-09-24 16:10:04 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:10 [INFO]  Epoch 24 loss: 22.024396419525146; train accuracy: 0.962890625; test accuracy: 0.1003
2025-09-24 16:10:10 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:10:10 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:10:10 [INFO]  Round 4 Finish--------|
2025-09-24 16:10:10 [INFO]  Model variance: mean: 0.002363751409575343, sum: 26412.443359375
2025-09-24 16:10:10 [INFO]  g_protos_std: 1.006292462348938
2025-09-24 16:10:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6868
2025-09-24 16:10:19 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:10:19 [INFO]  Round 5 starts--------|
2025-09-24 16:10:19 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:10:19 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:10:59 [INFO]  Epoch 25 loss: 217.68465375900269; train accuracy: 0.7804457720588235; test accuracy: 0.4305
2025-09-24 16:11:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_25.pth
2025-09-24 16:11:00 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:39 [INFO]  Epoch 26 loss: 256.57817697525024; train accuracy: 0.7647058823529411; test accuracy: 0.4106
2025-09-24 16:11:39 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:19 [INFO]  Epoch 27 loss: 254.77622652053833; train accuracy: 0.8235294117647058; test accuracy: 0.4619
2025-09-24 16:12:19 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:58 [INFO]  Epoch 28 loss: 256.92017936706543; train accuracy: 0.7179457720588235; test accuracy: 0.4065
2025-09-24 16:12:58 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:37 [INFO]  Epoch 29 loss: 263.51005601882935; train accuracy: 0.7678653492647058; test accuracy: 0.4416
2025-09-24 16:13:37 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:13:37 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:13:37 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:13:37 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:14:18 [INFO]  Epoch 25 loss: 226.38971996307373; train accuracy: 0.6887478298611112; test accuracy: 0.3836
2025-09-24 16:14:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_25.pth
2025-09-24 16:14:18 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:00 [INFO]  Epoch 26 loss: 269.6948890686035; train accuracy: 0.7405598958333334; test accuracy: 0.398
2025-09-24 16:15:00 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:41 [INFO]  Epoch 27 loss: 268.8163471221924; train accuracy: 0.7312825520833334; test accuracy: 0.4138
2025-09-24 16:15:41 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:24 [INFO]  Epoch 28 loss: 275.33685064315796; train accuracy: 0.7154405381944444; test accuracy: 0.4025
2025-09-24 16:16:24 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:04 [INFO]  Epoch 29 loss: 268.3374562263489; train accuracy: 0.7565646701388888; test accuracy: 0.4101
2025-09-24 16:17:04 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:17:04 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:17:04 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:17:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:18:09 [INFO]  Epoch 25 loss: 336.35452032089233; train accuracy: 0.8348262392241379; test accuracy: 0.5827
2025-09-24 16:18:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_25.pth
2025-09-24 16:18:09 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:14 [INFO]  Epoch 26 loss: 388.18365573883057; train accuracy: 0.8415611530172413; test accuracy: 0.5897
2025-09-24 16:19:14 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:20 [INFO]  Epoch 27 loss: 383.5043568611145; train accuracy: 0.8098060344827587; test accuracy: 0.5647
2025-09-24 16:20:20 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:29 [INFO]  Epoch 28 loss: 385.5308656692505; train accuracy: 0.8690396012931034; test accuracy: 0.6018
2025-09-24 16:21:29 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:35 [INFO]  Epoch 29 loss: 383.17937183380127; train accuracy: 0.8535492995689655; test accuracy: 0.5913
2025-09-24 16:22:35 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:22:35 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:22:35 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:22:35 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:22:55 [INFO]  Epoch 25 loss: 104.27815961837769; train accuracy: 0.68701171875; test accuracy: 0.2024
2025-09-24 16:22:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_25.pth
2025-09-24 16:22:55 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:15 [INFO]  Epoch 26 loss: 116.63811159133911; train accuracy: 0.8487548828125; test accuracy: 0.2447
2025-09-24 16:23:15 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:36 [INFO]  Epoch 27 loss: 116.79712438583374; train accuracy: 0.827392578125; test accuracy: 0.2252
2025-09-24 16:23:36 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:57 [INFO]  Epoch 28 loss: 115.56468057632446; train accuracy: 0.8095703125; test accuracy: 0.2469
2025-09-24 16:23:57 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:19 [INFO]  Epoch 29 loss: 114.50466728210449; train accuracy: 0.787353515625; test accuracy: 0.2054
2025-09-24 16:24:19 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:24:19 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:24:19 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:24:19 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:24:25 [INFO]  Epoch 25 loss: 20.937666416168213; train accuracy: 0.96484375; test accuracy: 0.1
2025-09-24 16:24:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_25.pth
2025-09-24 16:24:26 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:33 [INFO]  Epoch 26 loss: 21.88945770263672; train accuracy: 0.9635416666666666; test accuracy: 0.1
2025-09-24 16:24:33 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:39 [INFO]  Epoch 27 loss: 21.973981857299805; train accuracy: 0.962890625; test accuracy: 0.1006
2025-09-24 16:24:39 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:47 [INFO]  Epoch 28 loss: 21.828516960144043; train accuracy: 0.9635416666666666; test accuracy: 0.1096
2025-09-24 16:24:47 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:53 [INFO]  Epoch 29 loss: 21.85486936569214; train accuracy: 0.966796875; test accuracy: 0.1039
2025-09-24 16:24:53 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:24:53 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:24:53 [INFO]  Round 5 Finish--------|
2025-09-24 16:24:53 [INFO]  Model variance: mean: 0.0025830648373812437, sum: 28863.04296875
2025-09-24 16:24:53 [INFO]  g_protos_std: 1.0063369274139404
2025-09-24 16:25:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7001
2025-09-24 16:25:02 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml


2025-09-24 15:04:35 [INFO]  Load config from ./configs/CIFAR10_alpha0.1.yaml
2025-09-24 15:04:35 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.1', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.1}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:37 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:37 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:37 [INFO]  OneshotOurs
2025-09-24 15:04:38 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 15:04:38 [INFO]  Round 0 starts--------|
2025-09-24 15:04:38 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:04:45 [INFO]  generating sample per sample
2025-09-24 15:04:45 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:05:26 [INFO]  Epoch 0 loss: 475.3491897583008; train accuracy: 0.20171693313953487; test accuracy: 0.2041
2025-09-24 15:05:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_0.pth
2025-09-24 15:05:26 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:05 [INFO]  Epoch 1 loss: 438.87411975860596; train accuracy: 0.21534338662790697; test accuracy: 0.2154
2025-09-24 15:06:05 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:45 [INFO]  Epoch 2 loss: 432.0126829147339; train accuracy: 0.290515988372093; test accuracy: 0.2917
2025-09-24 15:06:45 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:25 [INFO]  Epoch 3 loss: 410.6517744064331; train accuracy: 0.37640806686046513; test accuracy: 0.3692
2025-09-24 15:07:25 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:05 [INFO]  Epoch 4 loss: 400.7718439102173; train accuracy: 0.40788517441860467; test accuracy: 0.3967
2025-09-24 15:08:05 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:08:05 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:08:05 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:08:06 [INFO]  generating sample per sample
2025-09-24 15:08:06 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:19 [INFO]  Epoch 0 loss: 143.12223434448242; train accuracy: 0.10286458333333333; test accuracy: 0.1059
2025-09-24 15:08:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_0.pth
2025-09-24 15:08:19 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:31 [INFO]  Epoch 1 loss: 132.526517868042; train accuracy: 0.12744140625; test accuracy: 0.1319
2025-09-24 15:08:31 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:44 [INFO]  Epoch 2 loss: 126.33635711669922; train accuracy: 0.11263020833333333; test accuracy: 0.1187
2025-09-24 15:08:44 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:58 [INFO]  Epoch 3 loss: 128.07784748077393; train accuracy: 0.19189453125; test accuracy: 0.1998
2025-09-24 15:08:58 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:10 [INFO]  Epoch 4 loss: 124.62403106689453; train accuracy: 0.17399088541666666; test accuracy: 0.1739
2025-09-24 15:09:10 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:09:10 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:09:10 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:09:16 [INFO]  generating sample per sample
2025-09-24 15:09:16 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:51 [INFO]  Epoch 0 loss: 401.61394596099854; train accuracy: 0.19373914930555555; test accuracy: 0.1907
2025-09-24 15:09:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_0.pth
2025-09-24 15:09:51 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:23 [INFO]  Epoch 1 loss: 372.1952905654907; train accuracy: 0.1823459201388889; test accuracy: 0.1791
2025-09-24 15:10:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:51 [INFO]  Epoch 2 loss: 363.5567579269409; train accuracy: 0.20155164930555555; test accuracy: 0.1984
2025-09-24 15:10:51 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:23 [INFO]  Epoch 3 loss: 359.25761890411377; train accuracy: 0.20670572916666666; test accuracy: 0.2017
2025-09-24 15:11:23 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:50 [INFO]  Epoch 4 loss: 351.2638359069824; train accuracy: 0.3209092881944444; test accuracy: 0.3169
2025-09-24 15:11:50 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:11:50 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:11:50 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:11:56 [INFO]  generating sample per sample
2025-09-24 15:11:56 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:35 [INFO]  Epoch 0 loss: 496.1458225250244; train accuracy: 0.143359375; test accuracy: 0.1436
2025-09-24 15:12:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_0.pth
2025-09-24 15:12:35 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:18 [INFO]  Epoch 1 loss: 463.39798069000244; train accuracy: 0.19036458333333334; test accuracy: 0.1908
2025-09-24 15:13:18 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:57 [INFO]  Epoch 2 loss: 448.77001667022705; train accuracy: 0.26419270833333336; test accuracy: 0.2649
2025-09-24 15:13:58 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:36 [INFO]  Epoch 3 loss: 436.77994441986084; train accuracy: 0.2790798611111111; test accuracy: 0.2824
2025-09-24 15:14:36 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:16 [INFO]  Epoch 4 loss: 424.6337585449219; train accuracy: 0.27760416666666665; test accuracy: 0.2788
2025-09-24 15:15:16 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:15:16 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:15:16 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:15:21 [INFO]  generating sample per sample
2025-09-24 15:15:21 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:51 [INFO]  Epoch 0 loss: 391.6156539916992; train accuracy: 0.16824776785714285; test accuracy: 0.1777
2025-09-24 15:15:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_0.pth
2025-09-24 15:15:52 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:23 [INFO]  Epoch 1 loss: 362.58934211730957; train accuracy: 0.208203125; test accuracy: 0.2096
2025-09-24 15:16:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:55 [INFO]  Epoch 2 loss: 354.2246437072754; train accuracy: 0.20703125; test accuracy: 0.2126
2025-09-24 15:16:55 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:28 [INFO]  Epoch 3 loss: 345.8956756591797; train accuracy: 0.24224330357142856; test accuracy: 0.2453
2025-09-24 15:17:28 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:01 [INFO]  Epoch 4 loss: 339.81267738342285; train accuracy: 0.33431919642857144; test accuracy: 0.3274
2025-09-24 15:18:01 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:18:01 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:18:01 [INFO]  Round 0 Finish--------|
2025-09-24 15:18:01 [INFO]  Model variance: mean: 0.001085988711565733, sum: 12134.78515625
2025-09-24 15:18:01 [INFO]  g_protos_std: 1.0058295726776123
2025-09-24 15:18:07 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.61
2025-09-24 15:18:07 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:18:07 [INFO]  Round 1 starts--------|
2025-09-24 15:18:07 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:18:07 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:46 [INFO]  Epoch 5 loss: 396.3125457763672; train accuracy: 0.43859011627906974; test accuracy: 0.4314
2025-09-24 15:18:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_5.pth
2025-09-24 15:18:47 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:25 [INFO]  Epoch 6 loss: 392.05355644226074; train accuracy: 0.3840843023255814; test accuracy: 0.3787
2025-09-24 15:19:25 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:05 [INFO]  Epoch 7 loss: 375.3537497520447; train accuracy: 0.44781068313953487; test accuracy: 0.4346
2025-09-24 15:20:05 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:42 [INFO]  Epoch 8 loss: 376.3120222091675; train accuracy: 0.46116460755813954; test accuracy: 0.4545
2025-09-24 15:20:42 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:21 [INFO]  Epoch 9 loss: 364.6145405769348; train accuracy: 0.5445130813953488; test accuracy: 0.5343
2025-09-24 15:21:21 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:21:21 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:21:21 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:21:21 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:35 [INFO]  Epoch 5 loss: 125.68291282653809; train accuracy: 0.1865234375; test accuracy: 0.1923
2025-09-24 15:21:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_5.pth
2025-09-24 15:21:35 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:49 [INFO]  Epoch 6 loss: 122.75956153869629; train accuracy: 0.1279296875; test accuracy: 0.1387
2025-09-24 15:21:49 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:01 [INFO]  Epoch 7 loss: 124.02735424041748; train accuracy: 0.279296875; test accuracy: 0.2829
2025-09-24 15:22:01 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:13 [INFO]  Epoch 8 loss: 120.84082698822021; train accuracy: 0.24202473958333334; test accuracy: 0.254
2025-09-24 15:22:13 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:26 [INFO]  Epoch 9 loss: 120.60171413421631; train accuracy: 0.24609375; test accuracy: 0.2524
2025-09-24 15:22:26 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:22:26 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:22:26 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:22:26 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:59 [INFO]  Epoch 5 loss: 339.53210830688477; train accuracy: 0.3130425347222222; test accuracy: 0.3122
2025-09-24 15:22:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_5.pth
2025-09-24 15:22:59 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:31 [INFO]  Epoch 6 loss: 339.3637647628784; train accuracy: 0.3396267361111111; test accuracy: 0.337
2025-09-24 15:23:31 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:05 [INFO]  Epoch 7 loss: 329.4298343658447; train accuracy: 0.3943684895833333; test accuracy: 0.3841
2025-09-24 15:24:05 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:39 [INFO]  Epoch 8 loss: 328.208477973938; train accuracy: 0.3556857638888889; test accuracy: 0.3542
2025-09-24 15:24:39 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:11 [INFO]  Epoch 9 loss: 317.8168754577637; train accuracy: 0.4893663194444444; test accuracy: 0.4845
2025-09-24 15:25:11 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:25:11 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:25:11 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:25:11 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:54 [INFO]  Epoch 5 loss: 416.8361749649048; train accuracy: 0.4088107638888889; test accuracy: 0.4031
2025-09-24 15:25:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_5.pth
2025-09-24 15:25:54 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:36 [INFO]  Epoch 6 loss: 406.2294044494629; train accuracy: 0.26254340277777777; test accuracy: 0.2579
2025-09-24 15:26:36 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:15 [INFO]  Epoch 7 loss: 399.7139005661011; train accuracy: 0.3944010416666667; test accuracy: 0.3943
2025-09-24 15:27:15 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:56 [INFO]  Epoch 8 loss: 393.82131004333496; train accuracy: 0.5042100694444445; test accuracy: 0.4996
2025-09-24 15:27:56 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:36 [INFO]  Epoch 9 loss: 384.29728507995605; train accuracy: 0.5615017361111111; test accuracy: 0.547
2025-09-24 15:28:36 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:28:36 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:28:36 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:28:36 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:03 [INFO]  Epoch 5 loss: 333.4808759689331; train accuracy: 0.29308035714285713; test accuracy: 0.2953
2025-09-24 15:29:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_5.pth
2025-09-24 15:29:04 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:32 [INFO]  Epoch 6 loss: 329.96034812927246; train accuracy: 0.34129464285714284; test accuracy: 0.3428
2025-09-24 15:29:32 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:04 [INFO]  Epoch 7 loss: 327.66716384887695; train accuracy: 0.3470424107142857; test accuracy: 0.3475
2025-09-24 15:30:04 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:34 [INFO]  Epoch 8 loss: 318.29182052612305; train accuracy: 0.3554129464285714; test accuracy: 0.3605
2025-09-24 15:30:34 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:04 [INFO]  Epoch 9 loss: 314.27793312072754; train accuracy: 0.38716517857142857; test accuracy: 0.3832
2025-09-24 15:31:04 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:31:04 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:31:04 [INFO]  Round 1 Finish--------|
2025-09-24 15:31:04 [INFO]  Model variance: mean: 0.0016293942462652922, sum: 18206.7734375
2025-09-24 15:31:04 [INFO]  g_protos_std: 1.0058213472366333
2025-09-24 15:31:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7124
2025-09-24 15:31:10 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:31:10 [INFO]  Round 2 starts--------|
2025-09-24 15:31:10 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:31:10 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:51 [INFO]  Epoch 10 loss: 367.1666736602783; train accuracy: 0.5720385174418605; test accuracy: 0.5601
2025-09-24 15:31:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_10.pth
2025-09-24 15:31:51 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:31 [INFO]  Epoch 11 loss: 351.9568028450012; train accuracy: 0.6095112645348837; test accuracy: 0.5862
2025-09-24 15:32:31 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:10 [INFO]  Epoch 12 loss: 351.33044147491455; train accuracy: 0.5646348110465116; test accuracy: 0.5534
2025-09-24 15:33:10 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:50 [INFO]  Epoch 13 loss: 350.79382944107056; train accuracy: 0.5600018168604651; test accuracy: 0.5438
2025-09-24 15:33:50 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:28 [INFO]  Epoch 14 loss: 350.1840329170227; train accuracy: 0.6349927325581395; test accuracy: 0.6139
2025-09-24 15:34:28 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:34:28 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:34:28 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:34:28 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:40 [INFO]  Epoch 10 loss: 117.55147457122803; train accuracy: 0.22884114583333334; test accuracy: 0.2336
2025-09-24 15:34:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_10.pth
2025-09-24 15:34:40 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:53 [INFO]  Epoch 11 loss: 119.50295925140381; train accuracy: 0.2708333333333333; test accuracy: 0.2735
2025-09-24 15:34:53 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:05 [INFO]  Epoch 12 loss: 117.20851612091064; train accuracy: 0.2802734375; test accuracy: 0.2837
2025-09-24 15:35:05 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:19 [INFO]  Epoch 13 loss: 116.07830810546875; train accuracy: 0.2791341145833333; test accuracy: 0.2763
2025-09-24 15:35:19 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:33 [INFO]  Epoch 14 loss: 113.89772510528564; train accuracy: 0.22737630208333334; test accuracy: 0.2311
2025-09-24 15:35:33 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:35:33 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:35:33 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:35:33 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:07 [INFO]  Epoch 10 loss: 312.21103954315186; train accuracy: 0.4326171875; test accuracy: 0.4238
2025-09-24 15:36:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_10.pth
2025-09-24 15:36:08 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:43 [INFO]  Epoch 11 loss: 312.43208026885986; train accuracy: 0.4959309895833333; test accuracy: 0.4799
2025-09-24 15:36:43 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:17 [INFO]  Epoch 12 loss: 303.4932818412781; train accuracy: 0.5335828993055556; test accuracy: 0.5248
2025-09-24 15:37:17 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:52 [INFO]  Epoch 13 loss: 299.9332661628723; train accuracy: 0.5953776041666666; test accuracy: 0.5804
2025-09-24 15:37:52 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:24 [INFO]  Epoch 14 loss: 293.3839497566223; train accuracy: 0.5768229166666666; test accuracy: 0.5571
2025-09-24 15:38:24 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:38:24 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:38:24 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:38:24 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:06 [INFO]  Epoch 10 loss: 383.1912941932678; train accuracy: 0.4924045138888889; test accuracy: 0.4791
2025-09-24 15:39:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_10.pth
2025-09-24 15:39:06 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:46 [INFO]  Epoch 11 loss: 374.98639488220215; train accuracy: 0.5522135416666667; test accuracy: 0.5412
2025-09-24 15:39:46 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:26 [INFO]  Epoch 12 loss: 368.0092134475708; train accuracy: 0.6195746527777778; test accuracy: 0.6011
2025-09-24 15:40:26 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:08 [INFO]  Epoch 13 loss: 367.1967077255249; train accuracy: 0.6164930555555556; test accuracy: 0.5956
2025-09-24 15:41:08 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:00 [INFO]  Epoch 14 loss: 365.08998680114746; train accuracy: 0.6073784722222222; test accuracy: 0.586
2025-09-24 15:42:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:42:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:42:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:42:00 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:40 [INFO]  Epoch 10 loss: 306.04533100128174; train accuracy: 0.42215401785714285; test accuracy: 0.421
2025-09-24 15:42:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_10.pth
2025-09-24 15:42:40 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:20 [INFO]  Epoch 11 loss: 305.1176357269287; train accuracy: 0.44559151785714285; test accuracy: 0.444
2025-09-24 15:43:20 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:59 [INFO]  Epoch 12 loss: 300.0343265533447; train accuracy: 0.5133370535714286; test accuracy: 0.5091
2025-09-24 15:43:59 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:39 [INFO]  Epoch 13 loss: 299.0041570663452; train accuracy: 0.4342633928571429; test accuracy: 0.4354
2025-09-24 15:44:39 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:19 [INFO]  Epoch 14 loss: 293.91100788116455; train accuracy: 0.5436941964285714; test accuracy: 0.5302
2025-09-24 15:45:19 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:45:19 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:45:19 [INFO]  Round 2 Finish--------|
2025-09-24 15:45:19 [INFO]  Model variance: mean: 0.002086939522996545, sum: 23319.361328125
2025-09-24 15:45:19 [INFO]  g_protos_std: 1.0058056116104126
2025-09-24 15:45:28 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7698
2025-09-24 15:45:28 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:45:28 [INFO]  Round 3 starts--------|
2025-09-24 15:45:28 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:45:28 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:16 [INFO]  Epoch 15 loss: 339.7844400405884; train accuracy: 0.6347202034883721; test accuracy: 0.6106
2025-09-24 15:46:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_15.pth
2025-09-24 15:46:17 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:05 [INFO]  Epoch 16 loss: 342.6859178543091; train accuracy: 0.5973382994186046; test accuracy: 0.5755
2025-09-24 15:47:05 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:54 [INFO]  Epoch 17 loss: 341.3949456214905; train accuracy: 0.6697856104651163; test accuracy: 0.6537
2025-09-24 15:47:54 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:43 [INFO]  Epoch 18 loss: 333.5352506637573; train accuracy: 0.6253633720930233; test accuracy: 0.6016
2025-09-24 15:48:43 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:33 [INFO]  Epoch 19 loss: 330.63991928100586; train accuracy: 0.6550690406976745; test accuracy: 0.627
2025-09-24 15:49:33 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:49:33 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:49:33 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:49:33 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:49 [INFO]  Epoch 15 loss: 114.81346797943115; train accuracy: 0.33935546875; test accuracy: 0.3268
2025-09-24 15:49:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_15.pth
2025-09-24 15:49:50 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:06 [INFO]  Epoch 16 loss: 111.95997428894043; train accuracy: 0.34228515625; test accuracy: 0.3471
2025-09-24 15:50:06 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:23 [INFO]  Epoch 17 loss: 118.24999904632568; train accuracy: 0.22965494791666666; test accuracy: 0.2395
2025-09-24 15:50:23 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:39 [INFO]  Epoch 18 loss: 116.1599006652832; train accuracy: 0.2513020833333333; test accuracy: 0.252
2025-09-24 15:50:39 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:55 [INFO]  Epoch 19 loss: 113.94373989105225; train accuracy: 0.23795572916666666; test accuracy: 0.2398
2025-09-24 15:50:55 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:50:55 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:50:55 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:50:55 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:36 [INFO]  Epoch 15 loss: 287.4919204711914; train accuracy: 0.5494791666666666; test accuracy: 0.5369
2025-09-24 15:51:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_15.pth
2025-09-24 15:51:37 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:16 [INFO]  Epoch 16 loss: 288.63865661621094; train accuracy: 0.599609375; test accuracy: 0.582
2025-09-24 15:52:16 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:59 [INFO]  Epoch 17 loss: 290.40503549575806; train accuracy: 0.5728081597222222; test accuracy: 0.5558
2025-09-24 15:52:59 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:39 [INFO]  Epoch 18 loss: 287.1639699935913; train accuracy: 0.6571180555555556; test accuracy: 0.6349
2025-09-24 15:53:39 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:18 [INFO]  Epoch 19 loss: 283.7370386123657; train accuracy: 0.6239691840277778; test accuracy: 0.5999
2025-09-24 15:54:18 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:54:18 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:54:18 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:54:18 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:10 [INFO]  Epoch 15 loss: 352.37180614471436; train accuracy: 0.6680555555555555; test accuracy: 0.6498
2025-09-24 15:55:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_15.pth
2025-09-24 15:55:11 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:59 [INFO]  Epoch 16 loss: 354.0963468551636; train accuracy: 0.6620225694444445; test accuracy: 0.6405
2025-09-24 15:55:59 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:50 [INFO]  Epoch 17 loss: 346.2732810974121; train accuracy: 0.6387586805555555; test accuracy: 0.6169
2025-09-24 15:56:50 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:41 [INFO]  Epoch 18 loss: 349.7164726257324; train accuracy: 0.6991319444444445; test accuracy: 0.6753
2025-09-24 15:57:41 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:32 [INFO]  Epoch 19 loss: 344.84267139434814; train accuracy: 0.7131076388888888; test accuracy: 0.6854
2025-09-24 15:58:32 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:58:32 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:58:32 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:58:32 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:13 [INFO]  Epoch 15 loss: 288.3440275192261; train accuracy: 0.5467633928571428; test accuracy: 0.5416
2025-09-24 15:59:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_15.pth
2025-09-24 15:59:13 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:52 [INFO]  Epoch 16 loss: 282.87331199645996; train accuracy: 0.6284040178571428; test accuracy: 0.6152
2025-09-24 15:59:52 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:32 [INFO]  Epoch 17 loss: 284.61143732070923; train accuracy: 0.5918526785714285; test accuracy: 0.5778
2025-09-24 16:00:32 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:12 [INFO]  Epoch 18 loss: 282.3172416687012; train accuracy: 0.5601004464285714; test accuracy: 0.5432
2025-09-24 16:01:12 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:53 [INFO]  Epoch 19 loss: 278.2482509613037; train accuracy: 0.6647879464285714; test accuracy: 0.6446
2025-09-24 16:01:53 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:01:53 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:01:53 [INFO]  Round 3 Finish--------|
2025-09-24 16:01:53 [INFO]  Model variance: mean: 0.0024858710821717978, sum: 27777.00390625
2025-09-24 16:01:53 [INFO]  g_protos_std: 1.0058103799819946
2025-09-24 16:02:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8022
2025-09-24 16:02:02 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:02:03 [INFO]  Round 4 starts--------|
2025-09-24 16:02:03 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:02:03 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:52 [INFO]  Epoch 20 loss: 326.3639121055603; train accuracy: 0.6790515988372093; test accuracy: 0.6569
2025-09-24 16:02:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_20.pth
2025-09-24 16:02:53 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:39 [INFO]  Epoch 21 loss: 328.4237937927246; train accuracy: 0.6995367005813954; test accuracy: 0.672
2025-09-24 16:03:39 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:27 [INFO]  Epoch 22 loss: 327.1485958099365; train accuracy: 0.5344749273255814; test accuracy: 0.5132
2025-09-24 16:04:27 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:16 [INFO]  Epoch 23 loss: 322.40224027633667; train accuracy: 0.6925872093023255; test accuracy: 0.6639
2025-09-24 16:05:16 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:05 [INFO]  Epoch 24 loss: 319.2869300842285; train accuracy: 0.7672147529069767; test accuracy: 0.7286
2025-09-24 16:06:05 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:06:05 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:06:05 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:06:05 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:21 [INFO]  Epoch 20 loss: 112.03250789642334; train accuracy: 0.3308919270833333; test accuracy: 0.3377
2025-09-24 16:06:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_20.pth
2025-09-24 16:06:22 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:36 [INFO]  Epoch 21 loss: 110.85067462921143; train accuracy: 0.296875; test accuracy: 0.2956
2025-09-24 16:06:36 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:51 [INFO]  Epoch 22 loss: 110.20080471038818; train accuracy: 0.34716796875; test accuracy: 0.3315
2025-09-24 16:06:51 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:06 [INFO]  Epoch 23 loss: 112.10066604614258; train accuracy: 0.3349609375; test accuracy: 0.329
2025-09-24 16:07:06 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:22 [INFO]  Epoch 24 loss: 109.3507776260376; train accuracy: 0.3025716145833333; test accuracy: 0.2888
2025-09-24 16:07:22 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:07:22 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:07:22 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:07:22 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:03 [INFO]  Epoch 20 loss: 275.53699588775635; train accuracy: 0.6357964409722222; test accuracy: 0.6128
2025-09-24 16:08:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_20.pth
2025-09-24 16:08:04 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:45 [INFO]  Epoch 21 loss: 272.67744493484497; train accuracy: 0.6307508680555556; test accuracy: 0.6047
2025-09-24 16:08:45 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:24 [INFO]  Epoch 22 loss: 282.90606594085693; train accuracy: 0.6801215277777778; test accuracy: 0.6514
2025-09-24 16:09:24 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:02 [INFO]  Epoch 23 loss: 281.17211627960205; train accuracy: 0.6941189236111112; test accuracy: 0.6667
2025-09-24 16:10:02 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:40 [INFO]  Epoch 24 loss: 274.59911012649536; train accuracy: 0.6597764756944444; test accuracy: 0.6266
2025-09-24 16:10:40 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:10:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:10:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:10:40 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:30 [INFO]  Epoch 20 loss: 337.88528871536255; train accuracy: 0.7236545138888889; test accuracy: 0.6955
2025-09-24 16:11:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_20.pth
2025-09-24 16:11:31 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:21 [INFO]  Epoch 21 loss: 332.5987596511841; train accuracy: 0.7267795138888888; test accuracy: 0.6967
2025-09-24 16:12:21 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:09 [INFO]  Epoch 22 loss: 335.8926272392273; train accuracy: 0.7059027777777778; test accuracy: 0.675
2025-09-24 16:13:09 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:58 [INFO]  Epoch 23 loss: 331.25182580947876; train accuracy: 0.7425347222222223; test accuracy: 0.7081
2025-09-24 16:13:58 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:14:47 [INFO]  Epoch 24 loss: 330.28197860717773; train accuracy: 0.6737847222222222; test accuracy: 0.6469
2025-09-24 16:14:47 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:14:47 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:14:47 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:14:47 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:26 [INFO]  Epoch 20 loss: 271.8419404029846; train accuracy: 0.6323660714285714; test accuracy: 0.615
2025-09-24 16:15:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_20.pth
2025-09-24 16:15:26 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:07 [INFO]  Epoch 21 loss: 281.97956228256226; train accuracy: 0.6370535714285714; test accuracy: 0.6182
2025-09-24 16:16:07 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:47 [INFO]  Epoch 22 loss: 273.6501693725586; train accuracy: 0.5534040178571429; test accuracy: 0.5324
2025-09-24 16:16:47 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:27 [INFO]  Epoch 23 loss: 275.58253383636475; train accuracy: 0.6444196428571428; test accuracy: 0.6197
2025-09-24 16:17:27 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:06 [INFO]  Epoch 24 loss: 268.97758388519287; train accuracy: 0.6418526785714286; test accuracy: 0.6188
2025-09-24 16:18:06 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:18:06 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:18:06 [INFO]  Round 4 Finish--------|
2025-09-24 16:18:06 [INFO]  Model variance: mean: 0.0028402754105627537, sum: 31737.099609375
2025-09-24 16:18:06 [INFO]  g_protos_std: 1.0058248043060303
2025-09-24 16:18:15 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8223
2025-09-24 16:18:15 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:18:15 [INFO]  Round 5 starts--------|
2025-09-24 16:18:15 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:18:15 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:05 [INFO]  Epoch 25 loss: 314.86789083480835; train accuracy: 0.7633539244186046; test accuracy: 0.7237
2025-09-24 16:19:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_0/epoch_25.pth
2025-09-24 16:19:06 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:55 [INFO]  Epoch 26 loss: 311.87366104125977; train accuracy: 0.7226108284883721; test accuracy: 0.6879
2025-09-24 16:19:55 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:44 [INFO]  Epoch 27 loss: 317.1620774269104; train accuracy: 0.7485010901162791; test accuracy: 0.7072
2025-09-24 16:20:44 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:31 [INFO]  Epoch 28 loss: 313.6337785720825; train accuracy: 0.7486827761627907; test accuracy: 0.7149
2025-09-24 16:21:31 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:20 [INFO]  Epoch 29 loss: 305.0978136062622; train accuracy: 0.7460029069767442; test accuracy: 0.702
2025-09-24 16:22:20 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:22:20 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:22:20 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:22:20 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:35 [INFO]  Epoch 25 loss: 108.50596618652344; train accuracy: 0.3250325520833333; test accuracy: 0.3229
2025-09-24 16:22:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_1/epoch_25.pth
2025-09-24 16:22:35 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:52 [INFO]  Epoch 26 loss: 107.0221176147461; train accuracy: 0.3766276041666667; test accuracy: 0.3699
2025-09-24 16:22:52 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:08 [INFO]  Epoch 27 loss: 109.86141300201416; train accuracy: 0.3533528645833333; test accuracy: 0.3469
2025-09-24 16:23:08 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:23 [INFO]  Epoch 28 loss: 107.6075611114502; train accuracy: 0.3951822916666667; test accuracy: 0.3807
2025-09-24 16:23:23 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:40 [INFO]  Epoch 29 loss: 107.001473903656; train accuracy: 0.4220377604166667; test accuracy: 0.4145
2025-09-24 16:23:40 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:23:40 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:23:40 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:23:40 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:23 [INFO]  Epoch 25 loss: 269.41603994369507; train accuracy: 0.5305989583333334; test accuracy: 0.5148
2025-09-24 16:24:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_2/epoch_25.pth
2025-09-24 16:24:23 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:09 [INFO]  Epoch 26 loss: 275.6741409301758; train accuracy: 0.6667209201388888; test accuracy: 0.6366
2025-09-24 16:25:09 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:52 [INFO]  Epoch 27 loss: 274.96087980270386; train accuracy: 0.6682400173611112; test accuracy: 0.6418
2025-09-24 16:25:52 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:37 [INFO]  Epoch 28 loss: 263.0287342071533; train accuracy: 0.7126736111111112; test accuracy: 0.6805
2025-09-24 16:26:37 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:27:20 [INFO]  Epoch 29 loss: 259.57634592056274; train accuracy: 0.6763780381944444; test accuracy: 0.6417
2025-09-24 16:27:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:27:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:27:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:27:20 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:16 [INFO]  Epoch 25 loss: 332.79067039489746; train accuracy: 0.7307725694444445; test accuracy: 0.6981
2025-09-24 16:31:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_3/epoch_25.pth
2025-09-24 16:31:17 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:41 [INFO]  Epoch 26 loss: 328.8052821159363; train accuracy: 0.6987847222222222; test accuracy: 0.6702
2025-09-24 16:52:41 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:38 [INFO]  Epoch 27 loss: 323.8005108833313; train accuracy: 0.7735677083333333; test accuracy: 0.7438
2025-09-24 16:53:38 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:34 [INFO]  Epoch 28 loss: 319.35381412506104; train accuracy: 0.7559895833333333; test accuracy: 0.7216
2025-09-24 16:54:34 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:55:30 [INFO]  Epoch 29 loss: 322.53038454055786; train accuracy: 0.7244357638888889; test accuracy: 0.6854
2025-09-24 16:55:30 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:55:30 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:55:30 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:55:30 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:56:14 [INFO]  Epoch 25 loss: 266.9834475517273; train accuracy: 0.6205915178571428; test accuracy: 0.5966
2025-09-24 16:56:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.1/local_models/client_4/epoch_25.pth
2025-09-24 16:56:14 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:56:57 [INFO]  Epoch 26 loss: 259.10797452926636; train accuracy: 0.6572544642857143; test accuracy: 0.6313
2025-09-24 16:56:57 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:57:41 [INFO]  Epoch 27 loss: 267.70945596694946; train accuracy: 0.6587053571428572; test accuracy: 0.6308
2025-09-24 16:57:41 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:25 [INFO]  Epoch 28 loss: 259.2706255912781; train accuracy: 0.6375558035714286; test accuracy: 0.6098
2025-09-24 16:58:25 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:05 [INFO]  Epoch 29 loss: 264.4485282897949; train accuracy: 0.6553571428571429; test accuracy: 0.6215
2025-09-24 16:59:05 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:59:05 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:59:05 [INFO]  Round 5 Finish--------|
2025-09-24 16:59:05 [INFO]  Model variance: mean: 0.0031657954677939415, sum: 35374.4453125
2025-09-24 16:59:05 [INFO]  g_protos_std: 1.0058691501617432
2025-09-24 16:59:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8352
2025-09-24 16:59:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.1/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml


2025-09-24 15:04:42 [INFO]  Load config from ./configs/CIFAR10_alpha0.3.yaml
2025-09-24 15:04:42 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.3', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.3}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:44 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:44 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 15:04:44 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:44 [INFO]  OneshotOurs
2025-09-24 15:04:45 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 15:04:45 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 15:04:45 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 15:04:48 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 15:04:50 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 15:04:52 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 15:04:54 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 15:04:56 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 15:04:58 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 15:05:00 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 15:05:01 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 15:05:03 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 15:05:05 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 15:05:07 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 15:05:09 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 15:05:11 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 15:05:13 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 15:05:15 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 15:05:17 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 15:05:18 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 15:05:20 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 15:05:22 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 15:05:24 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 15:05:24 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 15:05:25 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 15:05:25 [INFO]  Two-stage training enabled: Alignment epochs set to 1.
2025-09-24 15:05:25 [INFO]  Round 0 starts--------|
2025-09-24 15:05:25 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:35 [INFO]  generating sample per sample
2025-09-24 15:05:35 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:06:32 [INFO]  Epoch 0 loss: 453.48500776290894; train accuracy: 0.01103670634920635; test accuracy: 0.0497
2025-09-24 15:06:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_0.pth
2025-09-24 15:06:33 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:30 [INFO]  Epoch 1 loss: 664.3179130554199; train accuracy: 0.17509920634920634; test accuracy: 0.1284
2025-09-24 15:07:30 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:26 [INFO]  Epoch 2 loss: 622.7426843643188; train accuracy: 0.22126116071428573; test accuracy: 0.18
2025-09-24 15:08:26 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:25 [INFO]  Epoch 3 loss: 604.6327638626099; train accuracy: 0.27644469246031744; test accuracy: 0.2417
2025-09-24 15:09:25 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:23 [INFO]  Epoch 4 loss: 587.6233243942261; train accuracy: 0.3939422123015873; test accuracy: 0.3374
2025-09-24 15:10:23 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:10:23 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:10:23 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:10:32 [INFO]  generating sample per sample
2025-09-24 15:10:33 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:11:23 [INFO]  Epoch 0 loss: 467.2442903518677; train accuracy: 0.006340144230769231; test accuracy: 0.098
2025-09-24 15:11:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_0.pth
2025-09-24 15:11:24 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:17 [INFO]  Epoch 1 loss: 692.1198902130127; train accuracy: 0.23115985576923076; test accuracy: 0.1751
2025-09-24 15:12:17 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:18 [INFO]  Epoch 2 loss: 655.351035118103; train accuracy: 0.2825721153846154; test accuracy: 0.2153
2025-09-24 15:13:18 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:16 [INFO]  Epoch 3 loss: 634.8820142745972; train accuracy: 0.369140625; test accuracy: 0.2835
2025-09-24 15:14:16 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:12 [INFO]  Epoch 4 loss: 615.39635181427; train accuracy: 0.31292067307692306; test accuracy: 0.2319
2025-09-24 15:15:12 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:15:12 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:15:12 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:15:20 [INFO]  generating sample per sample
2025-09-24 15:15:20 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:16:09 [INFO]  Epoch 0 loss: 403.1102247238159; train accuracy: 0.031529017857142856; test accuracy: 0.0996
2025-09-24 15:16:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_0.pth
2025-09-24 15:16:09 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:57 [INFO]  Epoch 1 loss: 583.175386428833; train accuracy: 0.266357421875; test accuracy: 0.1705
2025-09-24 15:16:57 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:47 [INFO]  Epoch 2 loss: 541.4004888534546; train accuracy: 0.23088727678571427; test accuracy: 0.1502
2025-09-24 15:17:47 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:35 [INFO]  Epoch 3 loss: 526.7236251831055; train accuracy: 0.35239955357142855; test accuracy: 0.2259
2025-09-24 15:18:35 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:24 [INFO]  Epoch 4 loss: 508.94504737854004; train accuracy: 0.3905552455357143; test accuracy: 0.2554
2025-09-24 15:19:24 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:19:24 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:19:24 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:19:27 [INFO]  generating sample per sample
2025-09-24 15:19:28 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:19:47 [INFO]  Epoch 0 loss: 147.94515228271484; train accuracy: 0.00703125; test accuracy: 0.0924
2025-09-24 15:19:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_0.pth
2025-09-24 15:19:47 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:09 [INFO]  Epoch 1 loss: 200.42953205108643; train accuracy: 0.48525390625; test accuracy: 0.1428
2025-09-24 15:20:09 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:29 [INFO]  Epoch 2 loss: 182.11908626556396; train accuracy: 0.4849609375; test accuracy: 0.1328
2025-09-24 15:20:29 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:49 [INFO]  Epoch 3 loss: 179.98628330230713; train accuracy: 0.5673828125; test accuracy: 0.2144
2025-09-24 15:20:49 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:07 [INFO]  Epoch 4 loss: 177.87086582183838; train accuracy: 0.4869140625; test accuracy: 0.1464
2025-09-24 15:21:07 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:21:07 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:21:07 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:21:13 [INFO]  generating sample per sample
2025-09-24 15:21:13 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:21:48 [INFO]  Epoch 0 loss: 292.6924204826355; train accuracy: 0.03212890625; test accuracy: 0.0984
2025-09-24 15:21:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_0.pth
2025-09-24 15:21:48 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:23 [INFO]  Epoch 1 loss: 427.8878297805786; train accuracy: 0.25986328125; test accuracy: 0.1574
2025-09-24 15:22:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:59 [INFO]  Epoch 2 loss: 393.82984828948975; train accuracy: 0.306005859375; test accuracy: 0.2151
2025-09-24 15:22:59 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:38 [INFO]  Epoch 3 loss: 385.06928730010986; train accuracy: 0.289306640625; test accuracy: 0.1554
2025-09-24 15:23:38 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:13 [INFO]  Epoch 4 loss: 377.97699642181396; train accuracy: 0.36298828125; test accuracy: 0.2023
2025-09-24 15:24:13 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:24:13 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:24:13 [INFO]  Round 0 Finish--------|
2025-09-24 15:24:13 [INFO]  Model variance: mean: 0.0012539101298898458, sum: 14011.130859375
2025-09-24 15:24:13 [INFO]  g_protos_std: 1.0061997175216675
2025-09-24 15:24:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4765
2025-09-24 15:24:18 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:24:18 [INFO]  Round 1 starts--------|
2025-09-24 15:24:18 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:24:18 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:25:16 [INFO]  Epoch 5 loss: 415.0760259628296; train accuracy: 0.3285590277777778; test accuracy: 0.2613
2025-09-24 15:25:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_5.pth
2025-09-24 15:25:17 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:15 [INFO]  Epoch 6 loss: 548.1157817840576; train accuracy: 0.43508184523809523; test accuracy: 0.3611
2025-09-24 15:26:15 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:13 [INFO]  Epoch 7 loss: 547.5083088874817; train accuracy: 0.5660032242063492; test accuracy: 0.4575
2025-09-24 15:27:13 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:11 [INFO]  Epoch 8 loss: 531.5683822631836; train accuracy: 0.4930555555555556; test accuracy: 0.4347
2025-09-24 15:28:11 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:01 [INFO]  Epoch 9 loss: 518.3173098564148; train accuracy: 0.5635540674603174; test accuracy: 0.4645
2025-09-24 15:29:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:29:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:29:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:29:01 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:29:52 [INFO]  Epoch 5 loss: 432.35474157333374; train accuracy: 0.41075721153846156; test accuracy: 0.3126
2025-09-24 15:29:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_5.pth
2025-09-24 15:29:52 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:49 [INFO]  Epoch 6 loss: 591.7407217025757; train accuracy: 0.4450420673076923; test accuracy: 0.341
2025-09-24 15:30:49 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:47 [INFO]  Epoch 7 loss: 578.3939781188965; train accuracy: 0.4751201923076923; test accuracy: 0.3617
2025-09-24 15:31:47 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:45 [INFO]  Epoch 8 loss: 564.1761388778687; train accuracy: 0.5721153846153846; test accuracy: 0.4469
2025-09-24 15:32:45 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:45 [INFO]  Epoch 9 loss: 561.3185415267944; train accuracy: 0.5412860576923076; test accuracy: 0.4251
2025-09-24 15:33:45 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:33:45 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:33:45 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:33:45 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:34:35 [INFO]  Epoch 5 loss: 369.63974142074585; train accuracy: 0.47349330357142855; test accuracy: 0.311
2025-09-24 15:34:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_5.pth
2025-09-24 15:34:35 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:29 [INFO]  Epoch 6 loss: 489.63852405548096; train accuracy: 0.54150390625; test accuracy: 0.3675
2025-09-24 15:35:29 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:24 [INFO]  Epoch 7 loss: 476.24005651474; train accuracy: 0.5992257254464286; test accuracy: 0.446
2025-09-24 15:36:24 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:16 [INFO]  Epoch 8 loss: 469.5847682952881; train accuracy: 0.5316336495535714; test accuracy: 0.3714
2025-09-24 15:37:16 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:10 [INFO]  Epoch 9 loss: 463.4470019340515; train accuracy: 0.5934361049107143; test accuracy: 0.422
2025-09-24 15:38:10 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:38:10 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:38:10 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:38:10 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:38:31 [INFO]  Epoch 5 loss: 136.83654975891113; train accuracy: 0.5888671875; test accuracy: 0.1899
2025-09-24 15:38:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_5.pth
2025-09-24 15:38:32 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:53 [INFO]  Epoch 6 loss: 175.81919860839844; train accuracy: 0.50009765625; test accuracy: 0.1477
2025-09-24 15:38:53 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:14 [INFO]  Epoch 7 loss: 173.3101463317871; train accuracy: 0.628515625; test accuracy: 0.2178
2025-09-24 15:39:14 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:34 [INFO]  Epoch 8 loss: 172.12967586517334; train accuracy: 0.52470703125; test accuracy: 0.1633
2025-09-24 15:39:34 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:55 [INFO]  Epoch 9 loss: 169.39577388763428; train accuracy: 0.5392578125; test accuracy: 0.1642
2025-09-24 15:39:55 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:39:55 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:39:55 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:39:55 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:40:33 [INFO]  Epoch 5 loss: 272.82812213897705; train accuracy: 0.4583984375; test accuracy: 0.2673
2025-09-24 15:40:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_5.pth
2025-09-24 15:40:34 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:13 [INFO]  Epoch 6 loss: 364.5659999847412; train accuracy: 0.5076171875; test accuracy: 0.3186
2025-09-24 15:41:13 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:58 [INFO]  Epoch 7 loss: 359.75597858428955; train accuracy: 0.538720703125; test accuracy: 0.3314
2025-09-24 15:41:58 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:48 [INFO]  Epoch 8 loss: 355.2907381057739; train accuracy: 0.472216796875; test accuracy: 0.281
2025-09-24 15:42:48 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:39 [INFO]  Epoch 9 loss: 353.4049816131592; train accuracy: 0.53896484375; test accuracy: 0.3508
2025-09-24 15:43:39 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:43:39 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:43:39 [INFO]  Round 1 Finish--------|
2025-09-24 15:43:39 [INFO]  Model variance: mean: 0.0018072682432830334, sum: 20194.328125
2025-09-24 15:43:39 [INFO]  g_protos_std: 1.0062839984893799
2025-09-24 15:43:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6079
2025-09-24 15:43:48 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:43:48 [INFO]  Round 2 starts--------|
2025-09-24 15:43:48 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:43:48 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:45:04 [INFO]  Epoch 10 loss: 394.37893199920654; train accuracy: 0.6505766369047619; test accuracy: 0.5229
2025-09-24 15:45:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_10.pth
2025-09-24 15:45:05 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:21 [INFO]  Epoch 11 loss: 509.33401107788086; train accuracy: 0.6746341765873016; test accuracy: 0.5406
2025-09-24 15:46:21 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:36 [INFO]  Epoch 12 loss: 492.8535032272339; train accuracy: 0.6857328869047619; test accuracy: 0.5522
2025-09-24 15:47:36 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:49 [INFO]  Epoch 13 loss: 486.35747385025024; train accuracy: 0.7288256448412699; test accuracy: 0.6043
2025-09-24 15:48:49 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:01 [INFO]  Epoch 14 loss: 481.5959005355835; train accuracy: 0.7592075892857143; test accuracy: 0.6224
2025-09-24 15:50:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:50:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:50:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:50:01 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:51:17 [INFO]  Epoch 10 loss: 417.1230549812317; train accuracy: 0.5938100961538462; test accuracy: 0.4556
2025-09-24 15:51:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_10.pth
2025-09-24 15:51:17 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:33 [INFO]  Epoch 11 loss: 542.5935573577881; train accuracy: 0.6002403846153846; test accuracy: 0.4747
2025-09-24 15:52:33 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:48 [INFO]  Epoch 12 loss: 533.4591822624207; train accuracy: 0.5781850961538462; test accuracy: 0.4656
2025-09-24 15:53:48 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:04 [INFO]  Epoch 13 loss: 530.8570637702942; train accuracy: 0.6431490384615385; test accuracy: 0.5206
2025-09-24 15:55:04 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:20 [INFO]  Epoch 14 loss: 513.7974457740784; train accuracy: 0.6944110576923077; test accuracy: 0.5559
2025-09-24 15:56:20 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:56:20 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:56:20 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:56:20 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:57:24 [INFO]  Epoch 10 loss: 355.1814398765564; train accuracy: 0.6292898995535714; test accuracy: 0.4462
2025-09-24 15:57:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_10.pth
2025-09-24 15:57:25 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:32 [INFO]  Epoch 11 loss: 450.8500962257385; train accuracy: 0.5452357700892857; test accuracy: 0.3878
2025-09-24 15:58:32 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:39 [INFO]  Epoch 12 loss: 440.1929941177368; train accuracy: 0.7122628348214286; test accuracy: 0.5404
2025-09-24 15:59:39 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:40 [INFO]  Epoch 13 loss: 445.71565532684326; train accuracy: 0.6194545200892857; test accuracy: 0.4725
2025-09-24 16:00:40 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:47 [INFO]  Epoch 14 loss: 439.15493631362915; train accuracy: 0.6409040178571429; test accuracy: 0.5063
2025-09-24 16:01:47 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:01:47 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:01:47 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:01:47 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:02:13 [INFO]  Epoch 10 loss: 133.5300064086914; train accuracy: 0.64619140625; test accuracy: 0.239
2025-09-24 16:02:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_10.pth
2025-09-24 16:02:13 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:39 [INFO]  Epoch 11 loss: 169.24479389190674; train accuracy: 0.61484375; test accuracy: 0.2213
2025-09-24 16:02:39 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:03 [INFO]  Epoch 12 loss: 167.48759078979492; train accuracy: 0.60087890625; test accuracy: 0.2011
2025-09-24 16:03:03 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:29 [INFO]  Epoch 13 loss: 167.7972755432129; train accuracy: 0.53154296875; test accuracy: 0.165
2025-09-24 16:03:29 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:52 [INFO]  Epoch 14 loss: 164.19467782974243; train accuracy: 0.53203125; test accuracy: 0.1968
2025-09-24 16:03:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:03:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:03:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:03:52 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:04:38 [INFO]  Epoch 10 loss: 262.9946622848511; train accuracy: 0.5201171875; test accuracy: 0.3144
2025-09-24 16:04:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_10.pth
2025-09-24 16:04:39 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:26 [INFO]  Epoch 11 loss: 336.88237476348877; train accuracy: 0.577294921875; test accuracy: 0.3414
2025-09-24 16:05:26 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:13 [INFO]  Epoch 12 loss: 338.1720643043518; train accuracy: 0.59033203125; test accuracy: 0.3734
2025-09-24 16:06:13 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:59 [INFO]  Epoch 13 loss: 331.9611530303955; train accuracy: 0.597412109375; test accuracy: 0.3714
2025-09-24 16:06:59 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:43 [INFO]  Epoch 14 loss: 326.2431306838989; train accuracy: 0.6396484375; test accuracy: 0.4066
2025-09-24 16:07:43 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:07:43 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:07:43 [INFO]  Round 2 Finish--------|
2025-09-24 16:07:43 [INFO]  Model variance: mean: 0.00227428344078362, sum: 25412.734375
2025-09-24 16:07:43 [INFO]  g_protos_std: 1.0063508749008179
2025-09-24 16:07:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6691
2025-09-24 16:07:52 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:07:52 [INFO]  Round 3 starts--------|
2025-09-24 16:07:52 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:07:52 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:09:04 [INFO]  Epoch 15 loss: 385.3432078361511; train accuracy: 0.7655319940476191; test accuracy: 0.6135
2025-09-24 16:09:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_15.pth
2025-09-24 16:09:05 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:11 [INFO]  Epoch 16 loss: 473.6651773452759; train accuracy: 0.6430431547619048; test accuracy: 0.5474
2025-09-24 16:10:11 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:20 [INFO]  Epoch 17 loss: 464.0167064666748; train accuracy: 0.7451016865079365; test accuracy: 0.6078
2025-09-24 16:11:20 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:29 [INFO]  Epoch 18 loss: 458.0542006492615; train accuracy: 0.7145027281746031; test accuracy: 0.5793
2025-09-24 16:12:29 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:36 [INFO]  Epoch 19 loss: 462.5781283378601; train accuracy: 0.7560143849206349; test accuracy: 0.6182
2025-09-24 16:13:36 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:13:36 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:13:36 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:13:37 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:14:46 [INFO]  Epoch 15 loss: 402.59922647476196; train accuracy: 0.7014423076923076; test accuracy: 0.5647
2025-09-24 16:14:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_15.pth
2025-09-24 16:14:47 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:56 [INFO]  Epoch 16 loss: 510.4781837463379; train accuracy: 0.6586838942307692; test accuracy: 0.5246
2025-09-24 16:15:56 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:06 [INFO]  Epoch 17 loss: 505.6476860046387; train accuracy: 0.7278545673076923; test accuracy: 0.5785
2025-09-24 16:17:06 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:16 [INFO]  Epoch 18 loss: 501.51238536834717; train accuracy: 0.6900240384615385; test accuracy: 0.5515
2025-09-24 16:18:16 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:27 [INFO]  Epoch 19 loss: 493.63544178009033; train accuracy: 0.6361778846153846; test accuracy: 0.5261
2025-09-24 16:19:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:19:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:19:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:19:27 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:20:28 [INFO]  Epoch 15 loss: 344.78778886795044; train accuracy: 0.5960170200892857; test accuracy: 0.4652
2025-09-24 16:20:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_15.pth
2025-09-24 16:20:29 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:31 [INFO]  Epoch 16 loss: 428.790563583374; train accuracy: 0.6343122209821429; test accuracy: 0.4966
2025-09-24 16:21:31 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:31 [INFO]  Epoch 17 loss: 424.8736925125122; train accuracy: 0.7459891183035714; test accuracy: 0.5597
2025-09-24 16:22:31 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:31 [INFO]  Epoch 18 loss: 423.3189506530762; train accuracy: 0.7139020647321429; test accuracy: 0.5571
2025-09-24 16:23:31 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:35 [INFO]  Epoch 19 loss: 411.4160351753235; train accuracy: 0.7313755580357143; test accuracy: 0.5516
2025-09-24 16:24:35 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:24:35 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:24:35 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:24:35 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:25:00 [INFO]  Epoch 15 loss: 132.66572284698486; train accuracy: 0.66015625; test accuracy: 0.2403
2025-09-24 16:25:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_15.pth
2025-09-24 16:25:00 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:26 [INFO]  Epoch 16 loss: 164.03986263275146; train accuracy: 0.6005859375; test accuracy: 0.2045
2025-09-24 16:25:26 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:51 [INFO]  Epoch 17 loss: 162.4321002960205; train accuracy: 0.69658203125; test accuracy: 0.2551
2025-09-24 16:25:51 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:16 [INFO]  Epoch 18 loss: 158.68962907791138; train accuracy: 0.60888671875; test accuracy: 0.2073
2025-09-24 16:26:16 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:42 [INFO]  Epoch 19 loss: 159.02509832382202; train accuracy: 0.69501953125; test accuracy: 0.2556
2025-09-24 16:26:42 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:26:42 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:26:42 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:26:42 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:27:29 [INFO]  Epoch 15 loss: 258.5512127876282; train accuracy: 0.6724609375; test accuracy: 0.4253
2025-09-24 16:27:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_15.pth
2025-09-24 16:27:29 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:21 [INFO]  Epoch 16 loss: 319.51420164108276; train accuracy: 0.674169921875; test accuracy: 0.4414
2025-09-24 16:31:21 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:40 [INFO]  Epoch 17 loss: 321.397349357605; train accuracy: 0.6591796875; test accuracy: 0.4423
2025-09-24 16:52:40 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:26 [INFO]  Epoch 18 loss: 314.77370595932007; train accuracy: 0.734814453125; test accuracy: 0.4869
2025-09-24 16:53:26 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:14 [INFO]  Epoch 19 loss: 315.7458691596985; train accuracy: 0.708349609375; test accuracy: 0.4653
2025-09-24 16:54:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:54:14 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:54:14 [INFO]  Round 3 Finish--------|
2025-09-24 16:54:14 [INFO]  Model variance: mean: 0.0026666217017918825, sum: 29796.703125
2025-09-24 16:54:14 [INFO]  g_protos_std: 1.0064465999603271
2025-09-24 16:54:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7055
2025-09-24 16:54:23 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:54:23 [INFO]  Round 4 starts--------|
2025-09-24 16:54:23 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:54:23 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:55:37 [INFO]  Epoch 20 loss: 375.6322546005249; train accuracy: 0.6921812996031746; test accuracy: 0.5754
2025-09-24 16:55:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_20.pth
2025-09-24 16:55:37 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:56:52 [INFO]  Epoch 21 loss: 457.77404260635376; train accuracy: 0.7510850694444444; test accuracy: 0.6268
2025-09-24 16:56:52 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:04 [INFO]  Epoch 22 loss: 442.7964835166931; train accuracy: 0.7830171130952381; test accuracy: 0.6424
2025-09-24 16:58:04 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:12 [INFO]  Epoch 23 loss: 452.3868465423584; train accuracy: 0.834046378968254; test accuracy: 0.6843
2025-09-24 16:59:12 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:00:21 [INFO]  Epoch 24 loss: 450.7019338607788; train accuracy: 0.7474578373015873; test accuracy: 0.6089
2025-09-24 17:00:21 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:00:21 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:00:21 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:00:21 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:01:36 [INFO]  Epoch 20 loss: 396.51377868652344; train accuracy: 0.6729867788461539; test accuracy: 0.5307
2025-09-24 17:01:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_20.pth
2025-09-24 17:01:37 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:51 [INFO]  Epoch 21 loss: 493.68139839172363; train accuracy: 0.6486177884615385; test accuracy: 0.5102
2025-09-24 17:02:51 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:02 [INFO]  Epoch 22 loss: 481.7242488861084; train accuracy: 0.7241286057692308; test accuracy: 0.5914
2025-09-24 17:04:02 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:10 [INFO]  Epoch 23 loss: 489.3020558357239; train accuracy: 0.7193509615384616; test accuracy: 0.5951
2025-09-24 17:05:10 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:20 [INFO]  Epoch 24 loss: 487.250675201416; train accuracy: 0.7017728365384616; test accuracy: 0.5955
2025-09-24 17:06:20 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:06:20 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:06:20 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:06:20 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:07:18 [INFO]  Epoch 20 loss: 335.571825504303; train accuracy: 0.755126953125; test accuracy: 0.5793
2025-09-24 17:07:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_20.pth
2025-09-24 17:07:19 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:19 [INFO]  Epoch 21 loss: 407.55499792099; train accuracy: 0.7354910714285714; test accuracy: 0.5583
2025-09-24 17:08:19 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:09:19 [INFO]  Epoch 22 loss: 409.68156719207764; train accuracy: 0.8014439174107143; test accuracy: 0.6103
2025-09-24 17:09:19 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:10:19 [INFO]  Epoch 23 loss: 403.7443308830261; train accuracy: 0.7461635044642857; test accuracy: 0.5708
2025-09-24 17:10:19 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:11:20 [INFO]  Epoch 24 loss: 405.117826461792; train accuracy: 0.6387765066964286; test accuracy: 0.5075
2025-09-24 17:11:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:11:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:11:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:11:20 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:11:44 [INFO]  Epoch 20 loss: 129.03358793258667; train accuracy: 0.611328125; test accuracy: 0.2327
2025-09-24 17:11:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_20.pth
2025-09-24 17:11:44 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:08 [INFO]  Epoch 21 loss: 155.5619878768921; train accuracy: 0.66875; test accuracy: 0.2593
2025-09-24 17:12:08 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:31 [INFO]  Epoch 22 loss: 153.1873641014099; train accuracy: 0.67958984375; test accuracy: 0.2556
2025-09-24 17:12:31 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:54 [INFO]  Epoch 23 loss: 153.77092361450195; train accuracy: 0.75712890625; test accuracy: 0.3056
2025-09-24 17:12:54 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:19 [INFO]  Epoch 24 loss: 153.4470648765564; train accuracy: 0.7076171875; test accuracy: 0.2689
2025-09-24 17:13:19 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:13:19 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:13:19 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:13:19 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:14:02 [INFO]  Epoch 20 loss: 252.047504901886; train accuracy: 0.54306640625; test accuracy: 0.367
2025-09-24 17:14:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_20.pth
2025-09-24 17:14:03 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:14:46 [INFO]  Epoch 21 loss: 310.7849793434143; train accuracy: 0.7244140625; test accuracy: 0.4776
2025-09-24 17:14:46 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:15:29 [INFO]  Epoch 22 loss: 311.1400270462036; train accuracy: 0.736328125; test accuracy: 0.4825
2025-09-24 17:15:29 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:12 [INFO]  Epoch 23 loss: 309.0110402107239; train accuracy: 0.6748046875; test accuracy: 0.449
2025-09-24 17:16:12 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:55 [INFO]  Epoch 24 loss: 303.2126603126526; train accuracy: 0.73642578125; test accuracy: 0.5025
2025-09-24 17:16:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:16:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:16:55 [INFO]  Round 4 Finish--------|
2025-09-24 17:16:55 [INFO]  Model variance: mean: 0.003008681582286954, sum: 33618.86328125
2025-09-24 17:16:55 [INFO]  g_protos_std: 1.006532073020935
2025-09-24 17:17:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7283
2025-09-24 17:17:04 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:17:04 [INFO]  Round 5 starts--------|
2025-09-24 17:17:04 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:17:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:18:12 [INFO]  Epoch 25 loss: 366.12878608703613; train accuracy: 0.8284040178571429; test accuracy: 0.6657
2025-09-24 17:18:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_25.pth
2025-09-24 17:18:12 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:19:19 [INFO]  Epoch 26 loss: 438.3179888725281; train accuracy: 0.7590215773809523; test accuracy: 0.6168
2025-09-24 17:19:19 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:28 [INFO]  Epoch 27 loss: 437.26233100891113; train accuracy: 0.8471602182539683; test accuracy: 0.6934
2025-09-24 17:20:28 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:21:30 [INFO]  Epoch 28 loss: 431.91095447540283; train accuracy: 0.796843998015873; test accuracy: 0.6451
2025-09-24 17:21:30 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:22:32 [INFO]  Epoch 29 loss: 437.1023826599121; train accuracy: 0.8018353174603174; test accuracy: 0.6664
2025-09-24 17:22:32 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:22:32 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:22:32 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:22:32 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:23:38 [INFO]  Epoch 25 loss: 385.2160544395447; train accuracy: 0.7358774038461539; test accuracy: 0.5799
2025-09-24 17:23:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_25.pth
2025-09-24 17:23:38 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:24:45 [INFO]  Epoch 26 loss: 472.84588718414307; train accuracy: 0.6873798076923077; test accuracy: 0.6028
2025-09-24 17:24:45 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:25:54 [INFO]  Epoch 27 loss: 472.156222820282; train accuracy: 0.6729867788461539; test accuracy: 0.5647
2025-09-24 17:25:54 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:27:00 [INFO]  Epoch 28 loss: 459.98123693466187; train accuracy: 0.7594350961538462; test accuracy: 0.6449
2025-09-24 17:27:01 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:28:09 [INFO]  Epoch 29 loss: 466.9650778770447; train accuracy: 0.7196814903846154; test accuracy: 0.6251
2025-09-24 17:28:09 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:28:09 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:28:09 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:28:09 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:29:08 [INFO]  Epoch 25 loss: 331.3045320510864; train accuracy: 0.7631487165178571; test accuracy: 0.5903
2025-09-24 17:29:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_25.pth
2025-09-24 17:29:08 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:09 [INFO]  Epoch 26 loss: 403.70697832107544; train accuracy: 0.7362932477678571; test accuracy: 0.5521
2025-09-24 17:30:09 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:07 [INFO]  Epoch 27 loss: 396.6579909324646; train accuracy: 0.7635672433035714; test accuracy: 0.5921
2025-09-24 17:31:07 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:05 [INFO]  Epoch 28 loss: 386.5702543258667; train accuracy: 0.7641252790178571; test accuracy: 0.5703
2025-09-24 17:32:05 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:04 [INFO]  Epoch 29 loss: 387.93829250335693; train accuracy: 0.7878766741071429; test accuracy: 0.598
2025-09-24 17:33:04 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:33:04 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:33:04 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:33:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:33:28 [INFO]  Epoch 25 loss: 129.477641582489; train accuracy: 0.72548828125; test accuracy: 0.2773
2025-09-24 17:33:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_25.pth
2025-09-24 17:33:28 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:50 [INFO]  Epoch 26 loss: 150.04084062576294; train accuracy: 0.72646484375; test accuracy: 0.2826
2025-09-24 17:33:50 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:13 [INFO]  Epoch 27 loss: 151.20053148269653; train accuracy: 0.68828125; test accuracy: 0.2518
2025-09-24 17:34:13 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:35 [INFO]  Epoch 28 loss: 150.96815633773804; train accuracy: 0.775; test accuracy: 0.3032
2025-09-24 17:34:35 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:58 [INFO]  Epoch 29 loss: 150.1312870979309; train accuracy: 0.77646484375; test accuracy: 0.3198
2025-09-24 17:34:58 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:34:58 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:34:58 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:34:58 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:35:42 [INFO]  Epoch 25 loss: 249.3398208618164; train accuracy: 0.743603515625; test accuracy: 0.53
2025-09-24 17:35:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_25.pth
2025-09-24 17:35:42 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:36:24 [INFO]  Epoch 26 loss: 299.785240650177; train accuracy: 0.7169921875; test accuracy: 0.4539
2025-09-24 17:36:24 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:07 [INFO]  Epoch 27 loss: 302.12792444229126; train accuracy: 0.749462890625; test accuracy: 0.5271
2025-09-24 17:37:07 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:49 [INFO]  Epoch 28 loss: 301.4855909347534; train accuracy: 0.656689453125; test accuracy: 0.4158
2025-09-24 17:37:49 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:38:31 [INFO]  Epoch 29 loss: 294.8910460472107; train accuracy: 0.717578125; test accuracy: 0.4626
2025-09-24 17:38:31 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:38:31 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:38:31 [INFO]  Round 5 Finish--------|
2025-09-24 17:38:31 [INFO]  Model variance: mean: 0.0033193703275173903, sum: 37090.484375
2025-09-24 17:38:31 [INFO]  g_protos_std: 1.006622314453125
2025-09-24 17:38:40 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7596
2025-09-24 17:38:40 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml


2025-09-24 15:04:47 [INFO]  Load config from ./configs/CIFAR10_alpha0.3.yaml
2025-09-24 15:04:47 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.3', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.3}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:49 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:49 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:49 [INFO]  OneshotOurs
2025-09-24 15:04:50 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 15:04:50 [INFO]  Round 0 starts--------|
2025-09-24 15:04:50 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:04:55 [INFO]  generating sample per sample
2025-09-24 15:04:55 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:05:27 [INFO]  Epoch 0 loss: 380.8039855957031; train accuracy: 0.1401654411764706; test accuracy: 0.139
2025-09-24 15:05:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_0.pth
2025-09-24 15:05:28 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:01 [INFO]  Epoch 1 loss: 351.6304340362549; train accuracy: 0.17095588235294118; test accuracy: 0.1727
2025-09-24 15:06:01 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:33 [INFO]  Epoch 2 loss: 343.7392044067383; train accuracy: 0.17371323529411764; test accuracy: 0.1675
2025-09-24 15:06:33 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:05 [INFO]  Epoch 3 loss: 339.1600399017334; train accuracy: 0.2736672794117647; test accuracy: 0.2773
2025-09-24 15:07:05 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:37 [INFO]  Epoch 4 loss: 325.25340938568115; train accuracy: 0.3186465992647059; test accuracy: 0.3094
2025-09-24 15:07:37 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:07:37 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:07:37 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:07:46 [INFO]  generating sample per sample
2025-09-24 15:07:46 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:37 [INFO]  Epoch 0 loss: 612.5176334381104; train accuracy: 0.13881138392857142; test accuracy: 0.1417
2025-09-24 15:08:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_0.pth
2025-09-24 15:08:37 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:28 [INFO]  Epoch 1 loss: 572.5754432678223; train accuracy: 0.21180943080357142; test accuracy: 0.2104
2025-09-24 15:09:28 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:17 [INFO]  Epoch 2 loss: 550.3045263290405; train accuracy: 0.28125; test accuracy: 0.2793
2025-09-24 15:10:17 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:59 [INFO]  Epoch 3 loss: 536.7481107711792; train accuracy: 0.35037667410714285; test accuracy: 0.3511
2025-09-24 15:10:59 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:43 [INFO]  Epoch 4 loss: 524.3330678939819; train accuracy: 0.31319754464285715; test accuracy: 0.3165
2025-09-24 15:11:43 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:11:43 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:11:43 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:11:49 [INFO]  generating sample per sample
2025-09-24 15:11:49 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:38 [INFO]  Epoch 0 loss: 677.265926361084; train accuracy: 0.23393397177419356; test accuracy: 0.2381
2025-09-24 15:12:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_0.pth
2025-09-24 15:12:38 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:36 [INFO]  Epoch 1 loss: 634.1895294189453; train accuracy: 0.23755670362903225; test accuracy: 0.2341
2025-09-24 15:13:36 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:29 [INFO]  Epoch 2 loss: 600.3098440170288; train accuracy: 0.2571509576612903; test accuracy: 0.2539
2025-09-24 15:14:29 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:24 [INFO]  Epoch 3 loss: 579.4404191970825; train accuracy: 0.41919732862903225; test accuracy: 0.4242
2025-09-24 15:15:24 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:19 [INFO]  Epoch 4 loss: 560.4011573791504; train accuracy: 0.40650201612903225; test accuracy: 0.4052
2025-09-24 15:16:19 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:16:19 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:16:19 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:16:24 [INFO]  generating sample per sample
2025-09-24 15:16:24 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:58 [INFO]  Epoch 0 loss: 446.33931255340576; train accuracy: 0.15; test accuracy: 0.1571
2025-09-24 15:16:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_0.pth
2025-09-24 15:16:59 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:36 [INFO]  Epoch 1 loss: 413.40309619903564; train accuracy: 0.222314453125; test accuracy: 0.2298
2025-09-24 15:17:36 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:13 [INFO]  Epoch 2 loss: 401.69218254089355; train accuracy: 0.308984375; test accuracy: 0.3144
2025-09-24 15:18:13 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:49 [INFO]  Epoch 3 loss: 392.35469913482666; train accuracy: 0.3216796875; test accuracy: 0.3187
2025-09-24 15:18:49 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:25 [INFO]  Epoch 4 loss: 382.5819272994995; train accuracy: 0.3166015625; test accuracy: 0.3246
2025-09-24 15:19:25 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:19:25 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:19:25 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:19:31 [INFO]  generating sample per sample
2025-09-24 15:19:31 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:13 [INFO]  Epoch 0 loss: 498.7185878753662; train accuracy: 0.1801215277777778; test accuracy: 0.1859
2025-09-24 15:20:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_0.pth
2025-09-24 15:20:13 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:51 [INFO]  Epoch 1 loss: 466.01405143737793; train accuracy: 0.15651041666666668; test accuracy: 0.1569
2025-09-24 15:20:51 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:30 [INFO]  Epoch 2 loss: 450.4024543762207; train accuracy: 0.21336805555555555; test accuracy: 0.2181
2025-09-24 15:21:30 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:06 [INFO]  Epoch 3 loss: 439.4308443069458; train accuracy: 0.2708767361111111; test accuracy: 0.2716
2025-09-24 15:22:06 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:44 [INFO]  Epoch 4 loss: 427.6694211959839; train accuracy: 0.29301215277777776; test accuracy: 0.2913
2025-09-24 15:22:44 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:22:44 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:22:44 [INFO]  Round 0 Finish--------|
2025-09-24 15:22:44 [INFO]  Model variance: mean: 0.0013003102503716946, sum: 14529.6044921875
2025-09-24 15:22:44 [INFO]  g_protos_std: 1.0057921409606934
2025-09-24 15:22:49 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6516
2025-09-24 15:22:49 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:22:49 [INFO]  Round 1 starts--------|
2025-09-24 15:22:49 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:22:49 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:19 [INFO]  Epoch 5 loss: 323.13990688323975; train accuracy: 0.36735983455882354; test accuracy: 0.3656
2025-09-24 15:23:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_5.pth
2025-09-24 15:23:19 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:48 [INFO]  Epoch 6 loss: 317.8774299621582; train accuracy: 0.3102022058823529; test accuracy: 0.3087
2025-09-24 15:23:48 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:17 [INFO]  Epoch 7 loss: 311.0000696182251; train accuracy: 0.2979090073529412; test accuracy: 0.2961
2025-09-24 15:24:17 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:46 [INFO]  Epoch 8 loss: 308.9733295440674; train accuracy: 0.3779296875; test accuracy: 0.3731
2025-09-24 15:24:46 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:16 [INFO]  Epoch 9 loss: 306.56041431427; train accuracy: 0.3915441176470588; test accuracy: 0.3833
2025-09-24 15:25:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:25:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:25:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:25:16 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:04 [INFO]  Epoch 5 loss: 504.78517055511475; train accuracy: 0.43917410714285715; test accuracy: 0.4392
2025-09-24 15:26:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_5.pth
2025-09-24 15:26:04 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:51 [INFO]  Epoch 6 loss: 491.90802669525146; train accuracy: 0.4553920200892857; test accuracy: 0.4531
2025-09-24 15:26:51 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:39 [INFO]  Epoch 7 loss: 479.2184042930603; train accuracy: 0.4900599888392857; test accuracy: 0.4812
2025-09-24 15:27:39 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:27 [INFO]  Epoch 8 loss: 469.5467371940613; train accuracy: 0.5281110491071429; test accuracy: 0.5238
2025-09-24 15:28:27 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:09 [INFO]  Epoch 9 loss: 461.73835372924805; train accuracy: 0.6374162946428571; test accuracy: 0.6264
2025-09-24 15:29:09 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:29:09 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:29:09 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:29:09 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:59 [INFO]  Epoch 5 loss: 547.8062343597412; train accuracy: 0.41447202620967744; test accuracy: 0.4147
2025-09-24 15:29:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_5.pth
2025-09-24 15:29:59 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:48 [INFO]  Epoch 6 loss: 533.0963115692139; train accuracy: 0.5338646673387096; test accuracy: 0.5269
2025-09-24 15:30:48 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:36 [INFO]  Epoch 7 loss: 529.041745185852; train accuracy: 0.5276902721774194; test accuracy: 0.5207
2025-09-24 15:31:36 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:29 [INFO]  Epoch 8 loss: 511.7752785682678; train accuracy: 0.5066784274193549; test accuracy: 0.5033
2025-09-24 15:32:29 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:23 [INFO]  Epoch 9 loss: 497.6160297393799; train accuracy: 0.6305128528225806; test accuracy: 0.6227
2025-09-24 15:33:23 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:33:23 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:33:23 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:33:23 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:59 [INFO]  Epoch 5 loss: 380.7300748825073; train accuracy: 0.3322265625; test accuracy: 0.3399
2025-09-24 15:33:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_5.pth
2025-09-24 15:33:59 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:34 [INFO]  Epoch 6 loss: 369.0163164138794; train accuracy: 0.31103515625; test accuracy: 0.3141
2025-09-24 15:34:34 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:11 [INFO]  Epoch 7 loss: 358.95663356781006; train accuracy: 0.383447265625; test accuracy: 0.3851
2025-09-24 15:35:11 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:47 [INFO]  Epoch 8 loss: 352.27722358703613; train accuracy: 0.49912109375; test accuracy: 0.4885
2025-09-24 15:35:47 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:22 [INFO]  Epoch 9 loss: 347.0801820755005; train accuracy: 0.421875; test accuracy: 0.4154
2025-09-24 15:36:22 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:36:22 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:36:22 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:36:22 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:01 [INFO]  Epoch 5 loss: 420.87048053741455; train accuracy: 0.34487847222222223; test accuracy: 0.3395
2025-09-24 15:37:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_5.pth
2025-09-24 15:37:02 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:42 [INFO]  Epoch 6 loss: 407.98367977142334; train accuracy: 0.42886284722222223; test accuracy: 0.4244
2025-09-24 15:37:42 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:22 [INFO]  Epoch 7 loss: 401.9154939651489; train accuracy: 0.5080729166666667; test accuracy: 0.5106
2025-09-24 15:38:22 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:02 [INFO]  Epoch 8 loss: 391.14762115478516; train accuracy: 0.47413194444444445; test accuracy: 0.4734
2025-09-24 15:39:02 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:42 [INFO]  Epoch 9 loss: 387.5293712615967; train accuracy: 0.4935763888888889; test accuracy: 0.4837
2025-09-24 15:39:42 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:39:42 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:39:42 [INFO]  Round 1 Finish--------|
2025-09-24 15:39:42 [INFO]  Model variance: mean: 0.001974533312022686, sum: 22063.33984375
2025-09-24 15:39:42 [INFO]  g_protos_std: 1.0057908296585083
2025-09-24 15:39:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7479
2025-09-24 15:39:48 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:39:48 [INFO]  Round 2 starts--------|
2025-09-24 15:39:48 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:39:48 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:18 [INFO]  Epoch 10 loss: 295.8888759613037; train accuracy: 0.41004136029411764; test accuracy: 0.4008
2025-09-24 15:40:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_10.pth
2025-09-24 15:40:18 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:49 [INFO]  Epoch 11 loss: 294.0062355995178; train accuracy: 0.5106272977941176; test accuracy: 0.4925
2025-09-24 15:40:49 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:21 [INFO]  Epoch 12 loss: 287.3503212928772; train accuracy: 0.41486672794117646; test accuracy: 0.4079
2025-09-24 15:41:21 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:49 [INFO]  Epoch 13 loss: 292.66735315322876; train accuracy: 0.47127757352941174; test accuracy: 0.4526
2025-09-24 15:41:49 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:19 [INFO]  Epoch 14 loss: 276.6073341369629; train accuracy: 0.49942555147058826; test accuracy: 0.4777
2025-09-24 15:42:19 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:42:19 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:42:19 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:42:19 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:08 [INFO]  Epoch 10 loss: 458.4993209838867; train accuracy: 0.63671875; test accuracy: 0.6267
2025-09-24 15:43:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_10.pth
2025-09-24 15:43:08 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:55 [INFO]  Epoch 11 loss: 438.922598361969; train accuracy: 0.6357770647321429; test accuracy: 0.6246
2025-09-24 15:43:55 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:43 [INFO]  Epoch 12 loss: 440.3085660934448; train accuracy: 0.5977957589285714; test accuracy: 0.5894
2025-09-24 15:44:43 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:30 [INFO]  Epoch 13 loss: 444.8279161453247; train accuracy: 0.5658133370535714; test accuracy: 0.5585
2025-09-24 15:45:30 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:19 [INFO]  Epoch 14 loss: 435.791392326355; train accuracy: 0.7241908482142857; test accuracy: 0.6989
2025-09-24 15:46:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:46:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:46:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:46:19 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:11 [INFO]  Epoch 10 loss: 498.5355019569397; train accuracy: 0.6586441532258065; test accuracy: 0.6472
2025-09-24 15:47:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_10.pth
2025-09-24 15:47:12 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:58 [INFO]  Epoch 11 loss: 494.39640951156616; train accuracy: 0.6215032762096774; test accuracy: 0.6128
2025-09-24 15:47:58 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:45 [INFO]  Epoch 12 loss: 475.4425210952759; train accuracy: 0.6018460181451613; test accuracy: 0.5875
2025-09-24 15:48:45 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:35 [INFO]  Epoch 13 loss: 478.93514490127563; train accuracy: 0.6424836189516129; test accuracy: 0.6253
2025-09-24 15:49:35 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:26 [INFO]  Epoch 14 loss: 476.9036259651184; train accuracy: 0.6917212701612904; test accuracy: 0.6721
2025-09-24 15:50:26 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:50:26 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:50:26 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:50:26 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:59 [INFO]  Epoch 10 loss: 349.7139530181885; train accuracy: 0.450341796875; test accuracy: 0.4437
2025-09-24 15:51:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_10.pth
2025-09-24 15:51:00 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:35 [INFO]  Epoch 11 loss: 343.0044984817505; train accuracy: 0.56376953125; test accuracy: 0.5517
2025-09-24 15:51:35 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:08 [INFO]  Epoch 12 loss: 337.8139033317566; train accuracy: 0.56005859375; test accuracy: 0.5486
2025-09-24 15:52:08 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:43 [INFO]  Epoch 13 loss: 329.1449432373047; train accuracy: 0.5794921875; test accuracy: 0.5654
2025-09-24 15:52:43 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:17 [INFO]  Epoch 14 loss: 326.9036297798157; train accuracy: 0.568408203125; test accuracy: 0.5556
2025-09-24 15:53:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:53:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:53:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:53:17 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:54 [INFO]  Epoch 10 loss: 380.00787448883057; train accuracy: 0.4918402777777778; test accuracy: 0.4869
2025-09-24 15:53:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_10.pth
2025-09-24 15:53:54 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:30 [INFO]  Epoch 11 loss: 379.79774045944214; train accuracy: 0.5153645833333333; test accuracy: 0.5034
2025-09-24 15:54:30 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:09 [INFO]  Epoch 12 loss: 368.26976776123047; train accuracy: 0.513671875; test accuracy: 0.5
2025-09-24 15:55:09 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:45 [INFO]  Epoch 13 loss: 363.36699533462524; train accuracy: 0.6030815972222222; test accuracy: 0.5908
2025-09-24 15:55:45 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:21 [INFO]  Epoch 14 loss: 366.4592399597168; train accuracy: 0.5453125; test accuracy: 0.5278
2025-09-24 15:56:21 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:56:21 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:56:21 [INFO]  Round 2 Finish--------|
2025-09-24 15:56:21 [INFO]  Model variance: mean: 0.002524920040741563, sum: 28213.333984375
2025-09-24 15:56:21 [INFO]  g_protos_std: 1.00576651096344
2025-09-24 15:56:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7909
2025-09-24 15:56:26 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:56:26 [INFO]  Round 3 starts--------|
2025-09-24 15:56:26 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:56:26 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:55 [INFO]  Epoch 15 loss: 278.475106716156; train accuracy: 0.5463579963235294; test accuracy: 0.5218
2025-09-24 15:56:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_15.pth
2025-09-24 15:56:56 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:25 [INFO]  Epoch 16 loss: 277.0695481300354; train accuracy: 0.5822035845588235; test accuracy: 0.5571
2025-09-24 15:57:25 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:55 [INFO]  Epoch 17 loss: 276.76784563064575; train accuracy: 0.5330882352941176; test accuracy: 0.5166
2025-09-24 15:57:55 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:23 [INFO]  Epoch 18 loss: 268.82377433776855; train accuracy: 0.4932215073529412; test accuracy: 0.473
2025-09-24 15:58:23 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:55 [INFO]  Epoch 19 loss: 268.6419744491577; train accuracy: 0.6096622242647058; test accuracy: 0.583
2025-09-24 15:58:55 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:58:55 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:58:55 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:58:56 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:40 [INFO]  Epoch 15 loss: 430.1309223175049; train accuracy: 0.7046944754464286; test accuracy: 0.6858
2025-09-24 15:59:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_15.pth
2025-09-24 15:59:41 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:24 [INFO]  Epoch 16 loss: 420.364173412323; train accuracy: 0.6676897321428571; test accuracy: 0.649
2025-09-24 16:00:24 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:10 [INFO]  Epoch 17 loss: 427.95107078552246; train accuracy: 0.6726771763392857; test accuracy: 0.6482
2025-09-24 16:01:10 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:56 [INFO]  Epoch 18 loss: 416.57746601104736; train accuracy: 0.6959054129464286; test accuracy: 0.6701
2025-09-24 16:01:56 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:40 [INFO]  Epoch 19 loss: 412.1479263305664; train accuracy: 0.7244001116071429; test accuracy: 0.6999
2025-09-24 16:02:40 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:02:40 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:02:40 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:02:40 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:28 [INFO]  Epoch 15 loss: 462.68840169906616; train accuracy: 0.6996912802419355; test accuracy: 0.683
2025-09-24 16:03:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_15.pth
2025-09-24 16:03:28 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:16 [INFO]  Epoch 16 loss: 465.9557123184204; train accuracy: 0.7087638608870968; test accuracy: 0.6851
2025-09-24 16:04:16 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:08 [INFO]  Epoch 17 loss: 457.95661640167236; train accuracy: 0.7183719758064516; test accuracy: 0.7015
2025-09-24 16:05:08 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:02 [INFO]  Epoch 18 loss: 449.4162459373474; train accuracy: 0.7165133568548387; test accuracy: 0.6913
2025-09-24 16:06:02 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:51 [INFO]  Epoch 19 loss: 441.73377084732056; train accuracy: 0.6019090221774194; test accuracy: 0.5863
2025-09-24 16:06:51 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:06:51 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:06:51 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:06:51 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:24 [INFO]  Epoch 15 loss: 327.8699541091919; train accuracy: 0.590380859375; test accuracy: 0.5726
2025-09-24 16:07:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_15.pth
2025-09-24 16:07:24 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:59 [INFO]  Epoch 16 loss: 320.77227306365967; train accuracy: 0.519091796875; test accuracy: 0.507
2025-09-24 16:07:59 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:33 [INFO]  Epoch 17 loss: 318.13675594329834; train accuracy: 0.5390625; test accuracy: 0.519
2025-09-24 16:08:33 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:06 [INFO]  Epoch 18 loss: 317.05494832992554; train accuracy: 0.590966796875; test accuracy: 0.5736
2025-09-24 16:09:06 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:37 [INFO]  Epoch 19 loss: 315.33931970596313; train accuracy: 0.64814453125; test accuracy: 0.6264
2025-09-24 16:09:37 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:09:37 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:09:37 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:09:37 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:12 [INFO]  Epoch 15 loss: 353.4737968444824; train accuracy: 0.6514322916666667; test accuracy: 0.6393
2025-09-24 16:10:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_15.pth
2025-09-24 16:10:13 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:48 [INFO]  Epoch 16 loss: 352.75143909454346; train accuracy: 0.6236111111111111; test accuracy: 0.6058
2025-09-24 16:10:48 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:24 [INFO]  Epoch 17 loss: 353.20170497894287; train accuracy: 0.6446180555555555; test accuracy: 0.6284
2025-09-24 16:11:24 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:59 [INFO]  Epoch 18 loss: 343.75490617752075; train accuracy: 0.6094184027777778; test accuracy: 0.5896
2025-09-24 16:11:59 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:34 [INFO]  Epoch 19 loss: 347.8099021911621; train accuracy: 0.6780381944444445; test accuracy: 0.658
2025-09-24 16:12:34 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:12:34 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:12:34 [INFO]  Round 3 Finish--------|
2025-09-24 16:12:34 [INFO]  Model variance: mean: 0.003000801894813776, sum: 33530.81640625
2025-09-24 16:12:34 [INFO]  g_protos_std: 1.0057889223098755
2025-09-24 16:12:39 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8241
2025-09-24 16:12:39 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:12:39 [INFO]  Round 4 starts--------|
2025-09-24 16:12:39 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:12:39 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:05 [INFO]  Epoch 20 loss: 264.678391456604; train accuracy: 0.6646369485294118; test accuracy: 0.6303
2025-09-24 16:13:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_20.pth
2025-09-24 16:13:06 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:32 [INFO]  Epoch 21 loss: 264.355197429657; train accuracy: 0.6516544117647058; test accuracy: 0.6207
2025-09-24 16:13:32 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:59 [INFO]  Epoch 22 loss: 267.01863384246826; train accuracy: 0.5680147058823529; test accuracy: 0.5447
2025-09-24 16:13:59 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:14:25 [INFO]  Epoch 23 loss: 256.96098136901855; train accuracy: 0.6644646139705882; test accuracy: 0.6275
2025-09-24 16:14:25 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:14:52 [INFO]  Epoch 24 loss: 254.25110578536987; train accuracy: 0.5640510110294118; test accuracy: 0.5385
2025-09-24 16:14:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:14:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:14:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:14:52 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:35 [INFO]  Epoch 20 loss: 406.1717920303345; train accuracy: 0.7411411830357143; test accuracy: 0.7144
2025-09-24 16:15:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_20.pth
2025-09-24 16:15:36 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:22 [INFO]  Epoch 21 loss: 403.83034658432007; train accuracy: 0.6862444196428571; test accuracy: 0.6589
2025-09-24 16:16:22 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:05 [INFO]  Epoch 22 loss: 404.0728154182434; train accuracy: 0.7571847098214286; test accuracy: 0.7231
2025-09-24 16:17:05 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:48 [INFO]  Epoch 23 loss: 411.75291538238525; train accuracy: 0.665283203125; test accuracy: 0.6389
2025-09-24 16:17:48 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:30 [INFO]  Epoch 24 loss: 399.2329077720642; train accuracy: 0.6832101004464286; test accuracy: 0.6607
2025-09-24 16:18:30 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:18:30 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:18:30 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:18:30 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:17 [INFO]  Epoch 20 loss: 442.15388679504395; train accuracy: 0.7319493447580645; test accuracy: 0.7107
2025-09-24 16:19:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_20.pth
2025-09-24 16:19:17 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:04 [INFO]  Epoch 21 loss: 443.2622618675232; train accuracy: 0.7430065524193549; test accuracy: 0.7163
2025-09-24 16:20:04 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:53 [INFO]  Epoch 22 loss: 439.46777963638306; train accuracy: 0.7610572076612904; test accuracy: 0.7319
2025-09-24 16:20:53 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:41 [INFO]  Epoch 23 loss: 442.8168306350708; train accuracy: 0.7196320564516129; test accuracy: 0.6908
2025-09-24 16:21:41 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:28 [INFO]  Epoch 24 loss: 442.48834466934204; train accuracy: 0.6681262600806451; test accuracy: 0.6451
2025-09-24 16:22:28 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:22:28 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:22:28 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:22:29 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:01 [INFO]  Epoch 20 loss: 305.6962389945984; train accuracy: 0.745361328125; test accuracy: 0.72
2025-09-24 16:23:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_20.pth
2025-09-24 16:23:02 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:33 [INFO]  Epoch 21 loss: 306.1995596885681; train accuracy: 0.52578125; test accuracy: 0.5106
2025-09-24 16:23:33 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:06 [INFO]  Epoch 22 loss: 302.35155630111694; train accuracy: 0.66845703125; test accuracy: 0.6462
2025-09-24 16:24:06 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:44 [INFO]  Epoch 23 loss: 310.19194078445435; train accuracy: 0.665869140625; test accuracy: 0.6385
2025-09-24 16:24:44 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:21 [INFO]  Epoch 24 loss: 300.4364538192749; train accuracy: 0.648291015625; test accuracy: 0.631
2025-09-24 16:25:21 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:25:21 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:25:21 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:25:21 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:02 [INFO]  Epoch 20 loss: 349.0863447189331; train accuracy: 0.7034722222222223; test accuracy: 0.6791
2025-09-24 16:26:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_20.pth
2025-09-24 16:26:03 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:43 [INFO]  Epoch 21 loss: 347.4377861022949; train accuracy: 0.6258680555555556; test accuracy: 0.6028
2025-09-24 16:26:43 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:27:24 [INFO]  Epoch 22 loss: 333.7125782966614; train accuracy: 0.7016493055555556; test accuracy: 0.679
2025-09-24 16:27:24 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:10 [INFO]  Epoch 23 loss: 344.42583751678467; train accuracy: 0.6672309027777777; test accuracy: 0.6381
2025-09-24 16:31:10 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:23 [INFO]  Epoch 24 loss: 333.71232414245605; train accuracy: 0.7437065972222222; test accuracy: 0.7088
2025-09-24 16:52:23 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:52:23 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:52:23 [INFO]  Round 4 Finish--------|
2025-09-24 16:52:23 [INFO]  Model variance: mean: 0.0034217999782413244, sum: 38235.02734375
2025-09-24 16:52:23 [INFO]  g_protos_std: 1.0058155059814453
2025-09-24 16:52:28 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8434
2025-09-24 16:52:28 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:52:28 [INFO]  Round 5 starts--------|
2025-09-24 16:52:28 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:52:28 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:57 [INFO]  Epoch 25 loss: 255.11164903640747; train accuracy: 0.6923828125; test accuracy: 0.6581
2025-09-24 16:52:58 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_25.pth
2025-09-24 16:52:58 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:28 [INFO]  Epoch 26 loss: 263.10998916625977; train accuracy: 0.6626838235294118; test accuracy: 0.6252
2025-09-24 16:53:28 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:59 [INFO]  Epoch 27 loss: 261.83253812789917; train accuracy: 0.5642807904411765; test accuracy: 0.538
2025-09-24 16:53:59 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:28 [INFO]  Epoch 28 loss: 255.0195393562317; train accuracy: 0.6920955882352942; test accuracy: 0.6539
2025-09-24 16:54:28 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:56 [INFO]  Epoch 29 loss: 254.2977180480957; train accuracy: 0.6496438419117647; test accuracy: 0.6141
2025-09-24 16:54:56 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:54:56 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:54:56 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:54:56 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:55:42 [INFO]  Epoch 25 loss: 391.4691195487976; train accuracy: 0.7414202008928571; test accuracy: 0.6995
2025-09-24 16:55:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_25.pth
2025-09-24 16:55:42 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:56:32 [INFO]  Epoch 26 loss: 393.2366271018982; train accuracy: 0.7446986607142857; test accuracy: 0.7026
2025-09-24 16:56:32 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:57:18 [INFO]  Epoch 27 loss: 390.1821913719177; train accuracy: 0.7906319754464286; test accuracy: 0.7509
2025-09-24 16:57:18 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:05 [INFO]  Epoch 28 loss: 393.8405508995056; train accuracy: 0.7984444754464286; test accuracy: 0.7536
2025-09-24 16:58:05 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:53 [INFO]  Epoch 29 loss: 391.54687309265137; train accuracy: 0.7020786830357143; test accuracy: 0.6667
2025-09-24 16:58:53 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:58:53 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:58:53 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:58:53 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:45 [INFO]  Epoch 25 loss: 433.95247745513916; train accuracy: 0.7823840725806451; test accuracy: 0.7567
2025-09-24 16:59:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_25.pth
2025-09-24 16:59:45 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:00:34 [INFO]  Epoch 26 loss: 434.0688886642456; train accuracy: 0.7768082157258065; test accuracy: 0.7461
2025-09-24 17:00:34 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:01:24 [INFO]  Epoch 27 loss: 434.20809745788574; train accuracy: 0.7453377016129032; test accuracy: 0.7172
2025-09-24 17:01:24 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:12 [INFO]  Epoch 28 loss: 431.43741512298584; train accuracy: 0.8151776713709677; test accuracy: 0.7821
2025-09-24 17:02:12 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:00 [INFO]  Epoch 29 loss: 424.1711459159851; train accuracy: 0.7121660786290323; test accuracy: 0.6838
2025-09-24 17:03:00 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:03:00 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:03:00 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:03:00 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:33 [INFO]  Epoch 25 loss: 300.86606454849243; train accuracy: 0.596240234375; test accuracy: 0.5723
2025-09-24 17:03:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_25.pth
2025-09-24 17:03:34 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:05 [INFO]  Epoch 26 loss: 302.1583833694458; train accuracy: 0.709130859375; test accuracy: 0.6755
2025-09-24 17:04:05 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:35 [INFO]  Epoch 27 loss: 297.97913360595703; train accuracy: 0.74384765625; test accuracy: 0.7046
2025-09-24 17:04:35 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:06 [INFO]  Epoch 28 loss: 292.5224838256836; train accuracy: 0.751416015625; test accuracy: 0.7171
2025-09-24 17:05:06 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:36 [INFO]  Epoch 29 loss: 286.52412605285645; train accuracy: 0.6857421875; test accuracy: 0.649
2025-09-24 17:05:36 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:05:36 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:05:36 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:05:36 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:10 [INFO]  Epoch 25 loss: 327.93463039398193; train accuracy: 0.7360243055555555; test accuracy: 0.6994
2025-09-24 17:06:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_25.pth
2025-09-24 17:06:10 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:44 [INFO]  Epoch 26 loss: 333.20200634002686; train accuracy: 0.7496527777777777; test accuracy: 0.7177
2025-09-24 17:06:44 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:07:19 [INFO]  Epoch 27 loss: 319.1451029777527; train accuracy: 0.6553819444444444; test accuracy: 0.627
2025-09-24 17:07:19 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:07:54 [INFO]  Epoch 28 loss: 325.0646481513977; train accuracy: 0.7165364583333333; test accuracy: 0.6801
2025-09-24 17:07:54 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:29 [INFO]  Epoch 29 loss: 320.1733937263489; train accuracy: 0.7019965277777778; test accuracy: 0.6679
2025-09-24 17:08:29 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:08:29 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:08:29 [INFO]  Round 5 Finish--------|
2025-09-24 17:08:29 [INFO]  Model variance: mean: 0.003806679043918848, sum: 42535.6484375
2025-09-24 17:08:29 [INFO]  g_protos_std: 1.0058673620224
2025-09-24 17:08:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8562
2025-09-24 17:08:34 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml


2025-09-24 15:04:51 [INFO]  Load config from ./configs/CIFAR10_alpha0.5.yaml
2025-09-24 15:04:51 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.5', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.5}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:53 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:53 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 15:04:53 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:53 [INFO]  OneshotOurs
2025-09-24 15:04:54 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 15:04:54 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 15:04:54 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 15:04:57 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 15:04:59 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 15:05:01 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 15:05:03 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 15:05:05 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 15:05:07 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 15:05:09 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 15:05:12 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 15:05:14 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 15:05:16 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 15:05:18 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 15:05:20 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 15:05:22 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 15:05:24 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 15:05:26 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 15:05:28 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 15:05:30 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 15:05:32 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 15:05:34 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 15:05:36 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 15:05:36 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 15:05:37 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 15:05:37 [INFO]  Two-stage training enabled: Alignment epochs set to 1.
2025-09-24 15:05:37 [INFO]  Round 0 starts--------|
2025-09-24 15:05:37 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:45 [INFO]  generating sample per sample
2025-09-24 15:05:45 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:06:39 [INFO]  Epoch 0 loss: 382.3751902580261; train accuracy: 0.09990418632075472; test accuracy: 0.0624
2025-09-24 15:06:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_0.pth
2025-09-24 15:06:39 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:31 [INFO]  Epoch 1 loss: 544.3655452728271; train accuracy: 0.29779628537735847; test accuracy: 0.1807
2025-09-24 15:07:31 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:20 [INFO]  Epoch 2 loss: 517.8761739730835; train accuracy: 0.34780365566037735; test accuracy: 0.2127
2025-09-24 15:08:20 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:11 [INFO]  Epoch 3 loss: 505.46800327301025; train accuracy: 0.27281102594339623; test accuracy: 0.1706
2025-09-24 15:09:11 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:00 [INFO]  Epoch 4 loss: 495.0724468231201; train accuracy: 0.4562573702830189; test accuracy: 0.2886
2025-09-24 15:10:00 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:10:00 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:10:00 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:10:10 [INFO]  generating sample per sample
2025-09-24 15:10:10 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:11:09 [INFO]  Epoch 0 loss: 493.42391538619995; train accuracy: 0.1252264492753623; test accuracy: 0.099
2025-09-24 15:11:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_0.pth
2025-09-24 15:11:09 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:09 [INFO]  Epoch 1 loss: 728.7595272064209; train accuracy: 0.26208673007246375; test accuracy: 0.2283
2025-09-24 15:12:09 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:09 [INFO]  Epoch 2 loss: 683.4323968887329; train accuracy: 0.3132925724637681; test accuracy: 0.2659
2025-09-24 15:13:09 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:12 [INFO]  Epoch 3 loss: 652.214958190918; train accuracy: 0.38380321557971014; test accuracy: 0.3139
2025-09-24 15:14:12 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:13 [INFO]  Epoch 4 loss: 628.9707298278809; train accuracy: 0.5233242753623188; test accuracy: 0.4386
2025-09-24 15:15:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:15:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:15:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:15:21 [INFO]  generating sample per sample
2025-09-24 15:15:21 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:16:15 [INFO]  Epoch 0 loss: 411.39349842071533; train accuracy: 0.022101151315789474; test accuracy: 0.035
2025-09-24 15:16:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_0.pth
2025-09-24 15:16:15 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:06 [INFO]  Epoch 1 loss: 609.1181030273438; train accuracy: 0.17955043859649122; test accuracy: 0.1176
2025-09-24 15:17:06 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:58 [INFO]  Epoch 2 loss: 584.9707670211792; train accuracy: 0.29529879385964913; test accuracy: 0.2089
2025-09-24 15:17:58 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:51 [INFO]  Epoch 3 loss: 566.7152233123779; train accuracy: 0.2890282346491228; test accuracy: 0.2077
2025-09-24 15:18:51 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:44 [INFO]  Epoch 4 loss: 543.7969045639038; train accuracy: 0.36612527412280704; test accuracy: 0.2689
2025-09-24 15:19:44 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:19:44 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:19:44 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:19:52 [INFO]  generating sample per sample
2025-09-24 15:19:52 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:20:37 [INFO]  Epoch 0 loss: 362.76112699508667; train accuracy: 0.1227734375; test accuracy: 0.07
2025-09-24 15:20:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_0.pth
2025-09-24 15:20:38 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:21 [INFO]  Epoch 1 loss: 517.6371173858643; train accuracy: 0.280234375; test accuracy: 0.164
2025-09-24 15:21:21 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:05 [INFO]  Epoch 2 loss: 492.5362033843994; train accuracy: 0.2041796875; test accuracy: 0.1181
2025-09-24 15:22:05 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:49 [INFO]  Epoch 3 loss: 482.8084421157837; train accuracy: 0.3826171875; test accuracy: 0.2308
2025-09-24 15:22:49 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:34 [INFO]  Epoch 4 loss: 466.8565101623535; train accuracy: 0.3057421875; test accuracy: 0.1821
2025-09-24 15:23:34 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:23:34 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:23:34 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:23:43 [INFO]  generating sample per sample
2025-09-24 15:23:43 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:24:41 [INFO]  Epoch 0 loss: 468.15608739852905; train accuracy: 0.1664362980769231; test accuracy: 0.1367
2025-09-24 15:24:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_0.pth
2025-09-24 15:24:42 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:40 [INFO]  Epoch 1 loss: 677.7066659927368; train accuracy: 0.2184795673076923; test accuracy: 0.1633
2025-09-24 15:25:40 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:38 [INFO]  Epoch 2 loss: 645.9439487457275; train accuracy: 0.30315504807692306; test accuracy: 0.2388
2025-09-24 15:26:38 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:37 [INFO]  Epoch 3 loss: 629.1352710723877; train accuracy: 0.22025240384615385; test accuracy: 0.1622
2025-09-24 15:27:37 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:34 [INFO]  Epoch 4 loss: 609.253529548645; train accuracy: 0.40078125; test accuracy: 0.3195
2025-09-24 15:28:34 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:28:34 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:28:34 [INFO]  Round 0 Finish--------|
2025-09-24 15:28:34 [INFO]  Model variance: mean: 0.0013650937471538782, sum: 15253.4921875
2025-09-24 15:28:34 [INFO]  g_protos_std: 1.006279706954956
2025-09-24 15:28:40 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5768
2025-09-24 15:28:40 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:28:40 [INFO]  Round 1 starts--------|
2025-09-24 15:28:40 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:28:40 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:29:18 [INFO]  Epoch 5 loss: 353.5718011856079; train accuracy: 0.41067216981132076; test accuracy: 0.257
2025-09-24 15:29:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_5.pth
2025-09-24 15:29:19 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:04 [INFO]  Epoch 6 loss: 478.3972997665405; train accuracy: 0.445201945754717; test accuracy: 0.28
2025-09-24 15:30:04 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:47 [INFO]  Epoch 7 loss: 466.6140594482422; train accuracy: 0.5532502948113207; test accuracy: 0.3815
2025-09-24 15:30:47 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:33 [INFO]  Epoch 8 loss: 459.4415512084961; train accuracy: 0.5256854363207547; test accuracy: 0.3508
2025-09-24 15:31:33 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:20 [INFO]  Epoch 9 loss: 448.07990312576294; train accuracy: 0.6131706957547169; test accuracy: 0.4336
2025-09-24 15:32:20 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:32:20 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:32:20 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:32:20 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:33:20 [INFO]  Epoch 5 loss: 449.6738176345825; train accuracy: 0.3938802083333333; test accuracy: 0.3296
2025-09-24 15:33:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_5.pth
2025-09-24 15:33:20 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:23 [INFO]  Epoch 6 loss: 595.0291686058044; train accuracy: 0.5381567028985508; test accuracy: 0.4725
2025-09-24 15:34:23 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:26 [INFO]  Epoch 7 loss: 580.5691614151001; train accuracy: 0.5733412590579711; test accuracy: 0.4943
2025-09-24 15:35:26 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:29 [INFO]  Epoch 8 loss: 564.1725497245789; train accuracy: 0.6610903532608695; test accuracy: 0.5668
2025-09-24 15:36:29 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:32 [INFO]  Epoch 9 loss: 555.8070631027222; train accuracy: 0.6653079710144928; test accuracy: 0.5583
2025-09-24 15:37:32 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:37:32 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:37:32 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:37:32 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:38:26 [INFO]  Epoch 5 loss: 382.6247510910034; train accuracy: 0.3559141995614035; test accuracy: 0.2804
2025-09-24 15:38:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_5.pth
2025-09-24 15:38:26 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:20 [INFO]  Epoch 6 loss: 527.0074243545532; train accuracy: 0.4797491776315789; test accuracy: 0.3993
2025-09-24 15:39:20 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:13 [INFO]  Epoch 7 loss: 517.7590074539185; train accuracy: 0.4596011513157895; test accuracy: 0.3852
2025-09-24 15:40:13 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:07 [INFO]  Epoch 8 loss: 502.4496088027954; train accuracy: 0.4296875; test accuracy: 0.3514
2025-09-24 15:41:07 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:58 [INFO]  Epoch 9 loss: 499.2231616973877; train accuracy: 0.5669887609649122; test accuracy: 0.4658
2025-09-24 15:41:58 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:41:58 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:41:58 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:41:58 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:42:45 [INFO]  Epoch 5 loss: 334.82421875; train accuracy: 0.3428515625; test accuracy: 0.1967
2025-09-24 15:42:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_5.pth
2025-09-24 15:42:46 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:34 [INFO]  Epoch 6 loss: 444.898886680603; train accuracy: 0.4019921875; test accuracy: 0.2561
2025-09-24 15:43:34 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:19 [INFO]  Epoch 7 loss: 442.8262996673584; train accuracy: 0.4238671875; test accuracy: 0.3346
2025-09-24 15:44:19 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:03 [INFO]  Epoch 8 loss: 433.63697242736816; train accuracy: 0.484140625; test accuracy: 0.3426
2025-09-24 15:45:03 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:49 [INFO]  Epoch 9 loss: 422.4771695137024; train accuracy: 0.4919140625; test accuracy: 0.3358
2025-09-24 15:45:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:45:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:45:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:45:49 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:46:46 [INFO]  Epoch 5 loss: 430.1521258354187; train accuracy: 0.41256009615384615; test accuracy: 0.3274
2025-09-24 15:46:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_5.pth
2025-09-24 15:46:46 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:43 [INFO]  Epoch 6 loss: 587.2039604187012; train accuracy: 0.4458233173076923; test accuracy: 0.4058
2025-09-24 15:47:43 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:40 [INFO]  Epoch 7 loss: 581.0905303955078; train accuracy: 0.6139122596153846; test accuracy: 0.5108
2025-09-24 15:48:41 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:41 [INFO]  Epoch 8 loss: 558.1316738128662; train accuracy: 0.5811298076923077; test accuracy: 0.5195
2025-09-24 15:49:41 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:40 [INFO]  Epoch 9 loss: 549.0337524414062; train accuracy: 0.5869290865384615; test accuracy: 0.4971
2025-09-24 15:50:40 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:50:40 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:50:40 [INFO]  Round 1 Finish--------|
2025-09-24 15:50:40 [INFO]  Model variance: mean: 0.002006611553952098, sum: 22421.78125
2025-09-24 15:50:40 [INFO]  g_protos_std: 1.0064582824707031
2025-09-24 15:50:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7127
2025-09-24 15:50:46 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:50:46 [INFO]  Round 2 starts--------|
2025-09-24 15:50:46 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:50:46 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:51:33 [INFO]  Epoch 10 loss: 343.57053327560425; train accuracy: 0.5816995872641509; test accuracy: 0.3983
2025-09-24 15:51:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_10.pth
2025-09-24 15:51:33 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:21 [INFO]  Epoch 11 loss: 439.8205289840698; train accuracy: 0.6458579009433962; test accuracy: 0.4792
2025-09-24 15:52:21 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:10 [INFO]  Epoch 12 loss: 424.41126823425293; train accuracy: 0.5166199882075472; test accuracy: 0.3542
2025-09-24 15:53:10 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:56 [INFO]  Epoch 13 loss: 436.34655809402466; train accuracy: 0.5745872641509434; test accuracy: 0.418
2025-09-24 15:53:56 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:44 [INFO]  Epoch 14 loss: 424.12734746932983; train accuracy: 0.6448997641509434; test accuracy: 0.5036
2025-09-24 15:54:44 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:54:44 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:54:44 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:54:44 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:55:47 [INFO]  Epoch 10 loss: 424.45731925964355; train accuracy: 0.6745923913043478; test accuracy: 0.5535
2025-09-24 15:55:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_10.pth
2025-09-24 15:55:48 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:50 [INFO]  Epoch 11 loss: 534.8223028182983; train accuracy: 0.681442481884058; test accuracy: 0.5979
2025-09-24 15:56:50 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:53 [INFO]  Epoch 12 loss: 541.4522671699524; train accuracy: 0.6010246829710145; test accuracy: 0.5043
2025-09-24 15:57:53 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:57 [INFO]  Epoch 13 loss: 518.217845916748; train accuracy: 0.711333786231884; test accuracy: 0.6056
2025-09-24 15:58:57 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:00 [INFO]  Epoch 14 loss: 515.4136424064636; train accuracy: 0.7706918025362319; test accuracy: 0.6545
2025-09-24 16:00:00 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:00:00 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:00:00 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:00:00 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:00:50 [INFO]  Epoch 10 loss: 368.81134700775146; train accuracy: 0.5459155701754386; test accuracy: 0.4566
2025-09-24 16:00:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_10.pth
2025-09-24 16:00:50 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:44 [INFO]  Epoch 11 loss: 489.49514150619507; train accuracy: 0.47241639254385964; test accuracy: 0.3994
2025-09-24 16:01:44 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:37 [INFO]  Epoch 12 loss: 478.9163284301758; train accuracy: 0.6151315789473685; test accuracy: 0.5254
2025-09-24 16:02:37 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:27 [INFO]  Epoch 13 loss: 469.18121433258057; train accuracy: 0.5251507675438597; test accuracy: 0.448
2025-09-24 16:03:27 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:17 [INFO]  Epoch 14 loss: 467.18184185028076; train accuracy: 0.6309964364035088; test accuracy: 0.5452
2025-09-24 16:04:17 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:04:17 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:04:17 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:04:17 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:05:03 [INFO]  Epoch 10 loss: 321.52232551574707; train accuracy: 0.6017578125; test accuracy: 0.4455
2025-09-24 16:05:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_10.pth
2025-09-24 16:05:04 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:51 [INFO]  Epoch 11 loss: 412.4546113014221; train accuracy: 0.6501953125; test accuracy: 0.5062
2025-09-24 16:05:51 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:37 [INFO]  Epoch 12 loss: 403.7067332267761; train accuracy: 0.5855078125; test accuracy: 0.4745
2025-09-24 16:06:37 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:20 [INFO]  Epoch 13 loss: 402.4100799560547; train accuracy: 0.6562890625; test accuracy: 0.5153
2025-09-24 16:07:20 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:05 [INFO]  Epoch 14 loss: 392.5408444404602; train accuracy: 0.44109375; test accuracy: 0.366
2025-09-24 16:08:05 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:08:05 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:08:05 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:08:05 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:09:04 [INFO]  Epoch 10 loss: 415.2323136329651; train accuracy: 0.6393930288461539; test accuracy: 0.5633
2025-09-24 16:09:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_10.pth
2025-09-24 16:09:05 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:02 [INFO]  Epoch 11 loss: 533.104986667633; train accuracy: 0.6114182692307693; test accuracy: 0.5209
2025-09-24 16:10:02 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:59 [INFO]  Epoch 12 loss: 526.248987197876; train accuracy: 0.6108173076923077; test accuracy: 0.5052
2025-09-24 16:10:59 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:58 [INFO]  Epoch 13 loss: 512.0985422134399; train accuracy: 0.6605769230769231; test accuracy: 0.5783
2025-09-24 16:11:58 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:55 [INFO]  Epoch 14 loss: 511.0135807991028; train accuracy: 0.594140625; test accuracy: 0.5086
2025-09-24 16:12:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:12:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:12:55 [INFO]  Round 2 Finish--------|
2025-09-24 16:12:55 [INFO]  Model variance: mean: 0.0025342346634715796, sum: 28317.416015625
2025-09-24 16:12:55 [INFO]  g_protos_std: 1.006580114364624
2025-09-24 16:13:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7692
2025-09-24 16:13:00 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:13:00 [INFO]  Round 3 starts--------|
2025-09-24 16:13:00 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:13:00 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:13:47 [INFO]  Epoch 15 loss: 331.45893001556396; train accuracy: 0.5753611438679245; test accuracy: 0.3804
2025-09-24 16:13:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_15.pth
2025-09-24 16:13:48 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:14:34 [INFO]  Epoch 16 loss: 417.89861822128296; train accuracy: 0.6526017099056604; test accuracy: 0.5207
2025-09-24 16:14:34 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:22 [INFO]  Epoch 17 loss: 411.64707469940186; train accuracy: 0.685546875; test accuracy: 0.5082
2025-09-24 16:15:22 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:12 [INFO]  Epoch 18 loss: 407.90060091018677; train accuracy: 0.7278522995283019; test accuracy: 0.586
2025-09-24 16:16:12 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:03 [INFO]  Epoch 19 loss: 399.71577739715576; train accuracy: 0.6913325471698113; test accuracy: 0.4985
2025-09-24 16:17:03 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:17:03 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:17:03 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:17:03 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:18:07 [INFO]  Epoch 15 loss: 411.4442400932312; train accuracy: 0.7302139945652174; test accuracy: 0.6281
2025-09-24 16:18:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_15.pth
2025-09-24 16:18:07 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:12 [INFO]  Epoch 16 loss: 496.9958086013794; train accuracy: 0.7282042572463768; test accuracy: 0.6278
2025-09-24 16:19:12 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:16 [INFO]  Epoch 17 loss: 504.97383642196655; train accuracy: 0.6645437047101449; test accuracy: 0.5707
2025-09-24 16:20:16 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:19 [INFO]  Epoch 18 loss: 502.55713987350464; train accuracy: 0.7281476449275363; test accuracy: 0.6162
2025-09-24 16:21:19 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:23 [INFO]  Epoch 19 loss: 492.2788505554199; train accuracy: 0.7976958786231884; test accuracy: 0.678
2025-09-24 16:22:23 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:22:23 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:22:23 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:22:24 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:23:19 [INFO]  Epoch 15 loss: 356.2070093154907; train accuracy: 0.6632401315789473; test accuracy: 0.5548
2025-09-24 16:23:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_15.pth
2025-09-24 16:23:20 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:18 [INFO]  Epoch 16 loss: 460.71463775634766; train accuracy: 0.5323807565789473; test accuracy: 0.4564
2025-09-24 16:24:18 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:19 [INFO]  Epoch 17 loss: 454.8828339576721; train accuracy: 0.6540227521929824; test accuracy: 0.5389
2025-09-24 16:25:19 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:17 [INFO]  Epoch 18 loss: 455.3298683166504; train accuracy: 0.6450452302631579; test accuracy: 0.5411
2025-09-24 16:26:17 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:27:14 [INFO]  Epoch 19 loss: 447.15446043014526; train accuracy: 0.6624177631578947; test accuracy: 0.5489
2025-09-24 16:27:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:27:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:27:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:27:14 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:31:11 [INFO]  Epoch 15 loss: 310.71641540527344; train accuracy: 0.6935546875; test accuracy: 0.5168
2025-09-24 16:31:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_15.pth
2025-09-24 16:31:11 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:32 [INFO]  Epoch 16 loss: 387.50118827819824; train accuracy: 0.69921875; test accuracy: 0.5125
2025-09-24 16:52:32 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:24 [INFO]  Epoch 17 loss: 394.0287775993347; train accuracy: 0.665234375; test accuracy: 0.5576
2025-09-24 16:53:24 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:15 [INFO]  Epoch 18 loss: 381.28501653671265; train accuracy: 0.6555078125; test accuracy: 0.5103
2025-09-24 16:54:15 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:55:03 [INFO]  Epoch 19 loss: 385.32698011398315; train accuracy: 0.6809765625; test accuracy: 0.5469
2025-09-24 16:55:03 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:55:03 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:55:03 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:55:03 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:56:03 [INFO]  Epoch 15 loss: 401.1816945075989; train accuracy: 0.5661358173076924; test accuracy: 0.4717
2025-09-24 16:56:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_15.pth
2025-09-24 16:56:04 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:57:08 [INFO]  Epoch 16 loss: 507.56543731689453; train accuracy: 0.7451021634615385; test accuracy: 0.6467
2025-09-24 16:57:08 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:09 [INFO]  Epoch 17 loss: 499.98183488845825; train accuracy: 0.7407151442307692; test accuracy: 0.6377
2025-09-24 16:58:09 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:10 [INFO]  Epoch 18 loss: 494.63477420806885; train accuracy: 0.6225661057692308; test accuracy: 0.5278
2025-09-24 16:59:10 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:00:12 [INFO]  Epoch 19 loss: 484.2541103363037; train accuracy: 0.7208533653846154; test accuracy: 0.6139
2025-09-24 17:00:12 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:00:12 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:00:12 [INFO]  Round 3 Finish--------|
2025-09-24 17:00:12 [INFO]  Model variance: mean: 0.0029696342535316944, sum: 33182.55078125
2025-09-24 17:00:12 [INFO]  g_protos_std: 1.0066832304000854
2025-09-24 17:00:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8052
2025-09-24 17:00:18 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:00:18 [INFO]  Round 4 starts--------|
2025-09-24 17:00:18 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:00:18 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:01:09 [INFO]  Epoch 20 loss: 325.21291875839233; train accuracy: 0.7002137382075472; test accuracy: 0.5652
2025-09-24 17:01:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_20.pth
2025-09-24 17:01:10 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:01 [INFO]  Epoch 21 loss: 394.4409165382385; train accuracy: 0.7080630896226415; test accuracy: 0.5525
2025-09-24 17:02:01 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:49 [INFO]  Epoch 22 loss: 399.0643672943115; train accuracy: 0.6719487028301887; test accuracy: 0.5466
2025-09-24 17:02:49 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:38 [INFO]  Epoch 23 loss: 402.75539350509644; train accuracy: 0.6751179245283019; test accuracy: 0.5353
2025-09-24 17:03:38 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:26 [INFO]  Epoch 24 loss: 395.0978617668152; train accuracy: 0.72265625; test accuracy: 0.5416
2025-09-24 17:04:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:04:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:04:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:04:26 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:05:26 [INFO]  Epoch 20 loss: 403.1625156402588; train accuracy: 0.6658457880434783; test accuracy: 0.5671
2025-09-24 17:05:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_20.pth
2025-09-24 17:05:26 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:28 [INFO]  Epoch 21 loss: 488.78499603271484; train accuracy: 0.7329030797101449; test accuracy: 0.6341
2025-09-24 17:06:28 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:07:27 [INFO]  Epoch 22 loss: 478.3903589248657; train accuracy: 0.7762681159420289; test accuracy: 0.6591
2025-09-24 17:07:27 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:29 [INFO]  Epoch 23 loss: 477.18198585510254; train accuracy: 0.738875679347826; test accuracy: 0.6439
2025-09-24 17:08:29 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:09:29 [INFO]  Epoch 24 loss: 475.2155041694641; train accuracy: 0.7259114583333334; test accuracy: 0.6288
2025-09-24 17:09:29 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:09:29 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:09:29 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:09:29 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:10:20 [INFO]  Epoch 20 loss: 350.3594765663147; train accuracy: 0.6858552631578947; test accuracy: 0.5875
2025-09-24 17:10:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_20.pth
2025-09-24 17:10:21 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:11:11 [INFO]  Epoch 21 loss: 440.61990690231323; train accuracy: 0.6846902412280702; test accuracy: 0.5827
2025-09-24 17:11:11 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:00 [INFO]  Epoch 22 loss: 439.41752910614014; train accuracy: 0.6367872807017544; test accuracy: 0.5382
2025-09-24 17:12:00 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:49 [INFO]  Epoch 23 loss: 441.6003670692444; train accuracy: 0.657312225877193; test accuracy: 0.5784
2025-09-24 17:12:49 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:40 [INFO]  Epoch 24 loss: 429.05761098861694; train accuracy: 0.7380071271929824; test accuracy: 0.6329
2025-09-24 17:13:40 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:13:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:13:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:13:40 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:14:25 [INFO]  Epoch 20 loss: 306.5886015892029; train accuracy: 0.63125; test accuracy: 0.5366
2025-09-24 17:14:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_20.pth
2025-09-24 17:14:26 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:15:09 [INFO]  Epoch 21 loss: 376.9443292617798; train accuracy: 0.6855859375; test accuracy: 0.5512
2025-09-24 17:15:09 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:15:52 [INFO]  Epoch 22 loss: 381.33190298080444; train accuracy: 0.74828125; test accuracy: 0.6079
2025-09-24 17:15:52 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:37 [INFO]  Epoch 23 loss: 369.26887369155884; train accuracy: 0.6895703125; test accuracy: 0.567
2025-09-24 17:16:37 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:17:22 [INFO]  Epoch 24 loss: 369.87842178344727; train accuracy: 0.7771484375; test accuracy: 0.6338
2025-09-24 17:17:22 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:17:22 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:17:22 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:17:22 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:18:19 [INFO]  Epoch 20 loss: 388.9350337982178; train accuracy: 0.6460336538461539; test accuracy: 0.5555
2025-09-24 17:18:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_20.pth
2025-09-24 17:18:20 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:19:18 [INFO]  Epoch 21 loss: 493.9763517379761; train accuracy: 0.7015024038461538; test accuracy: 0.5873
2025-09-24 17:19:18 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:15 [INFO]  Epoch 22 loss: 482.0384798049927; train accuracy: 0.6969651442307693; test accuracy: 0.6107
2025-09-24 17:20:15 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:21:07 [INFO]  Epoch 23 loss: 472.5535979270935; train accuracy: 0.7288762019230769; test accuracy: 0.6081
2025-09-24 17:21:07 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:21:58 [INFO]  Epoch 24 loss: 471.412633895874; train accuracy: 0.7526442307692308; test accuracy: 0.6484
2025-09-24 17:21:58 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:21:58 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:21:58 [INFO]  Round 4 Finish--------|
2025-09-24 17:21:58 [INFO]  Model variance: mean: 0.0033509437926113605, sum: 37443.28515625
2025-09-24 17:21:58 [INFO]  g_protos_std: 1.0067903995513916
2025-09-24 17:22:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8289
2025-09-24 17:22:03 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:22:03 [INFO]  Round 5 starts--------|
2025-09-24 17:22:03 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:22:03 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:22:45 [INFO]  Epoch 25 loss: 320.6444401741028; train accuracy: 0.7512160966981132; test accuracy: 0.5921
2025-09-24 17:22:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_25.pth
2025-09-24 17:22:46 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:23:28 [INFO]  Epoch 26 loss: 390.99954891204834; train accuracy: 0.7580704599056604; test accuracy: 0.5547
2025-09-24 17:23:28 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:24:11 [INFO]  Epoch 27 loss: 382.7081251144409; train accuracy: 0.6845518867924528; test accuracy: 0.5487
2025-09-24 17:24:11 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:24:55 [INFO]  Epoch 28 loss: 383.55490589141846; train accuracy: 0.6876842570754716; test accuracy: 0.5467
2025-09-24 17:24:55 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:25:41 [INFO]  Epoch 29 loss: 380.615270614624; train accuracy: 0.7206294221698113; test accuracy: 0.5281
2025-09-24 17:25:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:25:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:25:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:25:41 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:26:42 [INFO]  Epoch 25 loss: 397.8260726928711; train accuracy: 0.8421082427536232; test accuracy: 0.7231
2025-09-24 17:26:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_25.pth
2025-09-24 17:26:42 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:27:42 [INFO]  Epoch 26 loss: 487.5944080352783; train accuracy: 0.7538213315217391; test accuracy: 0.6614
2025-09-24 17:27:42 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:28:42 [INFO]  Epoch 27 loss: 477.6987051963806; train accuracy: 0.8338711503623188; test accuracy: 0.7041
2025-09-24 17:28:42 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:29:42 [INFO]  Epoch 28 loss: 466.8560471534729; train accuracy: 0.7942142210144928; test accuracy: 0.6705
2025-09-24 17:29:42 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:40 [INFO]  Epoch 29 loss: 462.800989151001; train accuracy: 0.8198879076086957; test accuracy: 0.6986
2025-09-24 17:30:40 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:30:40 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:30:40 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:30:40 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:31:29 [INFO]  Epoch 25 loss: 342.2199559211731; train accuracy: 0.7534608004385965; test accuracy: 0.6344
2025-09-24 17:31:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_25.pth
2025-09-24 17:31:30 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:19 [INFO]  Epoch 26 loss: 426.331582069397; train accuracy: 0.6452165570175439; test accuracy: 0.548
2025-09-24 17:32:19 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:10 [INFO]  Epoch 27 loss: 420.1720495223999; train accuracy: 0.6443599232456141; test accuracy: 0.5635
2025-09-24 17:33:10 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:58 [INFO]  Epoch 28 loss: 416.77856159210205; train accuracy: 0.737561677631579; test accuracy: 0.6264
2025-09-24 17:33:58 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:48 [INFO]  Epoch 29 loss: 426.27570962905884; train accuracy: 0.7250548245614035; test accuracy: 0.5959
2025-09-24 17:34:48 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:34:48 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:34:48 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:34:48 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:35:31 [INFO]  Epoch 25 loss: 303.5075578689575; train accuracy: 0.6974609375; test accuracy: 0.5764
2025-09-24 17:35:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_25.pth
2025-09-24 17:35:31 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:36:14 [INFO]  Epoch 26 loss: 372.74495363235474; train accuracy: 0.6556640625; test accuracy: 0.5784
2025-09-24 17:36:14 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:36:58 [INFO]  Epoch 27 loss: 365.06597900390625; train accuracy: 0.760234375; test accuracy: 0.6076
2025-09-24 17:36:58 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:39 [INFO]  Epoch 28 loss: 357.50473260879517; train accuracy: 0.721640625; test accuracy: 0.6019
2025-09-24 17:37:39 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:38:21 [INFO]  Epoch 29 loss: 362.11781072616577; train accuracy: 0.7260546875; test accuracy: 0.5922
2025-09-24 17:38:21 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:38:21 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:38:21 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:38:21 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:39:12 [INFO]  Epoch 25 loss: 383.39156770706177; train accuracy: 0.7924278846153846; test accuracy: 0.6738
2025-09-24 17:39:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_25.pth
2025-09-24 17:39:12 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:40:07 [INFO]  Epoch 26 loss: 471.43045568466187; train accuracy: 0.7343149038461538; test accuracy: 0.6585
2025-09-24 17:40:07 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:40:58 [INFO]  Epoch 27 loss: 466.7961206436157; train accuracy: 0.7771935096153846; test accuracy: 0.6732
2025-09-24 17:40:58 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:41:52 [INFO]  Epoch 28 loss: 461.9306888580322; train accuracy: 0.7766826923076923; test accuracy: 0.6586
2025-09-24 17:41:52 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:42:45 [INFO]  Epoch 29 loss: 445.960889339447; train accuracy: 0.7658954326923076; test accuracy: 0.672
2025-09-24 17:42:45 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:42:45 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:42:45 [INFO]  Round 5 Finish--------|
2025-09-24 17:42:45 [INFO]  Model variance: mean: 0.003697308013215661, sum: 41313.54296875
2025-09-24 17:42:45 [INFO]  g_protos_std: 1.0069055557250977
2025-09-24 17:42:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8445
2025-09-24 17:42:50 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml


2025-09-24 15:04:56 [INFO]  Load config from ./configs/CIFAR10_alpha0.5.yaml
2025-09-24 15:04:56 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.5', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.5}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:58 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:58 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:59 [INFO]  OneshotOurs
2025-09-24 15:04:59 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 15:04:59 [INFO]  Round 0 starts--------|
2025-09-24 15:04:59 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:09 [INFO]  generating sample per sample
2025-09-24 15:05:09 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:06:16 [INFO]  Epoch 0 loss: 746.712739944458; train accuracy: 0.21119225543478262; test accuracy: 0.2129
2025-09-24 15:06:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_0.pth
2025-09-24 15:06:17 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:23 [INFO]  Epoch 1 loss: 691.2767810821533; train accuracy: 0.2630208333333333; test accuracy: 0.2653
2025-09-24 15:07:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:29 [INFO]  Epoch 2 loss: 668.6093645095825; train accuracy: 0.2591428894927536; test accuracy: 0.259
2025-09-24 15:08:29 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:36 [INFO]  Epoch 3 loss: 646.4749546051025; train accuracy: 0.3233695652173913; test accuracy: 0.3232
2025-09-24 15:09:36 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:40 [INFO]  Epoch 4 loss: 619.2393426895142; train accuracy: 0.41697803442028986; test accuracy: 0.413
2025-09-24 15:10:40 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:10:40 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:10:40 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:10:46 [INFO]  generating sample per sample
2025-09-24 15:10:46 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:11:34 [INFO]  Epoch 0 loss: 611.538836479187; train accuracy: 0.13124302455357142; test accuracy: 0.1331
2025-09-24 15:11:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_0.pth
2025-09-24 15:11:34 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:22 [INFO]  Epoch 1 loss: 568.3001775741577; train accuracy: 0.236083984375; test accuracy: 0.2414
2025-09-24 15:12:22 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:15 [INFO]  Epoch 2 loss: 554.7224426269531; train accuracy: 0.2650669642857143; test accuracy: 0.2671
2025-09-24 15:13:15 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:08 [INFO]  Epoch 3 loss: 536.4905757904053; train accuracy: 0.31581333705357145; test accuracy: 0.3204
2025-09-24 15:14:08 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:58 [INFO]  Epoch 4 loss: 515.1746044158936; train accuracy: 0.36973353794642855; test accuracy: 0.3678
2025-09-24 15:14:58 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:14:58 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:14:58 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:15:06 [INFO]  generating sample per sample
2025-09-24 15:15:06 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:55 [INFO]  Epoch 0 loss: 571.5081071853638; train accuracy: 0.220703125; test accuracy: 0.2285
2025-09-24 15:15:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_0.pth
2025-09-24 15:15:56 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:43 [INFO]  Epoch 1 loss: 528.7372741699219; train accuracy: 0.19966947115384615; test accuracy: 0.1976
2025-09-24 15:16:43 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:32 [INFO]  Epoch 2 loss: 511.5413236618042; train accuracy: 0.21484375; test accuracy: 0.2168
2025-09-24 15:17:32 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:23 [INFO]  Epoch 3 loss: 495.7805299758911; train accuracy: 0.33736478365384615; test accuracy: 0.3371
2025-09-24 15:18:23 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:14 [INFO]  Epoch 4 loss: 476.6891899108887; train accuracy: 0.3621168870192308; test accuracy: 0.3639
2025-09-24 15:19:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:19:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:19:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:19:24 [INFO]  generating sample per sample
2025-09-24 15:19:24 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:23 [INFO]  Epoch 0 loss: 694.5190877914429; train accuracy: 0.175445556640625; test accuracy: 0.175
2025-09-24 15:20:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_0.pth
2025-09-24 15:20:23 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:20 [INFO]  Epoch 1 loss: 649.3918313980103; train accuracy: 0.228424072265625; test accuracy: 0.2328
2025-09-24 15:21:20 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:16 [INFO]  Epoch 2 loss: 618.0324563980103; train accuracy: 0.29742431640625; test accuracy: 0.298
2025-09-24 15:22:16 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:15 [INFO]  Epoch 3 loss: 603.6190004348755; train accuracy: 0.264984130859375; test accuracy: 0.2683
2025-09-24 15:23:15 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:14 [INFO]  Epoch 4 loss: 579.7247457504272; train accuracy: 0.321624755859375; test accuracy: 0.3196
2025-09-24 15:24:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:24:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:24:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:24:19 [INFO]  generating sample per sample
2025-09-24 15:24:19 [INFO]  Epoch 0: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:52 [INFO]  Epoch 0 loss: 391.6456871032715; train accuracy: 0.14012276785714287; test accuracy: 0.1362
2025-09-24 15:24:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_0.pth
2025-09-24 15:24:52 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:24 [INFO]  Epoch 1 loss: 367.4617681503296; train accuracy: 0.11981026785714285; test accuracy: 0.1249
2025-09-24 15:25:24 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:25:57 [INFO]  Epoch 2 loss: 355.32350158691406; train accuracy: 0.2502232142857143; test accuracy: 0.2503
2025-09-24 15:25:57 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:30 [INFO]  Epoch 3 loss: 349.92152404785156; train accuracy: 0.32572544642857143; test accuracy: 0.3253
2025-09-24 15:26:30 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:03 [INFO]  Epoch 4 loss: 337.2259922027588; train accuracy: 0.2947544642857143; test accuracy: 0.2933
2025-09-24 15:27:03 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:27:03 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:27:03 [INFO]  Round 0 Finish--------|
2025-09-24 15:27:03 [INFO]  Model variance: mean: 0.0014517024392262101, sum: 16221.2529296875
2025-09-24 15:27:03 [INFO]  g_protos_std: 1.0057899951934814
2025-09-24 15:27:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6723
2025-09-24 15:27:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:27:09 [INFO]  Round 1 starts--------|
2025-09-24 15:27:09 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:27:09 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:13 [INFO]  Epoch 5 loss: 600.9919843673706; train accuracy: 0.434867527173913; test accuracy: 0.4291
2025-09-24 15:28:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_5.pth
2025-09-24 15:28:14 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:10 [INFO]  Epoch 6 loss: 576.4696416854858; train accuracy: 0.5428272192028986; test accuracy: 0.5396
2025-09-24 15:29:10 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:11 [INFO]  Epoch 7 loss: 577.5913944244385; train accuracy: 0.5609997735507246; test accuracy: 0.5536
2025-09-24 15:30:11 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:09 [INFO]  Epoch 8 loss: 565.175274848938; train accuracy: 0.5853996829710145; test accuracy: 0.5724
2025-09-24 15:31:09 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:16 [INFO]  Epoch 9 loss: 547.9436411857605; train accuracy: 0.6672044836956522; test accuracy: 0.6588
2025-09-24 15:32:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:32:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:32:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:32:16 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:07 [INFO]  Epoch 5 loss: 501.80119705200195; train accuracy: 0.5469796316964286; test accuracy: 0.548
2025-09-24 15:33:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_5.pth
2025-09-24 15:33:08 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:01 [INFO]  Epoch 6 loss: 489.59813499450684; train accuracy: 0.45326450892857145; test accuracy: 0.4527
2025-09-24 15:34:01 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:34:51 [INFO]  Epoch 7 loss: 481.2495446205139; train accuracy: 0.5487234933035714; test accuracy: 0.5477
2025-09-24 15:34:51 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:44 [INFO]  Epoch 8 loss: 462.69037103652954; train accuracy: 0.5326102120535714; test accuracy: 0.5346
2025-09-24 15:35:44 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:39 [INFO]  Epoch 9 loss: 465.09892988204956; train accuracy: 0.5827287946428571; test accuracy: 0.58
2025-09-24 15:36:39 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:36:39 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:36:39 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:36:39 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:27 [INFO]  Epoch 5 loss: 470.91007804870605; train accuracy: 0.43787560096153844; test accuracy: 0.4339
2025-09-24 15:37:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_5.pth
2025-09-24 15:37:27 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:18 [INFO]  Epoch 6 loss: 462.3457975387573; train accuracy: 0.42769681490384615; test accuracy: 0.425
2025-09-24 15:38:18 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:06 [INFO]  Epoch 7 loss: 449.38240242004395; train accuracy: 0.44681490384615385; test accuracy: 0.4452
2025-09-24 15:39:06 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:55 [INFO]  Epoch 8 loss: 436.96748971939087; train accuracy: 0.4708909254807692; test accuracy: 0.4673
2025-09-24 15:39:55 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:40:44 [INFO]  Epoch 9 loss: 432.9274797439575; train accuracy: 0.5678335336538461; test accuracy: 0.5622
2025-09-24 15:40:44 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:40:44 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:40:44 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:40:44 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:46 [INFO]  Epoch 5 loss: 567.8930263519287; train accuracy: 0.4764404296875; test accuracy: 0.4732
2025-09-24 15:41:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_5.pth
2025-09-24 15:41:46 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:46 [INFO]  Epoch 6 loss: 555.7796568870544; train accuracy: 0.404510498046875; test accuracy: 0.407
2025-09-24 15:42:46 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:46 [INFO]  Epoch 7 loss: 536.7308783531189; train accuracy: 0.54339599609375; test accuracy: 0.5408
2025-09-24 15:43:46 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:44:47 [INFO]  Epoch 8 loss: 521.8196821212769; train accuracy: 0.631072998046875; test accuracy: 0.6217
2025-09-24 15:44:47 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:45:46 [INFO]  Epoch 9 loss: 518.2229323387146; train accuracy: 0.61663818359375; test accuracy: 0.6084
2025-09-24 15:45:46 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:45:46 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:45:46 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:45:46 [INFO]  Epoch 5: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:20 [INFO]  Epoch 5 loss: 328.6106939315796; train accuracy: 0.26266741071428573; test accuracy: 0.259
2025-09-24 15:46:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_5.pth
2025-09-24 15:46:21 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:55 [INFO]  Epoch 6 loss: 334.1690511703491; train accuracy: 0.31478794642857144; test accuracy: 0.3136
2025-09-24 15:46:55 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:30 [INFO]  Epoch 7 loss: 327.7681465148926; train accuracy: 0.36685267857142856; test accuracy: 0.3713
2025-09-24 15:47:30 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:02 [INFO]  Epoch 8 loss: 316.95659160614014; train accuracy: 0.42276785714285714; test accuracy: 0.4244
2025-09-24 15:48:02 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:36 [INFO]  Epoch 9 loss: 311.6248083114624; train accuracy: 0.42081473214285714; test accuracy: 0.416
2025-09-24 15:48:36 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:48:36 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:48:36 [INFO]  Round 1 Finish--------|
2025-09-24 15:48:36 [INFO]  Model variance: mean: 0.0022066207602620125, sum: 24656.673828125
2025-09-24 15:48:36 [INFO]  g_protos_std: 1.0057586431503296
2025-09-24 15:48:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.767
2025-09-24 15:48:42 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:48:42 [INFO]  Round 2 starts--------|
2025-09-24 15:48:42 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:48:42 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:49:48 [INFO]  Epoch 10 loss: 540.5908365249634; train accuracy: 0.6204427083333334; test accuracy: 0.6079
2025-09-24 15:49:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_10.pth
2025-09-24 15:49:48 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:53 [INFO]  Epoch 11 loss: 539.7578959465027; train accuracy: 0.6601845561594203; test accuracy: 0.648
2025-09-24 15:50:53 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:51:57 [INFO]  Epoch 12 loss: 524.3948521614075; train accuracy: 0.6701766304347826; test accuracy: 0.6516
2025-09-24 15:51:57 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:00 [INFO]  Epoch 13 loss: 519.8165621757507; train accuracy: 0.6939821105072463; test accuracy: 0.6759
2025-09-24 15:53:00 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:01 [INFO]  Epoch 14 loss: 515.5532269477844; train accuracy: 0.685546875; test accuracy: 0.6706
2025-09-24 15:54:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:54:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:54:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:54:01 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:54:55 [INFO]  Epoch 10 loss: 449.99702978134155; train accuracy: 0.6430315290178571; test accuracy: 0.628
2025-09-24 15:54:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_10.pth
2025-09-24 15:54:55 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:47 [INFO]  Epoch 11 loss: 449.7536516189575; train accuracy: 0.6209542410714286; test accuracy: 0.6058
2025-09-24 15:55:47 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:37 [INFO]  Epoch 12 loss: 448.0439910888672; train accuracy: 0.609619140625; test accuracy: 0.5977
2025-09-24 15:56:37 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:57:29 [INFO]  Epoch 13 loss: 441.12576484680176; train accuracy: 0.6250697544642857; test accuracy: 0.605
2025-09-24 15:57:29 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:21 [INFO]  Epoch 14 loss: 437.95510721206665; train accuracy: 0.6285574776785714; test accuracy: 0.6145
2025-09-24 15:58:21 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:58:21 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:58:21 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:58:21 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:10 [INFO]  Epoch 10 loss: 422.5499029159546; train accuracy: 0.5474759615384616; test accuracy: 0.5335
2025-09-24 15:59:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_10.pth
2025-09-24 15:59:11 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:57 [INFO]  Epoch 11 loss: 420.33325576782227; train accuracy: 0.5985576923076923; test accuracy: 0.591
2025-09-24 15:59:57 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:43 [INFO]  Epoch 12 loss: 417.06572437286377; train accuracy: 0.6304462139423077; test accuracy: 0.6153
2025-09-24 16:00:43 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:33 [INFO]  Epoch 13 loss: 412.6916732788086; train accuracy: 0.6078725961538461; test accuracy: 0.5993
2025-09-24 16:01:33 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:22 [INFO]  Epoch 14 loss: 415.27723503112793; train accuracy: 0.5062349759615384; test accuracy: 0.4988
2025-09-24 16:02:22 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:02:22 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:02:22 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:02:22 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:19 [INFO]  Epoch 10 loss: 507.67379999160767; train accuracy: 0.649139404296875; test accuracy: 0.631
2025-09-24 16:03:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_10.pth
2025-09-24 16:03:20 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:04:17 [INFO]  Epoch 11 loss: 506.1054644584656; train accuracy: 0.666473388671875; test accuracy: 0.6515
2025-09-24 16:04:17 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:16 [INFO]  Epoch 12 loss: 498.6717281341553; train accuracy: 0.704986572265625; test accuracy: 0.6885
2025-09-24 16:05:16 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:14 [INFO]  Epoch 13 loss: 485.1875476837158; train accuracy: 0.651885986328125; test accuracy: 0.6406
2025-09-24 16:06:14 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:08 [INFO]  Epoch 14 loss: 488.88094425201416; train accuracy: 0.675811767578125; test accuracy: 0.6604
2025-09-24 16:07:08 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:07:08 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:07:08 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:07:08 [INFO]  Epoch 10: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:41 [INFO]  Epoch 10 loss: 303.54629135131836; train accuracy: 0.48197544642857143; test accuracy: 0.4762
2025-09-24 16:07:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_10.pth
2025-09-24 16:07:42 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:15 [INFO]  Epoch 11 loss: 303.01525592803955; train accuracy: 0.521484375; test accuracy: 0.5212
2025-09-24 16:08:15 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:08:48 [INFO]  Epoch 12 loss: 294.66556215286255; train accuracy: 0.46729910714285716; test accuracy: 0.4655
2025-09-24 16:08:48 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:20 [INFO]  Epoch 13 loss: 296.22150802612305; train accuracy: 0.5563616071428571; test accuracy: 0.5445
2025-09-24 16:09:20 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:09:51 [INFO]  Epoch 14 loss: 289.8771004676819; train accuracy: 0.5808035714285714; test accuracy: 0.5689
2025-09-24 16:09:51 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:09:51 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:09:51 [INFO]  Round 2 Finish--------|
2025-09-24 16:09:51 [INFO]  Model variance: mean: 0.0028123201336711645, sum: 31424.73046875
2025-09-24 16:09:51 [INFO]  g_protos_std: 1.0057390928268433
2025-09-24 16:09:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8113
2025-09-24 16:09:57 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:09:57 [INFO]  Round 3 starts--------|
2025-09-24 16:09:57 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:09:57 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:56 [INFO]  Epoch 15 loss: 511.46937465667725; train accuracy: 0.634369338768116; test accuracy: 0.6188
2025-09-24 16:10:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_15.pth
2025-09-24 16:10:56 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:54 [INFO]  Epoch 16 loss: 503.0943102836609; train accuracy: 0.6528532608695652; test accuracy: 0.6294
2025-09-24 16:11:54 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:54 [INFO]  Epoch 17 loss: 496.65883588790894; train accuracy: 0.6915760869565217; test accuracy: 0.6671
2025-09-24 16:12:54 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:52 [INFO]  Epoch 18 loss: 496.48202657699585; train accuracy: 0.7353940217391305; test accuracy: 0.7064
2025-09-24 16:13:52 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:14:52 [INFO]  Epoch 19 loss: 493.86753273010254; train accuracy: 0.7484997735507246; test accuracy: 0.7206
2025-09-24 16:14:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:14:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:14:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:14:52 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:40 [INFO]  Epoch 15 loss: 431.0278286933899; train accuracy: 0.6736537388392857; test accuracy: 0.6539
2025-09-24 16:15:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_15.pth
2025-09-24 16:15:41 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:16:30 [INFO]  Epoch 16 loss: 418.9141893386841; train accuracy: 0.6688058035714286; test accuracy: 0.6565
2025-09-24 16:16:30 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:20 [INFO]  Epoch 17 loss: 424.0489468574524; train accuracy: 0.6856863839285714; test accuracy: 0.661
2025-09-24 16:17:20 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:08 [INFO]  Epoch 18 loss: 424.2791323661804; train accuracy: 0.6907087053571429; test accuracy: 0.6713
2025-09-24 16:18:08 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:59 [INFO]  Epoch 19 loss: 406.56571865081787; train accuracy: 0.7120186941964286; test accuracy: 0.6882
2025-09-24 16:18:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:18:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:18:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:18:59 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:48 [INFO]  Epoch 15 loss: 396.1644778251648; train accuracy: 0.6830303485576923; test accuracy: 0.6629
2025-09-24 16:19:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_15.pth
2025-09-24 16:19:49 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:20:35 [INFO]  Epoch 16 loss: 402.6938376426697; train accuracy: 0.6921950120192307; test accuracy: 0.6732
2025-09-24 16:20:35 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:20 [INFO]  Epoch 17 loss: 392.08791875839233; train accuracy: 0.6603064903846154; test accuracy: 0.6503
2025-09-24 16:21:20 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:07 [INFO]  Epoch 18 loss: 392.60983085632324; train accuracy: 0.6758563701923077; test accuracy: 0.6592
2025-09-24 16:22:07 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:53 [INFO]  Epoch 19 loss: 387.4151177406311; train accuracy: 0.6702223557692307; test accuracy: 0.6512
2025-09-24 16:22:53 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:22:53 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:22:53 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:22:53 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:50 [INFO]  Epoch 15 loss: 475.07455110549927; train accuracy: 0.68914794921875; test accuracy: 0.6629
2025-09-24 16:23:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_15.pth
2025-09-24 16:23:51 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:52 [INFO]  Epoch 16 loss: 474.7917938232422; train accuracy: 0.71502685546875; test accuracy: 0.6977
2025-09-24 16:24:52 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:55 [INFO]  Epoch 17 loss: 471.39598989486694; train accuracy: 0.74371337890625; test accuracy: 0.7168
2025-09-24 16:25:55 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:57 [INFO]  Epoch 18 loss: 475.60859632492065; train accuracy: 0.72442626953125; test accuracy: 0.7004
2025-09-24 16:26:57 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:00 [INFO]  Epoch 19 loss: 464.1505432128906; train accuracy: 0.685943603515625; test accuracy: 0.6599
2025-09-24 16:31:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:31:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:31:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:31:00 [INFO]  Epoch 15: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:33 [INFO]  Epoch 15 loss: 286.60326862335205; train accuracy: 0.6351004464285714; test accuracy: 0.6159
2025-09-24 16:31:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_15.pth
2025-09-24 16:31:34 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:40 [INFO]  Epoch 16 loss: 286.60799741744995; train accuracy: 0.5931919642857143; test accuracy: 0.5878
2025-09-24 16:52:40 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:14 [INFO]  Epoch 17 loss: 284.1428837776184; train accuracy: 0.5904017857142857; test accuracy: 0.5737
2025-09-24 16:53:14 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:47 [INFO]  Epoch 18 loss: 276.58042335510254; train accuracy: 0.5813058035714286; test accuracy: 0.5635
2025-09-24 16:53:47 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:21 [INFO]  Epoch 19 loss: 288.061927318573; train accuracy: 0.6421875; test accuracy: 0.6167
2025-09-24 16:54:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:54:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:54:22 [INFO]  Round 3 Finish--------|
2025-09-24 16:54:22 [INFO]  Model variance: mean: 0.0033288265112787485, sum: 37196.1484375
2025-09-24 16:54:22 [INFO]  g_protos_std: 1.0057605504989624
2025-09-24 16:54:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8406
2025-09-24 16:54:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:54:27 [INFO]  Round 4 starts--------|
2025-09-24 16:54:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:54:27 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:55:32 [INFO]  Epoch 20 loss: 497.459810256958; train accuracy: 0.7173346920289855; test accuracy: 0.6938
2025-09-24 16:55:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_20.pth
2025-09-24 16:55:32 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:56:37 [INFO]  Epoch 21 loss: 486.6986413002014; train accuracy: 0.7815330615942029; test accuracy: 0.7503
2025-09-24 16:56:37 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:57:45 [INFO]  Epoch 22 loss: 481.9764108657837; train accuracy: 0.7809952445652174; test accuracy: 0.7492
2025-09-24 16:57:45 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:51 [INFO]  Epoch 23 loss: 476.2630076408386; train accuracy: 0.7794384057971014; test accuracy: 0.7451
2025-09-24 16:58:51 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:54 [INFO]  Epoch 24 loss: 474.05463695526123; train accuracy: 0.7744565217391305; test accuracy: 0.7418
2025-09-24 16:59:54 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:59:54 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:59:54 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:59:55 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:00:47 [INFO]  Epoch 20 loss: 406.4222068786621; train accuracy: 0.6666434151785714; test accuracy: 0.6443
2025-09-24 17:00:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_20.pth
2025-09-24 17:00:48 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:01:41 [INFO]  Epoch 21 loss: 417.7891273498535; train accuracy: 0.7443498883928571; test accuracy: 0.7178
2025-09-24 17:01:41 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:32 [INFO]  Epoch 22 loss: 397.58179569244385; train accuracy: 0.7579520089285714; test accuracy: 0.73
2025-09-24 17:02:32 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:03:22 [INFO]  Epoch 23 loss: 401.03741359710693; train accuracy: 0.7284458705357143; test accuracy: 0.6966
2025-09-24 17:03:22 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:11 [INFO]  Epoch 24 loss: 404.7075595855713; train accuracy: 0.7004743303571429; test accuracy: 0.6694
2025-09-24 17:04:11 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:04:11 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:04:11 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:04:11 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:59 [INFO]  Epoch 20 loss: 377.0295715332031; train accuracy: 0.7052659254807693; test accuracy: 0.6821
2025-09-24 17:04:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_20.pth
2025-09-24 17:04:59 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:47 [INFO]  Epoch 21 loss: 387.1162705421448; train accuracy: 0.6772085336538461; test accuracy: 0.6538
2025-09-24 17:05:47 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:31 [INFO]  Epoch 22 loss: 384.1408886909485; train accuracy: 0.7100360576923077; test accuracy: 0.6829
2025-09-24 17:06:31 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:07:17 [INFO]  Epoch 23 loss: 371.79918098449707; train accuracy: 0.6988055889423077; test accuracy: 0.6701
2025-09-24 17:07:17 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:01 [INFO]  Epoch 24 loss: 370.73272132873535; train accuracy: 0.6900916466346154; test accuracy: 0.6682
2025-09-24 17:08:01 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:08:01 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:08:01 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:08:01 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:56 [INFO]  Epoch 20 loss: 464.1896867752075; train accuracy: 0.751129150390625; test accuracy: 0.7227
2025-09-24 17:08:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_20.pth
2025-09-24 17:08:56 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:09:53 [INFO]  Epoch 21 loss: 463.303147315979; train accuracy: 0.697509765625; test accuracy: 0.6707
2025-09-24 17:09:53 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:10:48 [INFO]  Epoch 22 loss: 457.4868392944336; train accuracy: 0.71832275390625; test accuracy: 0.6922
2025-09-24 17:10:48 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:11:42 [INFO]  Epoch 23 loss: 457.57301092147827; train accuracy: 0.76275634765625; test accuracy: 0.7322
2025-09-24 17:11:42 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:35 [INFO]  Epoch 24 loss: 443.9651699066162; train accuracy: 0.79388427734375; test accuracy: 0.7621
2025-09-24 17:12:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:12:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:12:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:12:35 [INFO]  Epoch 20: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:06 [INFO]  Epoch 20 loss: 273.67469787597656; train accuracy: 0.6752790178571428; test accuracy: 0.6494
2025-09-24 17:13:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_20.pth
2025-09-24 17:13:07 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:37 [INFO]  Epoch 21 loss: 273.1880054473877; train accuracy: 0.6939732142857142; test accuracy: 0.6644
2025-09-24 17:13:37 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:14:08 [INFO]  Epoch 22 loss: 274.37944650650024; train accuracy: 0.7266183035714285; test accuracy: 0.6932
2025-09-24 17:14:08 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:14:40 [INFO]  Epoch 23 loss: 260.9232940673828; train accuracy: 0.6689174107142857; test accuracy: 0.6396
2025-09-24 17:14:40 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:15:09 [INFO]  Epoch 24 loss: 265.96738719940186; train accuracy: 0.6836495535714285; test accuracy: 0.6547
2025-09-24 17:15:09 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:15:09 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:15:09 [INFO]  Round 4 Finish--------|
2025-09-24 17:15:09 [INFO]  Model variance: mean: 0.0037863734178245068, sum: 42308.75390625
2025-09-24 17:15:09 [INFO]  g_protos_std: 1.0058069229125977
2025-09-24 17:15:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8547
2025-09-24 17:15:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:15:14 [INFO]  Round 5 starts--------|
2025-09-24 17:15:14 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:15:14 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:14 [INFO]  Epoch 25 loss: 476.430570602417; train accuracy: 0.7343466938405797; test accuracy: 0.7093
2025-09-24 17:16:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_25.pth
2025-09-24 17:16:14 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:17:11 [INFO]  Epoch 26 loss: 473.98247241973877; train accuracy: 0.7468863224637681; test accuracy: 0.7177
2025-09-24 17:17:11 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:18:09 [INFO]  Epoch 27 loss: 469.62464904785156; train accuracy: 0.7973278985507246; test accuracy: 0.7588
2025-09-24 17:18:09 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:19:09 [INFO]  Epoch 28 loss: 467.31696796417236; train accuracy: 0.8136039402173914; test accuracy: 0.7747
2025-09-24 17:19:09 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:07 [INFO]  Epoch 29 loss: 461.4891724586487; train accuracy: 0.6912364130434783; test accuracy: 0.6644
2025-09-24 17:20:07 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:20:07 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:20:07 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:20:07 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:52 [INFO]  Epoch 25 loss: 406.3691701889038; train accuracy: 0.801025390625; test accuracy: 0.762
2025-09-24 17:20:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_25.pth
2025-09-24 17:20:52 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:21:34 [INFO]  Epoch 26 loss: 408.7847099304199; train accuracy: 0.7819126674107143; test accuracy: 0.7489
2025-09-24 17:21:34 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:22:16 [INFO]  Epoch 27 loss: 380.978223323822; train accuracy: 0.7598005022321429; test accuracy: 0.7223
2025-09-24 17:22:16 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:23:00 [INFO]  Epoch 28 loss: 392.01905488967896; train accuracy: 0.7945033482142857; test accuracy: 0.7547
2025-09-24 17:23:00 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:23:44 [INFO]  Epoch 29 loss: 383.9439778327942; train accuracy: 0.8201381138392857; test accuracy: 0.7774
2025-09-24 17:23:44 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:23:44 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:23:44 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:23:44 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:24:23 [INFO]  Epoch 25 loss: 369.0813093185425; train accuracy: 0.7321213942307693; test accuracy: 0.6998
2025-09-24 17:24:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_25.pth
2025-09-24 17:24:23 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:25:06 [INFO]  Epoch 26 loss: 369.04601192474365; train accuracy: 0.76708984375; test accuracy: 0.7375
2025-09-24 17:25:06 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:25:51 [INFO]  Epoch 27 loss: 363.21415758132935; train accuracy: 0.7518028846153846; test accuracy: 0.7157
2025-09-24 17:25:51 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:26:36 [INFO]  Epoch 28 loss: 365.2789354324341; train accuracy: 0.7053034855769231; test accuracy: 0.6779
2025-09-24 17:26:36 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:27:20 [INFO]  Epoch 29 loss: 361.6478819847107; train accuracy: 0.8131009615384616; test accuracy: 0.7721
2025-09-24 17:27:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:27:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:27:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:27:20 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:28:14 [INFO]  Epoch 25 loss: 449.5565719604492; train accuracy: 0.76531982421875; test accuracy: 0.7335
2025-09-24 17:28:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_25.pth
2025-09-24 17:28:15 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:29:09 [INFO]  Epoch 26 loss: 438.5625467300415; train accuracy: 0.7744140625; test accuracy: 0.7428
2025-09-24 17:29:09 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:02 [INFO]  Epoch 27 loss: 436.22742891311646; train accuracy: 0.73291015625; test accuracy: 0.7039
2025-09-24 17:30:02 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:54 [INFO]  Epoch 28 loss: 434.8888096809387; train accuracy: 0.733489990234375; test accuracy: 0.7025
2025-09-24 17:30:54 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:46 [INFO]  Epoch 29 loss: 434.1850748062134; train accuracy: 0.79766845703125; test accuracy: 0.7593
2025-09-24 17:31:46 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:31:46 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:31:46 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:31:46 [INFO]  Epoch 25: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:16 [INFO]  Epoch 25 loss: 265.3482766151428; train accuracy: 0.6423549107142857; test accuracy: 0.6199
2025-09-24 17:32:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_25.pth
2025-09-24 17:32:16 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:49 [INFO]  Epoch 26 loss: 260.38195419311523; train accuracy: 0.6446428571428572; test accuracy: 0.6197
2025-09-24 17:32:49 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:18 [INFO]  Epoch 27 loss: 262.0511302947998; train accuracy: 0.6545758928571429; test accuracy: 0.6215
2025-09-24 17:33:18 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:49 [INFO]  Epoch 28 loss: 255.298677444458; train accuracy: 0.7511160714285714; test accuracy: 0.7174
2025-09-24 17:33:49 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:18 [INFO]  Epoch 29 loss: 254.31902742385864; train accuracy: 0.6678571428571428; test accuracy: 0.6435
2025-09-24 17:34:18 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:34:18 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:34:18 [INFO]  Round 5 Finish--------|
2025-09-24 17:34:18 [INFO]  Model variance: mean: 0.004203071817755699, sum: 46964.921875
2025-09-24 17:34:18 [INFO]  g_protos_std: 1.0058784484863281
2025-09-24 17:34:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8679
2025-09-24 17:34:23 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
