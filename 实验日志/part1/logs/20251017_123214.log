2025-10-17 12:32:16 [INFO]  Load config from ./configs/CIFAR10_alpha0.05_l1.yaml
2025-10-17 12:32:16 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.05', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 50, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'lambda_align_initial': 1.0}
2025-10-17 12:32:17 [INFO]  Dataset CIFAR10 loaded
2025-10-17 12:32:17 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10.pt
2025-10-17 12:32:17 [INFO]  Data distribution generated correctly using the corrected dirichlet function.
2025-10-17 12:32:17 [INFO]  Total assigned samples: 50000
2025-10-17 12:32:18 [INFO]  OneshotOursV7 with DRCL (ETF Anchors) and Lambda Annealing
2025-10-17 12:32:18 [INFO]  Initialized ETF fixed anchors with shape: torch.Size([10, 512])
2025-10-17 12:32:19 [INFO]  Round 0 starts--------|
2025-10-17 12:32:19 [INFO]  Client 0 Starts Local Trainning--------|
2025-10-17 12:32:52 [INFO]  Epoch 0 loss: 329.1859998703003; train accuracy: 0.37730784339400286; test accuracy: 0.142
2025-10-17 12:32:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_0.pth
2025-10-17 12:32:52 [INFO]  Client 0 Finish Local Training--------|
2025-10-17 12:32:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-10-17 12:32:52 [INFO]  Client 1 Starts Local Trainning--------|
