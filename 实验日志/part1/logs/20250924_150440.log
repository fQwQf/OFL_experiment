2025-09-24 15:04:42 [INFO]  Load config from ./configs/CIFAR10_alpha0.3.yaml
2025-09-24 15:04:42 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.3', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.3}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 5, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}, 'ours_v6_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20, 'alignment_epochs': 1}}
2025-09-24 15:04:44 [INFO]  Dataset CIFAR10 loaded
2025-09-24 15:04:44 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 15:04:44 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 15:04:44 [INFO]  OneshotOurs
2025-09-24 15:04:45 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 15:04:45 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 15:04:45 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 15:04:48 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 15:04:50 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 15:04:52 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 15:04:54 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 15:04:56 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 15:04:58 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 15:05:00 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 15:05:01 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 15:05:03 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 15:05:05 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 15:05:07 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 15:05:09 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 15:05:11 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 15:05:13 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 15:05:15 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 15:05:17 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 15:05:18 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 15:05:20 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 15:05:22 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 15:05:24 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 15:05:24 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 15:05:25 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 15:05:25 [INFO]  Two-stage training enabled: Alignment epochs set to 1.
2025-09-24 15:05:25 [INFO]  Round 0 starts--------|
2025-09-24 15:05:25 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:05:35 [INFO]  generating sample per sample
2025-09-24 15:05:35 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:06:32 [INFO]  Epoch 0 loss: 453.48500776290894; train accuracy: 0.01103670634920635; test accuracy: 0.0497
2025-09-24 15:06:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_0.pth
2025-09-24 15:06:33 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:07:30 [INFO]  Epoch 1 loss: 664.3179130554199; train accuracy: 0.17509920634920634; test accuracy: 0.1284
2025-09-24 15:07:30 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:08:26 [INFO]  Epoch 2 loss: 622.7426843643188; train accuracy: 0.22126116071428573; test accuracy: 0.18
2025-09-24 15:08:26 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:09:25 [INFO]  Epoch 3 loss: 604.6327638626099; train accuracy: 0.27644469246031744; test accuracy: 0.2417
2025-09-24 15:09:25 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:10:23 [INFO]  Epoch 4 loss: 587.6233243942261; train accuracy: 0.3939422123015873; test accuracy: 0.3374
2025-09-24 15:10:23 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:10:23 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:10:23 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:10:32 [INFO]  generating sample per sample
2025-09-24 15:10:33 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:11:23 [INFO]  Epoch 0 loss: 467.2442903518677; train accuracy: 0.006340144230769231; test accuracy: 0.098
2025-09-24 15:11:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_0.pth
2025-09-24 15:11:24 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:12:17 [INFO]  Epoch 1 loss: 692.1198902130127; train accuracy: 0.23115985576923076; test accuracy: 0.1751
2025-09-24 15:12:17 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:13:18 [INFO]  Epoch 2 loss: 655.351035118103; train accuracy: 0.2825721153846154; test accuracy: 0.2153
2025-09-24 15:13:18 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:14:16 [INFO]  Epoch 3 loss: 634.8820142745972; train accuracy: 0.369140625; test accuracy: 0.2835
2025-09-24 15:14:16 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:15:12 [INFO]  Epoch 4 loss: 615.39635181427; train accuracy: 0.31292067307692306; test accuracy: 0.2319
2025-09-24 15:15:12 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:15:12 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:15:12 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:15:20 [INFO]  generating sample per sample
2025-09-24 15:15:20 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:16:09 [INFO]  Epoch 0 loss: 403.1102247238159; train accuracy: 0.031529017857142856; test accuracy: 0.0996
2025-09-24 15:16:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_0.pth
2025-09-24 15:16:09 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:16:57 [INFO]  Epoch 1 loss: 583.175386428833; train accuracy: 0.266357421875; test accuracy: 0.1705
2025-09-24 15:16:57 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:17:47 [INFO]  Epoch 2 loss: 541.4004888534546; train accuracy: 0.23088727678571427; test accuracy: 0.1502
2025-09-24 15:17:47 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:18:35 [INFO]  Epoch 3 loss: 526.7236251831055; train accuracy: 0.35239955357142855; test accuracy: 0.2259
2025-09-24 15:18:35 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:19:24 [INFO]  Epoch 4 loss: 508.94504737854004; train accuracy: 0.3905552455357143; test accuracy: 0.2554
2025-09-24 15:19:24 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:19:24 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:19:24 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:19:27 [INFO]  generating sample per sample
2025-09-24 15:19:28 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:19:47 [INFO]  Epoch 0 loss: 147.94515228271484; train accuracy: 0.00703125; test accuracy: 0.0924
2025-09-24 15:19:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_0.pth
2025-09-24 15:19:47 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:09 [INFO]  Epoch 1 loss: 200.42953205108643; train accuracy: 0.48525390625; test accuracy: 0.1428
2025-09-24 15:20:09 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:29 [INFO]  Epoch 2 loss: 182.11908626556396; train accuracy: 0.4849609375; test accuracy: 0.1328
2025-09-24 15:20:29 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:20:49 [INFO]  Epoch 3 loss: 179.98628330230713; train accuracy: 0.5673828125; test accuracy: 0.2144
2025-09-24 15:20:49 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:21:07 [INFO]  Epoch 4 loss: 177.87086582183838; train accuracy: 0.4869140625; test accuracy: 0.1464
2025-09-24 15:21:07 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:21:07 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:21:07 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:21:13 [INFO]  generating sample per sample
2025-09-24 15:21:13 [INFO]  Epoch 0: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:21:48 [INFO]  Epoch 0 loss: 292.6924204826355; train accuracy: 0.03212890625; test accuracy: 0.0984
2025-09-24 15:21:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_0.pth
2025-09-24 15:21:48 [INFO]  Epoch 1: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:23 [INFO]  Epoch 1 loss: 427.8878297805786; train accuracy: 0.25986328125; test accuracy: 0.1574
2025-09-24 15:22:23 [INFO]  Epoch 2: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:22:59 [INFO]  Epoch 2 loss: 393.82984828948975; train accuracy: 0.306005859375; test accuracy: 0.2151
2025-09-24 15:22:59 [INFO]  Epoch 3: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:23:38 [INFO]  Epoch 3 loss: 385.06928730010986; train accuracy: 0.289306640625; test accuracy: 0.1554
2025-09-24 15:23:38 [INFO]  Epoch 4: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:24:13 [INFO]  Epoch 4 loss: 377.97699642181396; train accuracy: 0.36298828125; test accuracy: 0.2023
2025-09-24 15:24:13 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:24:13 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:24:13 [INFO]  Round 0 Finish--------|
2025-09-24 15:24:13 [INFO]  Model variance: mean: 0.0012539101298898458, sum: 14011.130859375
2025-09-24 15:24:13 [INFO]  g_protos_std: 1.0061997175216675
2025-09-24 15:24:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4765
2025-09-24 15:24:18 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:24:18 [INFO]  Round 1 starts--------|
2025-09-24 15:24:18 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:24:18 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:25:16 [INFO]  Epoch 5 loss: 415.0760259628296; train accuracy: 0.3285590277777778; test accuracy: 0.2613
2025-09-24 15:25:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_5.pth
2025-09-24 15:25:17 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:26:15 [INFO]  Epoch 6 loss: 548.1157817840576; train accuracy: 0.43508184523809523; test accuracy: 0.3611
2025-09-24 15:26:15 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:27:13 [INFO]  Epoch 7 loss: 547.5083088874817; train accuracy: 0.5660032242063492; test accuracy: 0.4575
2025-09-24 15:27:13 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:28:11 [INFO]  Epoch 8 loss: 531.5683822631836; train accuracy: 0.4930555555555556; test accuracy: 0.4347
2025-09-24 15:28:11 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:29:01 [INFO]  Epoch 9 loss: 518.3173098564148; train accuracy: 0.5635540674603174; test accuracy: 0.4645
2025-09-24 15:29:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:29:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:29:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:29:01 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:29:52 [INFO]  Epoch 5 loss: 432.35474157333374; train accuracy: 0.41075721153846156; test accuracy: 0.3126
2025-09-24 15:29:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_5.pth
2025-09-24 15:29:52 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:30:49 [INFO]  Epoch 6 loss: 591.7407217025757; train accuracy: 0.4450420673076923; test accuracy: 0.341
2025-09-24 15:30:49 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:31:47 [INFO]  Epoch 7 loss: 578.3939781188965; train accuracy: 0.4751201923076923; test accuracy: 0.3617
2025-09-24 15:31:47 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:32:45 [INFO]  Epoch 8 loss: 564.1761388778687; train accuracy: 0.5721153846153846; test accuracy: 0.4469
2025-09-24 15:32:45 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:33:45 [INFO]  Epoch 9 loss: 561.3185415267944; train accuracy: 0.5412860576923076; test accuracy: 0.4251
2025-09-24 15:33:45 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:33:45 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:33:45 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:33:45 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:34:35 [INFO]  Epoch 5 loss: 369.63974142074585; train accuracy: 0.47349330357142855; test accuracy: 0.311
2025-09-24 15:34:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_5.pth
2025-09-24 15:34:35 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:35:29 [INFO]  Epoch 6 loss: 489.63852405548096; train accuracy: 0.54150390625; test accuracy: 0.3675
2025-09-24 15:35:29 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:36:24 [INFO]  Epoch 7 loss: 476.24005651474; train accuracy: 0.5992257254464286; test accuracy: 0.446
2025-09-24 15:36:24 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:37:16 [INFO]  Epoch 8 loss: 469.5847682952881; train accuracy: 0.5316336495535714; test accuracy: 0.3714
2025-09-24 15:37:16 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:10 [INFO]  Epoch 9 loss: 463.4470019340515; train accuracy: 0.5934361049107143; test accuracy: 0.422
2025-09-24 15:38:10 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 15:38:10 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 15:38:10 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 15:38:10 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:38:31 [INFO]  Epoch 5 loss: 136.83654975891113; train accuracy: 0.5888671875; test accuracy: 0.1899
2025-09-24 15:38:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_5.pth
2025-09-24 15:38:32 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:38:53 [INFO]  Epoch 6 loss: 175.81919860839844; train accuracy: 0.50009765625; test accuracy: 0.1477
2025-09-24 15:38:53 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:14 [INFO]  Epoch 7 loss: 173.3101463317871; train accuracy: 0.628515625; test accuracy: 0.2178
2025-09-24 15:39:14 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:34 [INFO]  Epoch 8 loss: 172.12967586517334; train accuracy: 0.52470703125; test accuracy: 0.1633
2025-09-24 15:39:34 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:39:55 [INFO]  Epoch 9 loss: 169.39577388763428; train accuracy: 0.5392578125; test accuracy: 0.1642
2025-09-24 15:39:55 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 15:39:55 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 15:39:55 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 15:39:55 [INFO]  Epoch 5: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:40:33 [INFO]  Epoch 5 loss: 272.82812213897705; train accuracy: 0.4583984375; test accuracy: 0.2673
2025-09-24 15:40:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_5.pth
2025-09-24 15:40:34 [INFO]  Epoch 6: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:13 [INFO]  Epoch 6 loss: 364.5659999847412; train accuracy: 0.5076171875; test accuracy: 0.3186
2025-09-24 15:41:13 [INFO]  Epoch 7: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:41:58 [INFO]  Epoch 7 loss: 359.75597858428955; train accuracy: 0.538720703125; test accuracy: 0.3314
2025-09-24 15:41:58 [INFO]  Epoch 8: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:42:48 [INFO]  Epoch 8 loss: 355.2907381057739; train accuracy: 0.472216796875; test accuracy: 0.281
2025-09-24 15:42:48 [INFO]  Epoch 9: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:43:39 [INFO]  Epoch 9 loss: 353.4049816131592; train accuracy: 0.53896484375; test accuracy: 0.3508
2025-09-24 15:43:39 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 15:43:39 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 15:43:39 [INFO]  Round 1 Finish--------|
2025-09-24 15:43:39 [INFO]  Model variance: mean: 0.0018072682432830334, sum: 20194.328125
2025-09-24 15:43:39 [INFO]  g_protos_std: 1.0062839984893799
2025-09-24 15:43:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6079
2025-09-24 15:43:48 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 15:43:48 [INFO]  Round 2 starts--------|
2025-09-24 15:43:48 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 15:43:48 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:45:04 [INFO]  Epoch 10 loss: 394.37893199920654; train accuracy: 0.6505766369047619; test accuracy: 0.5229
2025-09-24 15:45:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_10.pth
2025-09-24 15:45:05 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:46:21 [INFO]  Epoch 11 loss: 509.33401107788086; train accuracy: 0.6746341765873016; test accuracy: 0.5406
2025-09-24 15:46:21 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:47:36 [INFO]  Epoch 12 loss: 492.8535032272339; train accuracy: 0.6857328869047619; test accuracy: 0.5522
2025-09-24 15:47:36 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:48:49 [INFO]  Epoch 13 loss: 486.35747385025024; train accuracy: 0.7288256448412699; test accuracy: 0.6043
2025-09-24 15:48:49 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:50:01 [INFO]  Epoch 14 loss: 481.5959005355835; train accuracy: 0.7592075892857143; test accuracy: 0.6224
2025-09-24 15:50:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 15:50:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 15:50:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 15:50:01 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:51:17 [INFO]  Epoch 10 loss: 417.1230549812317; train accuracy: 0.5938100961538462; test accuracy: 0.4556
2025-09-24 15:51:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_10.pth
2025-09-24 15:51:17 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:52:33 [INFO]  Epoch 11 loss: 542.5935573577881; train accuracy: 0.6002403846153846; test accuracy: 0.4747
2025-09-24 15:52:33 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:53:48 [INFO]  Epoch 12 loss: 533.4591822624207; train accuracy: 0.5781850961538462; test accuracy: 0.4656
2025-09-24 15:53:48 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:55:04 [INFO]  Epoch 13 loss: 530.8570637702942; train accuracy: 0.6431490384615385; test accuracy: 0.5206
2025-09-24 15:55:04 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:56:20 [INFO]  Epoch 14 loss: 513.7974457740784; train accuracy: 0.6944110576923077; test accuracy: 0.5559
2025-09-24 15:56:20 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 15:56:20 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 15:56:20 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 15:56:20 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 15:57:24 [INFO]  Epoch 10 loss: 355.1814398765564; train accuracy: 0.6292898995535714; test accuracy: 0.4462
2025-09-24 15:57:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_10.pth
2025-09-24 15:57:25 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:58:32 [INFO]  Epoch 11 loss: 450.8500962257385; train accuracy: 0.5452357700892857; test accuracy: 0.3878
2025-09-24 15:58:32 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 15:59:39 [INFO]  Epoch 12 loss: 440.1929941177368; train accuracy: 0.7122628348214286; test accuracy: 0.5404
2025-09-24 15:59:39 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:00:40 [INFO]  Epoch 13 loss: 445.71565532684326; train accuracy: 0.6194545200892857; test accuracy: 0.4725
2025-09-24 16:00:40 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:01:47 [INFO]  Epoch 14 loss: 439.15493631362915; train accuracy: 0.6409040178571429; test accuracy: 0.5063
2025-09-24 16:01:47 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:01:47 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:01:47 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:01:47 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:02:13 [INFO]  Epoch 10 loss: 133.5300064086914; train accuracy: 0.64619140625; test accuracy: 0.239
2025-09-24 16:02:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_10.pth
2025-09-24 16:02:13 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:02:39 [INFO]  Epoch 11 loss: 169.24479389190674; train accuracy: 0.61484375; test accuracy: 0.2213
2025-09-24 16:02:39 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:03 [INFO]  Epoch 12 loss: 167.48759078979492; train accuracy: 0.60087890625; test accuracy: 0.2011
2025-09-24 16:03:03 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:29 [INFO]  Epoch 13 loss: 167.7972755432129; train accuracy: 0.53154296875; test accuracy: 0.165
2025-09-24 16:03:29 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:03:52 [INFO]  Epoch 14 loss: 164.19467782974243; train accuracy: 0.53203125; test accuracy: 0.1968
2025-09-24 16:03:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:03:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:03:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:03:52 [INFO]  Epoch 10: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:04:38 [INFO]  Epoch 10 loss: 262.9946622848511; train accuracy: 0.5201171875; test accuracy: 0.3144
2025-09-24 16:04:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_10.pth
2025-09-24 16:04:39 [INFO]  Epoch 11: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:05:26 [INFO]  Epoch 11 loss: 336.88237476348877; train accuracy: 0.577294921875; test accuracy: 0.3414
2025-09-24 16:05:26 [INFO]  Epoch 12: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:13 [INFO]  Epoch 12 loss: 338.1720643043518; train accuracy: 0.59033203125; test accuracy: 0.3734
2025-09-24 16:06:13 [INFO]  Epoch 13: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:06:59 [INFO]  Epoch 13 loss: 331.9611530303955; train accuracy: 0.597412109375; test accuracy: 0.3714
2025-09-24 16:06:59 [INFO]  Epoch 14: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:07:43 [INFO]  Epoch 14 loss: 326.2431306838989; train accuracy: 0.6396484375; test accuracy: 0.4066
2025-09-24 16:07:43 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:07:43 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:07:43 [INFO]  Round 2 Finish--------|
2025-09-24 16:07:43 [INFO]  Model variance: mean: 0.00227428344078362, sum: 25412.734375
2025-09-24 16:07:43 [INFO]  g_protos_std: 1.0063508749008179
2025-09-24 16:07:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6691
2025-09-24 16:07:52 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:07:52 [INFO]  Round 3 starts--------|
2025-09-24 16:07:52 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:07:52 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:09:04 [INFO]  Epoch 15 loss: 385.3432078361511; train accuracy: 0.7655319940476191; test accuracy: 0.6135
2025-09-24 16:09:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_15.pth
2025-09-24 16:09:05 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:10:11 [INFO]  Epoch 16 loss: 473.6651773452759; train accuracy: 0.6430431547619048; test accuracy: 0.5474
2025-09-24 16:10:11 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:11:20 [INFO]  Epoch 17 loss: 464.0167064666748; train accuracy: 0.7451016865079365; test accuracy: 0.6078
2025-09-24 16:11:20 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:12:29 [INFO]  Epoch 18 loss: 458.0542006492615; train accuracy: 0.7145027281746031; test accuracy: 0.5793
2025-09-24 16:12:29 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:13:36 [INFO]  Epoch 19 loss: 462.5781283378601; train accuracy: 0.7560143849206349; test accuracy: 0.6182
2025-09-24 16:13:36 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 16:13:36 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 16:13:36 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 16:13:37 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:14:46 [INFO]  Epoch 15 loss: 402.59922647476196; train accuracy: 0.7014423076923076; test accuracy: 0.5647
2025-09-24 16:14:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_15.pth
2025-09-24 16:14:47 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:15:56 [INFO]  Epoch 16 loss: 510.4781837463379; train accuracy: 0.6586838942307692; test accuracy: 0.5246
2025-09-24 16:15:56 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:17:06 [INFO]  Epoch 17 loss: 505.6476860046387; train accuracy: 0.7278545673076923; test accuracy: 0.5785
2025-09-24 16:17:06 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:18:16 [INFO]  Epoch 18 loss: 501.51238536834717; train accuracy: 0.6900240384615385; test accuracy: 0.5515
2025-09-24 16:18:16 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:19:27 [INFO]  Epoch 19 loss: 493.63544178009033; train accuracy: 0.6361778846153846; test accuracy: 0.5261
2025-09-24 16:19:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 16:19:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 16:19:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 16:19:27 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:20:28 [INFO]  Epoch 15 loss: 344.78778886795044; train accuracy: 0.5960170200892857; test accuracy: 0.4652
2025-09-24 16:20:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_15.pth
2025-09-24 16:20:29 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:21:31 [INFO]  Epoch 16 loss: 428.790563583374; train accuracy: 0.6343122209821429; test accuracy: 0.4966
2025-09-24 16:21:31 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:22:31 [INFO]  Epoch 17 loss: 424.8736925125122; train accuracy: 0.7459891183035714; test accuracy: 0.5597
2025-09-24 16:22:31 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:23:31 [INFO]  Epoch 18 loss: 423.3189506530762; train accuracy: 0.7139020647321429; test accuracy: 0.5571
2025-09-24 16:23:31 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:24:35 [INFO]  Epoch 19 loss: 411.4160351753235; train accuracy: 0.7313755580357143; test accuracy: 0.5516
2025-09-24 16:24:35 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 16:24:35 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 16:24:35 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 16:24:35 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:25:00 [INFO]  Epoch 15 loss: 132.66572284698486; train accuracy: 0.66015625; test accuracy: 0.2403
2025-09-24 16:25:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_15.pth
2025-09-24 16:25:00 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:26 [INFO]  Epoch 16 loss: 164.03986263275146; train accuracy: 0.6005859375; test accuracy: 0.2045
2025-09-24 16:25:26 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:25:51 [INFO]  Epoch 17 loss: 162.4321002960205; train accuracy: 0.69658203125; test accuracy: 0.2551
2025-09-24 16:25:51 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:16 [INFO]  Epoch 18 loss: 158.68962907791138; train accuracy: 0.60888671875; test accuracy: 0.2073
2025-09-24 16:26:16 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:26:42 [INFO]  Epoch 19 loss: 159.02509832382202; train accuracy: 0.69501953125; test accuracy: 0.2556
2025-09-24 16:26:42 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 16:26:42 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 16:26:42 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 16:26:42 [INFO]  Epoch 15: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:27:29 [INFO]  Epoch 15 loss: 258.5512127876282; train accuracy: 0.6724609375; test accuracy: 0.4253
2025-09-24 16:27:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_15.pth
2025-09-24 16:27:29 [INFO]  Epoch 16: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:31:21 [INFO]  Epoch 16 loss: 319.51420164108276; train accuracy: 0.674169921875; test accuracy: 0.4414
2025-09-24 16:31:21 [INFO]  Epoch 17: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:52:40 [INFO]  Epoch 17 loss: 321.397349357605; train accuracy: 0.6591796875; test accuracy: 0.4423
2025-09-24 16:52:40 [INFO]  Epoch 18: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:53:26 [INFO]  Epoch 18 loss: 314.77370595932007; train accuracy: 0.734814453125; test accuracy: 0.4869
2025-09-24 16:53:26 [INFO]  Epoch 19: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:54:14 [INFO]  Epoch 19 loss: 315.7458691596985; train accuracy: 0.708349609375; test accuracy: 0.4653
2025-09-24 16:54:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 16:54:14 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 16:54:14 [INFO]  Round 3 Finish--------|
2025-09-24 16:54:14 [INFO]  Model variance: mean: 0.0026666217017918825, sum: 29796.703125
2025-09-24 16:54:14 [INFO]  g_protos_std: 1.0064465999603271
2025-09-24 16:54:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7055
2025-09-24 16:54:23 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 16:54:23 [INFO]  Round 4 starts--------|
2025-09-24 16:54:23 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 16:54:23 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 16:55:37 [INFO]  Epoch 20 loss: 375.6322546005249; train accuracy: 0.6921812996031746; test accuracy: 0.5754
2025-09-24 16:55:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_20.pth
2025-09-24 16:55:37 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:56:52 [INFO]  Epoch 21 loss: 457.77404260635376; train accuracy: 0.7510850694444444; test accuracy: 0.6268
2025-09-24 16:56:52 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:58:04 [INFO]  Epoch 22 loss: 442.7964835166931; train accuracy: 0.7830171130952381; test accuracy: 0.6424
2025-09-24 16:58:04 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 16:59:12 [INFO]  Epoch 23 loss: 452.3868465423584; train accuracy: 0.834046378968254; test accuracy: 0.6843
2025-09-24 16:59:12 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:00:21 [INFO]  Epoch 24 loss: 450.7019338607788; train accuracy: 0.7474578373015873; test accuracy: 0.6089
2025-09-24 17:00:21 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:00:21 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:00:21 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:00:21 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:01:36 [INFO]  Epoch 20 loss: 396.51377868652344; train accuracy: 0.6729867788461539; test accuracy: 0.5307
2025-09-24 17:01:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_20.pth
2025-09-24 17:01:37 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:02:51 [INFO]  Epoch 21 loss: 493.68139839172363; train accuracy: 0.6486177884615385; test accuracy: 0.5102
2025-09-24 17:02:51 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:04:02 [INFO]  Epoch 22 loss: 481.7242488861084; train accuracy: 0.7241286057692308; test accuracy: 0.5914
2025-09-24 17:04:02 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:05:10 [INFO]  Epoch 23 loss: 489.3020558357239; train accuracy: 0.7193509615384616; test accuracy: 0.5951
2025-09-24 17:05:10 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:06:20 [INFO]  Epoch 24 loss: 487.250675201416; train accuracy: 0.7017728365384616; test accuracy: 0.5955
2025-09-24 17:06:20 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:06:20 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:06:20 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:06:20 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:07:18 [INFO]  Epoch 20 loss: 335.571825504303; train accuracy: 0.755126953125; test accuracy: 0.5793
2025-09-24 17:07:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_20.pth
2025-09-24 17:07:19 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:08:19 [INFO]  Epoch 21 loss: 407.55499792099; train accuracy: 0.7354910714285714; test accuracy: 0.5583
2025-09-24 17:08:19 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:09:19 [INFO]  Epoch 22 loss: 409.68156719207764; train accuracy: 0.8014439174107143; test accuracy: 0.6103
2025-09-24 17:09:19 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:10:19 [INFO]  Epoch 23 loss: 403.7443308830261; train accuracy: 0.7461635044642857; test accuracy: 0.5708
2025-09-24 17:10:19 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:11:20 [INFO]  Epoch 24 loss: 405.117826461792; train accuracy: 0.6387765066964286; test accuracy: 0.5075
2025-09-24 17:11:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:11:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:11:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:11:20 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:11:44 [INFO]  Epoch 20 loss: 129.03358793258667; train accuracy: 0.611328125; test accuracy: 0.2327
2025-09-24 17:11:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_20.pth
2025-09-24 17:11:44 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:08 [INFO]  Epoch 21 loss: 155.5619878768921; train accuracy: 0.66875; test accuracy: 0.2593
2025-09-24 17:12:08 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:31 [INFO]  Epoch 22 loss: 153.1873641014099; train accuracy: 0.67958984375; test accuracy: 0.2556
2025-09-24 17:12:31 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:12:54 [INFO]  Epoch 23 loss: 153.77092361450195; train accuracy: 0.75712890625; test accuracy: 0.3056
2025-09-24 17:12:54 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:13:19 [INFO]  Epoch 24 loss: 153.4470648765564; train accuracy: 0.7076171875; test accuracy: 0.2689
2025-09-24 17:13:19 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:13:19 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:13:19 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:13:19 [INFO]  Epoch 20: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:14:02 [INFO]  Epoch 20 loss: 252.047504901886; train accuracy: 0.54306640625; test accuracy: 0.367
2025-09-24 17:14:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_20.pth
2025-09-24 17:14:03 [INFO]  Epoch 21: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:14:46 [INFO]  Epoch 21 loss: 310.7849793434143; train accuracy: 0.7244140625; test accuracy: 0.4776
2025-09-24 17:14:46 [INFO]  Epoch 22: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:15:29 [INFO]  Epoch 22 loss: 311.1400270462036; train accuracy: 0.736328125; test accuracy: 0.4825
2025-09-24 17:15:29 [INFO]  Epoch 23: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:12 [INFO]  Epoch 23 loss: 309.0110402107239; train accuracy: 0.6748046875; test accuracy: 0.449
2025-09-24 17:16:12 [INFO]  Epoch 24: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:16:55 [INFO]  Epoch 24 loss: 303.2126603126526; train accuracy: 0.73642578125; test accuracy: 0.5025
2025-09-24 17:16:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:16:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:16:55 [INFO]  Round 4 Finish--------|
2025-09-24 17:16:55 [INFO]  Model variance: mean: 0.003008681582286954, sum: 33618.86328125
2025-09-24 17:16:55 [INFO]  g_protos_std: 1.006532073020935
2025-09-24 17:17:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7283
2025-09-24 17:17:04 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:17:04 [INFO]  Round 5 starts--------|
2025-09-24 17:17:04 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:17:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:18:12 [INFO]  Epoch 25 loss: 366.12878608703613; train accuracy: 0.8284040178571429; test accuracy: 0.6657
2025-09-24 17:18:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_25.pth
2025-09-24 17:18:12 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:19:19 [INFO]  Epoch 26 loss: 438.3179888725281; train accuracy: 0.7590215773809523; test accuracy: 0.6168
2025-09-24 17:19:19 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:20:28 [INFO]  Epoch 27 loss: 437.26233100891113; train accuracy: 0.8471602182539683; test accuracy: 0.6934
2025-09-24 17:20:28 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:21:30 [INFO]  Epoch 28 loss: 431.91095447540283; train accuracy: 0.796843998015873; test accuracy: 0.6451
2025-09-24 17:21:30 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:22:32 [INFO]  Epoch 29 loss: 437.1023826599121; train accuracy: 0.8018353174603174; test accuracy: 0.6664
2025-09-24 17:22:32 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:22:32 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:22:32 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:22:32 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:23:38 [INFO]  Epoch 25 loss: 385.2160544395447; train accuracy: 0.7358774038461539; test accuracy: 0.5799
2025-09-24 17:23:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_25.pth
2025-09-24 17:23:38 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:24:45 [INFO]  Epoch 26 loss: 472.84588718414307; train accuracy: 0.6873798076923077; test accuracy: 0.6028
2025-09-24 17:24:45 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:25:54 [INFO]  Epoch 27 loss: 472.156222820282; train accuracy: 0.6729867788461539; test accuracy: 0.5647
2025-09-24 17:25:54 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:27:00 [INFO]  Epoch 28 loss: 459.98123693466187; train accuracy: 0.7594350961538462; test accuracy: 0.6449
2025-09-24 17:27:01 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:28:09 [INFO]  Epoch 29 loss: 466.9650778770447; train accuracy: 0.7196814903846154; test accuracy: 0.6251
2025-09-24 17:28:09 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:28:09 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:28:09 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:28:09 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:29:08 [INFO]  Epoch 25 loss: 331.3045320510864; train accuracy: 0.7631487165178571; test accuracy: 0.5903
2025-09-24 17:29:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_25.pth
2025-09-24 17:29:08 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:30:09 [INFO]  Epoch 26 loss: 403.70697832107544; train accuracy: 0.7362932477678571; test accuracy: 0.5521
2025-09-24 17:30:09 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:31:07 [INFO]  Epoch 27 loss: 396.6579909324646; train accuracy: 0.7635672433035714; test accuracy: 0.5921
2025-09-24 17:31:07 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:32:05 [INFO]  Epoch 28 loss: 386.5702543258667; train accuracy: 0.7641252790178571; test accuracy: 0.5703
2025-09-24 17:32:05 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:04 [INFO]  Epoch 29 loss: 387.93829250335693; train accuracy: 0.7878766741071429; test accuracy: 0.598
2025-09-24 17:33:04 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:33:04 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:33:04 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:33:04 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:33:28 [INFO]  Epoch 25 loss: 129.477641582489; train accuracy: 0.72548828125; test accuracy: 0.2773
2025-09-24 17:33:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_25.pth
2025-09-24 17:33:28 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:33:50 [INFO]  Epoch 26 loss: 150.04084062576294; train accuracy: 0.72646484375; test accuracy: 0.2826
2025-09-24 17:33:50 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:13 [INFO]  Epoch 27 loss: 151.20053148269653; train accuracy: 0.68828125; test accuracy: 0.2518
2025-09-24 17:34:13 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:35 [INFO]  Epoch 28 loss: 150.96815633773804; train accuracy: 0.775; test accuracy: 0.3032
2025-09-24 17:34:35 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:34:58 [INFO]  Epoch 29 loss: 150.1312870979309; train accuracy: 0.77646484375; test accuracy: 0.3198
2025-09-24 17:34:58 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:34:58 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:34:58 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:34:58 [INFO]  Epoch 25: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:35:42 [INFO]  Epoch 25 loss: 249.3398208618164; train accuracy: 0.743603515625; test accuracy: 0.53
2025-09-24 17:35:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_25.pth
2025-09-24 17:35:42 [INFO]  Epoch 26: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:36:24 [INFO]  Epoch 26 loss: 299.785240650177; train accuracy: 0.7169921875; test accuracy: 0.4539
2025-09-24 17:36:24 [INFO]  Epoch 27: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:07 [INFO]  Epoch 27 loss: 302.12792444229126; train accuracy: 0.749462890625; test accuracy: 0.5271
2025-09-24 17:37:07 [INFO]  Epoch 28: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:37:49 [INFO]  Epoch 28 loss: 301.4855909347534; train accuracy: 0.656689453125; test accuracy: 0.4158
2025-09-24 17:37:49 [INFO]  Epoch 29: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:38:31 [INFO]  Epoch 29 loss: 294.8910460472107; train accuracy: 0.717578125; test accuracy: 0.4626
2025-09-24 17:38:31 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 17:38:31 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 17:38:31 [INFO]  Round 5 Finish--------|
2025-09-24 17:38:31 [INFO]  Model variance: mean: 0.0033193703275173903, sum: 37090.484375
2025-09-24 17:38:31 [INFO]  g_protos_std: 1.006622314453125
2025-09-24 17:38:40 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7596
2025-09-24 17:38:40 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 17:38:40 [INFO]  Round 6 starts--------|
2025-09-24 17:38:40 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 17:38:40 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:39:43 [INFO]  Epoch 30 loss: 366.8825798034668; train accuracy: 0.8079737103174603; test accuracy: 0.6573
2025-09-24 17:39:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_30.pth
2025-09-24 17:39:44 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:40:50 [INFO]  Epoch 31 loss: 420.2001066207886; train accuracy: 0.8555927579365079; test accuracy: 0.7208
2025-09-24 17:40:50 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:41:54 [INFO]  Epoch 32 loss: 428.59111070632935; train accuracy: 0.7600446428571429; test accuracy: 0.6319
2025-09-24 17:41:54 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:43:01 [INFO]  Epoch 33 loss: 423.61510848999023; train accuracy: 0.8175843253968254; test accuracy: 0.6568
2025-09-24 17:43:01 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:44:08 [INFO]  Epoch 34 loss: 422.156813621521; train accuracy: 0.8446490575396826; test accuracy: 0.6973
2025-09-24 17:44:08 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 17:44:08 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 17:44:08 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 17:44:08 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:45:19 [INFO]  Epoch 30 loss: 386.08220958709717; train accuracy: 0.7984675480769231; test accuracy: 0.6455
2025-09-24 17:45:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_30.pth
2025-09-24 17:45:20 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:46:28 [INFO]  Epoch 31 loss: 458.69373178482056; train accuracy: 0.7548677884615385; test accuracy: 0.6617
2025-09-24 17:46:28 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:47:37 [INFO]  Epoch 32 loss: 455.04476022720337; train accuracy: 0.8071514423076923; test accuracy: 0.7017
2025-09-24 17:47:37 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:48:48 [INFO]  Epoch 33 loss: 453.64957904815674; train accuracy: 0.7975661057692308; test accuracy: 0.7052
2025-09-24 17:48:48 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:49:58 [INFO]  Epoch 34 loss: 451.92438888549805; train accuracy: 0.7787259615384615; test accuracy: 0.7102
2025-09-24 17:49:58 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 17:49:58 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 17:49:58 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 17:49:58 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:50:57 [INFO]  Epoch 30 loss: 326.3186922073364; train accuracy: 0.7440708705357143; test accuracy: 0.5965
2025-09-24 17:50:58 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_30.pth
2025-09-24 17:50:58 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:51:55 [INFO]  Epoch 31 loss: 385.3855881690979; train accuracy: 0.7734375; test accuracy: 0.605
2025-09-24 17:51:55 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:52:56 [INFO]  Epoch 32 loss: 383.6409559249878; train accuracy: 0.7473842075892857; test accuracy: 0.5556
2025-09-24 17:52:56 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:53:55 [INFO]  Epoch 33 loss: 387.26407623291016; train accuracy: 0.8128138950892857; test accuracy: 0.6051
2025-09-24 17:53:55 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:54:54 [INFO]  Epoch 34 loss: 383.6421756744385; train accuracy: 0.7852260044642857; test accuracy: 0.5988
2025-09-24 17:54:54 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 17:54:54 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 17:54:54 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 17:54:54 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:55:18 [INFO]  Epoch 30 loss: 126.54446840286255; train accuracy: 0.80068359375; test accuracy: 0.3599
2025-09-24 17:55:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_30.pth
2025-09-24 17:55:18 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:55:41 [INFO]  Epoch 31 loss: 147.23798608779907; train accuracy: 0.71240234375; test accuracy: 0.2588
2025-09-24 17:55:41 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:56:05 [INFO]  Epoch 32 loss: 146.49686813354492; train accuracy: 0.7794921875; test accuracy: 0.3242
2025-09-24 17:56:05 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:56:28 [INFO]  Epoch 33 loss: 149.9421362876892; train accuracy: 0.71728515625; test accuracy: 0.2639
2025-09-24 17:56:28 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:56:52 [INFO]  Epoch 34 loss: 147.532949924469; train accuracy: 0.730078125; test accuracy: 0.2736
2025-09-24 17:56:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 17:56:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 17:56:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 17:56:52 [INFO]  Epoch 30: Running in Stage 1 - Global Alignment Only.
2025-09-24 17:57:36 [INFO]  Epoch 30 loss: 247.84447383880615; train accuracy: 0.715283203125; test accuracy: 0.4248
2025-09-24 17:57:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_30.pth
2025-09-24 17:57:36 [INFO]  Epoch 31: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:58:20 [INFO]  Epoch 31 loss: 294.10164499282837; train accuracy: 0.722265625; test accuracy: 0.4751
2025-09-24 17:58:20 [INFO]  Epoch 32: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:03 [INFO]  Epoch 32 loss: 291.2257580757141; train accuracy: 0.794189453125; test accuracy: 0.5308
2025-09-24 17:59:03 [INFO]  Epoch 33: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 17:59:47 [INFO]  Epoch 33 loss: 289.34381914138794; train accuracy: 0.800390625; test accuracy: 0.5456
2025-09-24 17:59:47 [INFO]  Epoch 34: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:00:31 [INFO]  Epoch 34 loss: 302.3678674697876; train accuracy: 0.780078125; test accuracy: 0.5446
2025-09-24 18:00:31 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 18:00:31 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 18:00:31 [INFO]  Round 6 Finish--------|
2025-09-24 18:00:31 [INFO]  Model variance: mean: 0.0036030637566000223, sum: 40260.4609375
2025-09-24 18:00:31 [INFO]  g_protos_std: 1.0067178010940552
2025-09-24 18:00:39 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7685
2025-09-24 18:00:39 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 18:00:39 [INFO]  Round 7 starts--------|
2025-09-24 18:00:39 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 18:00:39 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:01:44 [INFO]  Epoch 35 loss: 358.399866104126; train accuracy: 0.8450830853174603; test accuracy: 0.6962
2025-09-24 18:01:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_35.pth
2025-09-24 18:01:45 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:02:50 [INFO]  Epoch 36 loss: 420.7340421676636; train accuracy: 0.8804253472222222; test accuracy: 0.7175
2025-09-24 18:02:50 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:03:59 [INFO]  Epoch 37 loss: 416.48319387435913; train accuracy: 0.8006262400793651; test accuracy: 0.651
2025-09-24 18:03:59 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:05:09 [INFO]  Epoch 38 loss: 413.21692276000977; train accuracy: 0.8399367559523809; test accuracy: 0.6808
2025-09-24 18:05:09 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:06:18 [INFO]  Epoch 39 loss: 412.341730594635; train accuracy: 0.806578621031746; test accuracy: 0.6547
2025-09-24 18:06:18 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 18:06:18 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 18:06:18 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 18:06:18 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:07:30 [INFO]  Epoch 35 loss: 378.76699781417847; train accuracy: 0.7824819711538461; test accuracy: 0.6653
2025-09-24 18:07:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_35.pth
2025-09-24 18:07:30 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:08:44 [INFO]  Epoch 36 loss: 450.41806077957153; train accuracy: 0.7315504807692308; test accuracy: 0.636
2025-09-24 18:08:44 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:09:54 [INFO]  Epoch 37 loss: 443.18522930145264; train accuracy: 0.7928185096153846; test accuracy: 0.7024
2025-09-24 18:09:54 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:11:08 [INFO]  Epoch 38 loss: 453.2965741157532; train accuracy: 0.790625; test accuracy: 0.6978
2025-09-24 18:11:08 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:12:19 [INFO]  Epoch 39 loss: 443.0808410644531; train accuracy: 0.8067908653846154; test accuracy: 0.7116
2025-09-24 18:12:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 18:12:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 18:12:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 18:12:19 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:13:21 [INFO]  Epoch 35 loss: 325.31224822998047; train accuracy: 0.8341587611607143; test accuracy: 0.6274
2025-09-24 18:13:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_35.pth
2025-09-24 18:13:21 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:14:23 [INFO]  Epoch 36 loss: 377.375967502594; train accuracy: 0.7876325334821429; test accuracy: 0.6144
2025-09-24 18:14:23 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:15:25 [INFO]  Epoch 37 loss: 380.07504987716675; train accuracy: 0.8083147321428571; test accuracy: 0.6177
2025-09-24 18:15:25 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:16:28 [INFO]  Epoch 38 loss: 382.55692958831787; train accuracy: 0.8032924107142857; test accuracy: 0.6156
2025-09-24 18:16:28 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:17:30 [INFO]  Epoch 39 loss: 373.64363956451416; train accuracy: 0.8224748883928571; test accuracy: 0.6314
2025-09-24 18:17:30 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 18:17:30 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 18:17:30 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 18:17:30 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:17:55 [INFO]  Epoch 35 loss: 126.81573295593262; train accuracy: 0.75341796875; test accuracy: 0.3063
2025-09-24 18:17:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_35.pth
2025-09-24 18:17:55 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:18:19 [INFO]  Epoch 36 loss: 149.57996606826782; train accuracy: 0.70771484375; test accuracy: 0.2682
2025-09-24 18:18:19 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:18:42 [INFO]  Epoch 37 loss: 147.65975952148438; train accuracy: 0.79775390625; test accuracy: 0.3291
2025-09-24 18:18:42 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:19:06 [INFO]  Epoch 38 loss: 149.62314701080322; train accuracy: 0.70048828125; test accuracy: 0.26
2025-09-24 18:19:06 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:19:30 [INFO]  Epoch 39 loss: 143.7245717048645; train accuracy: 0.733984375; test accuracy: 0.2757
2025-09-24 18:19:30 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 18:19:30 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 18:19:30 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 18:19:30 [INFO]  Epoch 35: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:20:16 [INFO]  Epoch 35 loss: 244.5650281906128; train accuracy: 0.810009765625; test accuracy: 0.5557
2025-09-24 18:20:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_35.pth
2025-09-24 18:20:16 [INFO]  Epoch 36: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:21:03 [INFO]  Epoch 36 loss: 287.15529012680054; train accuracy: 0.68779296875; test accuracy: 0.4712
2025-09-24 18:21:03 [INFO]  Epoch 37: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:21:47 [INFO]  Epoch 37 loss: 283.6296672821045; train accuracy: 0.799365234375; test accuracy: 0.5144
2025-09-24 18:21:47 [INFO]  Epoch 38: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:22:35 [INFO]  Epoch 38 loss: 286.17415857315063; train accuracy: 0.804296875; test accuracy: 0.5468
2025-09-24 18:22:35 [INFO]  Epoch 39: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:23:22 [INFO]  Epoch 39 loss: 290.7126154899597; train accuracy: 0.769921875; test accuracy: 0.518
2025-09-24 18:23:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 18:23:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 18:23:22 [INFO]  Round 7 Finish--------|
2025-09-24 18:23:22 [INFO]  Model variance: mean: 0.0038670385256409645, sum: 43210.1015625
2025-09-24 18:23:22 [INFO]  g_protos_std: 1.0068215131759644
2025-09-24 18:23:31 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7785
2025-09-24 18:23:31 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 18:23:31 [INFO]  Round 8 starts--------|
2025-09-24 18:23:31 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 18:23:31 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:24:42 [INFO]  Epoch 40 loss: 352.1314573287964; train accuracy: 0.8459821428571429; test accuracy: 0.7119
2025-09-24 18:24:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_40.pth
2025-09-24 18:24:42 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:25:56 [INFO]  Epoch 41 loss: 414.23654079437256; train accuracy: 0.8247147817460317; test accuracy: 0.6853
2025-09-24 18:25:56 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:27:09 [INFO]  Epoch 42 loss: 409.7776017189026; train accuracy: 0.8759300595238095; test accuracy: 0.733
2025-09-24 18:27:09 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:28:22 [INFO]  Epoch 43 loss: 407.04254627227783; train accuracy: 0.8598090277777778; test accuracy: 0.7269
2025-09-24 18:28:22 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:29:36 [INFO]  Epoch 44 loss: 410.84886360168457; train accuracy: 0.8910590277777778; test accuracy: 0.7473
2025-09-24 18:29:36 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 18:29:36 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 18:29:36 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 18:29:36 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:30:54 [INFO]  Epoch 40 loss: 373.6610713005066; train accuracy: 0.787890625; test accuracy: 0.718
2025-09-24 18:30:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_40.pth
2025-09-24 18:30:54 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:32:11 [INFO]  Epoch 41 loss: 445.5974745750427; train accuracy: 0.8077524038461539; test accuracy: 0.7046
2025-09-24 18:32:11 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:33:31 [INFO]  Epoch 42 loss: 443.5261015892029; train accuracy: 0.7915564903846154; test accuracy: 0.6969
2025-09-24 18:33:31 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:51:58 [INFO]  Epoch 43 loss: 440.3961787223816; train accuracy: 0.786298076923077; test accuracy: 0.7154
2025-09-24 18:51:58 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:53:15 [INFO]  Epoch 44 loss: 432.6880965232849; train accuracy: 0.832421875; test accuracy: 0.7475
2025-09-24 18:53:15 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 18:53:15 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 18:53:15 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 18:53:15 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:54:20 [INFO]  Epoch 40 loss: 318.07418155670166; train accuracy: 0.8383091517857143; test accuracy: 0.6376
2025-09-24 18:54:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_40.pth
2025-09-24 18:54:21 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:55:30 [INFO]  Epoch 41 loss: 377.9623980522156; train accuracy: 0.8259974888392857; test accuracy: 0.6325
2025-09-24 18:55:30 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:56:37 [INFO]  Epoch 42 loss: 373.55515336990356; train accuracy: 0.8115234375; test accuracy: 0.609
2025-09-24 18:56:37 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:57:44 [INFO]  Epoch 43 loss: 369.0098943710327; train accuracy: 0.7735072544642857; test accuracy: 0.5778
2025-09-24 18:57:44 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:58:52 [INFO]  Epoch 44 loss: 370.44957065582275; train accuracy: 0.7816685267857143; test accuracy: 0.5911
2025-09-24 18:58:52 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 18:58:52 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 18:58:52 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 18:58:52 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 18:59:20 [INFO]  Epoch 40 loss: 125.50628614425659; train accuracy: 0.735546875; test accuracy: 0.2724
2025-09-24 18:59:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_40.pth
2025-09-24 18:59:20 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 18:59:45 [INFO]  Epoch 41 loss: 143.73600244522095; train accuracy: 0.7423828125; test accuracy: 0.3033
2025-09-24 18:59:45 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:00:12 [INFO]  Epoch 42 loss: 143.1430606842041; train accuracy: 0.7052734375; test accuracy: 0.2679
2025-09-24 19:00:12 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:00:38 [INFO]  Epoch 43 loss: 144.8367919921875; train accuracy: 0.71943359375; test accuracy: 0.2875
2025-09-24 19:00:38 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:01:05 [INFO]  Epoch 44 loss: 142.53009843826294; train accuracy: 0.67041015625; test accuracy: 0.2637
2025-09-24 19:01:05 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:01:05 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:01:05 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:01:05 [INFO]  Epoch 40: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:01:53 [INFO]  Epoch 40 loss: 241.67403268814087; train accuracy: 0.8220703125; test accuracy: 0.5616
2025-09-24 19:01:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_40.pth
2025-09-24 19:01:53 [INFO]  Epoch 41: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:02:41 [INFO]  Epoch 41 loss: 279.47975873947144; train accuracy: 0.785302734375; test accuracy: 0.5449
2025-09-24 19:02:41 [INFO]  Epoch 42: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:03:27 [INFO]  Epoch 42 loss: 284.77016401290894; train accuracy: 0.851708984375; test accuracy: 0.6042
2025-09-24 19:03:27 [INFO]  Epoch 43: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:04:16 [INFO]  Epoch 43 loss: 277.10855531692505; train accuracy: 0.777099609375; test accuracy: 0.5484
2025-09-24 19:04:16 [INFO]  Epoch 44: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:05:04 [INFO]  Epoch 44 loss: 277.5966362953186; train accuracy: 0.801513671875; test accuracy: 0.57
2025-09-24 19:05:04 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:05:04 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:05:04 [INFO]  Round 8 Finish--------|
2025-09-24 19:05:04 [INFO]  Model variance: mean: 0.0041147926822304726, sum: 45978.49609375
2025-09-24 19:05:04 [INFO]  g_protos_std: 1.0069217681884766
2025-09-24 19:05:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8007
2025-09-24 19:05:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:05:14 [INFO]  Round 9 starts--------|
2025-09-24 19:05:14 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:05:14 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:06:28 [INFO]  Epoch 45 loss: 353.0429754257202; train accuracy: 0.8797123015873016; test accuracy: 0.7198
2025-09-24 19:06:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_45.pth
2025-09-24 19:06:29 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:07:43 [INFO]  Epoch 46 loss: 401.85615825653076; train accuracy: 0.8084077380952381; test accuracy: 0.6599
2025-09-24 19:07:43 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:08:57 [INFO]  Epoch 47 loss: 399.4371633529663; train accuracy: 0.8880828373015873; test accuracy: 0.7414
2025-09-24 19:08:57 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:10:13 [INFO]  Epoch 48 loss: 397.5577039718628; train accuracy: 0.8186073908730159; test accuracy: 0.6947
2025-09-24 19:10:13 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:11:26 [INFO]  Epoch 49 loss: 405.1178722381592; train accuracy: 0.8674665178571429; test accuracy: 0.7458
2025-09-24 19:11:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:11:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:11:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:11:26 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:12:42 [INFO]  Epoch 45 loss: 371.47870206832886; train accuracy: 0.8111177884615385; test accuracy: 0.7269
2025-09-24 19:12:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_45.pth
2025-09-24 19:12:43 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:14:00 [INFO]  Epoch 46 loss: 434.0418395996094; train accuracy: 0.834795673076923; test accuracy: 0.7159
2025-09-24 19:14:00 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:15:18 [INFO]  Epoch 47 loss: 439.25327157974243; train accuracy: 0.8030649038461538; test accuracy: 0.707
2025-09-24 19:15:18 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:16:33 [INFO]  Epoch 48 loss: 434.24851274490356; train accuracy: 0.7920673076923077; test accuracy: 0.7056
2025-09-24 19:16:33 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:17:50 [INFO]  Epoch 49 loss: 424.54806900024414; train accuracy: 0.8432391826923077; test accuracy: 0.7312
2025-09-24 19:17:50 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:17:50 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:17:50 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:17:50 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:18:56 [INFO]  Epoch 45 loss: 316.36772537231445; train accuracy: 0.8642926897321429; test accuracy: 0.6585
2025-09-24 19:18:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_45.pth
2025-09-24 19:18:56 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:20:03 [INFO]  Epoch 46 loss: 371.8355140686035; train accuracy: 0.8482840401785714; test accuracy: 0.645
2025-09-24 19:20:03 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:21:10 [INFO]  Epoch 47 loss: 365.32200050354004; train accuracy: 0.7976422991071429; test accuracy: 0.6052
2025-09-24 19:21:10 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:22:13 [INFO]  Epoch 48 loss: 360.6318416595459; train accuracy: 0.8350306919642857; test accuracy: 0.6362
2025-09-24 19:22:13 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:23:15 [INFO]  Epoch 49 loss: 371.6416096687317; train accuracy: 0.8172433035714286; test accuracy: 0.601
2025-09-24 19:23:15 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:23:15 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:23:15 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:23:15 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:23:38 [INFO]  Epoch 45 loss: 124.86200284957886; train accuracy: 0.75048828125; test accuracy: 0.2882
2025-09-24 19:23:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_45.pth
2025-09-24 19:23:39 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:24:03 [INFO]  Epoch 46 loss: 141.81241464614868; train accuracy: 0.80478515625; test accuracy: 0.3307
2025-09-24 19:24:03 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:24:28 [INFO]  Epoch 47 loss: 143.64616632461548; train accuracy: 0.71474609375; test accuracy: 0.2811
2025-09-24 19:24:28 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:24:52 [INFO]  Epoch 48 loss: 143.11685800552368; train accuracy: 0.76279296875; test accuracy: 0.308
2025-09-24 19:24:52 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:25:15 [INFO]  Epoch 49 loss: 140.1969656944275; train accuracy: 0.79560546875; test accuracy: 0.3406
2025-09-24 19:25:15 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:25:15 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:25:15 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:25:15 [INFO]  Epoch 45: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:26:02 [INFO]  Epoch 45 loss: 237.2721300125122; train accuracy: 0.78798828125; test accuracy: 0.5431
2025-09-24 19:26:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_45.pth
2025-09-24 19:26:02 [INFO]  Epoch 46: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:26:48 [INFO]  Epoch 46 loss: 283.87588357925415; train accuracy: 0.799853515625; test accuracy: 0.5471
2025-09-24 19:26:48 [INFO]  Epoch 47: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:27:33 [INFO]  Epoch 47 loss: 274.03520154953003; train accuracy: 0.767919921875; test accuracy: 0.5057
2025-09-24 19:27:33 [INFO]  Epoch 48: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:28:16 [INFO]  Epoch 48 loss: 273.76987409591675; train accuracy: 0.801513671875; test accuracy: 0.5627
2025-09-24 19:28:16 [INFO]  Epoch 49: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:29:01 [INFO]  Epoch 49 loss: 270.7243142127991; train accuracy: 0.787255859375; test accuracy: 0.5637
2025-09-24 19:29:01 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:29:01 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:29:01 [INFO]  Round 9 Finish--------|
2025-09-24 19:29:01 [INFO]  Model variance: mean: 0.004350272472947836, sum: 48609.734375
2025-09-24 19:29:01 [INFO]  g_protos_std: 1.007025122642517
2025-09-24 19:29:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8029
2025-09-24 19:29:10 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:29:10 [INFO]  Round 10 starts--------|
2025-09-24 19:29:10 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:29:10 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:30:20 [INFO]  Epoch 50 loss: 348.8824281692505; train accuracy: 0.8767051091269841; test accuracy: 0.7219
2025-09-24 19:30:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_50.pth
2025-09-24 19:30:20 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:31:29 [INFO]  Epoch 51 loss: 393.0937075614929; train accuracy: 0.8902529761904762; test accuracy: 0.7612
2025-09-24 19:31:29 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:32:36 [INFO]  Epoch 52 loss: 402.91992473602295; train accuracy: 0.8745969742063492; test accuracy: 0.7363
2025-09-24 19:32:36 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:33:42 [INFO]  Epoch 53 loss: 392.01878213882446; train accuracy: 0.912171378968254; test accuracy: 0.7698
2025-09-24 19:33:42 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:34:50 [INFO]  Epoch 54 loss: 391.3379764556885; train accuracy: 0.849609375; test accuracy: 0.7085
2025-09-24 19:34:50 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:34:50 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:34:50 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:34:50 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:35:56 [INFO]  Epoch 50 loss: 363.1286129951477; train accuracy: 0.8110276442307692; test accuracy: 0.7301
2025-09-24 19:35:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_50.pth
2025-09-24 19:35:57 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:37:10 [INFO]  Epoch 51 loss: 420.84366607666016; train accuracy: 0.8120793269230769; test accuracy: 0.732
2025-09-24 19:37:10 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:38:23 [INFO]  Epoch 52 loss: 438.2671160697937; train accuracy: 0.8303185096153847; test accuracy: 0.7509
2025-09-24 19:38:23 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:39:35 [INFO]  Epoch 53 loss: 423.23919916152954; train accuracy: 0.8202824519230769; test accuracy: 0.6915
2025-09-24 19:39:35 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:40:46 [INFO]  Epoch 54 loss: 421.4938950538635; train accuracy: 0.8317007211538462; test accuracy: 0.7243
2025-09-24 19:40:46 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 19:40:46 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 19:40:46 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 19:40:46 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:41:50 [INFO]  Epoch 50 loss: 313.1629490852356; train accuracy: 0.8748953683035714; test accuracy: 0.6629
2025-09-24 19:41:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_50.pth
2025-09-24 19:41:50 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:42:54 [INFO]  Epoch 51 loss: 358.24892711639404; train accuracy: 0.85888671875; test accuracy: 0.6467
2025-09-24 19:42:54 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:43:57 [INFO]  Epoch 52 loss: 369.85233545303345; train accuracy: 0.8184640066964286; test accuracy: 0.6026
2025-09-24 19:43:57 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:45:03 [INFO]  Epoch 53 loss: 350.23578214645386; train accuracy: 0.8226492745535714; test accuracy: 0.6166
2025-09-24 19:45:03 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:46:07 [INFO]  Epoch 54 loss: 365.08970499038696; train accuracy: 0.8007114955357143; test accuracy: 0.607
2025-09-24 19:46:07 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 19:46:07 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 19:46:07 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 19:46:07 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:46:30 [INFO]  Epoch 50 loss: 124.97146224975586; train accuracy: 0.666796875; test accuracy: 0.2361
2025-09-24 19:46:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_50.pth
2025-09-24 19:46:31 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:46:56 [INFO]  Epoch 51 loss: 141.44090843200684; train accuracy: 0.7849609375; test accuracy: 0.3397
2025-09-24 19:46:56 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:47:19 [INFO]  Epoch 52 loss: 144.33390378952026; train accuracy: 0.8205078125; test accuracy: 0.3539
2025-09-24 19:47:19 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:47:42 [INFO]  Epoch 53 loss: 140.22091341018677; train accuracy: 0.7712890625; test accuracy: 0.3043
2025-09-24 19:47:42 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:48:06 [INFO]  Epoch 54 loss: 140.12635707855225; train accuracy: 0.85048828125; test accuracy: 0.3974
2025-09-24 19:48:06 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 19:48:06 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 19:48:06 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 19:48:06 [INFO]  Epoch 50: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:48:53 [INFO]  Epoch 50 loss: 238.60633754730225; train accuracy: 0.749609375; test accuracy: 0.5026
2025-09-24 19:48:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_50.pth
2025-09-24 19:48:53 [INFO]  Epoch 51: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:49:41 [INFO]  Epoch 51 loss: 273.4029097557068; train accuracy: 0.812841796875; test accuracy: 0.5472
2025-09-24 19:49:41 [INFO]  Epoch 52: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:50:29 [INFO]  Epoch 52 loss: 271.98176431655884; train accuracy: 0.85986328125; test accuracy: 0.5885
2025-09-24 19:50:29 [INFO]  Epoch 53: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:51:15 [INFO]  Epoch 53 loss: 275.66771841049194; train accuracy: 0.836083984375; test accuracy: 0.5866
2025-09-24 19:51:15 [INFO]  Epoch 54: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:52:02 [INFO]  Epoch 54 loss: 274.0711507797241; train accuracy: 0.8646484375; test accuracy: 0.5838
2025-09-24 19:52:02 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 19:52:02 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 19:52:02 [INFO]  Round 10 Finish--------|
2025-09-24 19:52:02 [INFO]  Model variance: mean: 0.004572870675474405, sum: 51097.0390625
2025-09-24 19:52:02 [INFO]  g_protos_std: 1.0071220397949219
2025-09-24 19:52:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8287
2025-09-24 19:52:11 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 19:52:11 [INFO]  Round 11 starts--------|
2025-09-24 19:52:11 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 19:52:11 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:53:22 [INFO]  Epoch 55 loss: 343.57773065567017; train accuracy: 0.8959883432539683; test accuracy: 0.7419
2025-09-24 19:53:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_55.pth
2025-09-24 19:53:22 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:54:33 [INFO]  Epoch 56 loss: 393.50052642822266; train accuracy: 0.8882998511904762; test accuracy: 0.7582
2025-09-24 19:54:33 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:55:44 [INFO]  Epoch 57 loss: 392.1712636947632; train accuracy: 0.8705977182539683; test accuracy: 0.7501
2025-09-24 19:55:44 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:56:55 [INFO]  Epoch 58 loss: 388.64506483078003; train accuracy: 0.9095982142857143; test accuracy: 0.7782
2025-09-24 19:56:55 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 19:58:08 [INFO]  Epoch 59 loss: 383.13264751434326; train accuracy: 0.9035528273809523; test accuracy: 0.7766
2025-09-24 19:58:08 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 19:58:08 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 19:58:08 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 19:58:08 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 19:59:22 [INFO]  Epoch 55 loss: 370.6774830818176; train accuracy: 0.8262920673076923; test accuracy: 0.7301
2025-09-24 19:59:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_55.pth
2025-09-24 19:59:22 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:00:39 [INFO]  Epoch 56 loss: 421.4748978614807; train accuracy: 0.8235877403846154; test accuracy: 0.7072
2025-09-24 20:00:39 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:01:52 [INFO]  Epoch 57 loss: 422.6775574684143; train accuracy: 0.7837139423076923; test accuracy: 0.6634
2025-09-24 20:01:52 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:03:05 [INFO]  Epoch 58 loss: 423.9883642196655; train accuracy: 0.8460036057692307; test accuracy: 0.737
2025-09-24 20:03:05 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:04:17 [INFO]  Epoch 59 loss: 407.45988416671753; train accuracy: 0.8361177884615385; test accuracy: 0.7399
2025-09-24 20:04:17 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:04:17 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:04:17 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:04:17 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:05:24 [INFO]  Epoch 55 loss: 318.5962076187134; train accuracy: 0.8777204241071429; test accuracy: 0.6654
2025-09-24 20:05:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_55.pth
2025-09-24 20:05:24 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:06:27 [INFO]  Epoch 56 loss: 350.4650659561157; train accuracy: 0.834228515625; test accuracy: 0.6253
2025-09-24 20:06:27 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:07:32 [INFO]  Epoch 57 loss: 358.4772491455078; train accuracy: 0.8206263950892857; test accuracy: 0.6215
2025-09-24 20:07:32 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:08:35 [INFO]  Epoch 58 loss: 350.68777656555176; train accuracy: 0.8685477120535714; test accuracy: 0.649
2025-09-24 20:08:35 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:09:39 [INFO]  Epoch 59 loss: 356.49433183670044; train accuracy: 0.870849609375; test accuracy: 0.6636
2025-09-24 20:09:39 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:09:39 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:09:39 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:09:39 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:10:03 [INFO]  Epoch 55 loss: 122.75193119049072; train accuracy: 0.8224609375; test accuracy: 0.3363
2025-09-24 20:10:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_55.pth
2025-09-24 20:10:03 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:10:28 [INFO]  Epoch 56 loss: 137.03543090820312; train accuracy: 0.8265625; test accuracy: 0.3706
2025-09-24 20:10:28 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:10:53 [INFO]  Epoch 57 loss: 140.46437311172485; train accuracy: 0.84345703125; test accuracy: 0.3724
2025-09-24 20:10:53 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:11:18 [INFO]  Epoch 58 loss: 136.3838028907776; train accuracy: 0.73408203125; test accuracy: 0.3003
2025-09-24 20:11:18 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:11:43 [INFO]  Epoch 59 loss: 140.2956805229187; train accuracy: 0.86748046875; test accuracy: 0.3894
2025-09-24 20:11:43 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:11:43 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:11:43 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:11:43 [INFO]  Epoch 55: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:12:30 [INFO]  Epoch 55 loss: 236.0218949317932; train accuracy: 0.790234375; test accuracy: 0.5552
2025-09-24 20:12:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_55.pth
2025-09-24 20:12:30 [INFO]  Epoch 56: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:13:16 [INFO]  Epoch 56 loss: 273.34346294403076; train accuracy: 0.82392578125; test accuracy: 0.583
2025-09-24 20:13:16 [INFO]  Epoch 57: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:14:02 [INFO]  Epoch 57 loss: 262.43389987945557; train accuracy: 0.85498046875; test accuracy: 0.6006
2025-09-24 20:14:02 [INFO]  Epoch 58: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:14:47 [INFO]  Epoch 58 loss: 272.0021152496338; train accuracy: 0.86630859375; test accuracy: 0.6101
2025-09-24 20:14:47 [INFO]  Epoch 59: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:15:32 [INFO]  Epoch 59 loss: 272.1720128059387; train accuracy: 0.83984375; test accuracy: 0.5952
2025-09-24 20:15:32 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:15:32 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:15:32 [INFO]  Round 11 Finish--------|
2025-09-24 20:15:32 [INFO]  Model variance: mean: 0.004787088371813297, sum: 53490.6953125
2025-09-24 20:15:32 [INFO]  g_protos_std: 1.007232904434204
2025-09-24 20:15:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8244
2025-09-24 20:15:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:15:41 [INFO]  Round 12 starts--------|
2025-09-24 20:15:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:15:41 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:16:53 [INFO]  Epoch 60 loss: 344.2494478225708; train accuracy: 0.8656374007936508; test accuracy: 0.7141
2025-09-24 20:16:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_60.pth
2025-09-24 20:16:54 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:18:04 [INFO]  Epoch 61 loss: 387.27667713165283; train accuracy: 0.8850446428571429; test accuracy: 0.7212
2025-09-24 20:18:04 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:19:17 [INFO]  Epoch 62 loss: 388.495973110199; train accuracy: 0.8899739583333334; test accuracy: 0.7393
2025-09-24 20:19:17 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:20:30 [INFO]  Epoch 63 loss: 387.59234714508057; train accuracy: 0.8635602678571429; test accuracy: 0.73
2025-09-24 20:20:30 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:21:41 [INFO]  Epoch 64 loss: 376.4782214164734; train accuracy: 0.8777901785714286; test accuracy: 0.7096
2025-09-24 20:21:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:21:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:21:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:21:41 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:22:55 [INFO]  Epoch 60 loss: 365.4948091506958; train accuracy: 0.8474759615384615; test accuracy: 0.7384
2025-09-24 20:22:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_60.pth
2025-09-24 20:22:56 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:24:09 [INFO]  Epoch 61 loss: 421.3537964820862; train accuracy: 0.8010216346153847; test accuracy: 0.7011
2025-09-24 20:24:09 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:25:23 [INFO]  Epoch 62 loss: 407.6223711967468; train accuracy: 0.8626802884615384; test accuracy: 0.7677
2025-09-24 20:25:23 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:26:36 [INFO]  Epoch 63 loss: 413.0912914276123; train accuracy: 0.8177584134615384; test accuracy: 0.7156
2025-09-24 20:26:36 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:27:48 [INFO]  Epoch 64 loss: 405.1198925971985; train accuracy: 0.8569411057692308; test accuracy: 0.7572
2025-09-24 20:27:48 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:27:48 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:27:48 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:27:48 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:28:52 [INFO]  Epoch 60 loss: 313.73318243026733; train accuracy: 0.882568359375; test accuracy: 0.6611
2025-09-24 20:28:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_60.pth
2025-09-24 20:28:52 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:29:54 [INFO]  Epoch 61 loss: 349.76929473876953; train accuracy: 0.8900669642857143; test accuracy: 0.6545
2025-09-24 20:29:54 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:30:58 [INFO]  Epoch 62 loss: 348.089647769928; train accuracy: 0.8130929129464286; test accuracy: 0.6299
2025-09-24 20:30:58 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:32:03 [INFO]  Epoch 63 loss: 353.15864658355713; train accuracy: 0.8213239397321429; test accuracy: 0.6009
2025-09-24 20:32:03 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:33:06 [INFO]  Epoch 64 loss: 356.3560528755188; train accuracy: 0.8648158482142857; test accuracy: 0.6401
2025-09-24 20:33:06 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:33:06 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:33:06 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:33:06 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:33:30 [INFO]  Epoch 60 loss: 122.04737567901611; train accuracy: 0.78603515625; test accuracy: 0.3119
2025-09-24 20:33:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_60.pth
2025-09-24 20:33:30 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:33:55 [INFO]  Epoch 61 loss: 138.63676357269287; train accuracy: 0.79248046875; test accuracy: 0.3509
2025-09-24 20:33:55 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:34:19 [INFO]  Epoch 62 loss: 137.71444368362427; train accuracy: 0.82578125; test accuracy: 0.3694
2025-09-24 20:34:19 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:34:44 [INFO]  Epoch 63 loss: 136.960946559906; train accuracy: 0.7591796875; test accuracy: 0.3246
2025-09-24 20:34:44 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:35:10 [INFO]  Epoch 64 loss: 139.76602220535278; train accuracy: 0.80703125; test accuracy: 0.3477
2025-09-24 20:35:10 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:35:10 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:35:10 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:35:10 [INFO]  Epoch 60: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:35:54 [INFO]  Epoch 60 loss: 234.22441959381104; train accuracy: 0.816845703125; test accuracy: 0.5752
2025-09-24 20:35:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_60.pth
2025-09-24 20:35:55 [INFO]  Epoch 61: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:36:43 [INFO]  Epoch 61 loss: 263.7308464050293; train accuracy: 0.798291015625; test accuracy: 0.5609
2025-09-24 20:36:43 [INFO]  Epoch 62: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:37:29 [INFO]  Epoch 62 loss: 265.0489068031311; train accuracy: 0.826416015625; test accuracy: 0.6195
2025-09-24 20:37:29 [INFO]  Epoch 63: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:38:15 [INFO]  Epoch 63 loss: 272.0052046775818; train accuracy: 0.825634765625; test accuracy: 0.5816
2025-09-24 20:38:15 [INFO]  Epoch 64: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:39:00 [INFO]  Epoch 64 loss: 272.8377676010132; train accuracy: 0.808154296875; test accuracy: 0.599
2025-09-24 20:39:00 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 20:39:00 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 20:39:00 [INFO]  Round 12 Finish--------|
2025-09-24 20:39:00 [INFO]  Model variance: mean: 0.004992049653083086, sum: 55780.921875
2025-09-24 20:39:00 [INFO]  g_protos_std: 1.0073379278182983
2025-09-24 20:39:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8315
2025-09-24 20:39:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 20:39:09 [INFO]  Round 13 starts--------|
2025-09-24 20:39:09 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 20:39:09 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:40:21 [INFO]  Epoch 65 loss: 340.60552406311035; train accuracy: 0.8732018849206349; test accuracy: 0.7036
2025-09-24 20:40:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_65.pth
2025-09-24 20:40:21 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:41:32 [INFO]  Epoch 66 loss: 385.35612440109253; train accuracy: 0.9069630456349206; test accuracy: 0.7648
2025-09-24 20:41:32 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:42:43 [INFO]  Epoch 67 loss: 380.7604122161865; train accuracy: 0.8694816468253969; test accuracy: 0.7118
2025-09-24 20:42:43 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:43:52 [INFO]  Epoch 68 loss: 375.55886125564575; train accuracy: 0.8736979166666666; test accuracy: 0.7266
2025-09-24 20:43:52 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:45:01 [INFO]  Epoch 69 loss: 382.8997941017151; train accuracy: 0.9124813988095238; test accuracy: 0.7635
2025-09-24 20:45:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 20:45:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 20:45:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 20:45:01 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:46:12 [INFO]  Epoch 65 loss: 361.51627588272095; train accuracy: 0.8929987980769231; test accuracy: 0.7831
2025-09-24 20:46:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_65.pth
2025-09-24 20:46:12 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:47:20 [INFO]  Epoch 66 loss: 412.3392643928528; train accuracy: 0.8420673076923076; test accuracy: 0.7714
2025-09-24 20:47:20 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:48:31 [INFO]  Epoch 67 loss: 400.0194525718689; train accuracy: 0.834375; test accuracy: 0.7462
2025-09-24 20:48:31 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:49:41 [INFO]  Epoch 68 loss: 408.86744022369385; train accuracy: 0.8264723557692307; test accuracy: 0.7473
2025-09-24 20:49:41 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:50:51 [INFO]  Epoch 69 loss: 406.36732816696167; train accuracy: 0.8554987980769231; test accuracy: 0.7575
2025-09-24 20:50:51 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 20:50:51 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 20:50:51 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 20:50:51 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:51:51 [INFO]  Epoch 65 loss: 308.719464302063; train accuracy: 0.8935546875; test accuracy: 0.6731
2025-09-24 20:51:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_65.pth
2025-09-24 20:51:52 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:52:53 [INFO]  Epoch 66 loss: 353.3530707359314; train accuracy: 0.8679547991071429; test accuracy: 0.644
2025-09-24 20:52:53 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:53:52 [INFO]  Epoch 67 loss: 358.2262177467346; train accuracy: 0.8844517299107143; test accuracy: 0.6554
2025-09-24 20:53:52 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:54:54 [INFO]  Epoch 68 loss: 354.1092495918274; train accuracy: 0.8769880022321429; test accuracy: 0.6684
2025-09-24 20:54:54 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:55:55 [INFO]  Epoch 69 loss: 342.15518379211426; train accuracy: 0.8651994977678571; test accuracy: 0.6393
2025-09-24 20:55:55 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 20:55:55 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 20:55:55 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 20:55:55 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:56:19 [INFO]  Epoch 65 loss: 122.98831176757812; train accuracy: 0.7916015625; test accuracy: 0.3503
2025-09-24 20:56:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_65.pth
2025-09-24 20:56:19 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:56:43 [INFO]  Epoch 66 loss: 136.93629503250122; train accuracy: 0.85537109375; test accuracy: 0.3731
2025-09-24 20:56:43 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:07 [INFO]  Epoch 67 loss: 135.39216566085815; train accuracy: 0.812890625; test accuracy: 0.3441
2025-09-24 20:57:07 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:30 [INFO]  Epoch 68 loss: 138.16797304153442; train accuracy: 0.8271484375; test accuracy: 0.3778
2025-09-24 20:57:30 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:57:54 [INFO]  Epoch 69 loss: 138.28356742858887; train accuracy: 0.80341796875; test accuracy: 0.3448
2025-09-24 20:57:54 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 20:57:54 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 20:57:54 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 20:57:54 [INFO]  Epoch 65: Running in Stage 1 - Global Alignment Only.
2025-09-24 20:58:39 [INFO]  Epoch 65 loss: 233.0771360397339; train accuracy: 0.881005859375; test accuracy: 0.6263
2025-09-24 20:58:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_65.pth
2025-09-24 20:58:40 [INFO]  Epoch 66: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 20:59:23 [INFO]  Epoch 66 loss: 266.6312851905823; train accuracy: 0.86708984375; test accuracy: 0.6135
2025-09-24 20:59:23 [INFO]  Epoch 67: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:00:07 [INFO]  Epoch 67 loss: 262.3489508628845; train accuracy: 0.83759765625; test accuracy: 0.6168
2025-09-24 21:00:07 [INFO]  Epoch 68: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:00:53 [INFO]  Epoch 68 loss: 268.63769912719727; train accuracy: 0.76982421875; test accuracy: 0.5245
2025-09-24 21:00:53 [INFO]  Epoch 69: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:01:37 [INFO]  Epoch 69 loss: 262.9941420555115; train accuracy: 0.79189453125; test accuracy: 0.5473
2025-09-24 21:01:37 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:01:37 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:01:37 [INFO]  Round 13 Finish--------|
2025-09-24 21:01:37 [INFO]  Model variance: mean: 0.00519045814871788, sum: 57997.9296875
2025-09-24 21:01:37 [INFO]  g_protos_std: 1.0074480772018433
2025-09-24 21:01:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8361
2025-09-24 21:01:46 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:01:46 [INFO]  Round 14 starts--------|
2025-09-24 21:01:46 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:01:46 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:02:57 [INFO]  Epoch 70 loss: 338.32639026641846; train accuracy: 0.9005456349206349; test accuracy: 0.7475
2025-09-24 21:02:58 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_70.pth
2025-09-24 21:02:58 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:04:06 [INFO]  Epoch 71 loss: 386.1756134033203; train accuracy: 0.9090091765873016; test accuracy: 0.7311
2025-09-24 21:04:06 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:05:17 [INFO]  Epoch 72 loss: 385.40722846984863; train accuracy: 0.9070250496031746; test accuracy: 0.76
2025-09-24 21:05:17 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:06:29 [INFO]  Epoch 73 loss: 379.8602304458618; train accuracy: 0.9171316964285714; test accuracy: 0.8039
2025-09-24 21:06:29 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:07:41 [INFO]  Epoch 74 loss: 385.1786689758301; train accuracy: 0.9286954365079365; test accuracy: 0.7936
2025-09-24 21:07:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:07:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:07:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:07:41 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:08:52 [INFO]  Epoch 70 loss: 360.9457206726074; train accuracy: 0.8769230769230769; test accuracy: 0.7672
2025-09-24 21:08:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_70.pth
2025-09-24 21:08:52 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:10:05 [INFO]  Epoch 71 loss: 406.8644857406616; train accuracy: 0.8744891826923077; test accuracy: 0.7586
2025-09-24 21:10:05 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:11:17 [INFO]  Epoch 72 loss: 412.9513511657715; train accuracy: 0.8405348557692308; test accuracy: 0.7312
2025-09-24 21:11:17 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:12:30 [INFO]  Epoch 73 loss: 403.1322412490845; train accuracy: 0.874609375; test accuracy: 0.7482
2025-09-24 21:12:30 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:13:43 [INFO]  Epoch 74 loss: 406.62177181243896; train accuracy: 0.8693509615384616; test accuracy: 0.7517
2025-09-24 21:13:43 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:13:43 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:13:43 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:13:43 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:14:47 [INFO]  Epoch 70 loss: 307.5441756248474; train accuracy: 0.8583635602678571; test accuracy: 0.6499
2025-09-24 21:14:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_70.pth
2025-09-24 21:14:48 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:15:52 [INFO]  Epoch 71 loss: 341.32517290115356; train accuracy: 0.8887765066964286; test accuracy: 0.6592
2025-09-24 21:15:52 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:16:58 [INFO]  Epoch 72 loss: 348.60011053085327; train accuracy: 0.8785574776785714; test accuracy: 0.6625
2025-09-24 21:16:58 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:18:00 [INFO]  Epoch 73 loss: 345.4597268104553; train accuracy: 0.7918875558035714; test accuracy: 0.6022
2025-09-24 21:18:00 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:19:04 [INFO]  Epoch 74 loss: 341.2615704536438; train accuracy: 0.9056919642857143; test accuracy: 0.6825
2025-09-24 21:19:04 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:19:04 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:19:04 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:19:04 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:19:28 [INFO]  Epoch 70 loss: 120.9055495262146; train accuracy: 0.815234375; test accuracy: 0.368
2025-09-24 21:19:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_70.pth
2025-09-24 21:19:29 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:19:53 [INFO]  Epoch 71 loss: 128.89051914215088; train accuracy: 0.87861328125; test accuracy: 0.4004
2025-09-24 21:19:53 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:20:18 [INFO]  Epoch 72 loss: 135.58407640457153; train accuracy: 0.87685546875; test accuracy: 0.4197
2025-09-24 21:20:18 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:20:43 [INFO]  Epoch 73 loss: 131.9460105895996; train accuracy: 0.73076171875; test accuracy: 0.3076
2025-09-24 21:20:43 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:21:09 [INFO]  Epoch 74 loss: 135.27972030639648; train accuracy: 0.81357421875; test accuracy: 0.3682
2025-09-24 21:21:09 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:21:09 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:21:09 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:21:09 [INFO]  Epoch 70: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:21:56 [INFO]  Epoch 70 loss: 231.23423433303833; train accuracy: 0.8615234375; test accuracy: 0.5967
2025-09-24 21:21:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_70.pth
2025-09-24 21:21:57 [INFO]  Epoch 71: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:22:42 [INFO]  Epoch 71 loss: 261.4284510612488; train accuracy: 0.887646484375; test accuracy: 0.5906
2025-09-24 21:22:42 [INFO]  Epoch 72: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:23:29 [INFO]  Epoch 72 loss: 263.4181146621704; train accuracy: 0.84306640625; test accuracy: 0.6116
2025-09-24 21:23:29 [INFO]  Epoch 73: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:24:15 [INFO]  Epoch 73 loss: 260.2186985015869; train accuracy: 0.879443359375; test accuracy: 0.6106
2025-09-24 21:24:15 [INFO]  Epoch 74: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:25:01 [INFO]  Epoch 74 loss: 257.48506593704224; train accuracy: 0.894287109375; test accuracy: 0.6111
2025-09-24 21:25:01 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:25:01 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:25:01 [INFO]  Round 14 Finish--------|
2025-09-24 21:25:01 [INFO]  Model variance: mean: 0.005382960196584463, sum: 60148.9375
2025-09-24 21:25:01 [INFO]  g_protos_std: 1.0075534582138062
2025-09-24 21:25:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8399
2025-09-24 21:25:10 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:25:10 [INFO]  Round 15 starts--------|
2025-09-24 21:25:10 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:25:10 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:26:19 [INFO]  Epoch 75 loss: 340.96447944641113; train accuracy: 0.910125248015873; test accuracy: 0.7496
2025-09-24 21:26:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_75.pth
2025-09-24 21:26:20 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:27:30 [INFO]  Epoch 76 loss: 373.02431201934814; train accuracy: 0.9260912698412699; test accuracy: 0.8102
2025-09-24 21:27:30 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:28:37 [INFO]  Epoch 77 loss: 377.9161534309387; train accuracy: 0.8901289682539683; test accuracy: 0.7192
2025-09-24 21:28:37 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:29:47 [INFO]  Epoch 78 loss: 372.36798906326294; train accuracy: 0.9248511904761905; test accuracy: 0.7593
2025-09-24 21:29:47 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:30:59 [INFO]  Epoch 79 loss: 376.9870653152466; train accuracy: 0.898468501984127; test accuracy: 0.7684
2025-09-24 21:30:59 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:30:59 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:30:59 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:30:59 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:32:11 [INFO]  Epoch 75 loss: 357.5081729888916; train accuracy: 0.8624098557692308; test accuracy: 0.7641
2025-09-24 21:32:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_75.pth
2025-09-24 21:32:12 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:33:26 [INFO]  Epoch 76 loss: 406.21552562713623; train accuracy: 0.8323317307692307; test accuracy: 0.7293
2025-09-24 21:33:26 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:34:39 [INFO]  Epoch 77 loss: 411.5530638694763; train accuracy: 0.8831430288461538; test accuracy: 0.7753
2025-09-24 21:34:39 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:35:52 [INFO]  Epoch 78 loss: 396.3272337913513; train accuracy: 0.8982872596153846; test accuracy: 0.7666
2025-09-24 21:35:52 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:37:05 [INFO]  Epoch 79 loss: 403.39499616622925; train accuracy: 0.8927884615384616; test accuracy: 0.7745
2025-09-24 21:37:05 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 21:37:05 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 21:37:05 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 21:37:05 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:38:10 [INFO]  Epoch 75 loss: 306.8465042114258; train accuracy: 0.8484933035714286; test accuracy: 0.6462
2025-09-24 21:38:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_75.pth
2025-09-24 21:38:10 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:39:13 [INFO]  Epoch 76 loss: 334.7513065338135; train accuracy: 0.8968331473214286; test accuracy: 0.6836
2025-09-24 21:39:13 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:40:15 [INFO]  Epoch 77 loss: 329.42754316329956; train accuracy: 0.8506905691964286; test accuracy: 0.6407
2025-09-24 21:40:15 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:41:19 [INFO]  Epoch 78 loss: 338.92900800704956; train accuracy: 0.899169921875; test accuracy: 0.67
2025-09-24 21:41:19 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:42:21 [INFO]  Epoch 79 loss: 331.0197229385376; train accuracy: 0.89111328125; test accuracy: 0.671
2025-09-24 21:42:21 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 21:42:21 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 21:42:21 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 21:42:21 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:42:45 [INFO]  Epoch 75 loss: 121.4476752281189; train accuracy: 0.8380859375; test accuracy: 0.3654
2025-09-24 21:42:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_75.pth
2025-09-24 21:42:46 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:43:11 [INFO]  Epoch 76 loss: 128.14288902282715; train accuracy: 0.82724609375; test accuracy: 0.3451
2025-09-24 21:43:11 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:43:36 [INFO]  Epoch 77 loss: 133.38465023040771; train accuracy: 0.86962890625; test accuracy: 0.4144
2025-09-24 21:43:36 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:44:02 [INFO]  Epoch 78 loss: 133.77652549743652; train accuracy: 0.81513671875; test accuracy: 0.3449
2025-09-24 21:44:02 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:44:28 [INFO]  Epoch 79 loss: 135.89320278167725; train accuracy: 0.76162109375; test accuracy: 0.2866
2025-09-24 21:44:28 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 21:44:28 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 21:44:28 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 21:44:28 [INFO]  Epoch 75: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:45:14 [INFO]  Epoch 75 loss: 229.8468794822693; train accuracy: 0.83251953125; test accuracy: 0.5663
2025-09-24 21:45:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_75.pth
2025-09-24 21:45:16 [INFO]  Epoch 76: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:46:01 [INFO]  Epoch 76 loss: 258.44020652770996; train accuracy: 0.83974609375; test accuracy: 0.5796
2025-09-24 21:46:01 [INFO]  Epoch 77: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:46:49 [INFO]  Epoch 77 loss: 253.90653705596924; train accuracy: 0.8625; test accuracy: 0.6321
2025-09-24 21:46:49 [INFO]  Epoch 78: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:47:34 [INFO]  Epoch 78 loss: 255.47350549697876; train accuracy: 0.846044921875; test accuracy: 0.5741
2025-09-24 21:47:34 [INFO]  Epoch 79: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:48:20 [INFO]  Epoch 79 loss: 252.4915747642517; train accuracy: 0.87763671875; test accuracy: 0.5795
2025-09-24 21:48:20 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 21:48:20 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 21:48:20 [INFO]  Round 15 Finish--------|
2025-09-24 21:48:20 [INFO]  Model variance: mean: 0.005567620508372784, sum: 62212.32421875
2025-09-24 21:48:20 [INFO]  g_protos_std: 1.0076724290847778
2025-09-24 21:48:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8372
2025-09-24 21:48:29 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 21:48:29 [INFO]  Round 16 starts--------|
2025-09-24 21:48:29 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 21:48:29 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:49:39 [INFO]  Epoch 80 loss: 333.98339319229126; train accuracy: 0.9284784226190477; test accuracy: 0.7883
2025-09-24 21:49:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_80.pth
2025-09-24 21:49:40 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:50:49 [INFO]  Epoch 81 loss: 380.8011884689331; train accuracy: 0.9217199900793651; test accuracy: 0.7856
2025-09-24 21:50:49 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:52:00 [INFO]  Epoch 82 loss: 383.19039583206177; train accuracy: 0.9197668650793651; test accuracy: 0.7803
2025-09-24 21:52:00 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:53:09 [INFO]  Epoch 83 loss: 378.71085834503174; train accuracy: 0.9376860119047619; test accuracy: 0.7819
2025-09-24 21:53:09 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:54:19 [INFO]  Epoch 84 loss: 377.0764265060425; train accuracy: 0.9080791170634921; test accuracy: 0.7568
2025-09-24 21:54:19 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 21:54:19 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 21:54:19 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 21:54:19 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 21:55:34 [INFO]  Epoch 80 loss: 355.7198739051819; train accuracy: 0.9118389423076924; test accuracy: 0.7934
2025-09-24 21:55:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_80.pth
2025-09-24 21:55:35 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:56:48 [INFO]  Epoch 81 loss: 402.9443769454956; train accuracy: 0.8922175480769231; test accuracy: 0.7449
2025-09-24 21:56:48 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:57:59 [INFO]  Epoch 82 loss: 397.8108129501343; train accuracy: 0.8780048076923077; test accuracy: 0.737
2025-09-24 21:57:59 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 21:59:11 [INFO]  Epoch 83 loss: 401.2250347137451; train accuracy: 0.8922475961538462; test accuracy: 0.7895
2025-09-24 21:59:11 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:00:24 [INFO]  Epoch 84 loss: 393.9304575920105; train accuracy: 0.8760817307692308; test accuracy: 0.7849
2025-09-24 22:00:24 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:00:24 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:00:24 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:00:24 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:01:25 [INFO]  Epoch 80 loss: 306.84185695648193; train accuracy: 0.8763253348214286; test accuracy: 0.6619
2025-09-24 22:01:26 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_80.pth
2025-09-24 22:01:26 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:02:29 [INFO]  Epoch 81 loss: 344.09272813796997; train accuracy: 0.8617466517857143; test accuracy: 0.6467
2025-09-24 22:02:29 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:03:32 [INFO]  Epoch 82 loss: 349.9981679916382; train accuracy: 0.9217703683035714; test accuracy: 0.6845
2025-09-24 22:03:32 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:04:35 [INFO]  Epoch 83 loss: 341.76966667175293; train accuracy: 0.8969029017857143; test accuracy: 0.6716
2025-09-24 22:04:35 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:05:38 [INFO]  Epoch 84 loss: 338.2827353477478; train accuracy: 0.8993791852678571; test accuracy: 0.6806
2025-09-24 22:05:38 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:05:38 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:05:38 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:05:38 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:06:02 [INFO]  Epoch 80 loss: 120.89102458953857; train accuracy: 0.7986328125; test accuracy: 0.3313
2025-09-24 22:06:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_80.pth
2025-09-24 22:06:03 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:06:27 [INFO]  Epoch 81 loss: 133.48428916931152; train accuracy: 0.86201171875; test accuracy: 0.4155
2025-09-24 22:06:27 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:06:51 [INFO]  Epoch 82 loss: 132.33428144454956; train accuracy: 0.81083984375; test accuracy: 0.337
2025-09-24 22:06:51 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:07:15 [INFO]  Epoch 83 loss: 132.96753025054932; train accuracy: 0.8189453125; test accuracy: 0.3461
2025-09-24 22:07:15 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:07:39 [INFO]  Epoch 84 loss: 133.45115041732788; train accuracy: 0.87646484375; test accuracy: 0.3978
2025-09-24 22:07:39 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:07:39 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:07:39 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:07:39 [INFO]  Epoch 80: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:08:25 [INFO]  Epoch 80 loss: 228.2759280204773; train accuracy: 0.8541015625; test accuracy: 0.599
2025-09-24 22:08:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_80.pth
2025-09-24 22:08:25 [INFO]  Epoch 81: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:11 [INFO]  Epoch 81 loss: 256.24314880371094; train accuracy: 0.871240234375; test accuracy: 0.6243
2025-09-24 22:09:11 [INFO]  Epoch 82: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:09:56 [INFO]  Epoch 82 loss: 260.9865736961365; train accuracy: 0.864990234375; test accuracy: 0.61
2025-09-24 22:09:56 [INFO]  Epoch 83: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:10:43 [INFO]  Epoch 83 loss: 250.33770942687988; train accuracy: 0.819970703125; test accuracy: 0.5994
2025-09-24 22:10:43 [INFO]  Epoch 84: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:11:30 [INFO]  Epoch 84 loss: 251.35260581970215; train accuracy: 0.871240234375; test accuracy: 0.5903
2025-09-24 22:11:30 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:11:30 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:11:30 [INFO]  Round 16 Finish--------|
2025-09-24 22:11:30 [INFO]  Model variance: mean: 0.005747649352997541, sum: 64223.95703125
2025-09-24 22:11:30 [INFO]  g_protos_std: 1.0077756643295288
2025-09-24 22:11:39 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8542
2025-09-24 22:11:39 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:11:39 [INFO]  Round 17 starts--------|
2025-09-24 22:11:39 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:11:39 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:12:50 [INFO]  Epoch 85 loss: 332.3779845237732; train accuracy: 0.9034598214285714; test accuracy: 0.7239
2025-09-24 22:12:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_85.pth
2025-09-24 22:12:50 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:13:59 [INFO]  Epoch 86 loss: 373.9732060432434; train accuracy: 0.9045138888888888; test accuracy: 0.7438
2025-09-24 22:13:59 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:15:10 [INFO]  Epoch 87 loss: 367.33101177215576; train accuracy: 0.9247581845238095; test accuracy: 0.7647
2025-09-24 22:15:10 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:16:22 [INFO]  Epoch 88 loss: 371.3859848976135; train accuracy: 0.9052269345238095; test accuracy: 0.7447
2025-09-24 22:16:22 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:17:32 [INFO]  Epoch 89 loss: 371.97950649261475; train accuracy: 0.8984375; test accuracy: 0.7364
2025-09-24 22:17:32 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:17:32 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:17:32 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:17:32 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:18:43 [INFO]  Epoch 85 loss: 351.8064036369324; train accuracy: 0.905108173076923; test accuracy: 0.7881
2025-09-24 22:18:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_85.pth
2025-09-24 22:18:44 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:19:55 [INFO]  Epoch 86 loss: 389.0376124382019; train accuracy: 0.8832632211538461; test accuracy: 0.7597
2025-09-24 22:19:55 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:21:09 [INFO]  Epoch 87 loss: 399.2552490234375; train accuracy: 0.8718149038461539; test accuracy: 0.7586
2025-09-24 22:21:09 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:22:19 [INFO]  Epoch 88 loss: 389.32301568984985; train accuracy: 0.9097956730769231; test accuracy: 0.7744
2025-09-24 22:22:19 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:23:31 [INFO]  Epoch 89 loss: 386.8095016479492; train accuracy: 0.8820612980769231; test accuracy: 0.7741
2025-09-24 22:23:31 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:23:31 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:23:31 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:23:31 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:24:34 [INFO]  Epoch 85 loss: 306.3194360733032; train accuracy: 0.9070172991071429; test accuracy: 0.6866
2025-09-24 22:24:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_85.pth
2025-09-24 22:24:34 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:25:37 [INFO]  Epoch 86 loss: 338.86129426956177; train accuracy: 0.890625; test accuracy: 0.6556
2025-09-24 22:25:37 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:26:42 [INFO]  Epoch 87 loss: 327.72699308395386; train accuracy: 0.9122488839285714; test accuracy: 0.6976
2025-09-24 22:26:42 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:27:45 [INFO]  Epoch 88 loss: 332.622447013855; train accuracy: 0.9081333705357143; test accuracy: 0.6715
2025-09-24 22:27:45 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:28:46 [INFO]  Epoch 89 loss: 329.62003660202026; train accuracy: 0.8486328125; test accuracy: 0.6449
2025-09-24 22:28:46 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:28:46 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:28:46 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:28:46 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:29:10 [INFO]  Epoch 85 loss: 118.97018575668335; train accuracy: 0.81923828125; test accuracy: 0.3346
2025-09-24 22:29:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_85.pth
2025-09-24 22:29:10 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:29:33 [INFO]  Epoch 86 loss: 128.9105191230774; train accuracy: 0.86943359375; test accuracy: 0.3739
2025-09-24 22:29:33 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:29:57 [INFO]  Epoch 87 loss: 131.62636947631836; train accuracy: 0.86357421875; test accuracy: 0.3704
2025-09-24 22:29:57 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:30:21 [INFO]  Epoch 88 loss: 135.5896439552307; train accuracy: 0.87861328125; test accuracy: 0.4343
2025-09-24 22:30:21 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:30:45 [INFO]  Epoch 89 loss: 130.4198865890503; train accuracy: 0.87294921875; test accuracy: 0.4004
2025-09-24 22:30:45 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:30:45 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:30:45 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:30:45 [INFO]  Epoch 85: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:31:30 [INFO]  Epoch 85 loss: 228.82788562774658; train accuracy: 0.881103515625; test accuracy: 0.6092
2025-09-24 22:31:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_85.pth
2025-09-24 22:31:31 [INFO]  Epoch 86: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:32:15 [INFO]  Epoch 86 loss: 251.36298036575317; train accuracy: 0.885888671875; test accuracy: 0.6187
2025-09-24 22:32:15 [INFO]  Epoch 87: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:33:01 [INFO]  Epoch 87 loss: 256.76078271865845; train accuracy: 0.86767578125; test accuracy: 0.5703
2025-09-24 22:33:01 [INFO]  Epoch 88: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:33:44 [INFO]  Epoch 88 loss: 249.9233570098877; train accuracy: 0.83310546875; test accuracy: 0.597
2025-09-24 22:33:44 [INFO]  Epoch 89: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:34:28 [INFO]  Epoch 89 loss: 258.9712338447571; train accuracy: 0.91455078125; test accuracy: 0.6344
2025-09-24 22:34:28 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:34:28 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:34:28 [INFO]  Round 17 Finish--------|
2025-09-24 22:34:28 [INFO]  Model variance: mean: 0.005921273957937956, sum: 66164.03125
2025-09-24 22:34:28 [INFO]  g_protos_std: 1.00789475440979
2025-09-24 22:34:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8518
2025-09-24 22:34:37 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:34:37 [INFO]  Round 18 starts--------|
2025-09-24 22:34:37 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:34:37 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:35:44 [INFO]  Epoch 90 loss: 333.02483654022217; train accuracy: 0.9239211309523809; test accuracy: 0.7691
2025-09-24 22:35:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_90.pth
2025-09-24 22:35:45 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:36:51 [INFO]  Epoch 91 loss: 369.20982217788696; train accuracy: 0.9035838293650794; test accuracy: 0.7493
2025-09-24 22:36:51 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:38:01 [INFO]  Epoch 92 loss: 367.9237251281738; train accuracy: 0.9050409226190477; test accuracy: 0.7536
2025-09-24 22:38:01 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:39:12 [INFO]  Epoch 93 loss: 365.4024991989136; train accuracy: 0.9196738591269841; test accuracy: 0.7567
2025-09-24 22:39:12 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:40:22 [INFO]  Epoch 94 loss: 361.45205640792847; train accuracy: 0.9148995535714286; test accuracy: 0.7786
2025-09-24 22:40:22 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 22:40:22 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 22:40:22 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 22:40:22 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:41:36 [INFO]  Epoch 90 loss: 352.38493633270264; train accuracy: 0.8937800480769231; test accuracy: 0.7881
2025-09-24 22:41:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_90.pth
2025-09-24 22:41:36 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:42:49 [INFO]  Epoch 91 loss: 385.10332679748535; train accuracy: 0.9009014423076923; test accuracy: 0.7787
2025-09-24 22:42:49 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:44:02 [INFO]  Epoch 92 loss: 392.17979097366333; train accuracy: 0.8919170673076923; test accuracy: 0.7713
2025-09-24 22:44:02 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:45:14 [INFO]  Epoch 93 loss: 393.63505029678345; train accuracy: 0.9213641826923077; test accuracy: 0.7916
2025-09-24 22:45:14 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:46:25 [INFO]  Epoch 94 loss: 387.4311661720276; train accuracy: 0.8950721153846154; test accuracy: 0.768
2025-09-24 22:46:25 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 22:46:25 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 22:46:25 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 22:46:25 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:47:28 [INFO]  Epoch 90 loss: 305.6931104660034; train accuracy: 0.8832659040178571; test accuracy: 0.6653
2025-09-24 22:47:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_90.pth
2025-09-24 22:47:28 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:48:32 [INFO]  Epoch 91 loss: 332.87709045410156; train accuracy: 0.9076450892857143; test accuracy: 0.6763
2025-09-24 22:48:32 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:49:35 [INFO]  Epoch 92 loss: 340.9130563735962; train accuracy: 0.9142368861607143; test accuracy: 0.6905
2025-09-24 22:49:35 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:50:37 [INFO]  Epoch 93 loss: 339.35675954818726; train accuracy: 0.89501953125; test accuracy: 0.6516
2025-09-24 22:50:37 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:51:40 [INFO]  Epoch 94 loss: 328.8084726333618; train accuracy: 0.9016462053571429; test accuracy: 0.6849
2025-09-24 22:51:40 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 22:51:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 22:51:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 22:51:40 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:52:06 [INFO]  Epoch 90 loss: 118.59447860717773; train accuracy: 0.8841796875; test accuracy: 0.4106
2025-09-24 22:52:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_90.pth
2025-09-24 22:52:07 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:32 [INFO]  Epoch 91 loss: 135.0124340057373; train accuracy: 0.87236328125; test accuracy: 0.3774
2025-09-24 22:52:32 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:52:57 [INFO]  Epoch 92 loss: 134.20397853851318; train accuracy: 0.84521484375; test accuracy: 0.3614
2025-09-24 22:52:57 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:53:22 [INFO]  Epoch 93 loss: 130.8287124633789; train accuracy: 0.8587890625; test accuracy: 0.3535
2025-09-24 22:53:22 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:53:45 [INFO]  Epoch 94 loss: 133.88233184814453; train accuracy: 0.88583984375; test accuracy: 0.3929
2025-09-24 22:53:45 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 22:53:45 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 22:53:45 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 22:53:45 [INFO]  Epoch 90: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:54:30 [INFO]  Epoch 90 loss: 227.6149787902832; train accuracy: 0.869287109375; test accuracy: 0.6005
2025-09-24 22:54:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_90.pth
2025-09-24 22:54:31 [INFO]  Epoch 91: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:55:14 [INFO]  Epoch 91 loss: 248.244704246521; train accuracy: 0.88935546875; test accuracy: 0.6242
2025-09-24 22:55:14 [INFO]  Epoch 92: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:56:00 [INFO]  Epoch 92 loss: 244.12337398529053; train accuracy: 0.827587890625; test accuracy: 0.5812
2025-09-24 22:56:00 [INFO]  Epoch 93: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:56:46 [INFO]  Epoch 93 loss: 250.3775553703308; train accuracy: 0.91513671875; test accuracy: 0.6384
2025-09-24 22:56:46 [INFO]  Epoch 94: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 22:57:32 [INFO]  Epoch 94 loss: 255.6403546333313; train accuracy: 0.87177734375; test accuracy: 0.5706
2025-09-24 22:57:32 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 22:57:32 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 22:57:32 [INFO]  Round 18 Finish--------|
2025-09-24 22:57:32 [INFO]  Model variance: mean: 0.0060903048142790794, sum: 68052.7734375
2025-09-24 22:57:32 [INFO]  g_protos_std: 1.0080108642578125
2025-09-24 22:57:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8518
2025-09-24 22:57:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 22:57:41 [INFO]  Round 19 starts--------|
2025-09-24 22:57:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 22:57:41 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 22:58:53 [INFO]  Epoch 95 loss: 331.74549531936646; train accuracy: 0.9420572916666666; test accuracy: 0.8049
2025-09-24 22:58:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_95.pth
2025-09-24 22:58:53 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:00:04 [INFO]  Epoch 96 loss: 364.9920220375061; train accuracy: 0.9415922619047619; test accuracy: 0.7914
2025-09-24 23:00:04 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:01:15 [INFO]  Epoch 97 loss: 360.24632453918457; train accuracy: 0.9282614087301587; test accuracy: 0.7625
2025-09-24 23:01:15 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:02:22 [INFO]  Epoch 98 loss: 366.0232148170471; train accuracy: 0.9520089285714286; test accuracy: 0.8173
2025-09-24 23:02:22 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:03:32 [INFO]  Epoch 99 loss: 370.58079719543457; train accuracy: 0.9210069444444444; test accuracy: 0.7785
2025-09-24 23:03:32 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:03:32 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:03:32 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:03:32 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:04:44 [INFO]  Epoch 95 loss: 351.7909822463989; train accuracy: 0.9115084134615384; test accuracy: 0.8004
2025-09-24 23:04:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_95.pth
2025-09-24 23:04:45 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:05:57 [INFO]  Epoch 96 loss: 387.6461043357849; train accuracy: 0.887890625; test accuracy: 0.7555
2025-09-24 23:05:57 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:07:08 [INFO]  Epoch 97 loss: 389.23485946655273; train accuracy: 0.8930288461538461; test accuracy: 0.7723
2025-09-24 23:07:08 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:08:20 [INFO]  Epoch 98 loss: 387.9112882614136; train accuracy: 0.9398737980769231; test accuracy: 0.8254
2025-09-24 23:08:20 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:09:32 [INFO]  Epoch 99 loss: 390.0452723503113; train accuracy: 0.9393329326923077; test accuracy: 0.8146
2025-09-24 23:09:32 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:09:32 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:09:32 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:09:32 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:10:35 [INFO]  Epoch 95 loss: 305.6502413749695; train accuracy: 0.9293038504464286; test accuracy: 0.6817
2025-09-24 23:10:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_95.pth
2025-09-24 23:10:35 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:11:38 [INFO]  Epoch 96 loss: 331.35423374176025; train accuracy: 0.9093889508928571; test accuracy: 0.6815
2025-09-24 23:11:38 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:12:38 [INFO]  Epoch 97 loss: 330.56934213638306; train accuracy: 0.9109584263392857; test accuracy: 0.6876
2025-09-24 23:12:38 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:13:41 [INFO]  Epoch 98 loss: 333.38498735427856; train accuracy: 0.9120744977678571; test accuracy: 0.6757
2025-09-24 23:13:41 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:14:42 [INFO]  Epoch 99 loss: 332.85147285461426; train accuracy: 0.9063197544642857; test accuracy: 0.6728
2025-09-24 23:14:42 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:14:42 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:14:42 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:14:42 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:15:07 [INFO]  Epoch 95 loss: 118.55488920211792; train accuracy: 0.83388671875; test accuracy: 0.3585
2025-09-24 23:15:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_95.pth
2025-09-24 23:15:07 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:15:31 [INFO]  Epoch 96 loss: 130.91676092147827; train accuracy: 0.89814453125; test accuracy: 0.4034
2025-09-24 23:15:31 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:15:56 [INFO]  Epoch 97 loss: 130.9111876487732; train accuracy: 0.8345703125; test accuracy: 0.3627
2025-09-24 23:15:56 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:16:20 [INFO]  Epoch 98 loss: 129.5352611541748; train accuracy: 0.88720703125; test accuracy: 0.3828
2025-09-24 23:16:20 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:16:45 [INFO]  Epoch 99 loss: 131.9573211669922; train accuracy: 0.86171875; test accuracy: 0.3703
2025-09-24 23:16:45 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:16:45 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:16:45 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:16:45 [INFO]  Epoch 95: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:17:29 [INFO]  Epoch 95 loss: 223.5624589920044; train accuracy: 0.905517578125; test accuracy: 0.6258
2025-09-24 23:17:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_95.pth
2025-09-24 23:17:30 [INFO]  Epoch 96: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:18:16 [INFO]  Epoch 96 loss: 242.82218742370605; train accuracy: 0.89736328125; test accuracy: 0.6114
2025-09-24 23:18:16 [INFO]  Epoch 97: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:19:02 [INFO]  Epoch 97 loss: 248.56079769134521; train accuracy: 0.912646484375; test accuracy: 0.6105
2025-09-24 23:19:02 [INFO]  Epoch 98: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:19:47 [INFO]  Epoch 98 loss: 254.04494953155518; train accuracy: 0.88779296875; test accuracy: 0.5953
2025-09-24 23:19:47 [INFO]  Epoch 99: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:20:35 [INFO]  Epoch 99 loss: 248.99057579040527; train accuracy: 0.887158203125; test accuracy: 0.6126
2025-09-24 23:20:35 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:20:35 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:20:35 [INFO]  Round 19 Finish--------|
2025-09-24 23:20:35 [INFO]  Model variance: mean: 0.0062558287754654884, sum: 69902.328125
2025-09-24 23:20:35 [INFO]  g_protos_std: 1.0081297159194946
2025-09-24 23:20:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8499
2025-09-24 23:20:44 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:20:44 [INFO]  Round 20 starts--------|
2025-09-24 23:20:44 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:20:44 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:21:57 [INFO]  Epoch 100 loss: 333.72787284851074; train accuracy: 0.9318576388888888; test accuracy: 0.791
2025-09-24 23:21:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_100.pth
2025-09-24 23:21:57 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:23:10 [INFO]  Epoch 101 loss: 365.17130422592163; train accuracy: 0.9422743055555556; test accuracy: 0.785
2025-09-24 23:23:10 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:24:22 [INFO]  Epoch 102 loss: 358.8836269378662; train accuracy: 0.9264632936507936; test accuracy: 0.768
2025-09-24 23:24:22 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:25:36 [INFO]  Epoch 103 loss: 362.41476345062256; train accuracy: 0.9416542658730159; test accuracy: 0.7827
2025-09-24 23:25:36 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:26:47 [INFO]  Epoch 104 loss: 363.3478627204895; train accuracy: 0.9256262400793651; test accuracy: 0.7523
2025-09-24 23:26:47 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:26:47 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:26:47 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:26:47 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:28:03 [INFO]  Epoch 100 loss: 349.9771933555603; train accuracy: 0.9264122596153846; test accuracy: 0.8017
2025-09-24 23:28:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_100.pth
2025-09-24 23:28:04 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:29:16 [INFO]  Epoch 101 loss: 383.87426376342773; train accuracy: 0.8753004807692307; test accuracy: 0.7607
2025-09-24 23:29:16 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:30:31 [INFO]  Epoch 102 loss: 387.42137145996094; train accuracy: 0.9270132211538461; test accuracy: 0.7915
2025-09-24 23:30:31 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:31:45 [INFO]  Epoch 103 loss: 376.78559589385986; train accuracy: 0.9081129807692307; test accuracy: 0.8061
2025-09-24 23:31:45 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:32:57 [INFO]  Epoch 104 loss: 381.2723093032837; train accuracy: 0.9348858173076923; test accuracy: 0.8137
2025-09-24 23:32:57 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:32:57 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:32:57 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:32:57 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:34:04 [INFO]  Epoch 100 loss: 306.24980783462524; train accuracy: 0.9261997767857143; test accuracy: 0.6751
2025-09-24 23:34:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_100.pth
2025-09-24 23:34:05 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:35:11 [INFO]  Epoch 101 loss: 331.9427652359009; train accuracy: 0.8776157924107143; test accuracy: 0.6735
2025-09-24 23:35:11 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:36:17 [INFO]  Epoch 102 loss: 334.9502191543579; train accuracy: 0.9414411272321429; test accuracy: 0.6974
2025-09-24 23:36:17 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:37:16 [INFO]  Epoch 103 loss: 333.594735622406; train accuracy: 0.9125279017857143; test accuracy: 0.6911
2025-09-24 23:37:16 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:38:15 [INFO]  Epoch 104 loss: 332.22341871261597; train accuracy: 0.9356863839285714; test accuracy: 0.6926
2025-09-24 23:38:15 [INFO]  Client 2 Finish Local Training--------|
2025-09-24 23:38:15 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-24 23:38:15 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-24 23:38:15 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:38:37 [INFO]  Epoch 100 loss: 117.30772256851196; train accuracy: 0.860546875; test accuracy: 0.3865
2025-09-24 23:38:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_100.pth
2025-09-24 23:38:37 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:39:01 [INFO]  Epoch 101 loss: 129.09585571289062; train accuracy: 0.8837890625; test accuracy: 0.3923
2025-09-24 23:39:01 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:39:26 [INFO]  Epoch 102 loss: 130.56212902069092; train accuracy: 0.90302734375; test accuracy: 0.4322
2025-09-24 23:39:26 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:39:49 [INFO]  Epoch 103 loss: 128.96926546096802; train accuracy: 0.8328125; test accuracy: 0.3314
2025-09-24 23:39:49 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:40:13 [INFO]  Epoch 104 loss: 131.51958751678467; train accuracy: 0.91806640625; test accuracy: 0.4568
2025-09-24 23:40:13 [INFO]  Client 3 Finish Local Training--------|
2025-09-24 23:40:13 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-24 23:40:13 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-24 23:40:13 [INFO]  Epoch 100: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:40:56 [INFO]  Epoch 100 loss: 226.19123458862305; train accuracy: 0.895947265625; test accuracy: 0.6155
2025-09-24 23:40:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_100.pth
2025-09-24 23:40:56 [INFO]  Epoch 101: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:41:40 [INFO]  Epoch 101 loss: 250.3752579689026; train accuracy: 0.89228515625; test accuracy: 0.6232
2025-09-24 23:41:40 [INFO]  Epoch 102: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:42:25 [INFO]  Epoch 102 loss: 253.6399049758911; train accuracy: 0.920849609375; test accuracy: 0.6349
2025-09-24 23:42:25 [INFO]  Epoch 103: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:43:10 [INFO]  Epoch 103 loss: 247.31587076187134; train accuracy: 0.90283203125; test accuracy: 0.6294
2025-09-24 23:43:10 [INFO]  Epoch 104: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:43:55 [INFO]  Epoch 104 loss: 247.79949951171875; train accuracy: 0.819580078125; test accuracy: 0.5339
2025-09-24 23:43:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-24 23:43:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-24 23:43:55 [INFO]  Round 20 Finish--------|
2025-09-24 23:43:55 [INFO]  Model variance: mean: 0.00641655595973134, sum: 71698.2890625
2025-09-24 23:43:55 [INFO]  g_protos_std: 1.0082517862319946
2025-09-24 23:44:06 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8553
2025-09-24 23:44:06 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-24 23:44:06 [INFO]  Round 21 starts--------|
2025-09-24 23:44:06 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-24 23:44:06 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:45:18 [INFO]  Epoch 105 loss: 332.1244535446167; train accuracy: 0.9263392857142857; test accuracy: 0.773
2025-09-24 23:45:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_105.pth
2025-09-24 23:45:19 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:46:29 [INFO]  Epoch 106 loss: 361.7493553161621; train accuracy: 0.9444134424603174; test accuracy: 0.7798
2025-09-24 23:46:29 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:47:40 [INFO]  Epoch 107 loss: 356.23512029647827; train accuracy: 0.9330977182539683; test accuracy: 0.79
2025-09-24 23:47:40 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:48:50 [INFO]  Epoch 108 loss: 360.6564431190491; train accuracy: 0.9312686011904762; test accuracy: 0.764
2025-09-24 23:48:50 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:50:04 [INFO]  Epoch 109 loss: 358.76700496673584; train accuracy: 0.9392671130952381; test accuracy: 0.7856
2025-09-24 23:50:04 [INFO]  Client 0 Finish Local Training--------|
2025-09-24 23:50:04 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-24 23:50:04 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-24 23:50:04 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:51:16 [INFO]  Epoch 105 loss: 350.50572395324707; train accuracy: 0.9079026442307693; test accuracy: 0.7697
2025-09-24 23:51:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_105.pth
2025-09-24 23:51:16 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:52:30 [INFO]  Epoch 106 loss: 375.30092668533325; train accuracy: 0.8959735576923077; test accuracy: 0.7569
2025-09-24 23:52:30 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:53:42 [INFO]  Epoch 107 loss: 376.8901882171631; train accuracy: 0.9325420673076923; test accuracy: 0.8115
2025-09-24 23:53:42 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:54:56 [INFO]  Epoch 108 loss: 383.77807569503784; train accuracy: 0.9244891826923077; test accuracy: 0.8026
2025-09-24 23:54:56 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:56:05 [INFO]  Epoch 109 loss: 380.79338026046753; train accuracy: 0.9066105769230769; test accuracy: 0.7879
2025-09-24 23:56:05 [INFO]  Client 1 Finish Local Training--------|
2025-09-24 23:56:05 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-24 23:56:05 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-24 23:56:05 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-24 23:57:06 [INFO]  Epoch 105 loss: 304.05317735671997; train accuracy: 0.9268275669642857; test accuracy: 0.6919
2025-09-24 23:57:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_105.pth
2025-09-24 23:57:06 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:58:10 [INFO]  Epoch 106 loss: 333.55268812179565; train accuracy: 0.9291294642857143; test accuracy: 0.6981
2025-09-24 23:58:10 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-24 23:59:15 [INFO]  Epoch 107 loss: 324.9758892059326; train accuracy: 0.8664202008928571; test accuracy: 0.6667
2025-09-24 23:59:15 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:00:17 [INFO]  Epoch 108 loss: 338.1572914123535; train accuracy: 0.9104352678571429; test accuracy: 0.6869
2025-09-25 00:00:17 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:01:20 [INFO]  Epoch 109 loss: 325.54818391799927; train accuracy: 0.9312569754464286; test accuracy: 0.6877
2025-09-25 00:01:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-25 00:01:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-25 00:01:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-25 00:01:20 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:01:44 [INFO]  Epoch 105 loss: 119.2237000465393; train accuracy: 0.82919921875; test accuracy: 0.3252
2025-09-25 00:01:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_105.pth
2025-09-25 00:01:44 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:02:09 [INFO]  Epoch 106 loss: 125.55303907394409; train accuracy: 0.88583984375; test accuracy: 0.3924
2025-09-25 00:02:09 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:02:34 [INFO]  Epoch 107 loss: 128.86553478240967; train accuracy: 0.89619140625; test accuracy: 0.4256
2025-09-25 00:02:34 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:02:59 [INFO]  Epoch 108 loss: 126.05425119400024; train accuracy: 0.90986328125; test accuracy: 0.4322
2025-09-25 00:02:59 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:03:25 [INFO]  Epoch 109 loss: 128.53725719451904; train accuracy: 0.815625; test accuracy: 0.3589
2025-09-25 00:03:25 [INFO]  Client 3 Finish Local Training--------|
2025-09-25 00:03:25 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-25 00:03:25 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-25 00:03:25 [INFO]  Epoch 105: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:04:10 [INFO]  Epoch 105 loss: 226.07064533233643; train accuracy: 0.9150390625; test accuracy: 0.6198
2025-09-25 00:04:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_105.pth
2025-09-25 00:04:10 [INFO]  Epoch 106: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:04:56 [INFO]  Epoch 106 loss: 242.82270622253418; train accuracy: 0.919970703125; test accuracy: 0.6203
2025-09-25 00:04:56 [INFO]  Epoch 107: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:05:43 [INFO]  Epoch 107 loss: 241.73338842391968; train accuracy: 0.8833984375; test accuracy: 0.6015
2025-09-25 00:05:43 [INFO]  Epoch 108: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:06:30 [INFO]  Epoch 108 loss: 238.78886032104492; train accuracy: 0.892822265625; test accuracy: 0.6318
2025-09-25 00:06:30 [INFO]  Epoch 109: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:07:18 [INFO]  Epoch 109 loss: 253.5997772216797; train accuracy: 0.87890625; test accuracy: 0.6052
2025-09-25 00:07:18 [INFO]  Client 4 Finish Local Training--------|
2025-09-25 00:07:18 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-25 00:07:18 [INFO]  Round 21 Finish--------|
2025-09-25 00:07:18 [INFO]  Model variance: mean: 0.006574136670678854, sum: 73459.0859375
2025-09-25 00:07:18 [INFO]  g_protos_std: 1.0083744525909424
2025-09-25 00:07:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8607
2025-09-25 00:07:26 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-25 00:07:26 [INFO]  Round 22 starts--------|
2025-09-25 00:07:26 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-25 00:07:26 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:08:39 [INFO]  Epoch 110 loss: 329.4301505088806; train accuracy: 0.9091951884920635; test accuracy: 0.7727
2025-09-25 00:08:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_110.pth
2025-09-25 00:08:39 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:09:52 [INFO]  Epoch 111 loss: 363.16815280914307; train accuracy: 0.9211309523809523; test accuracy: 0.7846
2025-09-25 00:09:52 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:11:06 [INFO]  Epoch 112 loss: 359.859073638916; train accuracy: 0.9392981150793651; test accuracy: 0.7738
2025-09-25 00:11:06 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:12:18 [INFO]  Epoch 113 loss: 353.8563632965088; train accuracy: 0.9597904265873016; test accuracy: 0.8029
2025-09-25 00:12:18 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:13:27 [INFO]  Epoch 114 loss: 353.7652235031128; train accuracy: 0.9252542162698413; test accuracy: 0.771
2025-09-25 00:13:27 [INFO]  Client 0 Finish Local Training--------|
2025-09-25 00:13:27 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-25 00:13:27 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-25 00:13:27 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
2025-09-25 00:14:40 [INFO]  Epoch 110 loss: 345.9197335243225; train accuracy: 0.8806790865384615; test accuracy: 0.7776
2025-09-25 00:14:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_110.pth
2025-09-25 00:14:40 [INFO]  Epoch 111: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:15:55 [INFO]  Epoch 111 loss: 376.60970306396484; train accuracy: 0.9298076923076923; test accuracy: 0.7979
2025-09-25 00:15:55 [INFO]  Epoch 112: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:17:07 [INFO]  Epoch 112 loss: 382.8748388290405; train accuracy: 0.9143629807692307; test accuracy: 0.8004
2025-09-25 00:17:07 [INFO]  Epoch 113: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:18:22 [INFO]  Epoch 113 loss: 376.78937101364136; train accuracy: 0.9211838942307692; test accuracy: 0.7871
2025-09-25 00:18:22 [INFO]  Epoch 114: Running in Stage 2 - Local Task Fine-tuning.
2025-09-25 00:19:34 [INFO]  Epoch 114 loss: 382.5367383956909; train accuracy: 0.9178185096153846; test accuracy: 0.7854
2025-09-25 00:19:34 [INFO]  Client 1 Finish Local Training--------|
2025-09-25 00:19:34 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-25 00:19:34 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-25 00:19:34 [INFO]  Epoch 110: Running in Stage 1 - Global Alignment Only.
