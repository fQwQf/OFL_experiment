2025-10-19 19:01:18 [INFO]  Load config from ./configs/Tiny_alpha0.05_l5.yaml
2025-10-19 19:01:18 [INFO]  config: {'exp_name': 'Tiny_alpha0.05', 'dataset': {'data_name': 'Tiny-ImageNet', 'root_path': '~/datasets/', 'train_batch_size': 128, 'test_batch_size': 256, 'channels': 3, 'num_classes': 200, 'image_size': 64, 'aux_data_name': 'Tiny-ImageNet', 'aux_root_path': '~/datasets/', 'aux_split': 'test'}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 100, 'frac_clients': 1.0, 'lr': 0.005, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.99}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'Tiny_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.5, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'lambda_align_initial': 5.0}
2025-10-19 19:01:19 [INFO]  Dataset Tiny-ImageNet loaded
2025-10-19 19:01:19 [INFO]  Dataset index dict loaded from preprocessed_data/Tiny-ImageNet.pt
2025-10-19 19:01:19 [INFO]  Data distribution generated correctly using the corrected dirichlet function.
2025-10-19 19:01:19 [INFO]  Total assigned samples: 100000
2025-10-19 19:01:19 [INFO]  OneshotOursV7 with DRCL (ETF Anchors) and Lambda Annealing
2025-10-19 19:01:21 [INFO]  Initialized ETF fixed anchors with shape: torch.Size([200, 512])
2025-10-19 19:01:22 [INFO]  Round 0 starts--------|
2025-10-19 19:01:22 [INFO]  Client 0 Starts Local Trainning--------|
