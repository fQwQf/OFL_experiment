2025-09-24 12:27:33 [INFO]  Load config from ./configs/CIFAR10_alpha0.05.yaml
2025-09-24 12:27:33 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.05', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:27:36 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:27:36 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 12:27:36 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:27:37 [INFO]  OneshotOurs
2025-09-24 12:27:37 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 12:27:37 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 12:27:37 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 12:27:39 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 12:27:41 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 12:27:42 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 12:27:44 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 12:27:45 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 12:27:46 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 12:27:48 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 12:27:49 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 12:27:51 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 12:27:52 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 12:27:54 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 12:27:55 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 12:27:57 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 12:27:58 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 12:28:00 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 12:28:01 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 12:28:03 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 12:28:04 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 12:28:06 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 12:28:07 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 12:28:07 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 12:28:08 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 12:28:08 [INFO]  Round 0 starts--------|
2025-09-24 12:30:12 [INFO]  Model variance: mean: 0.0004179656971246004, sum: 4670.32861328125
2025-09-24 12:30:12 [INFO]  g_protos_std: 1.0060840845108032
2025-09-24 12:30:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.1417
2025-09-24 12:30:16 [INFO]  Round 1 starts--------|
2025-09-24 12:31:14 [INFO]  Model variance: mean: 0.0005314062582328916, sum: 5937.908203125
2025-09-24 12:31:14 [INFO]  g_protos_std: 1.0060958862304688
2025-09-24 12:31:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.2117
2025-09-24 12:31:18 [INFO]  Round 2 starts--------|
2025-09-24 12:32:10 [INFO]  Model variance: mean: 0.0006147808162495494, sum: 6869.53125
2025-09-24 12:32:10 [INFO]  g_protos_std: 1.0060962438583374
2025-09-24 12:32:15 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.2331
2025-09-24 12:32:15 [INFO]  Round 3 starts--------|
2025-09-24 12:33:08 [INFO]  Model variance: mean: 0.0006836435641162097, sum: 7639.0
2025-09-24 12:33:08 [INFO]  g_protos_std: 1.0060923099517822
2025-09-24 12:33:12 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.2553
2025-09-24 12:33:12 [INFO]  Round 4 starts--------|
2025-09-24 12:34:03 [INFO]  Model variance: mean: 0.0007454219157807529, sum: 8329.30859375
2025-09-24 12:34:03 [INFO]  g_protos_std: 1.006088137626648
2025-09-24 12:34:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.2764
2025-09-24 12:34:08 [INFO]  Round 5 starts--------|
2025-09-24 12:34:59 [INFO]  Model variance: mean: 0.0007978861103765666, sum: 8915.541015625
2025-09-24 12:34:59 [INFO]  g_protos_std: 1.006089210510254
2025-09-24 12:35:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3098
2025-09-24 12:35:04 [INFO]  Round 6 starts--------|
2025-09-24 12:35:55 [INFO]  Model variance: mean: 0.000843214220367372, sum: 9422.03515625
2025-09-24 12:35:55 [INFO]  g_protos_std: 1.006087303161621
2025-09-24 12:36:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3235
2025-09-24 12:36:00 [INFO]  Round 7 starts--------|
2025-09-24 12:36:50 [INFO]  Model variance: mean: 0.0008849694859236479, sum: 9888.6064453125
2025-09-24 12:36:50 [INFO]  g_protos_std: 1.0060818195343018
2025-09-24 12:36:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3412
2025-09-24 12:36:55 [INFO]  Round 8 starts--------|
2025-09-24 12:37:46 [INFO]  Model variance: mean: 0.0009276908240281045, sum: 10365.97265625
2025-09-24 12:37:46 [INFO]  g_protos_std: 1.0060805082321167
2025-09-24 12:37:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3512
2025-09-24 12:37:50 [INFO]  Round 9 starts--------|
2025-09-24 12:38:41 [INFO]  Model variance: mean: 0.000965214625466615, sum: 10785.26171875
2025-09-24 12:38:41 [INFO]  g_protos_std: 1.0060793161392212
2025-09-24 12:38:45 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3519
2025-09-24 12:38:45 [INFO]  Round 10 starts--------|
2025-09-24 12:39:38 [INFO]  Model variance: mean: 0.0010035720188170671, sum: 11213.865234375
2025-09-24 12:39:38 [INFO]  g_protos_std: 1.0060800313949585
2025-09-24 12:39:43 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3588
2025-09-24 12:39:43 [INFO]  Round 11 starts--------|
2025-09-24 12:40:33 [INFO]  Model variance: mean: 0.0010409591486677527, sum: 11631.6279296875
2025-09-24 12:40:33 [INFO]  g_protos_std: 1.0060828924179077
2025-09-24 12:40:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3837
2025-09-24 12:40:37 [INFO]  Round 12 starts--------|
2025-09-24 12:41:27 [INFO]  Model variance: mean: 0.0010732695227488875, sum: 11992.662109375
2025-09-24 12:41:27 [INFO]  g_protos_std: 1.0060827732086182
2025-09-24 12:41:31 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3843
2025-09-24 12:41:31 [INFO]  Round 13 starts--------|
2025-09-24 12:42:21 [INFO]  Model variance: mean: 0.0011093318462371826, sum: 12395.62109375
2025-09-24 12:42:21 [INFO]  g_protos_std: 1.0060863494873047
2025-09-24 12:42:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3897
2025-09-24 12:42:26 [INFO]  Round 14 starts--------|
2025-09-24 12:43:15 [INFO]  Model variance: mean: 0.0011445715790614486, sum: 12789.3876953125
2025-09-24 12:43:15 [INFO]  g_protos_std: 1.0060904026031494
2025-09-24 12:43:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4041
2025-09-24 12:43:19 [INFO]  Round 15 starts--------|
2025-09-24 12:44:12 [INFO]  Model variance: mean: 0.0011772995349019766, sum: 13155.0888671875
2025-09-24 12:44:12 [INFO]  g_protos_std: 1.0060921907424927
2025-09-24 12:44:17 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3904
2025-09-24 12:44:17 [INFO]  Round 16 starts--------|
2025-09-24 12:45:08 [INFO]  Model variance: mean: 0.0012088320218026638, sum: 13507.4306640625
2025-09-24 12:45:08 [INFO]  g_protos_std: 1.0060985088348389
2025-09-24 12:45:12 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4345
2025-09-24 12:45:12 [INFO]  Round 17 starts--------|
2025-09-24 12:46:04 [INFO]  Model variance: mean: 0.0012384140864014626, sum: 13837.9794921875
2025-09-24 12:46:04 [INFO]  g_protos_std: 1.0061007738113403
2025-09-24 12:46:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4265
2025-09-24 12:46:08 [INFO]  Round 18 starts--------|
2025-09-24 12:46:59 [INFO]  Model variance: mean: 0.0012705562403425574, sum: 14197.1337890625
2025-09-24 12:46:59 [INFO]  g_protos_std: 1.0061060190200806
2025-09-24 12:47:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4413
2025-09-24 12:47:04 [INFO]  Round 19 starts--------|
2025-09-24 12:47:55 [INFO]  Model variance: mean: 0.0013004504144191742, sum: 14531.1708984375
2025-09-24 12:47:55 [INFO]  g_protos_std: 1.006113886833191
2025-09-24 12:48:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4414
2025-09-24 12:48:00 [INFO]  Round 20 starts--------|
2025-09-24 12:48:52 [INFO]  Model variance: mean: 0.001328971004113555, sum: 14849.857421875
2025-09-24 12:48:52 [INFO]  g_protos_std: 1.006116509437561
2025-09-24 12:48:56 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4488
2025-09-24 12:48:56 [INFO]  Round 21 starts--------|
2025-09-24 12:49:47 [INFO]  Model variance: mean: 0.0013576473575085402, sum: 15170.2861328125
2025-09-24 12:49:47 [INFO]  g_protos_std: 1.0061218738555908
2025-09-24 12:49:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4639
2025-09-24 12:49:51 [INFO]  Round 22 starts--------|
2025-09-24 12:50:42 [INFO]  Model variance: mean: 0.0013851094990968704, sum: 15477.146484375
2025-09-24 12:50:42 [INFO]  g_protos_std: 1.006123423576355
2025-09-24 12:50:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.44
2025-09-24 12:50:46 [INFO]  Round 23 starts--------|
2025-09-24 12:51:37 [INFO]  Model variance: mean: 0.0014124043518677354, sum: 15782.1376953125
2025-09-24 12:51:37 [INFO]  g_protos_std: 1.0061249732971191
2025-09-24 12:51:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.452
2025-09-24 12:51:42 [INFO]  Round 24 starts--------|
2025-09-24 12:52:33 [INFO]  Model variance: mean: 0.0014396815095096827, sum: 16086.931640625
2025-09-24 12:52:33 [INFO]  g_protos_std: 1.0061286687850952
2025-09-24 12:52:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4446
2025-09-24 12:52:37 [INFO]  Round 25 starts--------|
2025-09-24 12:53:29 [INFO]  Model variance: mean: 0.0014664620393887162, sum: 16386.17578125
2025-09-24 12:53:29 [INFO]  g_protos_std: 1.0061336755752563
2025-09-24 12:53:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4575
2025-09-24 12:53:34 [INFO]  Round 26 starts--------|
2025-09-24 12:54:24 [INFO]  Model variance: mean: 0.0014924462884664536, sum: 16676.5234375
2025-09-24 12:54:24 [INFO]  g_protos_std: 1.0061376094818115
2025-09-24 12:54:28 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4732
2025-09-24 12:54:28 [INFO]  Round 27 starts--------|
2025-09-24 12:55:19 [INFO]  Model variance: mean: 0.0015180064365267754, sum: 16962.130859375
2025-09-24 12:55:19 [INFO]  g_protos_std: 1.0061396360397339
2025-09-24 12:55:24 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.463
2025-09-24 12:55:24 [INFO]  Round 28 starts--------|
2025-09-24 12:56:15 [INFO]  Model variance: mean: 0.0015444635646417737, sum: 17257.76171875
2025-09-24 12:56:15 [INFO]  g_protos_std: 1.0061451196670532
2025-09-24 12:56:20 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4878
2025-09-24 12:56:20 [INFO]  Round 29 starts--------|
2025-09-24 12:57:12 [INFO]  Model variance: mean: 0.0015691579319536686, sum: 17533.6953125
2025-09-24 12:57:12 [INFO]  g_protos_std: 1.0061540603637695
2025-09-24 12:57:17 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4736
2025-09-24 12:57:17 [INFO]  Round 30 starts--------|
2025-09-24 12:58:10 [INFO]  Model variance: mean: 0.0015924179460853338, sum: 17793.6015625
2025-09-24 12:58:10 [INFO]  g_protos_std: 1.0061513185501099
2025-09-24 12:58:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4861
2025-09-24 12:58:14 [INFO]  Round 31 starts--------|
2025-09-24 12:59:06 [INFO]  Model variance: mean: 0.0016153192846104503, sum: 18049.5
2025-09-24 12:59:06 [INFO]  g_protos_std: 1.0061557292938232
2025-09-24 12:59:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4951
2025-09-24 12:59:10 [INFO]  Round 32 starts--------|
2025-09-24 13:00:01 [INFO]  Model variance: mean: 0.0016399655723944306, sum: 18324.896484375
2025-09-24 13:00:01 [INFO]  g_protos_std: 1.0061589479446411
2025-09-24 13:00:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4829
2025-09-24 13:00:05 [INFO]  Round 33 starts--------|
2025-09-24 13:00:55 [INFO]  Model variance: mean: 0.001662720926105976, sum: 18579.1640625
2025-09-24 13:00:55 [INFO]  g_protos_std: 1.006162405014038
2025-09-24 13:01:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4853
2025-09-24 13:01:00 [INFO]  Round 34 starts--------|
2025-09-24 13:01:50 [INFO]  Model variance: mean: 0.0016850546235218644, sum: 18828.71875
2025-09-24 13:01:50 [INFO]  g_protos_std: 1.006166696548462
2025-09-24 13:01:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4905
2025-09-24 13:01:55 [INFO]  Round 35 starts--------|
2025-09-24 13:02:48 [INFO]  Model variance: mean: 0.001707616844214499, sum: 19080.828125
2025-09-24 13:02:48 [INFO]  g_protos_std: 1.0061711072921753
2025-09-24 13:02:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4992


2025-09-24 12:27:39 [INFO]  Load config from ./configs/CIFAR10_alpha0.05.yaml
2025-09-24 12:27:39 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.05', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:27:41 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:27:41 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:27:41 [INFO]  OneshotOurs
2025-09-24 12:27:42 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 12:27:42 [INFO]  Round 0 starts--------|
2025-09-24 12:30:10 [INFO]  Model variance: mean: 0.00036414689384400845, sum: 4068.9599609375
2025-09-24 12:30:10 [INFO]  g_protos_std: 1.0059771537780762
2025-09-24 12:30:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4217
2025-09-24 12:30:14 [INFO]  Round 1 starts--------|
2025-09-24 12:31:30 [INFO]  Model variance: mean: 0.0005051970947533846, sum: 5645.0478515625
2025-09-24 12:31:30 [INFO]  g_protos_std: 1.0059562921524048
2025-09-24 12:31:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4851
2025-09-24 12:31:34 [INFO]  Round 2 starts--------|
2025-09-24 12:32:45 [INFO]  Model variance: mean: 0.0006213344749994576, sum: 6942.76171875
2025-09-24 12:32:45 [INFO]  g_protos_std: 1.0059401988983154
2025-09-24 12:32:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5301
2025-09-24 12:32:50 [INFO]  Round 3 starts--------|
2025-09-24 12:34:01 [INFO]  Model variance: mean: 0.0007265713647939265, sum: 8118.67333984375
2025-09-24 12:34:01 [INFO]  g_protos_std: 1.0059354305267334
2025-09-24 12:34:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5695
2025-09-24 12:34:05 [INFO]  Round 4 starts--------|
2025-09-24 12:35:15 [INFO]  Model variance: mean: 0.0008137375116348267, sum: 9092.6640625
2025-09-24 12:35:15 [INFO]  g_protos_std: 1.0059319734573364
2025-09-24 12:35:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5982
2025-09-24 12:35:19 [INFO]  Round 5 starts--------|
2025-09-24 12:36:30 [INFO]  Model variance: mean: 0.0009012952796183527, sum: 10071.0302734375
2025-09-24 12:36:30 [INFO]  g_protos_std: 1.0059312582015991
2025-09-24 12:36:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6226
2025-09-24 12:36:35 [INFO]  Round 6 starts--------|
2025-09-24 12:37:44 [INFO]  Model variance: mean: 0.000980569631792605, sum: 10956.837890625
2025-09-24 12:37:44 [INFO]  g_protos_std: 1.0059311389923096
2025-09-24 12:37:49 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6376
2025-09-24 12:37:49 [INFO]  Round 7 starts--------|
2025-09-24 12:38:58 [INFO]  Model variance: mean: 0.0010634234640747309, sum: 11882.642578125
2025-09-24 12:38:58 [INFO]  g_protos_std: 1.0059348344802856
2025-09-24 12:39:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.665
2025-09-24 12:39:02 [INFO]  Round 8 starts--------|
2025-09-24 12:40:11 [INFO]  Model variance: mean: 0.0011410943698137999, sum: 12750.533203125
2025-09-24 12:40:11 [INFO]  g_protos_std: 1.0059345960617065
2025-09-24 12:40:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6837
2025-09-24 12:40:16 [INFO]  Round 9 starts--------|
2025-09-24 12:41:24 [INFO]  Model variance: mean: 0.0012168425600975752, sum: 13596.9404296875
2025-09-24 12:41:24 [INFO]  g_protos_std: 1.0059316158294678
2025-09-24 12:41:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7003
2025-09-24 12:41:29 [INFO]  Round 10 starts--------|
2025-09-24 12:42:41 [INFO]  Model variance: mean: 0.0012897844426333904, sum: 14411.9892578125
2025-09-24 12:42:41 [INFO]  g_protos_std: 1.0059301853179932
2025-09-24 12:42:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7082
2025-09-24 12:42:46 [INFO]  Round 11 starts--------|
2025-09-24 12:43:55 [INFO]  Model variance: mean: 0.001361499889753759, sum: 15213.333984375
2025-09-24 12:43:55 [INFO]  g_protos_std: 1.0059393644332886
2025-09-24 12:44:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7241
2025-09-24 12:44:00 [INFO]  Round 12 starts--------|
2025-09-24 12:45:09 [INFO]  Model variance: mean: 0.001429432537406683, sum: 15972.41015625
2025-09-24 12:45:09 [INFO]  g_protos_std: 1.00594162940979
2025-09-24 12:45:13 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7364
2025-09-24 12:45:13 [INFO]  Round 13 starts--------|
2025-09-24 12:46:24 [INFO]  Model variance: mean: 0.0014925915747880936, sum: 16678.146484375
2025-09-24 12:46:24 [INFO]  g_protos_std: 1.005934715270996
2025-09-24 12:46:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7498
2025-09-24 12:46:29 [INFO]  Round 14 starts--------|
2025-09-24 12:47:40 [INFO]  Model variance: mean: 0.0015603050123900175, sum: 17434.7734375
2025-09-24 12:47:40 [INFO]  g_protos_std: 1.0059465169906616
2025-09-24 12:47:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7533
2025-09-24 12:47:44 [INFO]  Round 15 starts--------|
2025-09-24 12:48:57 [INFO]  Model variance: mean: 0.001619733520783484, sum: 18098.82421875
2025-09-24 12:48:57 [INFO]  g_protos_std: 1.005939245223999
2025-09-24 12:49:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7595
2025-09-24 12:49:01 [INFO]  Round 16 starts--------|
2025-09-24 12:50:11 [INFO]  Model variance: mean: 0.0016792102251201868, sum: 18763.4140625
2025-09-24 12:50:11 [INFO]  g_protos_std: 1.005937099456787
2025-09-24 12:50:15 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7693
2025-09-24 12:50:15 [INFO]  Round 17 starts--------|
2025-09-24 12:51:24 [INFO]  Model variance: mean: 0.0017383191734552383, sum: 19423.89453125
2025-09-24 12:51:24 [INFO]  g_protos_std: 1.0059378147125244
2025-09-24 12:51:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7729
2025-09-24 12:51:29 [INFO]  Round 18 starts--------|
2025-09-24 12:52:36 [INFO]  Model variance: mean: 0.0017954770009964705, sum: 20062.57421875
2025-09-24 12:52:36 [INFO]  g_protos_std: 1.005936861038208
2025-09-24 12:52:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7759
2025-09-24 12:52:41 [INFO]  Round 19 starts--------|
2025-09-24 12:53:49 [INFO]  Model variance: mean: 0.0018528890796005726, sum: 20704.09375
2025-09-24 12:53:49 [INFO]  g_protos_std: 1.005947470664978
2025-09-24 12:53:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7867
2025-09-24 12:53:53 [INFO]  Round 20 starts--------|
2025-09-24 12:55:04 [INFO]  Model variance: mean: 0.001906879828311503, sum: 21307.3828125
2025-09-24 12:55:04 [INFO]  g_protos_std: 1.0059435367584229
2025-09-24 12:55:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7911
2025-09-24 12:55:08 [INFO]  Round 21 starts--------|
2025-09-24 12:56:17 [INFO]  Model variance: mean: 0.0019613124895840883, sum: 21915.611328125
2025-09-24 12:56:17 [INFO]  g_protos_std: 1.0059468746185303
2025-09-24 12:56:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7925
2025-09-24 12:56:21 [INFO]  Round 22 starts--------|
2025-09-24 12:57:30 [INFO]  Model variance: mean: 0.002014614874497056, sum: 22511.2109375
2025-09-24 12:57:30 [INFO]  g_protos_std: 1.0059494972229004
2025-09-24 12:57:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7962
2025-09-24 12:57:35 [INFO]  Round 23 starts--------|
2025-09-24 12:58:43 [INFO]  Model variance: mean: 0.002065619919449091, sum: 23081.13671875
2025-09-24 12:58:43 [INFO]  g_protos_std: 1.005951166152954
2025-09-24 12:58:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8017
2025-09-24 12:58:48 [INFO]  Round 24 starts--------|
2025-09-24 12:59:56 [INFO]  Model variance: mean: 0.0021156303118914366, sum: 23639.951171875
2025-09-24 12:59:56 [INFO]  g_protos_std: 1.0059558153152466
2025-09-24 13:00:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8102
2025-09-24 13:00:00 [INFO]  Round 25 starts--------|
2025-09-24 13:01:11 [INFO]  Model variance: mean: 0.0021675056777894497, sum: 24219.603515625
2025-09-24 13:01:11 [INFO]  g_protos_std: 1.0059651136398315
2025-09-24 13:01:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8088
2025-09-24 13:01:16 [INFO]  Round 26 starts--------|
2025-09-24 13:02:24 [INFO]  Model variance: mean: 0.002214133506640792, sum: 24740.62109375
2025-09-24 13:02:24 [INFO]  g_protos_std: 1.0059617757797241
2025-09-24 13:02:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8119
2025-09-24 13:02:29 [INFO]  Round 27 starts--------|
2025-09-24 13:03:38 [INFO]  Model variance: mean: 0.0022628000006079674, sum: 25284.41796875
2025-09-24 13:03:38 [INFO]  g_protos_std: 1.0059700012207031
2025-09-24 13:03:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8189
2025-09-24 13:03:42 [INFO]  Round 28 starts--------|
2025-09-24 13:04:53 [INFO]  Model variance: mean: 0.0023094427306205034, sum: 25805.6015625
2025-09-24 13:04:53 [INFO]  g_protos_std: 1.0059726238250732
2025-09-24 13:04:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8191
2025-09-24 13:04:57 [INFO]  Round 29 starts--------|
2025-09-24 13:06:07 [INFO]  Model variance: mean: 0.002356830285862088, sum: 26335.109375
2025-09-24 13:06:07 [INFO]  g_protos_std: 1.0059785842895508
2025-09-24 13:06:12 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8246
2025-09-24 13:06:12 [INFO]  Round 30 starts--------|
2025-09-24 13:07:24 [INFO]  Model variance: mean: 0.002403749618679285, sum: 26859.3828125
2025-09-24 13:07:24 [INFO]  g_protos_std: 1.0059845447540283
2025-09-24 13:07:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8265
2025-09-24 13:07:29 [INFO]  Round 31 starts--------|
2025-09-24 13:08:37 [INFO]  Model variance: mean: 0.0024464766029268503, sum: 27336.8125
2025-09-24 13:08:37 [INFO]  g_protos_std: 1.005983829498291
2025-09-24 13:08:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8251
2025-09-24 13:08:42 [INFO]  Round 32 starts--------|
2025-09-24 13:09:50 [INFO]  Model variance: mean: 0.0024899498093873262, sum: 27822.578125
2025-09-24 13:09:50 [INFO]  g_protos_std: 1.005988597869873
2025-09-24 13:09:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8312
2025-09-24 13:09:55 [INFO]  Round 33 starts--------|
2025-09-24 13:11:06 [INFO]  Model variance: mean: 0.0025341238360852003, sum: 28316.177734375
2025-09-24 13:11:06 [INFO]  g_protos_std: 1.005997657775879
2025-09-24 13:11:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8339
2025-09-24 13:11:10 [INFO]  Round 34 starts--------|
2025-09-24 13:12:23 [INFO]  Model variance: mean: 0.002577297855168581, sum: 28798.6015625
2025-09-24 13:12:23 [INFO]  g_protos_std: 1.0060027837753296
2025-09-24 13:12:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8396
2025-09-24 13:12:27 [INFO]  Round 35 starts--------|
2025-09-24 13:13:41 [INFO]  Model variance: mean: 0.002621112624183297, sum: 29288.1875
2025-09-24 13:13:41 [INFO]  g_protos_std: 1.0060110092163086
2025-09-24 13:13:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8367


2025-09-24 12:27:48 [INFO]  Load config from ./configs/CIFAR10_alpha0.1.yaml
2025-09-24 12:27:48 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.1', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.1}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:27:51 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:27:51 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 12:27:51 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:27:51 [INFO]  OneshotOurs
2025-09-24 12:27:51 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 12:27:51 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 12:27:51 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 12:27:53 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 12:27:55 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 12:27:56 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 12:27:58 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 12:27:59 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 12:28:01 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 12:28:02 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 12:28:04 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 12:28:05 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 12:28:07 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 12:28:08 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 12:28:10 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 12:28:11 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 12:28:13 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 12:28:14 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 12:28:16 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 12:28:17 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 12:28:19 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 12:28:21 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 12:28:22 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 12:28:22 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 12:28:23 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 12:28:23 [INFO]  Round 0 starts--------|
2025-09-24 12:30:59 [INFO]  Model variance: mean: 0.000502876122482121, sum: 5619.11328125
2025-09-24 12:30:59 [INFO]  g_protos_std: 1.0060404539108276
2025-09-24 12:31:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.2422
2025-09-24 12:31:04 [INFO]  Round 1 starts--------|
2025-09-24 12:32:17 [INFO]  Model variance: mean: 0.0006572466809302568, sum: 7344.04296875
2025-09-24 12:32:17 [INFO]  g_protos_std: 1.0060268640518188
2025-09-24 12:32:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3239
2025-09-24 12:32:21 [INFO]  Round 2 starts--------|
2025-09-24 12:33:37 [INFO]  Model variance: mean: 0.0007738421554677188, sum: 8646.875
2025-09-24 12:33:37 [INFO]  g_protos_std: 1.0060220956802368
2025-09-24 12:33:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3465
2025-09-24 12:33:42 [INFO]  Round 3 starts--------|
2025-09-24 12:34:53 [INFO]  Model variance: mean: 0.0008736987365409732, sum: 9762.66796875
2025-09-24 12:34:53 [INFO]  g_protos_std: 1.0060155391693115
2025-09-24 12:34:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3957
2025-09-24 12:34:57 [INFO]  Round 4 starts--------|
2025-09-24 12:36:11 [INFO]  Model variance: mean: 0.0009604982915334404, sum: 10732.5615234375
2025-09-24 12:36:11 [INFO]  g_protos_std: 1.0060064792633057
2025-09-24 12:36:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4219
2025-09-24 12:36:16 [INFO]  Round 5 starts--------|
2025-09-24 12:37:31 [INFO]  Model variance: mean: 0.0010419641621410847, sum: 11642.857421875
2025-09-24 12:37:31 [INFO]  g_protos_std: 1.0060019493103027
2025-09-24 12:37:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4584
2025-09-24 12:37:35 [INFO]  Round 6 starts--------|
2025-09-24 12:38:48 [INFO]  Model variance: mean: 0.0011195028200745583, sum: 12509.2705078125
2025-09-24 12:38:48 [INFO]  g_protos_std: 1.0060006380081177
2025-09-24 12:38:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4718
2025-09-24 12:38:52 [INFO]  Round 7 starts--------|
2025-09-24 12:40:05 [INFO]  Model variance: mean: 0.0011904092971235514, sum: 13301.576171875
2025-09-24 12:40:05 [INFO]  g_protos_std: 1.00600004196167
2025-09-24 12:40:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4681
2025-09-24 12:40:10 [INFO]  Round 8 starts--------|
2025-09-24 12:41:23 [INFO]  Model variance: mean: 0.0012587480014190078, sum: 14065.189453125
2025-09-24 12:41:23 [INFO]  g_protos_std: 1.005998134613037
2025-09-24 12:41:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5154
2025-09-24 12:41:27 [INFO]  Round 9 starts--------|
2025-09-24 12:42:39 [INFO]  Model variance: mean: 0.001322382129728794, sum: 14776.234375
2025-09-24 12:42:39 [INFO]  g_protos_std: 1.0059962272644043
2025-09-24 12:42:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.525
2025-09-24 12:42:44 [INFO]  Round 10 starts--------|
2025-09-24 12:44:00 [INFO]  Model variance: mean: 0.0013843162450939417, sum: 15468.283203125
2025-09-24 12:44:00 [INFO]  g_protos_std: 1.0060030221939087
2025-09-24 12:44:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5356
2025-09-24 12:44:05 [INFO]  Round 11 starts--------|
2025-09-24 12:45:18 [INFO]  Model variance: mean: 0.0014435227494686842, sum: 16129.853515625
2025-09-24 12:45:18 [INFO]  g_protos_std: 1.005999207496643
2025-09-24 12:45:22 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5635
2025-09-24 12:45:22 [INFO]  Round 12 starts--------|
2025-09-24 12:46:36 [INFO]  Model variance: mean: 0.0015009428607299924, sum: 16771.462890625
2025-09-24 12:46:36 [INFO]  g_protos_std: 1.006005048751831
2025-09-24 12:46:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5658
2025-09-24 12:46:41 [INFO]  Round 13 starts--------|
2025-09-24 12:47:54 [INFO]  Model variance: mean: 0.0015562445623800159, sum: 17389.40234375
2025-09-24 12:47:54 [INFO]  g_protos_std: 1.0060110092163086
2025-09-24 12:47:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5753
2025-09-24 12:47:58 [INFO]  Round 14 starts--------|
2025-09-24 12:49:12 [INFO]  Model variance: mean: 0.0016086205141618848, sum: 17974.6484375
2025-09-24 12:49:12 [INFO]  g_protos_std: 1.0060136318206787
2025-09-24 12:49:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5706
2025-09-24 12:49:16 [INFO]  Round 15 starts--------|
2025-09-24 12:50:33 [INFO]  Model variance: mean: 0.0016608524601906538, sum: 18558.28515625
2025-09-24 12:50:33 [INFO]  g_protos_std: 1.006018877029419
2025-09-24 12:50:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5917
2025-09-24 12:50:38 [INFO]  Round 16 starts--------|
2025-09-24 12:51:51 [INFO]  Model variance: mean: 0.0017118541290983558, sum: 19128.17578125
2025-09-24 12:51:51 [INFO]  g_protos_std: 1.0060259103775024
2025-09-24 12:51:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.607
2025-09-24 12:51:55 [INFO]  Round 17 starts--------|
2025-09-24 12:53:09 [INFO]  Model variance: mean: 0.0017604840686544776, sum: 19671.564453125
2025-09-24 12:53:09 [INFO]  g_protos_std: 1.0060336589813232
2025-09-24 12:53:13 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6053
2025-09-24 12:53:13 [INFO]  Round 18 starts--------|
2025-09-24 12:54:26 [INFO]  Model variance: mean: 0.001808138913474977, sum: 20204.056640625
2025-09-24 12:54:26 [INFO]  g_protos_std: 1.006040096282959
2025-09-24 12:54:31 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6193
2025-09-24 12:54:31 [INFO]  Round 19 starts--------|
2025-09-24 12:55:44 [INFO]  Model variance: mean: 0.00185419712215662, sum: 20718.708984375
2025-09-24 12:55:44 [INFO]  g_protos_std: 1.0060495138168335
2025-09-24 12:55:49 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6184
2025-09-24 12:55:49 [INFO]  Round 20 starts--------|
2025-09-24 12:57:04 [INFO]  Model variance: mean: 0.0019010014366358519, sum: 21241.69921875
2025-09-24 12:57:04 [INFO]  g_protos_std: 1.0060595273971558
2025-09-24 12:57:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6467
2025-09-24 12:57:09 [INFO]  Round 21 starts--------|
2025-09-24 12:58:23 [INFO]  Model variance: mean: 0.0019457966554909945, sum: 21742.23828125
2025-09-24 12:58:23 [INFO]  g_protos_std: 1.0060689449310303
2025-09-24 12:58:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6364
2025-09-24 12:58:27 [INFO]  Round 22 starts--------|
2025-09-24 12:59:40 [INFO]  Model variance: mean: 0.001990396063774824, sum: 22240.58984375
2025-09-24 12:59:40 [INFO]  g_protos_std: 1.006075143814087
2025-09-24 12:59:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6578
2025-09-24 12:59:44 [INFO]  Round 23 starts--------|
2025-09-24 13:00:58 [INFO]  Model variance: mean: 0.0020321449264883995, sum: 22707.08984375
2025-09-24 13:00:58 [INFO]  g_protos_std: 1.006085753440857
2025-09-24 13:01:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6592
2025-09-24 13:01:02 [INFO]  Round 24 starts--------|
2025-09-24 13:02:17 [INFO]  Model variance: mean: 0.002073148963972926, sum: 23165.267578125
2025-09-24 13:02:17 [INFO]  g_protos_std: 1.0060962438583374
2025-09-24 13:02:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6756
2025-09-24 13:02:21 [INFO]  Round 25 starts--------|
2025-09-24 13:03:35 [INFO]  Model variance: mean: 0.0021149294916540384, sum: 23632.12109375
2025-09-24 13:03:35 [INFO]  g_protos_std: 1.0061062574386597
2025-09-24 13:03:39 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6706
2025-09-24 13:03:39 [INFO]  Round 26 starts--------|
2025-09-24 13:04:53 [INFO]  Model variance: mean: 0.0021548813674598932, sum: 24078.541015625
2025-09-24 13:04:53 [INFO]  g_protos_std: 1.0061150789260864
2025-09-24 13:04:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6571
2025-09-24 13:04:57 [INFO]  Round 27 starts--------|
2025-09-24 13:06:11 [INFO]  Model variance: mean: 0.002194817643612623, sum: 24524.787109375
2025-09-24 13:06:11 [INFO]  g_protos_std: 1.0061266422271729
2025-09-24 13:06:15 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6837
2025-09-24 13:06:15 [INFO]  Round 28 starts--------|
2025-09-24 13:07:28 [INFO]  Model variance: mean: 0.0022336896508932114, sum: 24959.140625
2025-09-24 13:07:28 [INFO]  g_protos_std: 1.0061343908309937
2025-09-24 13:07:32 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6833
2025-09-24 13:07:32 [INFO]  Round 29 starts--------|
2025-09-24 13:08:45 [INFO]  Model variance: mean: 0.002271061297506094, sum: 25376.73046875
2025-09-24 13:08:45 [INFO]  g_protos_std: 1.0061463117599487
2025-09-24 13:08:49 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.703
2025-09-24 13:08:49 [INFO]  Round 30 starts--------|
2025-09-24 13:10:04 [INFO]  Model variance: mean: 0.002309354953467846, sum: 25804.62109375
2025-09-24 13:10:04 [INFO]  g_protos_std: 1.0061535835266113
2025-09-24 13:10:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6952
2025-09-24 13:10:08 [INFO]  Round 31 starts--------|
2025-09-24 13:11:22 [INFO]  Model variance: mean: 0.0023476555943489075, sum: 26232.58984375
2025-09-24 13:11:22 [INFO]  g_protos_std: 1.0061663389205933
2025-09-24 13:11:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7117
2025-09-24 13:11:26 [INFO]  Round 32 starts--------|
2025-09-24 13:12:39 [INFO]  Model variance: mean: 0.002384623046964407, sum: 26645.662109375
2025-09-24 13:12:39 [INFO]  g_protos_std: 1.0061767101287842
2025-09-24 13:12:43 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7157
2025-09-24 13:12:43 [INFO]  Round 33 starts--------|
2025-09-24 13:13:57 [INFO]  Model variance: mean: 0.0024205532390624285, sum: 27047.14453125
2025-09-24 13:13:57 [INFO]  g_protos_std: 1.006189227104187
2025-09-24 13:14:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7058
2025-09-24 13:14:02 [INFO]  Round 34 starts--------|
2025-09-24 13:15:17 [INFO]  Model variance: mean: 0.0024553341791033745, sum: 27435.787109375
2025-09-24 13:15:17 [INFO]  g_protos_std: 1.0061997175216675
2025-09-24 13:15:22 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7181
2025-09-24 13:15:22 [INFO]  Round 35 starts--------|
2025-09-24 13:16:38 [INFO]  Model variance: mean: 0.0024908597115427256, sum: 27832.74609375
2025-09-24 13:16:38 [INFO]  g_protos_std: 1.0062110424041748
2025-09-24 13:16:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7117


2025-09-24 12:27:53 [INFO]  Load config from ./configs/CIFAR10_alpha0.1.yaml
2025-09-24 12:27:53 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.1', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.1}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:27:54 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:27:54 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:27:55 [INFO]  OneshotOurs
2025-09-24 12:27:55 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 12:27:55 [INFO]  Round 0 starts--------|
2025-09-24 12:30:43 [INFO]  Model variance: mean: 0.0003975265717599541, sum: 4441.94287109375
2025-09-24 12:30:43 [INFO]  g_protos_std: 1.0059387683868408
2025-09-24 12:30:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4118
2025-09-24 12:30:47 [INFO]  Round 1 starts--------|
2025-09-24 12:32:10 [INFO]  Model variance: mean: 0.0005678538582287729, sum: 6345.171875
2025-09-24 12:32:10 [INFO]  g_protos_std: 1.0059130191802979
2025-09-24 12:32:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4831
2025-09-24 12:32:14 [INFO]  Round 2 starts--------|
2025-09-24 12:33:37 [INFO]  Model variance: mean: 0.0007059790077619255, sum: 7888.5751953125
2025-09-24 12:33:37 [INFO]  g_protos_std: 1.0059038400650024
2025-09-24 12:33:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5263
2025-09-24 12:33:41 [INFO]  Round 3 starts--------|
2025-09-24 12:35:01 [INFO]  Model variance: mean: 0.0008243070915341377, sum: 9210.767578125
2025-09-24 12:35:01 [INFO]  g_protos_std: 1.0058907270431519
2025-09-24 12:35:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5631
2025-09-24 12:35:05 [INFO]  Round 4 starts--------|
2025-09-24 12:36:28 [INFO]  Model variance: mean: 0.0009333017515018582, sum: 10428.6689453125
2025-09-24 12:36:28 [INFO]  g_protos_std: 1.005889892578125
2025-09-24 12:36:33 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5859
2025-09-24 12:36:33 [INFO]  Round 5 starts--------|
2025-09-24 12:37:57 [INFO]  Model variance: mean: 0.0010341777233406901, sum: 11555.8525390625
2025-09-24 12:37:57 [INFO]  g_protos_std: 1.0058897733688354
2025-09-24 12:38:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6164
2025-09-24 12:38:01 [INFO]  Round 6 starts--------|
2025-09-24 12:39:23 [INFO]  Model variance: mean: 0.001128766336478293, sum: 12612.78125
2025-09-24 12:39:23 [INFO]  g_protos_std: 1.005890130996704
2025-09-24 12:39:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6414
2025-09-24 12:39:27 [INFO]  Round 7 starts--------|
2025-09-24 12:40:48 [INFO]  Model variance: mean: 0.0012166997184976935, sum: 13595.34375
2025-09-24 12:40:48 [INFO]  g_protos_std: 1.0058873891830444
2025-09-24 12:40:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6515
2025-09-24 12:40:52 [INFO]  Round 8 starts--------|
2025-09-24 12:42:11 [INFO]  Model variance: mean: 0.001306700287386775, sum: 14601.005859375
2025-09-24 12:42:11 [INFO]  g_protos_std: 1.0058927536010742
2025-09-24 12:42:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6684
2025-09-24 12:42:16 [INFO]  Round 9 starts--------|
2025-09-24 12:43:37 [INFO]  Model variance: mean: 0.001394597697071731, sum: 15583.1669921875
2025-09-24 12:43:37 [INFO]  g_protos_std: 1.0058954954147339
2025-09-24 12:43:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6945
2025-09-24 12:43:42 [INFO]  Round 10 starts--------|
2025-09-24 12:45:05 [INFO]  Model variance: mean: 0.0014767057728022337, sum: 16500.638671875
2025-09-24 12:45:05 [INFO]  g_protos_std: 1.0058928728103638
2025-09-24 12:45:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7036
2025-09-24 12:45:09 [INFO]  Round 11 starts--------|
2025-09-24 12:46:31 [INFO]  Model variance: mean: 0.00155908043961972, sum: 17421.08984375
2025-09-24 12:46:31 [INFO]  g_protos_std: 1.0059001445770264
2025-09-24 12:46:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7187
2025-09-24 12:46:35 [INFO]  Round 12 starts--------|
2025-09-24 12:47:57 [INFO]  Model variance: mean: 0.001632501371204853, sum: 18241.4921875
2025-09-24 12:47:57 [INFO]  g_protos_std: 1.0058956146240234
2025-09-24 12:48:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7243
2025-09-24 12:48:01 [INFO]  Round 13 starts--------|
2025-09-24 12:49:23 [INFO]  Model variance: mean: 0.0017098478274419904, sum: 19105.7578125
2025-09-24 12:49:23 [INFO]  g_protos_std: 1.0058987140655518
2025-09-24 12:49:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7336
2025-09-24 12:49:27 [INFO]  Round 14 starts--------|
2025-09-24 12:50:48 [INFO]  Model variance: mean: 0.0017845046240836382, sum: 19939.96875
2025-09-24 12:50:48 [INFO]  g_protos_std: 1.0058989524841309
2025-09-24 12:50:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7463
2025-09-24 12:50:53 [INFO]  Round 15 starts--------|
2025-09-24 12:52:16 [INFO]  Model variance: mean: 0.0018555071437731385, sum: 20733.34765625
2025-09-24 12:52:16 [INFO]  g_protos_std: 1.0058984756469727
2025-09-24 12:52:20 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.756
2025-09-24 12:52:20 [INFO]  Round 16 starts--------|
2025-09-24 12:53:42 [INFO]  Model variance: mean: 0.0019221807597205043, sum: 21478.35546875
2025-09-24 12:53:42 [INFO]  g_protos_std: 1.0058883428573608
2025-09-24 12:53:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7607
2025-09-24 12:53:47 [INFO]  Round 17 starts--------|
2025-09-24 12:55:07 [INFO]  Model variance: mean: 0.001992275472730398, sum: 22261.58984375
2025-09-24 12:55:07 [INFO]  g_protos_std: 1.0059012174606323
2025-09-24 12:55:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7741
2025-09-24 12:55:11 [INFO]  Round 18 starts--------|
2025-09-24 12:56:31 [INFO]  Model variance: mean: 0.0020566268358379602, sum: 22980.6484375
2025-09-24 12:56:31 [INFO]  g_protos_std: 1.005894422531128
2025-09-24 12:56:36 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7753
2025-09-24 12:56:36 [INFO]  Round 19 starts--------|
2025-09-24 12:57:56 [INFO]  Model variance: mean: 0.002121244790032506, sum: 23702.6875
2025-09-24 12:57:56 [INFO]  g_protos_std: 1.0058982372283936
2025-09-24 12:58:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.787
2025-09-24 12:58:00 [INFO]  Round 20 starts--------|
2025-09-24 12:59:24 [INFO]  Model variance: mean: 0.002184966579079628, sum: 24414.7109375
2025-09-24 12:59:24 [INFO]  g_protos_std: 1.0058989524841309
2025-09-24 12:59:28 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7839
2025-09-24 12:59:28 [INFO]  Round 21 starts--------|
2025-09-24 13:00:49 [INFO]  Model variance: mean: 0.002246858086436987, sum: 25106.28515625
2025-09-24 13:00:49 [INFO]  g_protos_std: 1.005900502204895
2025-09-24 13:00:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7988
2025-09-24 13:00:53 [INFO]  Round 22 starts--------|
2025-09-24 13:02:14 [INFO]  Model variance: mean: 0.002308756113052368, sum: 25797.9296875
2025-09-24 13:02:14 [INFO]  g_protos_std: 1.0059067010879517
2025-09-24 13:02:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8024
2025-09-24 13:02:18 [INFO]  Round 23 starts--------|
2025-09-24 13:03:39 [INFO]  Model variance: mean: 0.002364933956414461, sum: 26425.658203125
2025-09-24 13:03:39 [INFO]  g_protos_std: 1.0059033632278442
2025-09-24 13:03:43 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7993
2025-09-24 13:03:43 [INFO]  Round 24 starts--------|
2025-09-24 13:05:04 [INFO]  Model variance: mean: 0.0024237679317593575, sum: 27083.06640625
2025-09-24 13:05:04 [INFO]  g_protos_std: 1.0059086084365845
2025-09-24 13:05:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8055
2025-09-24 13:05:09 [INFO]  Round 25 starts--------|
2025-09-24 13:06:32 [INFO]  Model variance: mean: 0.002480483381077647, sum: 27716.80078125
2025-09-24 13:06:32 [INFO]  g_protos_std: 1.0059183835983276
2025-09-24 13:06:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.808
2025-09-24 13:06:37 [INFO]  Round 26 starts--------|
2025-09-24 13:07:58 [INFO]  Model variance: mean: 0.002535347593948245, sum: 28329.8515625
2025-09-24 13:07:58 [INFO]  g_protos_std: 1.0059187412261963
2025-09-24 13:08:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.812
2025-09-24 13:08:03 [INFO]  Round 27 starts--------|
2025-09-24 13:09:26 [INFO]  Model variance: mean: 0.0025898669846355915, sum: 28939.048828125
2025-09-24 13:09:26 [INFO]  g_protos_std: 1.005920648574829
2025-09-24 13:09:30 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8218
2025-09-24 13:09:30 [INFO]  Round 28 starts--------|
2025-09-24 13:10:51 [INFO]  Model variance: mean: 0.002641984261572361, sum: 29521.40625
2025-09-24 13:10:51 [INFO]  g_protos_std: 1.0059221982955933
2025-09-24 13:10:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8211
2025-09-24 13:10:55 [INFO]  Round 29 starts--------|
2025-09-24 13:12:16 [INFO]  Model variance: mean: 0.00269450806081295, sum: 30108.302734375
2025-09-24 13:12:16 [INFO]  g_protos_std: 1.005925178527832
2025-09-24 13:12:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8207
2025-09-24 13:12:21 [INFO]  Round 30 starts--------|
2025-09-24 13:13:45 [INFO]  Model variance: mean: 0.002747409977018833, sum: 30699.42578125
2025-09-24 13:13:45 [INFO]  g_protos_std: 1.005933165550232
2025-09-24 13:13:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.825
2025-09-24 13:13:50 [INFO]  Round 31 starts--------|
2025-09-24 13:15:13 [INFO]  Model variance: mean: 0.00279799266718328, sum: 31264.634765625
2025-09-24 13:15:13 [INFO]  g_protos_std: 1.005940556526184
2025-09-24 13:15:17 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8253
2025-09-24 13:15:17 [INFO]  Round 32 starts--------|
2025-09-24 13:16:40 [INFO]  Model variance: mean: 0.002847624709829688, sum: 31819.22265625
2025-09-24 13:16:40 [INFO]  g_protos_std: 1.0059412717819214
2025-09-24 13:16:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8289
2025-09-24 13:16:44 [INFO]  Round 33 starts--------|
2025-09-24 13:18:06 [INFO]  Model variance: mean: 0.002896709833294153, sum: 32367.6953125
2025-09-24 13:18:06 [INFO]  g_protos_std: 1.0059480667114258
2025-09-24 13:18:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8303
2025-09-24 13:18:10 [INFO]  Round 34 starts--------|
2025-09-24 13:19:32 [INFO]  Model variance: mean: 0.0029461977537721395, sum: 32920.671875
2025-09-24 13:19:32 [INFO]  g_protos_std: 1.0059549808502197
2025-09-24 13:19:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8327
2025-09-24 13:19:37 [INFO]  Round 35 starts--------|
2025-09-24 13:21:01 [INFO]  Model variance: mean: 0.002993958769366145, sum: 33454.3515625
2025-09-24 13:21:01 [INFO]  g_protos_std: 1.005961537361145
2025-09-24 13:21:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8373


2025-09-24 12:28:04 [INFO]  Load config from ./configs/CIFAR10_alpha0.3.yaml
2025-09-24 12:28:04 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.3', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.3}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:28:06 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:28:06 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 12:28:06 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:28:06 [INFO]  OneshotOurs
2025-09-24 12:28:06 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 12:28:06 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 12:28:07 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 12:28:09 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 12:28:10 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 12:28:12 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 12:28:13 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 12:28:15 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 12:28:16 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 12:28:18 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 12:28:19 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 12:28:21 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 12:28:22 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 12:28:24 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 12:28:25 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 12:28:27 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 12:28:29 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 12:28:30 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 12:28:32 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 12:28:33 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 12:28:35 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 12:28:37 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 12:28:38 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 12:28:38 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 12:28:39 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 12:28:39 [INFO]  Round 0 starts--------|
2025-09-24 12:31:56 [INFO]  Model variance: mean: 0.000586625246796757, sum: 6554.92236328125
2025-09-24 12:31:56 [INFO]  g_protos_std: 1.0059475898742676
2025-09-24 12:32:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3529
2025-09-24 12:32:00 [INFO]  Round 1 starts--------|
2025-09-24 12:33:54 [INFO]  Model variance: mean: 0.000788278819527477, sum: 8808.189453125
2025-09-24 12:33:54 [INFO]  g_protos_std: 1.0059254169464111
2025-09-24 12:33:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3944
2025-09-24 12:33:58 [INFO]  Round 2 starts--------|
2025-09-24 12:35:49 [INFO]  Model variance: mean: 0.0009477502899244428, sum: 10590.1162109375
2025-09-24 12:35:49 [INFO]  g_protos_std: 1.0059195756912231
2025-09-24 12:35:54 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4463
2025-09-24 12:35:54 [INFO]  Round 3 starts--------|
2025-09-24 12:37:49 [INFO]  Model variance: mean: 0.0010800051968544722, sum: 12067.92578125
2025-09-24 12:37:49 [INFO]  g_protos_std: 1.0059198141098022
2025-09-24 12:37:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4708
2025-09-24 12:37:53 [INFO]  Round 4 starts--------|
2025-09-24 12:39:49 [INFO]  Model variance: mean: 0.0012024559546262026, sum: 13436.185546875
2025-09-24 12:39:49 [INFO]  g_protos_std: 1.0059235095977783
2025-09-24 12:39:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4832
2025-09-24 12:39:53 [INFO]  Round 5 starts--------|
2025-09-24 12:41:50 [INFO]  Model variance: mean: 0.0013181210961192846, sum: 14728.6220703125
2025-09-24 12:41:50 [INFO]  g_protos_std: 1.0059242248535156
2025-09-24 12:41:54 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5306
2025-09-24 12:41:54 [INFO]  Round 6 starts--------|
2025-09-24 12:43:48 [INFO]  Model variance: mean: 0.0014273787382990122, sum: 15949.4609375
2025-09-24 12:43:48 [INFO]  g_protos_std: 1.0059247016906738
2025-09-24 12:43:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5487
2025-09-24 12:43:53 [INFO]  Round 7 starts--------|
2025-09-24 12:45:50 [INFO]  Model variance: mean: 0.0015318449586629868, sum: 17116.76171875
2025-09-24 12:45:50 [INFO]  g_protos_std: 1.0059317350387573
2025-09-24 12:45:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5584
2025-09-24 12:45:55 [INFO]  Round 8 starts--------|
2025-09-24 12:47:52 [INFO]  Model variance: mean: 0.0016324392054229975, sum: 18240.796875
2025-09-24 12:47:52 [INFO]  g_protos_std: 1.0059363842010498
2025-09-24 12:47:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.599
2025-09-24 12:47:57 [INFO]  Round 9 starts--------|
2025-09-24 12:49:54 [INFO]  Model variance: mean: 0.0017273700796067715, sum: 19301.55078125
2025-09-24 12:49:54 [INFO]  g_protos_std: 1.0059431791305542
2025-09-24 12:49:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6056
2025-09-24 12:49:58 [INFO]  Round 10 starts--------|
2025-09-24 12:51:56 [INFO]  Model variance: mean: 0.0018167374655604362, sum: 20300.13671875
2025-09-24 12:51:56 [INFO]  g_protos_std: 1.005950927734375
2025-09-24 12:52:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.625
2025-09-24 12:52:01 [INFO]  Round 11 starts--------|
2025-09-24 12:53:55 [INFO]  Model variance: mean: 0.001903287135064602, sum: 21267.23828125
2025-09-24 12:53:55 [INFO]  g_protos_std: 1.0059635639190674
2025-09-24 12:53:59 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6458
2025-09-24 12:53:59 [INFO]  Round 12 starts--------|
2025-09-24 12:55:54 [INFO]  Model variance: mean: 0.0019869573879987, sum: 22202.166015625
2025-09-24 12:55:54 [INFO]  g_protos_std: 1.005979299545288
2025-09-24 12:55:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6633
2025-09-24 12:55:58 [INFO]  Round 13 starts--------|
2025-09-24 12:57:53 [INFO]  Model variance: mean: 0.0020668506622314453, sum: 23094.890625
2025-09-24 12:57:53 [INFO]  g_protos_std: 1.0059906244277954
2025-09-24 12:57:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.662
2025-09-24 12:57:58 [INFO]  Round 14 starts--------|
2025-09-24 12:59:52 [INFO]  Model variance: mean: 0.0021462971344590187, sum: 23982.62109375
2025-09-24 12:59:52 [INFO]  g_protos_std: 1.0060087442398071
2025-09-24 12:59:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6747
2025-09-24 12:59:57 [INFO]  Round 15 starts--------|
2025-09-24 13:01:56 [INFO]  Model variance: mean: 0.0022219552192837, sum: 24828.021484375
2025-09-24 13:01:56 [INFO]  g_protos_std: 1.0060198307037354
2025-09-24 13:02:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6815
2025-09-24 13:02:01 [INFO]  Round 16 starts--------|
2025-09-24 13:03:57 [INFO]  Model variance: mean: 0.002295067999511957, sum: 25644.978515625
2025-09-24 13:03:57 [INFO]  g_protos_std: 1.006030797958374
2025-09-24 13:04:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.697
2025-09-24 13:04:01 [INFO]  Round 17 starts--------|
2025-09-24 13:05:58 [INFO]  Model variance: mean: 0.002366116503253579, sum: 26438.87109375
2025-09-24 13:05:58 [INFO]  g_protos_std: 1.006052851676941
2025-09-24 13:06:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6994
2025-09-24 13:06:02 [INFO]  Round 18 starts--------|
2025-09-24 13:07:58 [INFO]  Model variance: mean: 0.002435751259326935, sum: 27216.966796875
2025-09-24 13:07:58 [INFO]  g_protos_std: 1.0060722827911377
2025-09-24 13:08:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.694
2025-09-24 13:08:03 [INFO]  Round 19 starts--------|
2025-09-24 13:09:58 [INFO]  Model variance: mean: 0.002505047246813774, sum: 27991.27734375
2025-09-24 13:09:58 [INFO]  g_protos_std: 1.0060954093933105
2025-09-24 13:10:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7104
2025-09-24 13:10:03 [INFO]  Round 20 starts--------|
2025-09-24 13:11:59 [INFO]  Model variance: mean: 0.0025707280728965998, sum: 28725.19140625
2025-09-24 13:11:59 [INFO]  g_protos_std: 1.0061105489730835
2025-09-24 13:12:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7267
2025-09-24 13:12:04 [INFO]  Round 21 starts--------|
2025-09-24 13:14:00 [INFO]  Model variance: mean: 0.002635569078847766, sum: 29449.72265625
2025-09-24 13:14:00 [INFO]  g_protos_std: 1.006133794784546
2025-09-24 13:14:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7147
2025-09-24 13:14:04 [INFO]  Round 22 starts--------|
2025-09-24 13:16:01 [INFO]  Model variance: mean: 0.002698038937523961, sum: 30147.7578125
2025-09-24 13:16:01 [INFO]  g_protos_std: 1.0061582326889038
2025-09-24 13:16:06 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7369
2025-09-24 13:16:06 [INFO]  Round 23 starts--------|
2025-09-24 13:18:02 [INFO]  Model variance: mean: 0.0027609532698988914, sum: 30850.7578125
2025-09-24 13:18:02 [INFO]  g_protos_std: 1.0061793327331543
2025-09-24 13:18:06 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7357
2025-09-24 13:18:06 [INFO]  Round 24 starts--------|
2025-09-24 13:20:06 [INFO]  Model variance: mean: 0.002822526264935732, sum: 31538.7734375
2025-09-24 13:20:06 [INFO]  g_protos_std: 1.006203055381775
2025-09-24 13:20:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7394
2025-09-24 13:20:11 [INFO]  Round 25 starts--------|
2025-09-24 13:22:12 [INFO]  Model variance: mean: 0.002882979577407241, sum: 32214.275390625
2025-09-24 13:22:12 [INFO]  g_protos_std: 1.0062271356582642
2025-09-24 13:22:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7412
2025-09-24 13:22:16 [INFO]  Round 26 starts--------|
2025-09-24 13:24:14 [INFO]  Model variance: mean: 0.0029425823595374823, sum: 32880.2734375
2025-09-24 13:24:14 [INFO]  g_protos_std: 1.006250023841858
2025-09-24 13:24:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7565
2025-09-24 13:24:19 [INFO]  Round 27 starts--------|
2025-09-24 13:26:17 [INFO]  Model variance: mean: 0.0030006705783307552, sum: 33529.34765625
2025-09-24 13:26:17 [INFO]  g_protos_std: 1.0062777996063232
2025-09-24 13:26:22 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7467
2025-09-24 13:26:22 [INFO]  Round 28 starts--------|
2025-09-24 13:28:21 [INFO]  Model variance: mean: 0.0030588845256716013, sum: 34179.828125
2025-09-24 13:28:21 [INFO]  g_protos_std: 1.0063042640686035
2025-09-24 13:28:25 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.771
2025-09-24 13:28:25 [INFO]  Round 29 starts--------|
2025-09-24 13:30:25 [INFO]  Model variance: mean: 0.0031148698180913925, sum: 34805.40625
2025-09-24 13:30:25 [INFO]  g_protos_std: 1.0063239336013794
2025-09-24 13:30:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7685
2025-09-24 13:30:29 [INFO]  Round 30 starts--------|
2025-09-24 13:32:31 [INFO]  Model variance: mean: 0.003170247655361891, sum: 35424.1953125
2025-09-24 13:32:31 [INFO]  g_protos_std: 1.0063464641571045
2025-09-24 13:32:36 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7681
2025-09-24 13:32:36 [INFO]  Round 31 starts--------|
2025-09-24 13:34:36 [INFO]  Model variance: mean: 0.0032246948685497046, sum: 36032.5859375
2025-09-24 13:34:36 [INFO]  g_protos_std: 1.0063731670379639
2025-09-24 13:34:40 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7785
2025-09-24 13:34:40 [INFO]  Round 32 starts--------|
2025-09-24 13:36:38 [INFO]  Model variance: mean: 0.0032792966812849045, sum: 36642.703125
2025-09-24 13:36:38 [INFO]  g_protos_std: 1.0064011812210083
2025-09-24 13:36:42 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7654
2025-09-24 13:36:42 [INFO]  Round 33 starts--------|
2025-09-24 13:38:40 [INFO]  Model variance: mean: 0.003332228399813175, sum: 37234.16015625
2025-09-24 13:38:40 [INFO]  g_protos_std: 1.0064197778701782
2025-09-24 13:38:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7852
2025-09-24 13:38:44 [INFO]  Round 34 starts--------|
2025-09-24 13:40:42 [INFO]  Model variance: mean: 0.00338478060439229, sum: 37821.375
2025-09-24 13:40:42 [INFO]  g_protos_std: 1.0064436197280884
2025-09-24 13:40:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7792
2025-09-24 13:40:46 [INFO]  Round 35 starts--------|
2025-09-24 13:42:44 [INFO]  Model variance: mean: 0.0034369078930467367, sum: 38403.84375
2025-09-24 13:42:44 [INFO]  g_protos_std: 1.0064752101898193
2025-09-24 13:42:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7799


2025-09-24 12:28:10 [INFO]  Load config from ./configs/CIFAR10_alpha0.3.yaml
2025-09-24 12:28:10 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.3', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.3}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:28:12 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:28:12 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:28:12 [INFO]  OneshotOurs
2025-09-24 12:28:13 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 12:28:13 [INFO]  Round 0 starts--------|
2025-09-24 12:31:32 [INFO]  Model variance: mean: 0.0004708556516561657, sum: 5261.318359375
2025-09-24 12:31:32 [INFO]  g_protos_std: 1.0059016942977905
2025-09-24 12:31:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4316
2025-09-24 12:31:37 [INFO]  Round 1 starts--------|
2025-09-24 12:33:28 [INFO]  Model variance: mean: 0.0006910296506248415, sum: 7721.5322265625
2025-09-24 12:33:28 [INFO]  g_protos_std: 1.0058693885803223
2025-09-24 12:33:33 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5066
2025-09-24 12:33:33 [INFO]  Round 2 starts--------|
2025-09-24 12:35:21 [INFO]  Model variance: mean: 0.00086908572120592, sum: 9711.1220703125
2025-09-24 12:35:21 [INFO]  g_protos_std: 1.0058587789535522
2025-09-24 12:35:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5623
2025-09-24 12:35:26 [INFO]  Round 3 starts--------|
2025-09-24 12:37:13 [INFO]  Model variance: mean: 0.0010186887811869383, sum: 11382.779296875
2025-09-24 12:37:13 [INFO]  g_protos_std: 1.0058419704437256
2025-09-24 12:37:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5954
2025-09-24 12:37:18 [INFO]  Round 4 starts--------|
2025-09-24 12:39:08 [INFO]  Model variance: mean: 0.0011597891571000218, sum: 12959.427734375
2025-09-24 12:39:08 [INFO]  g_protos_std: 1.0058420896530151
2025-09-24 12:39:12 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6306
2025-09-24 12:39:12 [INFO]  Round 5 starts--------|
2025-09-24 12:41:01 [INFO]  Model variance: mean: 0.0012947256909683347, sum: 14467.203125
2025-09-24 12:41:01 [INFO]  g_protos_std: 1.0058516263961792
2025-09-24 12:41:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6652
2025-09-24 12:41:05 [INFO]  Round 6 starts--------|
2025-09-24 12:42:53 [INFO]  Model variance: mean: 0.0014149938942864537, sum: 15811.07421875
2025-09-24 12:42:53 [INFO]  g_protos_std: 1.0058438777923584
2025-09-24 12:42:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6761
2025-09-24 12:42:57 [INFO]  Round 7 starts--------|
2025-09-24 12:44:47 [INFO]  Model variance: mean: 0.001534581882879138, sum: 17147.34375
2025-09-24 12:44:47 [INFO]  g_protos_std: 1.0058473348617554
2025-09-24 12:44:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6951
2025-09-24 12:44:51 [INFO]  Round 8 starts--------|
2025-09-24 12:46:42 [INFO]  Model variance: mean: 0.001648880890570581, sum: 18424.515625
2025-09-24 12:46:42 [INFO]  g_protos_std: 1.0058461427688599
2025-09-24 12:46:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7199
2025-09-24 12:46:46 [INFO]  Round 9 starts--------|
2025-09-24 12:48:33 [INFO]  Model variance: mean: 0.0017596558900550008, sum: 19662.310546875
2025-09-24 12:48:33 [INFO]  g_protos_std: 1.0058444738388062
2025-09-24 12:48:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7323
2025-09-24 12:48:38 [INFO]  Round 10 starts--------|
2025-09-24 12:50:30 [INFO]  Model variance: mean: 0.0018681720830500126, sum: 20874.865234375
2025-09-24 12:50:30 [INFO]  g_protos_std: 1.005846381187439
2025-09-24 12:50:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7455
2025-09-24 12:50:34 [INFO]  Round 11 starts--------|
2025-09-24 12:52:21 [INFO]  Model variance: mean: 0.0019680331461131573, sum: 21990.70703125
2025-09-24 12:52:21 [INFO]  g_protos_std: 1.0058411359786987
2025-09-24 12:52:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7577
2025-09-24 12:52:26 [INFO]  Round 12 starts--------|
2025-09-24 12:54:14 [INFO]  Model variance: mean: 0.002067605732008815, sum: 23103.328125
2025-09-24 12:54:14 [INFO]  g_protos_std: 1.0058417320251465
2025-09-24 12:54:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7677
2025-09-24 12:54:19 [INFO]  Round 13 starts--------|
2025-09-24 12:56:08 [INFO]  Model variance: mean: 0.00216317200101912, sum: 24171.1796875
2025-09-24 12:56:08 [INFO]  g_protos_std: 1.005845069885254
2025-09-24 12:56:12 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7766
2025-09-24 12:56:12 [INFO]  Round 14 starts--------|
2025-09-24 12:58:03 [INFO]  Model variance: mean: 0.002253262558951974, sum: 25177.84765625
2025-09-24 12:58:03 [INFO]  g_protos_std: 1.0058356523513794
2025-09-24 12:58:07 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.781
2025-09-24 12:58:07 [INFO]  Round 15 starts--------|
2025-09-24 12:59:59 [INFO]  Model variance: mean: 0.0023421323858201504, sum: 26170.875
2025-09-24 12:59:59 [INFO]  g_protos_std: 1.0058388710021973
2025-09-24 13:00:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7939
2025-09-24 13:00:04 [INFO]  Round 16 starts--------|
2025-09-24 13:01:53 [INFO]  Model variance: mean: 0.002429243642836809, sum: 27144.251953125
2025-09-24 13:01:53 [INFO]  g_protos_std: 1.0058388710021973
2025-09-24 13:01:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7973
2025-09-24 13:01:58 [INFO]  Round 17 starts--------|
2025-09-24 13:03:47 [INFO]  Model variance: mean: 0.0025132782757282257, sum: 28083.25
2025-09-24 13:03:47 [INFO]  g_protos_std: 1.0058324337005615
2025-09-24 13:03:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8006
2025-09-24 13:03:52 [INFO]  Round 18 starts--------|
2025-09-24 13:05:42 [INFO]  Model variance: mean: 0.0025961152277886868, sum: 29008.8671875
2025-09-24 13:05:42 [INFO]  g_protos_std: 1.0058369636535645
2025-09-24 13:05:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8055
2025-09-24 13:05:46 [INFO]  Round 19 starts--------|
2025-09-24 13:07:36 [INFO]  Model variance: mean: 0.0026766574010252953, sum: 29908.841796875
2025-09-24 13:07:36 [INFO]  g_protos_std: 1.0058403015136719
2025-09-24 13:07:40 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8166
2025-09-24 13:07:40 [INFO]  Round 20 starts--------|
2025-09-24 13:09:33 [INFO]  Model variance: mean: 0.0027569730300456285, sum: 30806.28515625
2025-09-24 13:09:33 [INFO]  g_protos_std: 1.0058512687683105
2025-09-24 13:09:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8192
2025-09-24 13:09:37 [INFO]  Round 21 starts--------|
2025-09-24 13:11:28 [INFO]  Model variance: mean: 0.002834922866895795, sum: 31677.291015625
2025-09-24 13:11:28 [INFO]  g_protos_std: 1.005865454673767
2025-09-24 13:11:32 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.82
2025-09-24 13:11:32 [INFO]  Round 22 starts--------|
2025-09-24 13:13:23 [INFO]  Model variance: mean: 0.0029082426335662603, sum: 32496.5625
2025-09-24 13:13:23 [INFO]  g_protos_std: 1.005853295326233
2025-09-24 13:13:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8224
2025-09-24 13:13:27 [INFO]  Round 23 starts--------|
2025-09-24 13:15:19 [INFO]  Model variance: mean: 0.002982984995469451, sum: 33331.73046875
2025-09-24 13:15:19 [INFO]  g_protos_std: 1.0058635473251343
2025-09-24 13:15:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8286
2025-09-24 13:15:23 [INFO]  Round 24 starts--------|
2025-09-24 13:17:15 [INFO]  Model variance: mean: 0.0030559503939002752, sum: 34147.04296875
2025-09-24 13:17:15 [INFO]  g_protos_std: 1.005872130393982
2025-09-24 13:17:20 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8306
2025-09-24 13:17:20 [INFO]  Round 25 starts--------|
2025-09-24 13:19:16 [INFO]  Model variance: mean: 0.003127767238765955, sum: 34949.51953125
2025-09-24 13:19:16 [INFO]  g_protos_std: 1.005886435508728
2025-09-24 13:19:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8363
2025-09-24 13:19:21 [INFO]  Round 26 starts--------|
2025-09-24 13:21:13 [INFO]  Model variance: mean: 0.0031953139696270227, sum: 35704.28515625
2025-09-24 13:21:13 [INFO]  g_protos_std: 1.005884051322937
2025-09-24 13:21:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.837
2025-09-24 13:21:18 [INFO]  Round 27 starts--------|
2025-09-24 13:23:11 [INFO]  Model variance: mean: 0.003263612277805805, sum: 36467.4453125
2025-09-24 13:23:11 [INFO]  g_protos_std: 1.0058945417404175
2025-09-24 13:23:15 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8413
2025-09-24 13:23:15 [INFO]  Round 28 starts--------|
2025-09-24 13:25:07 [INFO]  Model variance: mean: 0.0033319152425974607, sum: 37230.66015625
2025-09-24 13:25:07 [INFO]  g_protos_std: 1.005908727645874
2025-09-24 13:25:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8415
2025-09-24 13:25:11 [INFO]  Round 29 starts--------|
2025-09-24 13:27:02 [INFO]  Model variance: mean: 0.0033988766372203827, sum: 37978.8828125
2025-09-24 13:27:02 [INFO]  g_protos_std: 1.0059250593185425
2025-09-24 13:27:06 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.848
2025-09-24 13:27:06 [INFO]  Round 30 starts--------|
2025-09-24 13:28:59 [INFO]  Model variance: mean: 0.00346251018345356, sum: 38689.921875
2025-09-24 13:28:59 [INFO]  g_protos_std: 1.0059244632720947
2025-09-24 13:29:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8501
2025-09-24 13:29:03 [INFO]  Round 31 starts--------|
2025-09-24 13:30:55 [INFO]  Model variance: mean: 0.00352520402520895, sum: 39390.4609375
2025-09-24 13:30:55 [INFO]  g_protos_std: 1.00593101978302
2025-09-24 13:31:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8491
2025-09-24 13:31:00 [INFO]  Round 32 starts--------|
2025-09-24 13:32:50 [INFO]  Model variance: mean: 0.003587415674701333, sum: 40085.609375
2025-09-24 13:32:50 [INFO]  g_protos_std: 1.0059328079223633
2025-09-24 13:32:54 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8512
2025-09-24 13:32:54 [INFO]  Round 33 starts--------|
2025-09-24 13:34:47 [INFO]  Model variance: mean: 0.0036489712074398994, sum: 40773.4296875
2025-09-24 13:34:47 [INFO]  g_protos_std: 1.005942702293396
2025-09-24 13:34:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8553
2025-09-24 13:34:51 [INFO]  Round 34 starts--------|
2025-09-24 13:36:42 [INFO]  Model variance: mean: 0.003711173078045249, sum: 41468.46875
2025-09-24 13:36:42 [INFO]  g_protos_std: 1.0059648752212524
2025-09-24 13:36:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8583
2025-09-24 13:36:47 [INFO]  Round 35 starts--------|
2025-09-24 13:38:39 [INFO]  Model variance: mean: 0.003771287389099598, sum: 42140.18359375
2025-09-24 13:38:39 [INFO]  g_protos_std: 1.0059728622436523
2025-09-24 13:38:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8602


2025-09-24 12:28:16 [INFO]  Load config from ./configs/CIFAR10_alpha0.5.yaml
2025-09-24 12:28:16 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.5', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.5}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:28:18 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:28:18 [INFO]  Dataset split: 45000 samples for private clients, 5000 for public pool.
2025-09-24 12:28:18 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:28:18 [INFO]  OneshotOurs
2025-09-24 12:28:19 [INFO]  Public feature bank strategy is ENABLED.
2025-09-24 12:28:19 [INFO]  Initializing teacher model for pre-training on public data.
2025-09-24 12:28:19 [INFO]  Starting teacher model pre-training for 20 epochs...
2025-09-24 12:28:21 [INFO]  Teacher pre-train epoch 1/20, Loss: 2.1400
2025-09-24 12:28:23 [INFO]  Teacher pre-train epoch 2/20, Loss: 1.6752
2025-09-24 12:28:24 [INFO]  Teacher pre-train epoch 3/20, Loss: 1.3908
2025-09-24 12:28:26 [INFO]  Teacher pre-train epoch 4/20, Loss: 1.1216
2025-09-24 12:28:27 [INFO]  Teacher pre-train epoch 5/20, Loss: 0.8087
2025-09-24 12:28:29 [INFO]  Teacher pre-train epoch 6/20, Loss: 0.4810
2025-09-24 12:28:30 [INFO]  Teacher pre-train epoch 7/20, Loss: 0.2685
2025-09-24 12:28:32 [INFO]  Teacher pre-train epoch 8/20, Loss: 0.1152
2025-09-24 12:28:34 [INFO]  Teacher pre-train epoch 9/20, Loss: 0.0431
2025-09-24 12:28:35 [INFO]  Teacher pre-train epoch 10/20, Loss: 0.0185
2025-09-24 12:28:37 [INFO]  Teacher pre-train epoch 11/20, Loss: 0.0085
2025-09-24 12:28:39 [INFO]  Teacher pre-train epoch 12/20, Loss: 0.0050
2025-09-24 12:28:40 [INFO]  Teacher pre-train epoch 13/20, Loss: 0.0033
2025-09-24 12:28:42 [INFO]  Teacher pre-train epoch 14/20, Loss: 0.0026
2025-09-24 12:28:44 [INFO]  Teacher pre-train epoch 15/20, Loss: 0.0022
2025-09-24 12:28:45 [INFO]  Teacher pre-train epoch 16/20, Loss: 0.0019
2025-09-24 12:28:47 [INFO]  Teacher pre-train epoch 17/20, Loss: 0.0017
2025-09-24 12:28:49 [INFO]  Teacher pre-train epoch 18/20, Loss: 0.0016
2025-09-24 12:28:51 [INFO]  Teacher pre-train epoch 19/20, Loss: 0.0015
2025-09-24 12:28:52 [INFO]  Teacher pre-train epoch 20/20, Loss: 0.0014
2025-09-24 12:28:52 [INFO]  Teacher pre-training finished. Generating public feature bank...
2025-09-24 12:28:54 [INFO]  Public feature bank created with size: torch.Size([4096, 512])
2025-09-24 12:28:54 [INFO]  Round 0 starts--------|
2025-09-24 12:32:27 [INFO]  Model variance: mean: 0.0006363727152347565, sum: 7110.7978515625
2025-09-24 12:32:27 [INFO]  g_protos_std: 1.0059372186660767
2025-09-24 12:32:32 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3813
2025-09-24 12:32:32 [INFO]  Round 1 starts--------|
2025-09-24 12:34:47 [INFO]  Model variance: mean: 0.000888900482095778, sum: 9932.53125
2025-09-24 12:34:47 [INFO]  g_protos_std: 1.0059071779251099
2025-09-24 12:34:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4243
2025-09-24 12:34:51 [INFO]  Round 2 starts--------|
2025-09-24 12:37:06 [INFO]  Model variance: mean: 0.0010873846476897597, sum: 12150.3837890625
2025-09-24 12:37:06 [INFO]  g_protos_std: 1.0059155225753784
2025-09-24 12:37:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4913
2025-09-24 12:37:11 [INFO]  Round 3 starts--------|
2025-09-24 12:39:27 [INFO]  Model variance: mean: 0.0012441800208762288, sum: 13902.4072265625
2025-09-24 12:39:27 [INFO]  g_protos_std: 1.0059199333190918
2025-09-24 12:39:32 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5334
2025-09-24 12:39:32 [INFO]  Round 4 starts--------|
2025-09-24 12:41:46 [INFO]  Model variance: mean: 0.0013923299266025424, sum: 15557.8271484375
2025-09-24 12:41:46 [INFO]  g_protos_std: 1.0059361457824707
2025-09-24 12:41:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5634
2025-09-24 12:41:50 [INFO]  Round 5 starts--------|
2025-09-24 12:44:07 [INFO]  Model variance: mean: 0.001526830019429326, sum: 17060.724609375
2025-09-24 12:44:07 [INFO]  g_protos_std: 1.005947232246399
2025-09-24 12:44:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5977
2025-09-24 12:44:11 [INFO]  Round 6 starts--------|
2025-09-24 12:46:31 [INFO]  Model variance: mean: 0.0016583745600655675, sum: 18530.59765625
2025-09-24 12:46:31 [INFO]  g_protos_std: 1.0059618949890137
2025-09-24 12:46:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6464
2025-09-24 12:46:35 [INFO]  Round 7 starts--------|
2025-09-24 12:48:56 [INFO]  Model variance: mean: 0.0017775725573301315, sum: 19862.509765625
2025-09-24 12:48:56 [INFO]  g_protos_std: 1.005974531173706
2025-09-24 12:49:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6592
2025-09-24 12:49:01 [INFO]  Round 8 starts--------|
2025-09-24 12:51:19 [INFO]  Model variance: mean: 0.0018933896208181977, sum: 21156.64453125
2025-09-24 12:51:19 [INFO]  g_protos_std: 1.0059984922409058
2025-09-24 12:51:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6824
2025-09-24 12:51:23 [INFO]  Round 9 starts--------|
2025-09-24 12:53:42 [INFO]  Model variance: mean: 0.0020026452839374542, sum: 22377.4609375
2025-09-24 12:53:42 [INFO]  g_protos_std: 1.0060224533081055
2025-09-24 12:53:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7051
2025-09-24 12:53:47 [INFO]  Round 10 starts--------|
2025-09-24 12:56:05 [INFO]  Model variance: mean: 0.0021069792564958334, sum: 23543.28515625
2025-09-24 12:56:05 [INFO]  g_protos_std: 1.0060360431671143
2025-09-24 12:56:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7243
2025-09-24 12:56:10 [INFO]  Round 11 starts--------|
2025-09-24 12:58:25 [INFO]  Model variance: mean: 0.0022062293719500303, sum: 24652.30078125
2025-09-24 12:58:25 [INFO]  g_protos_std: 1.0060527324676514
2025-09-24 12:58:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7201
2025-09-24 12:58:29 [INFO]  Round 12 starts--------|
2025-09-24 13:00:45 [INFO]  Model variance: mean: 0.002301944186910987, sum: 25721.814453125
2025-09-24 13:00:45 [INFO]  g_protos_std: 1.0060791969299316
2025-09-24 13:00:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7351
2025-09-24 13:00:50 [INFO]  Round 13 starts--------|
2025-09-24 13:03:04 [INFO]  Model variance: mean: 0.002393509494140744, sum: 26744.958984375
2025-09-24 13:03:04 [INFO]  g_protos_std: 1.0061019659042358
2025-09-24 13:03:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7493
2025-09-24 13:03:09 [INFO]  Round 14 starts--------|
2025-09-24 13:05:26 [INFO]  Model variance: mean: 0.0024836277589201927, sum: 27751.9375
2025-09-24 13:05:26 [INFO]  g_protos_std: 1.0061213970184326
2025-09-24 13:05:31 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7637
2025-09-24 13:05:31 [INFO]  Round 15 starts--------|
2025-09-24 13:07:49 [INFO]  Model variance: mean: 0.0025675040669739246, sum: 28689.166015625
2025-09-24 13:07:49 [INFO]  g_protos_std: 1.0061365365982056
2025-09-24 13:07:54 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7589
2025-09-24 13:07:54 [INFO]  Round 16 starts--------|
2025-09-24 13:10:12 [INFO]  Model variance: mean: 0.0026507412549108267, sum: 29619.255859375
2025-09-24 13:10:12 [INFO]  g_protos_std: 1.0061626434326172
2025-09-24 13:10:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7692
2025-09-24 13:10:16 [INFO]  Round 17 starts--------|
2025-09-24 13:12:33 [INFO]  Model variance: mean: 0.002732244087383151, sum: 30529.96484375
2025-09-24 13:12:33 [INFO]  g_protos_std: 1.006183385848999
2025-09-24 13:12:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7775
2025-09-24 13:12:38 [INFO]  Round 18 starts--------|
2025-09-24 13:14:59 [INFO]  Model variance: mean: 0.002813003957271576, sum: 31432.37109375
2025-09-24 13:14:59 [INFO]  g_protos_std: 1.006211280822754
2025-09-24 13:15:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7843
2025-09-24 13:15:03 [INFO]  Round 19 starts--------|
2025-09-24 13:17:23 [INFO]  Model variance: mean: 0.00288971746340394, sum: 32289.564453125
2025-09-24 13:17:23 [INFO]  g_protos_std: 1.006234049797058
2025-09-24 13:17:28 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7919
2025-09-24 13:17:28 [INFO]  Round 20 starts--------|
2025-09-24 13:19:52 [INFO]  Model variance: mean: 0.0029656989499926567, sum: 33138.578125
2025-09-24 13:19:52 [INFO]  g_protos_std: 1.0062651634216309
2025-09-24 13:19:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8014
2025-09-24 13:19:57 [INFO]  Round 21 starts--------|
2025-09-24 13:22:18 [INFO]  Model variance: mean: 0.00304030510596931, sum: 33972.22265625
2025-09-24 13:22:18 [INFO]  g_protos_std: 1.0062896013259888
2025-09-24 13:22:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7976
2025-09-24 13:22:23 [INFO]  Round 22 starts--------|
2025-09-24 13:24:46 [INFO]  Model variance: mean: 0.003113251645117998, sum: 34787.32421875
2025-09-24 13:24:46 [INFO]  g_protos_std: 1.0063142776489258
2025-09-24 13:24:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8052
2025-09-24 13:24:51 [INFO]  Round 23 starts--------|
2025-09-24 13:27:11 [INFO]  Model variance: mean: 0.003184101078659296, sum: 35578.9921875
2025-09-24 13:27:11 [INFO]  g_protos_std: 1.0063445568084717
2025-09-24 13:27:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8149
2025-09-24 13:27:16 [INFO]  Round 24 starts--------|
2025-09-24 13:29:38 [INFO]  Model variance: mean: 0.003252228954806924, sum: 36340.25
2025-09-24 13:29:38 [INFO]  g_protos_std: 1.006368637084961
2025-09-24 13:29:43 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8206
2025-09-24 13:29:43 [INFO]  Round 25 starts--------|
2025-09-24 13:32:06 [INFO]  Model variance: mean: 0.0033195570576936007, sum: 37092.5703125
2025-09-24 13:32:06 [INFO]  g_protos_std: 1.0063971281051636
2025-09-24 13:32:11 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8217
2025-09-24 13:32:11 [INFO]  Round 26 starts--------|
2025-09-24 13:34:32 [INFO]  Model variance: mean: 0.0033877911046147346, sum: 37855.015625
2025-09-24 13:34:32 [INFO]  g_protos_std: 1.0064290761947632
2025-09-24 13:34:36 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8221
2025-09-24 13:34:36 [INFO]  Round 27 starts--------|
2025-09-24 13:36:58 [INFO]  Model variance: mean: 0.0034531259443610907, sum: 38585.0625
2025-09-24 13:36:58 [INFO]  g_protos_std: 1.006450891494751
2025-09-24 13:37:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8254
2025-09-24 13:37:02 [INFO]  Round 28 starts--------|
2025-09-24 13:39:23 [INFO]  Model variance: mean: 0.0035183564759790897, sum: 39313.9453125
2025-09-24 13:39:23 [INFO]  g_protos_std: 1.0064809322357178
2025-09-24 13:39:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8313
2025-09-24 13:39:27 [INFO]  Round 29 starts--------|
2025-09-24 13:41:48 [INFO]  Model variance: mean: 0.003582378849387169, sum: 40029.328125
2025-09-24 13:41:48 [INFO]  g_protos_std: 1.0065168142318726
2025-09-24 13:41:53 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8357
2025-09-24 13:41:53 [INFO]  Round 30 starts--------|
2025-09-24 13:44:18 [INFO]  Model variance: mean: 0.0036438351962715387, sum: 40716.0390625
2025-09-24 13:44:18 [INFO]  g_protos_std: 1.0065425634384155
2025-09-24 13:44:22 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8365
2025-09-24 13:44:22 [INFO]  Round 31 starts--------|
2025-09-24 13:46:46 [INFO]  Model variance: mean: 0.003706300398334861, sum: 41414.0234375
2025-09-24 13:46:46 [INFO]  g_protos_std: 1.0065714120864868
2025-09-24 13:46:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8403
2025-09-24 13:46:51 [INFO]  Round 32 starts--------|
2025-09-24 13:49:14 [INFO]  Model variance: mean: 0.003767287125810981, sum: 42095.484375
2025-09-24 13:49:14 [INFO]  g_protos_std: 1.0066028833389282
2025-09-24 13:49:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8443
2025-09-24 13:49:18 [INFO]  Round 33 starts--------|
2025-09-24 13:51:43 [INFO]  Model variance: mean: 0.003826376749202609, sum: 42755.75
2025-09-24 13:51:43 [INFO]  g_protos_std: 1.0066331624984741
2025-09-24 13:51:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8434
2025-09-24 13:51:47 [INFO]  Round 34 starts--------|
2025-09-24 13:54:10 [INFO]  Model variance: mean: 0.0038849161937832832, sum: 43409.8671875
2025-09-24 13:54:10 [INFO]  g_protos_std: 1.0066587924957275
2025-09-24 13:54:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.845
2025-09-24 13:54:14 [INFO]  Round 35 starts--------|
2025-09-24 13:56:40 [INFO]  Model variance: mean: 0.0039437985979020596, sum: 44067.81640625
2025-09-24 13:56:40 [INFO]  g_protos_std: 1.006691575050354
2025-09-24 13:56:45 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.847


2025-09-24 12:28:22 [INFO]  Load config from ./configs/CIFAR10_alpha0.5.yaml
2025-09-24 12:28:22 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.5', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.5}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'ours_v5_params': {'use_public_feature_bank': True, 'public_data_ratio': 0.1, 'feature_bank_size': 4096, 'teacher_pretrain_epochs': 20}}
2025-09-24 12:28:24 [INFO]  Dataset CIFAR10 loaded
2025-09-24 12:28:24 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10_private.pt
2025-09-24 12:28:24 [INFO]  OneshotOurs
2025-09-24 12:28:24 [INFO]  Public feature bank strategy is DISABLED.
2025-09-24 12:28:24 [INFO]  Round 0 starts--------|
2025-09-24 12:32:21 [INFO]  Model variance: mean: 0.0005199358565732837, sum: 5809.73828125
2025-09-24 12:32:21 [INFO]  g_protos_std: 1.0058971643447876
2025-09-24 12:32:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4621
2025-09-24 12:32:26 [INFO]  Round 1 starts--------|
2025-09-24 12:34:47 [INFO]  Model variance: mean: 0.0007588904118165374, sum: 8479.8046875
2025-09-24 12:34:47 [INFO]  g_protos_std: 1.0058462619781494
2025-09-24 12:34:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5235
2025-09-24 12:34:51 [INFO]  Round 2 starts--------|
2025-09-24 12:37:05 [INFO]  Model variance: mean: 0.0009582174243405461, sum: 10707.0751953125
2025-09-24 12:37:05 [INFO]  g_protos_std: 1.005833625793457
2025-09-24 12:37:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5779
2025-09-24 12:37:10 [INFO]  Round 3 starts--------|
2025-09-24 12:39:34 [INFO]  Model variance: mean: 0.0011304516810923815, sum: 12631.6123046875
2025-09-24 12:39:34 [INFO]  g_protos_std: 1.0058223009109497
2025-09-24 12:39:40 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6164
2025-09-24 12:39:40 [INFO]  Round 4 starts--------|
2025-09-24 12:42:05 [INFO]  Model variance: mean: 0.0012851106002926826, sum: 14359.763671875
2025-09-24 12:42:05 [INFO]  g_protos_std: 1.0058228969573975
2025-09-24 12:42:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6525
2025-09-24 12:42:10 [INFO]  Round 5 starts--------|
2025-09-24 12:44:37 [INFO]  Model variance: mean: 0.001432768302038312, sum: 16009.68359375
2025-09-24 12:44:37 [INFO]  g_protos_std: 1.005815863609314
2025-09-24 12:44:43 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6822
2025-09-24 12:44:43 [INFO]  Round 6 starts--------|
2025-09-24 12:47:10 [INFO]  Model variance: mean: 0.001573299872688949, sum: 17579.9765625
2025-09-24 12:47:10 [INFO]  g_protos_std: 1.0058181285858154
2025-09-24 12:47:16 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7085
2025-09-24 12:47:16 [INFO]  Round 7 starts--------|
2025-09-24 12:49:41 [INFO]  Model variance: mean: 0.0017052784096449614, sum: 19054.69921875
2025-09-24 12:49:41 [INFO]  g_protos_std: 1.0058090686798096
2025-09-24 12:49:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7216
2025-09-24 12:49:47 [INFO]  Round 8 starts--------|
2025-09-24 12:52:12 [INFO]  Model variance: mean: 0.001832145731896162, sum: 20472.30859375
2025-09-24 12:52:12 [INFO]  g_protos_std: 1.005807638168335
2025-09-24 12:52:17 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.739
2025-09-24 12:52:17 [INFO]  Round 9 starts--------|
2025-09-24 12:54:43 [INFO]  Model variance: mean: 0.001953252824023366, sum: 21825.552734375
2025-09-24 12:54:43 [INFO]  g_protos_std: 1.0058029890060425
2025-09-24 12:54:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7546
2025-09-24 12:54:48 [INFO]  Round 10 starts--------|
2025-09-24 12:57:19 [INFO]  Model variance: mean: 0.0020697633735835552, sum: 23127.435546875
2025-09-24 12:57:19 [INFO]  g_protos_std: 1.0058050155639648
2025-09-24 12:57:24 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7659
2025-09-24 12:57:24 [INFO]  Round 11 starts--------|
2025-09-24 12:59:51 [INFO]  Model variance: mean: 0.002182738622650504, sum: 24389.81640625
2025-09-24 12:59:51 [INFO]  g_protos_std: 1.00579833984375
2025-09-24 12:59:56 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7744
2025-09-24 12:59:56 [INFO]  Round 12 starts--------|
2025-09-24 13:02:23 [INFO]  Model variance: mean: 0.0022927436511963606, sum: 25619.0078125
2025-09-24 13:02:23 [INFO]  g_protos_std: 1.0057984590530396
2025-09-24 13:02:28 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7852
2025-09-24 13:02:28 [INFO]  Round 13 starts--------|
2025-09-24 13:04:53 [INFO]  Model variance: mean: 0.0023985288571566343, sum: 26801.046875
2025-09-24 13:04:53 [INFO]  g_protos_std: 1.0057986974716187
2025-09-24 13:04:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7964
2025-09-24 13:04:58 [INFO]  Round 14 starts--------|
2025-09-24 13:07:24 [INFO]  Model variance: mean: 0.0024976118002086878, sum: 27908.193359375
2025-09-24 13:07:24 [INFO]  g_protos_std: 1.0057944059371948
2025-09-24 13:07:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.797
2025-09-24 13:07:29 [INFO]  Round 15 starts--------|
2025-09-24 13:09:58 [INFO]  Model variance: mean: 0.0025956439785659313, sum: 29003.6015625
2025-09-24 13:09:58 [INFO]  g_protos_std: 1.0057939291000366
2025-09-24 13:10:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8074
2025-09-24 13:10:03 [INFO]  Round 16 starts--------|
2025-09-24 13:12:32 [INFO]  Model variance: mean: 0.002690701512619853, sum: 30065.76953125
2025-09-24 13:12:32 [INFO]  g_protos_std: 1.0057928562164307
2025-09-24 13:12:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8112
2025-09-24 13:12:37 [INFO]  Round 17 starts--------|
2025-09-24 13:15:04 [INFO]  Model variance: mean: 0.002784027485176921, sum: 31108.58984375
2025-09-24 13:15:04 [INFO]  g_protos_std: 1.0058032274246216
2025-09-24 13:15:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8216
2025-09-24 13:15:10 [INFO]  Round 18 starts--------|
2025-09-24 13:17:35 [INFO]  Model variance: mean: 0.00287296948954463, sum: 32102.421875
2025-09-24 13:17:35 [INFO]  g_protos_std: 1.0058037042617798
2025-09-24 13:17:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8253
2025-09-24 13:17:41 [INFO]  Round 19 starts--------|
2025-09-24 13:20:08 [INFO]  Model variance: mean: 0.0029611801728606224, sum: 33088.0859375
2025-09-24 13:20:08 [INFO]  g_protos_std: 1.0058084726333618
2025-09-24 13:20:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8258
2025-09-24 13:20:14 [INFO]  Round 20 starts--------|
2025-09-24 13:22:43 [INFO]  Model variance: mean: 0.003045187331736088, sum: 34026.77734375
2025-09-24 13:22:43 [INFO]  g_protos_std: 1.005804419517517
2025-09-24 13:22:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8347
2025-09-24 13:22:48 [INFO]  Round 21 starts--------|
2025-09-24 13:25:14 [INFO]  Model variance: mean: 0.0031297069508582354, sum: 34971.1953125
2025-09-24 13:25:14 [INFO]  g_protos_std: 1.0058095455169678
2025-09-24 13:25:20 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8357
2025-09-24 13:25:20 [INFO]  Round 22 starts--------|
2025-09-24 13:27:47 [INFO]  Model variance: mean: 0.0032158223912119865, sum: 35933.4453125
2025-09-24 13:27:47 [INFO]  g_protos_std: 1.0058300495147705
2025-09-24 13:27:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.84
2025-09-24 13:27:52 [INFO]  Round 23 starts--------|
2025-09-24 13:30:18 [INFO]  Model variance: mean: 0.0032962977420538664, sum: 36832.671875
2025-09-24 13:30:18 [INFO]  g_protos_std: 1.0058338642120361
2025-09-24 13:30:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8442
2025-09-24 13:30:23 [INFO]  Round 24 starts--------|
2025-09-24 13:32:49 [INFO]  Model variance: mean: 0.0033755144104361534, sum: 37717.8359375
2025-09-24 13:32:49 [INFO]  g_protos_std: 1.0058388710021973
2025-09-24 13:32:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8477
2025-09-24 13:32:55 [INFO]  Round 25 starts--------|
2025-09-24 13:35:25 [INFO]  Model variance: mean: 0.003453001379966736, sum: 38583.671875
2025-09-24 13:35:25 [INFO]  g_protos_std: 1.0058504343032837
2025-09-24 13:35:30 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8528
2025-09-24 13:35:30 [INFO]  Round 26 starts--------|
2025-09-24 13:37:59 [INFO]  Model variance: mean: 0.0035279400181025267, sum: 39421.03125
2025-09-24 13:37:59 [INFO]  g_protos_std: 1.0058544874191284
2025-09-24 13:38:04 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8544
2025-09-24 13:38:04 [INFO]  Round 27 starts--------|
2025-09-24 13:40:30 [INFO]  Model variance: mean: 0.0036033333744853735, sum: 40263.47265625
2025-09-24 13:40:30 [INFO]  g_protos_std: 1.0058735609054565
2025-09-24 13:40:36 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8576
2025-09-24 13:40:36 [INFO]  Round 28 starts--------|
2025-09-24 13:43:03 [INFO]  Model variance: mean: 0.003677169792354107, sum: 41088.51953125
2025-09-24 13:43:03 [INFO]  g_protos_std: 1.0058841705322266
2025-09-24 13:43:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.856
2025-09-24 13:43:08 [INFO]  Round 29 starts--------|
2025-09-24 13:45:38 [INFO]  Model variance: mean: 0.003749227849766612, sum: 41893.69140625
2025-09-24 13:45:38 [INFO]  g_protos_std: 1.005892276763916
2025-09-24 13:45:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.862
2025-09-24 13:45:44 [INFO]  Round 30 starts--------|
2025-09-24 13:48:16 [INFO]  Model variance: mean: 0.003818749450147152, sum: 42670.5234375
2025-09-24 13:48:16 [INFO]  g_protos_std: 1.0058951377868652
2025-09-24 13:48:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8615
2025-09-24 13:48:21 [INFO]  Round 31 starts--------|
2025-09-24 13:50:49 [INFO]  Model variance: mean: 0.0038891553413122892, sum: 43457.234375
2025-09-24 13:50:49 [INFO]  g_protos_std: 1.0059113502502441
2025-09-24 13:50:54 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8617
2025-09-24 13:50:54 [INFO]  Round 32 starts--------|
2025-09-24 13:53:21 [INFO]  Model variance: mean: 0.00395975774154067, sum: 44246.14453125
2025-09-24 13:53:21 [INFO]  g_protos_std: 1.005932092666626
2025-09-24 13:53:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8657
2025-09-24 13:53:27 [INFO]  Round 33 starts--------|
2025-09-24 13:55:55 [INFO]  Model variance: mean: 0.004027428105473518, sum: 45002.2890625
2025-09-24 13:55:55 [INFO]  g_protos_std: 1.005945086479187
2025-09-24 13:56:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8711
2025-09-24 13:56:00 [INFO]  Round 34 starts--------|
2025-09-24 13:58:28 [INFO]  Model variance: mean: 0.004094115924090147, sum: 45747.453125
2025-09-24 13:58:28 [INFO]  g_protos_std: 1.0059534311294556
2025-09-24 13:58:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.87
2025-09-24 13:58:34 [INFO]  Round 35 starts--------|
2025-09-24 14:01:04 [INFO]  Model variance: mean: 0.004159904550760984, sum: 46482.57421875
2025-09-24 14:01:04 [INFO]  g_protos_std: 1.0059674978256226
2025-09-24 14:01:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8707
