2025-09-22 01:41:59 [INFO]  Load config from ./configs/CIFAR10_alpha0.5.yaml
2025-09-22 01:41:59 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.5', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.5}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1}
2025-09-22 01:42:01 [INFO]  Dataset CIFAR10 loaded
2025-09-22 01:42:01 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10.pt
2025-09-22 01:42:01 [INFO]  OneshotOurs
2025-09-22 01:42:01 [INFO]  Round 0 starts--------|
2025-09-22 01:42:01 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:42:08 [INFO]  generating sample per sample
2025-09-22 01:42:46 [INFO]  Epoch 0 loss: 803.3915758132935; train accuracy: 0.17801706414473684; test accuracy: 0.1595
2025-09-22 01:42:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_0.pth
2025-09-22 01:42:46 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:42:46 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:42:46 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:42:51 [INFO]  generating sample per sample
2025-09-22 01:43:21 [INFO]  Epoch 0 loss: 636.832350730896; train accuracy: 0.2784463205645161; test accuracy: 0.1879
2025-09-22 01:43:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_0.pth
2025-09-22 01:43:21 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:43:21 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:43:21 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:43:26 [INFO]  generating sample per sample
2025-09-22 01:43:55 [INFO]  Epoch 0 loss: 617.2233991622925; train accuracy: 0.22299299568965517; test accuracy: 0.1711
2025-09-22 01:43:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_0.pth
2025-09-22 01:43:55 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:43:55 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:43:55 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:44:02 [INFO]  generating sample per sample
2025-09-22 01:44:37 [INFO]  Epoch 0 loss: 744.4165391921997; train accuracy: 0.2752007378472222; test accuracy: 0.2092
2025-09-22 01:44:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_0.pth
2025-09-22 01:44:37 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:44:37 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:44:37 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:44:40 [INFO]  generating sample per sample
2025-09-22 01:45:00 [INFO]  Epoch 0 loss: 405.5735912322998; train accuracy: 0.24864783653846154; test accuracy: 0.1008
2025-09-22 01:45:00 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_0.pth
2025-09-22 01:45:00 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:45:00 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:45:00 [INFO]  Round 0 Finish--------|
2025-09-22 01:45:00 [INFO]  Model variance: mean: 0.0006606917013414204, sum: 7382.537109375
2025-09-22 01:45:00 [INFO]  g_protos_std: 1.0059521198272705
2025-09-22 01:45:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4045
2025-09-22 01:45:05 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:45:05 [INFO]  Round 1 starts--------|
2025-09-22 01:45:05 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:45:50 [INFO]  Epoch 1 loss: 730.8546028137207; train accuracy: 0.2543688322368421; test accuracy: 0.2164
2025-09-22 01:45:50 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:45:50 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:45:50 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:46:27 [INFO]  Epoch 1 loss: 588.8147954940796; train accuracy: 0.2993006552419355; test accuracy: 0.1924
2025-09-22 01:46:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:46:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:46:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:47:08 [INFO]  Epoch 1 loss: 580.4913473129272; train accuracy: 0.29509024784482757; test accuracy: 0.2203
2025-09-22 01:47:08 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:47:08 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:47:08 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:48:00 [INFO]  Epoch 1 loss: 690.6891756057739; train accuracy: 0.2967122395833333; test accuracy: 0.2359
2025-09-22 01:48:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:48:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:48:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:48:29 [INFO]  Epoch 1 loss: 367.9693937301636; train accuracy: 0.28170072115384615; test accuracy: 0.1278
2025-09-22 01:48:29 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:48:29 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:48:29 [INFO]  Round 1 Finish--------|
2025-09-22 01:48:29 [INFO]  Model variance: mean: 0.0009094076813198626, sum: 10161.677734375
2025-09-22 01:48:29 [INFO]  g_protos_std: 1.0059329271316528
2025-09-22 01:48:36 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4704
2025-09-22 01:48:36 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:48:36 [INFO]  Round 2 starts--------|
2025-09-22 01:48:36 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:49:35 [INFO]  Epoch 2 loss: 701.0762042999268; train accuracy: 0.3697574013157895; test accuracy: 0.31
2025-09-22 01:49:35 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:49:35 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:49:35 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:50:23 [INFO]  Epoch 2 loss: 555.2493553161621; train accuracy: 0.4057459677419355; test accuracy: 0.2724
2025-09-22 01:50:23 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:50:23 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:50:23 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:51:11 [INFO]  Epoch 2 loss: 562.375002861023; train accuracy: 0.3697804418103448; test accuracy: 0.2651
2025-09-22 01:51:11 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:51:11 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:51:11 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:52:08 [INFO]  Epoch 2 loss: 661.3715257644653; train accuracy: 0.3331163194444444; test accuracy: 0.2675
2025-09-22 01:52:08 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:52:08 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:52:08 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:52:42 [INFO]  Epoch 2 loss: 358.38906478881836; train accuracy: 0.3088942307692308; test accuracy: 0.1407
2025-09-22 01:52:42 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:52:42 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:52:42 [INFO]  Round 2 Finish--------|
2025-09-22 01:52:42 [INFO]  Model variance: mean: 0.001115840976126492, sum: 12468.353515625
2025-09-22 01:52:42 [INFO]  g_protos_std: 1.0059382915496826
2025-09-22 01:52:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5277
2025-09-22 01:52:50 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:52:50 [INFO]  Round 3 starts--------|
2025-09-22 01:52:50 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:53:57 [INFO]  Epoch 3 loss: 680.2031307220459; train accuracy: 0.4187140213815789; test accuracy: 0.3822
2025-09-22 01:53:57 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:53:57 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:53:57 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:54:50 [INFO]  Epoch 3 loss: 545.5173377990723; train accuracy: 0.3358429939516129; test accuracy: 0.2204
2025-09-22 01:54:50 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:54:50 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:54:50 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:55:40 [INFO]  Epoch 3 loss: 546.9448881149292; train accuracy: 0.31122036637931033; test accuracy: 0.2207
2025-09-22 01:55:40 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:55:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:55:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:56:44 [INFO]  Epoch 3 loss: 637.1383543014526; train accuracy: 0.3554416232638889; test accuracy: 0.2783
2025-09-22 01:56:44 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:56:44 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:56:44 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:57:17 [INFO]  Epoch 3 loss: 342.42610454559326; train accuracy: 0.4436598557692308; test accuracy: 0.2182
2025-09-22 01:57:17 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:57:17 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:57:17 [INFO]  Round 3 Finish--------|
2025-09-22 01:57:17 [INFO]  Model variance: mean: 0.0012944680638611317, sum: 14464.32421875
2025-09-22 01:57:17 [INFO]  g_protos_std: 1.0059527158737183
2025-09-22 01:57:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5805
2025-09-22 01:57:26 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:57:26 [INFO]  Round 4 starts--------|
2025-09-22 01:57:26 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:58:28 [INFO]  Epoch 4 loss: 652.3286237716675; train accuracy: 0.5724712171052632; test accuracy: 0.488
2025-09-22 01:58:28 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:58:28 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:58:28 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:59:26 [INFO]  Epoch 4 loss: 529.0299263000488; train accuracy: 0.48724168346774194; test accuracy: 0.332
2025-09-22 01:59:26 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:59:26 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:59:26 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:00:20 [INFO]  Epoch 4 loss: 540.2950859069824; train accuracy: 0.5247844827586207; test accuracy: 0.3729
2025-09-22 02:00:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:00:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:00:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:01:26 [INFO]  Epoch 4 loss: 619.1359100341797; train accuracy: 0.5144856770833334; test accuracy: 0.405
2025-09-22 02:01:26 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:01:26 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:01:26 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:02:02 [INFO]  Epoch 4 loss: 334.16608905792236; train accuracy: 0.34289863782051283; test accuracy: 0.1576
2025-09-22 02:02:02 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:02:02 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:02:02 [INFO]  Round 4 Finish--------|
2025-09-22 02:02:02 [INFO]  Model variance: mean: 0.0014629008946940303, sum: 16346.384765625
2025-09-22 02:02:02 [INFO]  g_protos_std: 1.005957841873169
2025-09-22 02:02:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6241
2025-09-22 02:02:10 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:02:10 [INFO]  Round 5 starts--------|
2025-09-22 02:02:10 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:03:22 [INFO]  Epoch 5 loss: 623.701817035675; train accuracy: 0.5463096217105263; test accuracy: 0.4647
2025-09-22 02:03:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_5.pth
2025-09-22 02:03:22 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:03:22 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:03:22 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:04:17 [INFO]  Epoch 5 loss: 523.8673768043518; train accuracy: 0.4537550403225806; test accuracy: 0.2962
2025-09-22 02:04:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_5.pth
2025-09-22 02:04:17 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:04:17 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:04:17 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:05:10 [INFO]  Epoch 5 loss: 533.0204877853394; train accuracy: 0.4303273168103448; test accuracy: 0.3087
2025-09-22 02:05:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_5.pth
2025-09-22 02:05:10 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:05:10 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:05:10 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:06:14 [INFO]  Epoch 5 loss: 593.0172142982483; train accuracy: 0.4948187934027778; test accuracy: 0.3971
2025-09-22 02:06:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_5.pth
2025-09-22 02:06:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:06:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:06:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:06:53 [INFO]  Epoch 5 loss: 328.6977643966675; train accuracy: 0.39473157051282054; test accuracy: 0.1877
2025-09-22 02:06:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_5.pth
2025-09-22 02:06:53 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:06:53 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:06:53 [INFO]  Round 5 Finish--------|
2025-09-22 02:06:53 [INFO]  Model variance: mean: 0.001623345771804452, sum: 18139.1875
2025-09-22 02:06:53 [INFO]  g_protos_std: 1.0059674978256226
2025-09-22 02:07:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.646
2025-09-22 02:07:00 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:07:00 [INFO]  Round 6 starts--------|
2025-09-22 02:07:00 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:08:12 [INFO]  Epoch 6 loss: 619.0133929252625; train accuracy: 0.5401418585526315; test accuracy: 0.4533
2025-09-22 02:08:12 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:08:12 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:08:12 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:09:10 [INFO]  Epoch 6 loss: 510.923819065094; train accuracy: 0.5328881048387096; test accuracy: 0.3474
2025-09-22 02:09:10 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:09:10 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:09:10 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:10:05 [INFO]  Epoch 6 loss: 521.4373254776001; train accuracy: 0.5142780172413793; test accuracy: 0.3624
2025-09-22 02:10:05 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:10:05 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:10:05 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:11:14 [INFO]  Epoch 6 loss: 585.5653772354126; train accuracy: 0.5488823784722222; test accuracy: 0.4429
2025-09-22 02:11:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:11:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:11:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:11:58 [INFO]  Epoch 6 loss: 323.04301261901855; train accuracy: 0.42402844551282054; test accuracy: 0.2061
2025-09-22 02:11:58 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:11:58 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:11:58 [INFO]  Round 6 Finish--------|
2025-09-22 02:11:58 [INFO]  Model variance: mean: 0.0017701582983136177, sum: 19779.6640625
2025-09-22 02:11:58 [INFO]  g_protos_std: 1.005972146987915
2025-09-22 02:12:06 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6655
2025-09-22 02:12:06 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:12:06 [INFO]  Round 7 starts--------|
2025-09-22 02:12:06 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:13:21 [INFO]  Epoch 7 loss: 593.593891620636; train accuracy: 0.5275493421052632; test accuracy: 0.4466
2025-09-22 02:13:21 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:13:21 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:13:21 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:14:24 [INFO]  Epoch 7 loss: 499.03909635543823; train accuracy: 0.552702872983871; test accuracy: 0.3759
2025-09-22 02:14:24 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:14:24 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:14:24 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:15:25 [INFO]  Epoch 7 loss: 513.7467823028564; train accuracy: 0.41066136853448276; test accuracy: 0.3052
2025-09-22 02:15:25 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:15:25 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:15:25 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:16:35 [INFO]  Epoch 7 loss: 568.7533974647522; train accuracy: 0.505859375; test accuracy: 0.4227
2025-09-22 02:16:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:16:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:16:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:17:14 [INFO]  Epoch 7 loss: 317.87879037857056; train accuracy: 0.6577023237179487; test accuracy: 0.378
2025-09-22 02:17:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:17:14 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:17:14 [INFO]  Round 7 Finish--------|
2025-09-22 02:17:14 [INFO]  Model variance: mean: 0.0019122791709378362, sum: 21367.71484375
2025-09-22 02:17:14 [INFO]  g_protos_std: 1.0059881210327148
2025-09-22 02:17:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6901
2025-09-22 02:17:21 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:17:21 [INFO]  Round 8 starts--------|
2025-09-22 02:17:21 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:18:39 [INFO]  Epoch 8 loss: 591.5244083404541; train accuracy: 0.6782740542763158; test accuracy: 0.5919
2025-09-22 02:18:39 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:18:39 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:18:39 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:19:40 [INFO]  Epoch 8 loss: 495.11038303375244; train accuracy: 0.6688193044354839; test accuracy: 0.4508
2025-09-22 02:19:40 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:19:40 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:19:40 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:20:39 [INFO]  Epoch 8 loss: 494.88272047042847; train accuracy: 0.5704135237068966; test accuracy: 0.4062
2025-09-22 02:20:39 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:20:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:20:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:21:48 [INFO]  Epoch 8 loss: 551.413414478302; train accuracy: 0.4723307291666667; test accuracy: 0.4026
2025-09-22 02:21:48 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:21:48 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:21:48 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:22:27 [INFO]  Epoch 8 loss: 315.16362714767456; train accuracy: 0.5821814903846154; test accuracy: 0.2911
2025-09-22 02:22:27 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:22:27 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:22:27 [INFO]  Round 8 Finish--------|
2025-09-22 02:22:27 [INFO]  Model variance: mean: 0.002046928508207202, sum: 22872.28125
2025-09-22 02:22:27 [INFO]  g_protos_std: 1.0060091018676758
2025-09-22 02:22:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7146
2025-09-22 02:22:34 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:22:34 [INFO]  Round 9 starts--------|
2025-09-22 02:22:34 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:23:50 [INFO]  Epoch 9 loss: 574.840950012207; train accuracy: 0.6834138569078947; test accuracy: 0.5829
2025-09-22 02:23:50 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:23:50 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:23:50 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:24:51 [INFO]  Epoch 9 loss: 487.0430154800415; train accuracy: 0.5052608366935484; test accuracy: 0.3299
2025-09-22 02:24:51 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:24:51 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:24:51 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:25:49 [INFO]  Epoch 9 loss: 493.6210045814514; train accuracy: 0.5074084051724138; test accuracy: 0.3468
2025-09-22 02:25:49 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:25:49 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:25:49 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:27:00 [INFO]  Epoch 9 loss: 557.5688543319702; train accuracy: 0.6219075520833334; test accuracy: 0.5079
2025-09-22 02:27:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:27:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:27:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:27:41 [INFO]  Epoch 9 loss: 298.1132593154907; train accuracy: 0.6500901442307693; test accuracy: 0.3811
2025-09-22 02:27:41 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:27:41 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:27:41 [INFO]  Round 9 Finish--------|
2025-09-22 02:27:41 [INFO]  Model variance: mean: 0.0021751883905380964, sum: 24305.451171875
2025-09-22 02:27:41 [INFO]  g_protos_std: 1.0060187578201294
2025-09-22 02:27:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7282
2025-09-22 02:27:50 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:27:50 [INFO]  Round 10 starts--------|
2025-09-22 02:27:50 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:29:03 [INFO]  Epoch 10 loss: 559.9313855171204; train accuracy: 0.7379471628289473; test accuracy: 0.6212
2025-09-22 02:29:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_10.pth
2025-09-22 02:29:03 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:29:03 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:29:03 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:30:06 [INFO]  Epoch 10 loss: 481.48461866378784; train accuracy: 0.7130796370967742; test accuracy: 0.4905
2025-09-22 02:30:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_10.pth
2025-09-22 02:30:06 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:30:06 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:30:06 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:31:03 [INFO]  Epoch 10 loss: 490.0919885635376; train accuracy: 0.639581088362069; test accuracy: 0.477
2025-09-22 02:31:03 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_10.pth
2025-09-22 02:31:03 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:31:03 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:31:03 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:32:13 [INFO]  Epoch 10 loss: 551.7005243301392; train accuracy: 0.5072699652777778; test accuracy: 0.4277
2025-09-22 02:32:14 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_10.pth
2025-09-22 02:32:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:32:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:32:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:32:54 [INFO]  Epoch 10 loss: 303.80246448516846; train accuracy: 0.6754807692307693; test accuracy: 0.3882
2025-09-22 02:32:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_10.pth
2025-09-22 02:32:54 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:32:54 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:32:54 [INFO]  Round 10 Finish--------|
2025-09-22 02:32:54 [INFO]  Model variance: mean: 0.002296171383932233, sum: 25657.30859375
2025-09-22 02:32:54 [INFO]  g_protos_std: 1.0060259103775024
2025-09-22 02:33:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7366
2025-09-22 02:33:02 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:33:02 [INFO]  Round 11 starts--------|
2025-09-22 02:33:02 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:34:16 [INFO]  Epoch 11 loss: 558.1000928878784; train accuracy: 0.7089586759868421; test accuracy: 0.5845
2025-09-22 02:34:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:34:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:34:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:35:18 [INFO]  Epoch 11 loss: 483.46699571609497; train accuracy: 0.6248424899193549; test accuracy: 0.4382
2025-09-22 02:35:18 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:35:18 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:35:18 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:36:13 [INFO]  Epoch 11 loss: 474.50988721847534; train accuracy: 0.6772629310344828; test accuracy: 0.5405
2025-09-22 02:36:13 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:36:13 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:36:13 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:37:25 [INFO]  Epoch 11 loss: 540.3907299041748; train accuracy: 0.6871202256944444; test accuracy: 0.5609
2025-09-22 02:37:25 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:37:25 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:37:25 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:38:06 [INFO]  Epoch 11 loss: 293.3596611022949; train accuracy: 0.6439803685897436; test accuracy: 0.3638
2025-09-22 02:38:06 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:38:06 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:38:06 [INFO]  Round 11 Finish--------|
2025-09-22 02:38:06 [INFO]  Model variance: mean: 0.0024137822911143303, sum: 26971.48828125
2025-09-22 02:38:06 [INFO]  g_protos_std: 1.0060486793518066
2025-09-22 02:38:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7568
2025-09-22 02:38:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:38:14 [INFO]  Round 12 starts--------|
2025-09-22 02:38:14 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:39:29 [INFO]  Epoch 12 loss: 566.1078081130981; train accuracy: 0.7039473684210527; test accuracy: 0.5895
2025-09-22 02:39:29 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:39:29 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:39:29 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:40:27 [INFO]  Epoch 12 loss: 468.46113538742065; train accuracy: 0.6527847782258065; test accuracy: 0.4669
2025-09-22 02:40:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:40:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:40:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:41:21 [INFO]  Epoch 12 loss: 475.0444326400757; train accuracy: 0.5941540948275862; test accuracy: 0.4641
2025-09-22 02:41:21 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:41:21 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:41:21 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:42:32 [INFO]  Epoch 12 loss: 533.8814167976379; train accuracy: 0.7500271267361112; test accuracy: 0.6165
2025-09-22 02:42:32 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:42:32 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:42:32 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:43:11 [INFO]  Epoch 12 loss: 296.2473087310791; train accuracy: 0.6783353365384616; test accuracy: 0.3559
2025-09-22 02:43:11 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:43:11 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:43:11 [INFO]  Round 12 Finish--------|
2025-09-22 02:43:11 [INFO]  Model variance: mean: 0.00252212374471128, sum: 28182.08984375
2025-09-22 02:43:11 [INFO]  g_protos_std: 1.0060524940490723
2025-09-22 02:43:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7696
2025-09-22 02:43:21 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:43:21 [INFO]  Round 13 starts--------|
2025-09-22 02:43:21 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:44:34 [INFO]  Epoch 13 loss: 543.5581617355347; train accuracy: 0.6687654194078947; test accuracy: 0.5466
2025-09-22 02:44:34 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:44:34 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:44:34 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:45:32 [INFO]  Epoch 13 loss: 462.94931173324585; train accuracy: 0.7229397681451613; test accuracy: 0.517
2025-09-22 02:45:32 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:45:32 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:45:32 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:46:30 [INFO]  Epoch 13 loss: 473.506055355072; train accuracy: 0.6894194504310345; test accuracy: 0.5473
2025-09-22 02:46:30 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:46:30 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:46:30 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:47:43 [INFO]  Epoch 13 loss: 528.1737670898438; train accuracy: 0.7940809461805556; test accuracy: 0.6275
2025-09-22 02:47:43 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:47:43 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:47:43 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:48:21 [INFO]  Epoch 13 loss: 293.1146101951599; train accuracy: 0.5773737980769231; test accuracy: 0.3393
2025-09-22 02:48:21 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:48:21 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:48:21 [INFO]  Round 13 Finish--------|
2025-09-22 02:48:21 [INFO]  Model variance: mean: 0.002630410483106971, sum: 29392.080078125
2025-09-22 02:48:21 [INFO]  g_protos_std: 1.006073236465454
2025-09-22 02:48:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7674
2025-09-22 02:48:29 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:48:29 [INFO]  Round 14 starts--------|
2025-09-22 02:48:29 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:49:41 [INFO]  Epoch 14 loss: 550.8022408485413; train accuracy: 0.7394120065789473; test accuracy: 0.6311
2025-09-22 02:49:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:49:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:49:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:50:41 [INFO]  Epoch 14 loss: 458.72008752822876; train accuracy: 0.7127016129032258; test accuracy: 0.4965
2025-09-22 02:50:41 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:50:41 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:50:41 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:51:36 [INFO]  Epoch 14 loss: 469.0713334083557; train accuracy: 0.6760843211206896; test accuracy: 0.525
2025-09-22 02:51:36 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:51:36 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:51:36 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:52:48 [INFO]  Epoch 14 loss: 526.481734752655; train accuracy: 0.58984375; test accuracy: 0.477
2025-09-22 02:52:48 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:52:48 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:52:48 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:53:25 [INFO]  Epoch 14 loss: 291.4337205886841; train accuracy: 0.78515625; test accuracy: 0.4681
2025-09-22 02:53:25 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:53:25 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:53:25 [INFO]  Round 14 Finish--------|
2025-09-22 02:53:25 [INFO]  Model variance: mean: 0.002731449669227004, sum: 30521.0859375
2025-09-22 02:53:25 [INFO]  g_protos_std: 1.0060830116271973
2025-09-22 02:53:33 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7687
2025-09-22 02:53:33 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:53:33 [INFO]  Round 15 starts--------|
2025-09-22 02:53:33 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:54:49 [INFO]  Epoch 15 loss: 547.090407371521; train accuracy: 0.7925061677631579; test accuracy: 0.6838
2025-09-22 02:54:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_15.pth
2025-09-22 02:54:49 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:54:49 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:54:49 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:55:48 [INFO]  Epoch 15 loss: 453.9973883628845; train accuracy: 0.6984311995967742; test accuracy: 0.5113
2025-09-22 02:55:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_15.pth
2025-09-22 02:55:48 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:55:48 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:55:48 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:56:50 [INFO]  Epoch 15 loss: 463.89500856399536; train accuracy: 0.613213900862069; test accuracy: 0.4487
2025-09-22 02:56:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_15.pth
2025-09-22 02:56:50 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:56:50 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:56:50 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:58:00 [INFO]  Epoch 15 loss: 523.7584471702576; train accuracy: 0.6683485243055556; test accuracy: 0.5352
2025-09-22 02:58:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_15.pth
2025-09-22 02:58:01 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:58:01 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:58:01 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:58:41 [INFO]  Epoch 15 loss: 292.72063398361206; train accuracy: 0.755058092948718; test accuracy: 0.4228
2025-09-22 02:58:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_15.pth
2025-09-22 02:58:42 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:58:42 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:58:42 [INFO]  Round 15 Finish--------|
2025-09-22 02:58:42 [INFO]  Model variance: mean: 0.002831757999956608, sum: 31641.927734375
2025-09-22 02:58:42 [INFO]  g_protos_std: 1.006091833114624
2025-09-22 02:58:49 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7792
2025-09-22 02:58:49 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:58:49 [INFO]  Round 16 starts--------|
2025-09-22 02:58:49 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:00:02 [INFO]  Epoch 16 loss: 531.7074222564697; train accuracy: 0.7986225328947368; test accuracy: 0.6811
2025-09-22 03:00:02 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:00:02 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:00:02 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:01:02 [INFO]  Epoch 16 loss: 456.86259174346924; train accuracy: 0.7545992943548387; test accuracy: 0.5123
2025-09-22 03:01:02 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:01:02 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:01:02 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:01:57 [INFO]  Epoch 16 loss: 456.45973539352417; train accuracy: 0.6755118534482759; test accuracy: 0.5163
2025-09-22 03:01:57 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:01:57 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:01:57 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:03:05 [INFO]  Epoch 16 loss: 510.6995759010315; train accuracy: 0.6346299913194444; test accuracy: 0.5249
2025-09-22 03:03:06 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:03:06 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:03:06 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:03:44 [INFO]  Epoch 16 loss: 282.63125801086426; train accuracy: 0.8187099358974359; test accuracy: 0.4776
2025-09-22 03:03:44 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:03:44 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:03:44 [INFO]  Round 16 Finish--------|
2025-09-22 03:03:44 [INFO]  Model variance: mean: 0.0029321731999516487, sum: 32763.962890625
2025-09-22 03:03:44 [INFO]  g_protos_std: 1.0061161518096924
2025-09-22 03:03:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7903
2025-09-22 03:03:52 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:03:52 [INFO]  Round 17 starts--------|
2025-09-22 03:03:52 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:05:04 [INFO]  Epoch 17 loss: 536.6815509796143; train accuracy: 0.7691714638157895; test accuracy: 0.6652
2025-09-22 03:05:04 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:05:04 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:05:04 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:06:02 [INFO]  Epoch 17 loss: 459.089054107666; train accuracy: 0.7066532258064516; test accuracy: 0.4823
2025-09-22 03:06:02 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:06:02 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:06:02 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:06:56 [INFO]  Epoch 17 loss: 447.1868486404419; train accuracy: 0.6410627693965517; test accuracy: 0.5088
2025-09-22 03:06:56 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:06:56 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:06:56 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:08:02 [INFO]  Epoch 17 loss: 517.3532910346985; train accuracy: 0.7068142361111112; test accuracy: 0.5865
2025-09-22 03:08:02 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:08:02 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:08:02 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:08:40 [INFO]  Epoch 17 loss: 284.3194546699524; train accuracy: 0.7309695512820513; test accuracy: 0.4507
2025-09-22 03:08:40 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:08:40 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:08:40 [INFO]  Round 17 Finish--------|
2025-09-22 03:08:40 [INFO]  Model variance: mean: 0.0030275036115199327, sum: 33829.1796875
2025-09-22 03:08:40 [INFO]  g_protos_std: 1.0061253309249878
2025-09-22 03:08:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7981
2025-09-22 03:08:47 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:08:47 [INFO]  Round 18 starts--------|
2025-09-22 03:08:47 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:09:59 [INFO]  Epoch 18 loss: 522.6077766418457; train accuracy: 0.7646227384868421; test accuracy: 0.6419
2025-09-22 03:09:59 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:09:59 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:09:59 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:10:56 [INFO]  Epoch 18 loss: 444.1890592575073; train accuracy: 0.7193485383064516; test accuracy: 0.5087
2025-09-22 03:10:56 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:10:56 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:10:56 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:11:53 [INFO]  Epoch 18 loss: 445.36169624328613; train accuracy: 0.6697198275862069; test accuracy: 0.525
2025-09-22 03:11:53 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:11:53 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:11:53 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:12:57 [INFO]  Epoch 18 loss: 513.1363143920898; train accuracy: 0.7645128038194444; test accuracy: 0.6174
2025-09-22 03:12:57 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:12:57 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:12:57 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:13:36 [INFO]  Epoch 18 loss: 284.23814630508423; train accuracy: 0.8207632211538461; test accuracy: 0.527
2025-09-22 03:13:36 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:13:36 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:13:36 [INFO]  Round 18 Finish--------|
2025-09-22 03:13:36 [INFO]  Model variance: mean: 0.0031212512403726578, sum: 34876.7109375
2025-09-22 03:13:36 [INFO]  g_protos_std: 1.0061445236206055
2025-09-22 03:13:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8041
2025-09-22 03:13:44 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:13:44 [INFO]  Round 19 starts--------|
2025-09-22 03:13:44 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:14:56 [INFO]  Epoch 19 loss: 525.193597316742; train accuracy: 0.810546875; test accuracy: 0.6797
2025-09-22 03:14:56 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:14:56 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:14:56 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:15:54 [INFO]  Epoch 19 loss: 441.25352001190186; train accuracy: 0.7150327620967742; test accuracy: 0.498
2025-09-22 03:15:54 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:15:54 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:15:54 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:16:54 [INFO]  Epoch 19 loss: 449.8232479095459; train accuracy: 0.6627491918103449; test accuracy: 0.4905
2025-09-22 03:16:54 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:16:54 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:16:54 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:18:06 [INFO]  Epoch 19 loss: 498.470685005188; train accuracy: 0.6495768229166666; test accuracy: 0.5247
2025-09-22 03:18:06 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:18:06 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:18:06 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:18:43 [INFO]  Epoch 19 loss: 285.3778133392334; train accuracy: 0.7729366987179487; test accuracy: 0.4905
2025-09-22 03:18:43 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:18:43 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:18:43 [INFO]  Round 19 Finish--------|
2025-09-22 03:18:43 [INFO]  Model variance: mean: 0.003213688964024186, sum: 35909.60546875
2025-09-22 03:18:43 [INFO]  g_protos_std: 1.0061630010604858
2025-09-22 03:18:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8041
2025-09-22 03:18:50 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:18:50 [INFO]  Round 20 starts--------|
2025-09-22 03:18:50 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:19:57 [INFO]  Epoch 20 loss: 515.584804058075; train accuracy: 0.7823807565789473; test accuracy: 0.6701
2025-09-22 03:19:58 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_20.pth
2025-09-22 03:19:58 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:19:58 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:19:58 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:20:56 [INFO]  Epoch 20 loss: 445.58501291275024; train accuracy: 0.760773689516129; test accuracy: 0.5266
2025-09-22 03:20:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_20.pth
2025-09-22 03:20:56 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:20:56 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:20:56 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:21:52 [INFO]  Epoch 20 loss: 445.4110312461853; train accuracy: 0.7197602370689655; test accuracy: 0.5783
2025-09-22 03:21:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_20.pth
2025-09-22 03:21:52 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:21:52 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:21:52 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:22:58 [INFO]  Epoch 20 loss: 501.6252450942993; train accuracy: 0.7637803819444444; test accuracy: 0.628
2025-09-22 03:22:58 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_20.pth
2025-09-22 03:22:58 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:22:58 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:22:58 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:23:36 [INFO]  Epoch 20 loss: 276.64833307266235; train accuracy: 0.8011318108974359; test accuracy: 0.4807
2025-09-22 03:23:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_20.pth
2025-09-22 03:23:36 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:23:36 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:23:36 [INFO]  Round 20 Finish--------|
2025-09-22 03:23:36 [INFO]  Model variance: mean: 0.0033025573939085007, sum: 36902.6171875
2025-09-22 03:23:36 [INFO]  g_protos_std: 1.0061757564544678
2025-09-22 03:23:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.8155
2025-09-22 03:23:44 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml

2025-09-22 01:44:52 [INFO]  Load config from ./configs/CIFAR10_alpha0.5_with_memorybank.yaml
2025-09-22 01:44:52 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.5', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.5}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'use_memory_bank': True, 'memory_bank_size': 4096}
2025-09-22 01:44:54 [INFO]  Dataset CIFAR10 loaded
2025-09-22 01:44:54 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10.pt
2025-09-22 01:44:54 [INFO]  OneshotOurs
2025-09-22 01:44:55 [INFO]  Round 0 starts--------|
2025-09-22 01:44:55 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:45:01 [INFO]  generating sample per sample
2025-09-22 01:45:02 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:45:02 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:45:50 [INFO]  Epoch 0 loss: 916.5474443435669; train accuracy: 0.23134251644736842; test accuracy: 0.1834
2025-09-22 01:45:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_0.pth
2025-09-22 01:45:51 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:45:51 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:45:51 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:45:57 [INFO]  generating sample per sample
2025-09-22 01:45:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:45:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:46:37 [INFO]  Epoch 0 loss: 727.2227821350098; train accuracy: 0.2703503024193548; test accuracy: 0.1719
2025-09-22 01:46:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_0.pth
2025-09-22 01:46:37 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:46:37 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:46:37 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:46:43 [INFO]  generating sample per sample
2025-09-22 01:46:43 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:46:43 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:47:29 [INFO]  Epoch 0 loss: 703.4355010986328; train accuracy: 0.1884765625; test accuracy: 0.1192
2025-09-22 01:47:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_0.pth
2025-09-22 01:47:29 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:47:29 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:47:29 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:47:36 [INFO]  generating sample per sample
2025-09-22 01:47:36 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:47:36 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:48:30 [INFO]  Epoch 0 loss: 856.00998878479; train accuracy: 0.2383083767361111; test accuracy: 0.1858
2025-09-22 01:48:31 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_0.pth
2025-09-22 01:48:31 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:48:31 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:48:31 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:48:35 [INFO]  generating sample per sample
2025-09-22 01:48:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:48:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:49:07 [INFO]  Epoch 0 loss: 458.72980213165283; train accuracy: 0.25535857371794873; test accuracy: 0.1041
2025-09-22 01:49:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_0.pth
2025-09-22 01:49:07 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:49:07 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:49:07 [INFO]  Round 0 Finish--------|
2025-09-22 01:49:07 [INFO]  Model variance: mean: 0.0007293196977116168, sum: 8149.38330078125
2025-09-22 01:49:07 [INFO]  g_protos_std: 1.0060443878173828
2025-09-22 01:49:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3507
2025-09-22 01:49:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:49:14 [INFO]  Round 1 starts--------|
2025-09-22 01:49:14 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:49:14 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:49:14 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:50:14 [INFO]  Epoch 1 loss: 866.740870475769; train accuracy: 0.36669921875; test accuracy: 0.2936
2025-09-22 01:50:14 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:50:14 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:50:14 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:50:14 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:50:14 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:51:04 [INFO]  Epoch 1 loss: 677.8833341598511; train accuracy: 0.24996849798387097; test accuracy: 0.1615
2025-09-22 01:51:04 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:51:04 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:51:04 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:51:04 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:51:04 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:51:51 [INFO]  Epoch 1 loss: 669.9309740066528; train accuracy: 0.27566002155172414; test accuracy: 0.1705
2025-09-22 01:51:51 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:51:51 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:51:51 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:51:51 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:51:51 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:52:51 [INFO]  Epoch 1 loss: 807.7794513702393; train accuracy: 0.3389756944444444; test accuracy: 0.2558
2025-09-22 01:52:51 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:52:51 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:52:51 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:52:51 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:52:51 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:53:24 [INFO]  Epoch 1 loss: 426.48049449920654; train accuracy: 0.38040865384615385; test accuracy: 0.2037
2025-09-22 01:53:24 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:53:24 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:53:24 [INFO]  Round 1 Finish--------|
2025-09-22 01:53:24 [INFO]  Model variance: mean: 0.0009927379433065653, sum: 11092.806640625
2025-09-22 01:53:24 [INFO]  g_protos_std: 1.0062156915664673
2025-09-22 01:53:33 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.421
2025-09-22 01:53:33 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:53:33 [INFO]  Round 2 starts--------|
2025-09-22 01:53:33 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:53:33 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:53:33 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:54:35 [INFO]  Epoch 2 loss: 823.3480110168457; train accuracy: 0.39751233552631576; test accuracy: 0.3376
2025-09-22 01:54:35 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:54:35 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:54:35 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:54:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:54:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:55:28 [INFO]  Epoch 2 loss: 664.7784423828125; train accuracy: 0.31640625; test accuracy: 0.2092
2025-09-22 01:55:28 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:55:28 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:55:28 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:55:28 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:55:28 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:56:19 [INFO]  Epoch 2 loss: 656.1653823852539; train accuracy: 0.3608903556034483; test accuracy: 0.2437
2025-09-22 01:56:19 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:56:19 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:56:19 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:56:19 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:56:19 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:57:19 [INFO]  Epoch 2 loss: 787.223391532898; train accuracy: 0.3616807725694444; test accuracy: 0.2753
2025-09-22 01:57:19 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:57:19 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:57:19 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:57:19 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:57:19 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:57:53 [INFO]  Epoch 2 loss: 417.932168006897; train accuracy: 0.3934795673076923; test accuracy: 0.1728
2025-09-22 01:57:53 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:57:53 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:57:53 [INFO]  Round 2 Finish--------|
2025-09-22 01:57:53 [INFO]  Model variance: mean: 0.001188137335702777, sum: 13276.189453125
2025-09-22 01:57:53 [INFO]  g_protos_std: 1.0063896179199219
2025-09-22 01:58:02 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4856
2025-09-22 01:58:02 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:58:02 [INFO]  Round 3 starts--------|
2025-09-22 01:58:02 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:58:02 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:58:02 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:59:11 [INFO]  Epoch 3 loss: 809.870283126831; train accuracy: 0.5115388569078947; test accuracy: 0.435
2025-09-22 01:59:11 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:59:11 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:59:11 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:59:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:59:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:00:11 [INFO]  Epoch 3 loss: 640.6299724578857; train accuracy: 0.3282825100806452; test accuracy: 0.2131
2025-09-22 02:00:11 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:00:11 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:00:11 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:00:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:00:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:01:05 [INFO]  Epoch 3 loss: 642.391716003418; train accuracy: 0.3559065193965517; test accuracy: 0.2607
2025-09-22 02:01:05 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:01:05 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:01:05 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:01:05 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:01:05 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:02:11 [INFO]  Epoch 3 loss: 769.712797164917; train accuracy: 0.3033311631944444; test accuracy: 0.2302
2025-09-22 02:02:11 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:02:11 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:02:11 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:02:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:02:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:02:48 [INFO]  Epoch 3 loss: 410.3158988952637; train accuracy: 0.3375901442307692; test accuracy: 0.1442
2025-09-22 02:02:48 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:02:48 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:02:48 [INFO]  Round 3 Finish--------|
2025-09-22 02:02:48 [INFO]  Model variance: mean: 0.0013536557089537382, sum: 15125.68359375
2025-09-22 02:02:48 [INFO]  g_protos_std: 1.0065414905548096
2025-09-22 02:02:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5272
2025-09-22 02:02:57 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:02:57 [INFO]  Round 4 starts--------|
2025-09-22 02:02:57 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:02:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:02:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:04:02 [INFO]  Epoch 4 loss: 784.2467985153198; train accuracy: 0.4742495888157895; test accuracy: 0.3934
2025-09-22 02:04:02 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:04:02 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:04:02 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:04:03 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:04:03 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:04:56 [INFO]  Epoch 4 loss: 633.8292016983032; train accuracy: 0.3995715725806452; test accuracy: 0.2692
2025-09-22 02:04:56 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:04:56 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:04:56 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:04:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:04:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:05:48 [INFO]  Epoch 4 loss: 634.1941757202148; train accuracy: 0.29913119612068967; test accuracy: 0.213
2025-09-22 02:05:48 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:05:48 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:05:48 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:05:48 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:05:48 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:06:53 [INFO]  Epoch 4 loss: 745.0633182525635; train accuracy: 0.3290201822916667; test accuracy: 0.2525
2025-09-22 02:06:53 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:06:53 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:06:53 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:06:53 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:06:53 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:07:31 [INFO]  Epoch 4 loss: 402.6691074371338; train accuracy: 0.4890324519230769; test accuracy: 0.2218
2025-09-22 02:07:31 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:07:31 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:07:31 [INFO]  Round 4 Finish--------|
2025-09-22 02:07:31 [INFO]  Model variance: mean: 0.0015078975120559335, sum: 16849.173828125
2025-09-22 02:07:31 [INFO]  g_protos_std: 1.0066801309585571
2025-09-22 02:07:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5857
2025-09-22 02:07:38 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:07:38 [INFO]  Round 5 starts--------|
2025-09-22 02:07:38 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:07:38 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:07:38 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:08:44 [INFO]  Epoch 5 loss: 755.4026718139648; train accuracy: 0.5446391858552632; test accuracy: 0.4576
2025-09-22 02:08:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_5.pth
2025-09-22 02:08:45 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:08:45 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:08:45 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:08:45 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:08:45 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:09:41 [INFO]  Epoch 5 loss: 624.2715559005737; train accuracy: 0.5080330141129032; test accuracy: 0.3288
2025-09-22 02:09:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_5.pth
2025-09-22 02:09:41 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:09:41 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:09:41 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:09:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:09:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:10:36 [INFO]  Epoch 5 loss: 619.8835468292236; train accuracy: 0.5013133081896551; test accuracy: 0.3395
2025-09-22 02:10:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_5.pth
2025-09-22 02:10:37 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:10:37 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:10:37 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:10:37 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:10:37 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:11:47 [INFO]  Epoch 5 loss: 724.9347610473633; train accuracy: 0.4249403211805556; test accuracy: 0.3457
2025-09-22 02:11:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_5.pth
2025-09-22 02:11:47 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:11:47 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:11:47 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:11:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:11:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:12:27 [INFO]  Epoch 5 loss: 396.6920919418335; train accuracy: 0.5067107371794872; test accuracy: 0.2902
2025-09-22 02:12:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_5.pth
2025-09-22 02:12:27 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:12:27 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:12:27 [INFO]  Round 5 Finish--------|
2025-09-22 02:12:27 [INFO]  Model variance: mean: 0.0016515491297468543, sum: 18454.330078125
2025-09-22 02:12:27 [INFO]  g_protos_std: 1.0067893266677856
2025-09-22 02:12:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6131
2025-09-22 02:12:35 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:12:35 [INFO]  Round 6 starts--------|
2025-09-22 02:12:35 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:12:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:12:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:13:47 [INFO]  Epoch 6 loss: 741.5937147140503; train accuracy: 0.4790296052631579; test accuracy: 0.4044
2025-09-22 02:13:47 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:13:47 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:13:47 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:13:48 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:13:48 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:14:44 [INFO]  Epoch 6 loss: 604.829047203064; train accuracy: 0.5163810483870968; test accuracy: 0.3373
2025-09-22 02:14:44 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:14:44 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:14:44 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:14:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:14:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:15:41 [INFO]  Epoch 6 loss: 618.1633319854736; train accuracy: 0.42898033405172414; test accuracy: 0.3384
2025-09-22 02:15:41 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:15:41 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:15:41 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:15:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:15:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:16:49 [INFO]  Epoch 6 loss: 708.2598476409912; train accuracy: 0.6468912760416666; test accuracy: 0.5078
2025-09-22 02:16:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:16:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:16:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:16:49 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:16:49 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:17:27 [INFO]  Epoch 6 loss: 388.27290439605713; train accuracy: 0.4872295673076923; test accuracy: 0.224
2025-09-22 02:17:27 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:17:27 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:17:27 [INFO]  Round 6 Finish--------|
2025-09-22 02:17:27 [INFO]  Model variance: mean: 0.0017885746201500297, sum: 19985.447265625
2025-09-22 02:17:27 [INFO]  g_protos_std: 1.006887435913086
2025-09-22 02:17:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6499
2025-09-22 02:17:34 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:17:34 [INFO]  Round 7 starts--------|
2025-09-22 02:17:34 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:17:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:17:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:18:42 [INFO]  Epoch 7 loss: 741.9001975059509; train accuracy: 0.49539987664473684; test accuracy: 0.4271
2025-09-22 02:18:42 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:18:42 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:18:42 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:18:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:18:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:19:43 [INFO]  Epoch 7 loss: 602.3343143463135; train accuracy: 0.6221963205645161; test accuracy: 0.4271
2025-09-22 02:19:43 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:19:43 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:19:43 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:19:43 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:19:43 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:20:42 [INFO]  Epoch 7 loss: 607.8518409729004; train accuracy: 0.5572130926724138; test accuracy: 0.4282
2025-09-22 02:20:42 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:20:42 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:20:42 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:20:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:20:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:21:54 [INFO]  Epoch 7 loss: 702.0323877334595; train accuracy: 0.4050835503472222; test accuracy: 0.3372
2025-09-22 02:21:54 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:21:54 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:21:54 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:21:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:21:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:22:34 [INFO]  Epoch 7 loss: 386.0500249862671; train accuracy: 0.42993790064102566; test accuracy: 0.2058
2025-09-22 02:22:34 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:22:34 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:22:34 [INFO]  Round 7 Finish--------|
2025-09-22 02:22:34 [INFO]  Model variance: mean: 0.0019130524015054107, sum: 21376.35546875
2025-09-22 02:22:34 [INFO]  g_protos_std: 1.006968379020691
2025-09-22 02:22:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6488
2025-09-22 02:22:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:22:41 [INFO]  Round 8 starts--------|
2025-09-22 02:22:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:22:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:22:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:23:52 [INFO]  Epoch 8 loss: 712.3326258659363; train accuracy: 0.6596165707236842; test accuracy: 0.5681
2025-09-22 02:23:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:23:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:23:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:23:52 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:23:52 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:24:54 [INFO]  Epoch 8 loss: 591.1508750915527; train accuracy: 0.6054057459677419; test accuracy: 0.4116
2025-09-22 02:24:54 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:24:54 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:24:54 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:24:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:24:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:25:49 [INFO]  Epoch 8 loss: 601.4199733734131; train accuracy: 0.5911907327586207; test accuracy: 0.4162
2025-09-22 02:25:49 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:25:49 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:25:49 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:25:49 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:25:49 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:27:00 [INFO]  Epoch 8 loss: 684.5061378479004; train accuracy: 0.7111002604166666; test accuracy: 0.5707
2025-09-22 02:27:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:27:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:27:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:27:00 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:27:00 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:27:38 [INFO]  Epoch 8 loss: 379.060471534729; train accuracy: 0.6208433493589743; test accuracy: 0.3443
2025-09-22 02:27:38 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:27:38 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:27:38 [INFO]  Round 8 Finish--------|
2025-09-22 02:27:38 [INFO]  Model variance: mean: 0.0020374313462525606, sum: 22766.16015625
2025-09-22 02:27:38 [INFO]  g_protos_std: 1.0070507526397705
2025-09-22 02:27:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7036
2025-09-22 02:27:46 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:27:46 [INFO]  Round 9 starts--------|
2025-09-22 02:27:46 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:27:46 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:27:46 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:29:01 [INFO]  Epoch 9 loss: 721.4839825630188; train accuracy: 0.6301912006578947; test accuracy: 0.5425
2025-09-22 02:29:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:29:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:29:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:29:01 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:29:01 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:30:03 [INFO]  Epoch 9 loss: 593.1926870346069; train accuracy: 0.681672127016129; test accuracy: 0.459
2025-09-22 02:30:03 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:30:03 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:30:03 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:30:03 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:30:03 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:30:59 [INFO]  Epoch 9 loss: 590.0936737060547; train accuracy: 0.5880926724137931; test accuracy: 0.4516
2025-09-22 02:30:59 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:30:59 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:30:59 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:30:59 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:30:59 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:32:10 [INFO]  Epoch 9 loss: 678.8162574768066; train accuracy: 0.5745171440972222; test accuracy: 0.4564
2025-09-22 02:32:10 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:32:10 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:32:10 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:32:10 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:32:10 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:32:49 [INFO]  Epoch 9 loss: 372.8537378311157; train accuracy: 0.6438802083333334; test accuracy: 0.3903
2025-09-22 02:32:49 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:32:49 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:32:49 [INFO]  Round 9 Finish--------|
2025-09-22 02:32:49 [INFO]  Model variance: mean: 0.0021492524538189173, sum: 24015.642578125
2025-09-22 02:32:49 [INFO]  g_protos_std: 1.0071136951446533
2025-09-22 02:32:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6993
2025-09-22 02:32:57 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:32:57 [INFO]  Round 10 starts--------|
2025-09-22 02:32:57 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:32:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:32:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:34:13 [INFO]  Epoch 10 loss: 702.278627872467; train accuracy: 0.6556846217105263; test accuracy: 0.5747
2025-09-22 02:34:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_10.pth
2025-09-22 02:34:13 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:34:13 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:34:13 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:34:13 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:34:13 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:35:16 [INFO]  Epoch 10 loss: 586.5836825370789; train accuracy: 0.6725365423387096; test accuracy: 0.467
2025-09-22 02:35:16 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_10.pth
2025-09-22 02:35:16 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:35:16 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:35:16 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:35:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:35:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:36:10 [INFO]  Epoch 10 loss: 581.68625831604; train accuracy: 0.5100013469827587; test accuracy: 0.3729
2025-09-22 02:36:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_10.pth
2025-09-22 02:36:10 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:36:10 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:36:10 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:36:10 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:36:10 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:37:22 [INFO]  Epoch 10 loss: 668.9144005775452; train accuracy: 0.7076822916666666; test accuracy: 0.5483
2025-09-22 02:37:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_10.pth
2025-09-22 02:37:22 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:37:22 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:37:22 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:37:22 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:37:22 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:38:01 [INFO]  Epoch 10 loss: 376.1688165664673; train accuracy: 0.6362179487179487; test accuracy: 0.3799
2025-09-22 02:38:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_10.pth
2025-09-22 02:38:01 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:38:01 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:38:01 [INFO]  Round 10 Finish--------|
2025-09-22 02:38:01 [INFO]  Model variance: mean: 0.002259062835946679, sum: 25242.658203125
2025-09-22 02:38:01 [INFO]  g_protos_std: 1.007179856300354
2025-09-22 02:38:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7259
2025-09-22 02:38:10 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:38:10 [INFO]  Round 11 starts--------|
2025-09-22 02:38:10 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:38:10 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:38:10 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:39:22 [INFO]  Epoch 11 loss: 703.652407169342; train accuracy: 0.6321186266447368; test accuracy: 0.5519
2025-09-22 02:39:22 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:39:22 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:39:22 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:39:22 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:39:22 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:40:23 [INFO]  Epoch 11 loss: 580.3674130439758; train accuracy: 0.6628339213709677; test accuracy: 0.4489
2025-09-22 02:40:23 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:40:23 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:40:23 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:40:23 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:40:23 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:41:20 [INFO]  Epoch 11 loss: 575.3237476348877; train accuracy: 0.663995150862069; test accuracy: 0.4837
2025-09-22 02:41:20 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:41:20 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:41:20 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:41:20 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:41:20 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:42:32 [INFO]  Epoch 11 loss: 674.0488996505737; train accuracy: 0.5972222222222222; test accuracy: 0.4756
2025-09-22 02:42:32 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:42:32 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:42:32 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:42:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:42:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:43:12 [INFO]  Epoch 11 loss: 362.59261655807495; train accuracy: 0.5950520833333334; test accuracy: 0.2923
2025-09-22 02:43:12 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:43:12 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:43:12 [INFO]  Round 11 Finish--------|
2025-09-22 02:43:12 [INFO]  Model variance: mean: 0.002362915314733982, sum: 26403.1015625
2025-09-22 02:43:12 [INFO]  g_protos_std: 1.007225513458252
2025-09-22 02:43:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7242
2025-09-22 02:43:21 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:43:21 [INFO]  Round 12 starts--------|
2025-09-22 02:43:21 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:43:21 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:43:21 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:44:34 [INFO]  Epoch 12 loss: 685.6581921577454; train accuracy: 0.6933079769736842; test accuracy: 0.5989
2025-09-22 02:44:34 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:44:34 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:44:34 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:44:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:44:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:45:35 [INFO]  Epoch 12 loss: 572.1612033843994; train accuracy: 0.6348286290322581; test accuracy: 0.4357
2025-09-22 02:45:35 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:45:35 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:45:35 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:45:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:45:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:46:34 [INFO]  Epoch 12 loss: 579.46217918396; train accuracy: 0.6772629310344828; test accuracy: 0.5024
2025-09-22 02:46:34 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:46:34 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:46:34 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:46:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:46:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:47:42 [INFO]  Epoch 12 loss: 657.0919241905212; train accuracy: 0.6828342013888888; test accuracy: 0.5476
2025-09-22 02:47:42 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:47:42 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:47:42 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:47:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:47:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:48:19 [INFO]  Epoch 12 loss: 365.5581398010254; train accuracy: 0.6293569711538461; test accuracy: 0.333
2025-09-22 02:48:19 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:48:19 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:48:19 [INFO]  Round 12 Finish--------|
2025-09-22 02:48:19 [INFO]  Model variance: mean: 0.002463930519297719, sum: 27531.841796875
2025-09-22 02:48:19 [INFO]  g_protos_std: 1.0072721242904663
2025-09-22 02:48:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7292
2025-09-22 02:48:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:48:27 [INFO]  Round 13 starts--------|
2025-09-22 02:48:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:48:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:48:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:49:41 [INFO]  Epoch 13 loss: 686.050705909729; train accuracy: 0.7249691611842105; test accuracy: 0.6207
2025-09-22 02:49:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:49:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:49:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:49:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:49:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:50:40 [INFO]  Epoch 13 loss: 574.780740737915; train accuracy: 0.7010458669354839; test accuracy: 0.4818
2025-09-22 02:50:40 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:50:40 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:50:40 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:50:40 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:50:40 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:51:34 [INFO]  Epoch 13 loss: 573.5197772979736; train accuracy: 0.6127087823275862; test accuracy: 0.4462
2025-09-22 02:51:34 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:51:34 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:51:34 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:51:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:51:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:52:41 [INFO]  Epoch 13 loss: 652.0983729362488; train accuracy: 0.6055230034722222; test accuracy: 0.4775
2025-09-22 02:52:41 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:52:41 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:52:41 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:52:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:52:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:53:20 [INFO]  Epoch 13 loss: 359.35657119750977; train accuracy: 0.6767327724358975; test accuracy: 0.4222
2025-09-22 02:53:20 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:53:20 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:53:20 [INFO]  Round 13 Finish--------|
2025-09-22 02:53:20 [INFO]  Model variance: mean: 0.002561934059485793, sum: 28626.927734375
2025-09-22 02:53:20 [INFO]  g_protos_std: 1.007336139678955
2025-09-22 02:53:28 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7459
2025-09-22 02:53:28 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:53:28 [INFO]  Round 14 starts--------|
2025-09-22 02:53:28 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:53:28 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:53:28 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:54:42 [INFO]  Epoch 14 loss: 682.6032295227051; train accuracy: 0.7442948190789473; test accuracy: 0.6379
2025-09-22 02:54:42 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:54:42 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:54:42 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:54:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:54:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:55:41 [INFO]  Epoch 14 loss: 566.5240879058838; train accuracy: 0.714812247983871; test accuracy: 0.4814
2025-09-22 02:55:41 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:55:41 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:55:41 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:55:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:55:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:56:36 [INFO]  Epoch 14 loss: 570.1698198318481; train accuracy: 0.6395137392241379; test accuracy: 0.5077
2025-09-22 02:56:36 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:56:36 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:56:36 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:56:36 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:56:36 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:57:43 [INFO]  Epoch 14 loss: 653.4301180839539; train accuracy: 0.7519259982638888; test accuracy: 0.6081
2025-09-22 02:57:43 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:57:43 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:57:43 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:57:43 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:57:43 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:58:20 [INFO]  Epoch 14 loss: 351.9156494140625; train accuracy: 0.5840845352564102; test accuracy: 0.3479
2025-09-22 02:58:20 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:58:20 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:58:20 [INFO]  Round 14 Finish--------|
2025-09-22 02:58:20 [INFO]  Model variance: mean: 0.00265384535305202, sum: 29653.94140625
2025-09-22 02:58:20 [INFO]  g_protos_std: 1.0073745250701904
2025-09-22 02:58:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7568
2025-09-22 02:58:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:58:27 [INFO]  Round 15 starts--------|
2025-09-22 02:58:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:58:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:58:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:59:39 [INFO]  Epoch 15 loss: 669.9931716918945; train accuracy: 0.7238127055921053; test accuracy: 0.6212
2025-09-22 02:59:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_15.pth
2025-09-22 02:59:40 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:59:40 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:59:40 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:59:40 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:59:40 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:00:38 [INFO]  Epoch 15 loss: 559.3637938499451; train accuracy: 0.7105909778225806; test accuracy: 0.482
2025-09-22 03:00:39 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_15.pth
2025-09-22 03:00:39 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:00:39 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:00:39 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:00:39 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:00:39 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:01:33 [INFO]  Epoch 15 loss: 557.8349943161011; train accuracy: 0.6666891163793104; test accuracy: 0.5138
2025-09-22 03:01:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_15.pth
2025-09-22 03:01:33 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:01:33 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:01:33 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:01:33 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:01:33 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:02:40 [INFO]  Epoch 15 loss: 642.4635896682739; train accuracy: 0.7366536458333334; test accuracy: 0.5913
2025-09-22 03:02:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_15.pth
2025-09-22 03:02:40 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:02:40 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:02:40 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:02:40 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:02:40 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:03:19 [INFO]  Epoch 15 loss: 360.71171474456787; train accuracy: 0.5736678685897436; test accuracy: 0.3326
2025-09-22 03:03:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_15.pth
2025-09-22 03:03:20 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:03:20 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:03:20 [INFO]  Round 15 Finish--------|
2025-09-22 03:03:20 [INFO]  Model variance: mean: 0.0027458290569484234, sum: 30681.76171875
2025-09-22 03:03:20 [INFO]  g_protos_std: 1.0074117183685303
2025-09-22 03:03:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7615
2025-09-22 03:03:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:03:27 [INFO]  Round 16 starts--------|
2025-09-22 03:03:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:03:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:03:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:04:38 [INFO]  Epoch 16 loss: 665.6936502456665; train accuracy: 0.7669356496710527; test accuracy: 0.6703
2025-09-22 03:04:38 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:04:38 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:04:38 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:04:38 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:04:38 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:05:36 [INFO]  Epoch 16 loss: 566.009575843811; train accuracy: 0.7233807963709677; test accuracy: 0.4984
2025-09-22 03:05:36 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:05:36 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:05:36 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:05:36 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:05:36 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:06:30 [INFO]  Epoch 16 loss: 558.8960890769958; train accuracy: 0.6827518857758621; test accuracy: 0.5067
2025-09-22 03:06:30 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:06:30 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:06:30 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:06:30 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:06:30 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:07:40 [INFO]  Epoch 16 loss: 641.5158095359802; train accuracy: 0.8017578125; test accuracy: 0.6445
2025-09-22 03:07:40 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:07:40 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:07:40 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:07:40 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:07:40 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:08:18 [INFO]  Epoch 16 loss: 351.449481010437; train accuracy: 0.6656149839743589; test accuracy: 0.4066
2025-09-22 03:08:18 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:08:18 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:08:18 [INFO]  Round 16 Finish--------|
2025-09-22 03:08:18 [INFO]  Model variance: mean: 0.002831502351909876, sum: 31639.0703125
2025-09-22 03:08:18 [INFO]  g_protos_std: 1.0074522495269775
2025-09-22 03:08:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7764
2025-09-22 03:08:26 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:08:26 [INFO]  Round 17 starts--------|
2025-09-22 03:08:26 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:08:26 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:08:26 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:09:39 [INFO]  Epoch 17 loss: 655.3705687522888; train accuracy: 0.7997789884868421; test accuracy: 0.6877
2025-09-22 03:09:39 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:09:39 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:09:39 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:09:39 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:09:39 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:10:36 [INFO]  Epoch 17 loss: 560.8009634017944; train accuracy: 0.7361076108870968; test accuracy: 0.4942
2025-09-22 03:10:36 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:10:36 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:10:36 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:10:36 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:10:36 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:11:29 [INFO]  Epoch 17 loss: 554.1544351577759; train accuracy: 0.6200161637931034; test accuracy: 0.4937
2025-09-22 03:11:29 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:11:29 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:11:29 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:11:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:11:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:12:37 [INFO]  Epoch 17 loss: 639.8757801055908; train accuracy: 0.7715657552083334; test accuracy: 0.6276
2025-09-22 03:12:37 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:12:37 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:12:37 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:12:37 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:12:37 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:13:14 [INFO]  Epoch 17 loss: 346.94937324523926; train accuracy: 0.7515024038461539; test accuracy: 0.4122
2025-09-22 03:13:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:13:15 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:13:15 [INFO]  Round 17 Finish--------|
2025-09-22 03:13:15 [INFO]  Model variance: mean: 0.002917666919529438, sum: 32601.869140625
2025-09-22 03:13:15 [INFO]  g_protos_std: 1.0074883699417114
2025-09-22 03:13:22 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7854
2025-09-22 03:13:22 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:13:22 [INFO]  Round 18 starts--------|
2025-09-22 03:13:22 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:13:22 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:13:22 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:14:36 [INFO]  Epoch 18 loss: 658.0072722434998; train accuracy: 0.8030170641447368; test accuracy: 0.682
2025-09-22 03:14:36 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:14:36 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:14:36 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:14:36 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:14:36 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:15:31 [INFO]  Epoch 18 loss: 554.7561812400818; train accuracy: 0.7446761592741935; test accuracy: 0.5129
2025-09-22 03:15:31 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:15:31 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:15:31 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:15:31 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:15:31 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:16:29 [INFO]  Epoch 18 loss: 554.1199159622192; train accuracy: 0.7303677262931034; test accuracy: 0.5782
2025-09-22 03:16:29 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:16:29 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:16:29 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:16:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:16:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:17:35 [INFO]  Epoch 18 loss: 641.1844038963318; train accuracy: 0.7926703559027778; test accuracy: 0.6404
2025-09-22 03:17:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:17:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:17:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:17:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:17:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:18:12 [INFO]  Epoch 18 loss: 346.4772539138794; train accuracy: 0.8101462339743589; test accuracy: 0.4812
2025-09-22 03:18:12 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:18:12 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:18:12 [INFO]  Round 18 Finish--------|
2025-09-22 03:18:12 [INFO]  Model variance: mean: 0.0029981371480971575, sum: 33501.0390625
2025-09-22 03:18:12 [INFO]  g_protos_std: 1.0075247287750244
2025-09-22 03:18:20 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7851
2025-09-22 03:18:20 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:18:20 [INFO]  Round 19 starts--------|
2025-09-22 03:18:20 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:18:20 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:18:20 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:19:34 [INFO]  Epoch 19 loss: 648.1693682670593; train accuracy: 0.7482267680921053; test accuracy: 0.6415
2025-09-22 03:19:34 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:19:34 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:19:34 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:19:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:19:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:20:34 [INFO]  Epoch 19 loss: 550.2780904769897; train accuracy: 0.7534652217741935; test accuracy: 0.5012
2025-09-22 03:20:34 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:20:34 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:20:34 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:20:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:20:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:21:32 [INFO]  Epoch 19 loss: 552.0073680877686; train accuracy: 0.678778286637931; test accuracy: 0.5358
2025-09-22 03:21:32 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:21:32 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:21:32 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:21:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:21:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:22:41 [INFO]  Epoch 19 loss: 630.0704822540283; train accuracy: 0.6991373697916666; test accuracy: 0.5678
2025-09-22 03:22:41 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:22:41 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:22:41 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:22:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:22:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:23:20 [INFO]  Epoch 19 loss: 343.35222148895264; train accuracy: 0.7680288461538461; test accuracy: 0.4709
2025-09-22 03:23:20 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:23:20 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:23:20 [INFO]  Round 19 Finish--------|
2025-09-22 03:23:20 [INFO]  Model variance: mean: 0.0030785975977778435, sum: 34400.1015625
2025-09-22 03:23:20 [INFO]  g_protos_std: 1.0075552463531494
2025-09-22 03:23:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7928
2025-09-22 03:23:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:23:27 [INFO]  Round 20 starts--------|
2025-09-22 03:23:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:23:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:23:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:24:39 [INFO]  Epoch 20 loss: 656.4587936401367; train accuracy: 0.7354800575657895; test accuracy: 0.6352
2025-09-22 03:24:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_0/epoch_20.pth
2025-09-22 03:24:40 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:24:40 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:24:40 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:24:40 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:24:40 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:25:41 [INFO]  Epoch 20 loss: 543.2735915184021; train accuracy: 0.7142137096774194; test accuracy: 0.5007
2025-09-22 03:25:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_1/epoch_20.pth
2025-09-22 03:25:41 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:25:41 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:25:41 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:25:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:25:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:26:35 [INFO]  Epoch 20 loss: 545.2932262420654; train accuracy: 0.684637661637931; test accuracy: 0.5244
2025-09-22 03:26:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_2/epoch_20.pth
2025-09-22 03:26:36 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:26:36 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:26:36 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:26:36 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:26:36 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:27:45 [INFO]  Epoch 20 loss: 623.6875228881836; train accuracy: 0.7677951388888888; test accuracy: 0.6352
2025-09-22 03:27:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_3/epoch_20.pth
2025-09-22 03:27:46 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:27:46 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:27:46 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:27:46 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:27:46 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:28:24 [INFO]  Epoch 20 loss: 339.68065452575684; train accuracy: 0.71484375; test accuracy: 0.4171
2025-09-22 03:28:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.5/local_models/client_4/epoch_20.pth
2025-09-22 03:28:24 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:28:24 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:28:24 [INFO]  Round 20 Finish--------|
2025-09-22 03:28:24 [INFO]  Model variance: mean: 0.0031576252076774836, sum: 35283.15234375
2025-09-22 03:28:24 [INFO]  g_protos_std: 1.0075900554656982
2025-09-22 03:28:32 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7926
2025-09-22 03:28:32 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.5/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml




2025-09-22 01:46:32 [INFO]  Load config from ./configs/CIFAR10_alpha0.3.yaml
2025-09-22 01:46:32 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.3', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.3}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1}
2025-09-22 01:46:34 [INFO]  Dataset CIFAR10 loaded
2025-09-22 01:46:34 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10.pt
2025-09-22 01:46:34 [INFO]  OneshotOurs
2025-09-22 01:46:35 [INFO]  Round 0 starts--------|
2025-09-22 01:46:35 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:46:38 [INFO]  generating sample per sample
2025-09-22 01:47:10 [INFO]  Epoch 0 loss: 397.4656295776367; train accuracy: 0.3972039473684211; test accuracy: 0.1551
2025-09-22 01:47:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_0.pth
2025-09-22 01:47:10 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:47:10 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:47:10 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:47:17 [INFO]  generating sample per sample
2025-09-22 01:48:05 [INFO]  Epoch 0 loss: 639.5694704055786; train accuracy: 0.27435105846774194; test accuracy: 0.1734
2025-09-22 01:48:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_0.pth
2025-09-22 01:48:05 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:48:05 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:48:05 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:48:12 [INFO]  generating sample per sample
2025-09-22 01:49:07 [INFO]  Epoch 0 loss: 723.9420337677002; train accuracy: 0.2919214221014493; test accuracy: 0.2102
2025-09-22 01:49:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_0.pth
2025-09-22 01:49:07 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:49:07 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:49:07 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:49:12 [INFO]  generating sample per sample
2025-09-22 01:49:51 [INFO]  Epoch 0 loss: 453.05716609954834; train accuracy: 0.2526633522727273; test accuracy: 0.1755
2025-09-22 01:49:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_0.pth
2025-09-22 01:49:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:49:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:49:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:49:57 [INFO]  generating sample per sample
2025-09-22 01:50:38 [INFO]  Epoch 0 loss: 493.9087505340576; train accuracy: 0.2263671875; test accuracy: 0.118
2025-09-22 01:50:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_0.pth
2025-09-22 01:50:38 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:50:38 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:50:38 [INFO]  Round 0 Finish--------|
2025-09-22 01:50:38 [INFO]  Model variance: mean: 0.000622703111730516, sum: 6958.0546875
2025-09-22 01:50:38 [INFO]  g_protos_std: 1.0059874057769775
2025-09-22 01:50:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3037
2025-09-22 01:50:47 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:50:47 [INFO]  Round 1 starts--------|
2025-09-22 01:50:47 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:51:19 [INFO]  Epoch 1 loss: 358.5286340713501; train accuracy: 0.3822985197368421; test accuracy: 0.1501
2025-09-22 01:51:19 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:51:19 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:51:19 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:52:10 [INFO]  Epoch 1 loss: 593.2674188613892; train accuracy: 0.3406313004032258; test accuracy: 0.2237
2025-09-22 01:52:10 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:52:10 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:52:10 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:53:10 [INFO]  Epoch 1 loss: 673.8849143981934; train accuracy: 0.31739696557971014; test accuracy: 0.2323
2025-09-22 01:53:10 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:53:10 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:53:10 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:53:49 [INFO]  Epoch 1 loss: 413.6703824996948; train accuracy: 0.30064808238636365; test accuracy: 0.1922
2025-09-22 01:53:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:53:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:53:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:54:33 [INFO]  Epoch 1 loss: 450.16279888153076; train accuracy: 0.352421875; test accuracy: 0.1801
2025-09-22 01:54:33 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:54:33 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:54:33 [INFO]  Round 1 Finish--------|
2025-09-22 01:54:33 [INFO]  Model variance: mean: 0.0008485746802762151, sum: 9481.9326171875
2025-09-22 01:54:33 [INFO]  g_protos_std: 1.0059796571731567
2025-09-22 01:54:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4074
2025-09-22 01:54:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:54:41 [INFO]  Round 2 starts--------|
2025-09-22 01:54:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:55:16 [INFO]  Epoch 2 loss: 350.0599374771118; train accuracy: 0.35922080592105265; test accuracy: 0.1447
2025-09-22 01:55:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:55:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:55:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:56:08 [INFO]  Epoch 2 loss: 566.664155960083; train accuracy: 0.32544732862903225; test accuracy: 0.2144
2025-09-22 01:56:08 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:56:08 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:56:08 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:57:09 [INFO]  Epoch 2 loss: 653.8885660171509; train accuracy: 0.37406589673913043; test accuracy: 0.288
2025-09-22 01:57:09 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:57:09 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:57:09 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:57:49 [INFO]  Epoch 2 loss: 391.2167167663574; train accuracy: 0.3341619318181818; test accuracy: 0.2065
2025-09-22 01:57:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:57:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:57:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:58:33 [INFO]  Epoch 2 loss: 441.54154109954834; train accuracy: 0.359140625; test accuracy: 0.1849
2025-09-22 01:58:33 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:58:33 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:58:33 [INFO]  Round 2 Finish--------|
2025-09-22 01:58:33 [INFO]  Model variance: mean: 0.001033975393511355, sum: 11553.591796875
2025-09-22 01:58:33 [INFO]  g_protos_std: 1.0059818029403687
2025-09-22 01:58:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4479
2025-09-22 01:58:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:58:41 [INFO]  Round 3 starts--------|
2025-09-22 01:58:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:59:17 [INFO]  Epoch 3 loss: 345.2817630767822; train accuracy: 0.34750205592105265; test accuracy: 0.1609
2025-09-22 01:59:17 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:59:17 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:59:17 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:00:17 [INFO]  Epoch 3 loss: 549.8023462295532; train accuracy: 0.48528855846774194; test accuracy: 0.3156
2025-09-22 02:00:17 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:00:17 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:00:17 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:01:21 [INFO]  Epoch 3 loss: 634.8319082260132; train accuracy: 0.43500905797101447; test accuracy: 0.342
2025-09-22 02:01:21 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:01:21 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:01:21 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:02:02 [INFO]  Epoch 3 loss: 384.57726097106934; train accuracy: 0.4240056818181818; test accuracy: 0.2602
2025-09-22 02:02:02 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:02:02 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:02:02 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:02:48 [INFO]  Epoch 3 loss: 428.79166650772095; train accuracy: 0.4233984375; test accuracy: 0.218
2025-09-22 02:02:48 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:02:48 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:02:48 [INFO]  Round 3 Finish--------|
2025-09-22 02:02:48 [INFO]  Model variance: mean: 0.0011891707545146346, sum: 13287.7373046875
2025-09-22 02:02:48 [INFO]  g_protos_std: 1.0059880018234253
2025-09-22 02:02:57 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4966
2025-09-22 02:02:57 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:02:57 [INFO]  Round 4 starts--------|
2025-09-22 02:02:57 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:03:33 [INFO]  Epoch 4 loss: 339.2158508300781; train accuracy: 0.4929070723684211; test accuracy: 0.2069
2025-09-22 02:03:33 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:03:33 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:03:33 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:04:31 [INFO]  Epoch 4 loss: 532.4914903640747; train accuracy: 0.5137978830645161; test accuracy: 0.3418
2025-09-22 02:04:31 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:04:31 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:04:31 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:05:35 [INFO]  Epoch 4 loss: 619.4267225265503; train accuracy: 0.49946218297101447; test accuracy: 0.3637
2025-09-22 02:05:35 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:05:35 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:05:35 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:06:17 [INFO]  Epoch 4 loss: 377.90617418289185; train accuracy: 0.38782848011363635; test accuracy: 0.2048
2025-09-22 02:06:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:06:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:06:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:07:06 [INFO]  Epoch 4 loss: 417.9137907028198; train accuracy: 0.496875; test accuracy: 0.2512
2025-09-22 02:07:06 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:07:06 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:07:06 [INFO]  Round 4 Finish--------|
2025-09-22 02:07:06 [INFO]  Model variance: mean: 0.0013356396229937673, sum: 14924.373046875
2025-09-22 02:07:06 [INFO]  g_protos_std: 1.0060060024261475
2025-09-22 02:07:13 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.529
2025-09-22 02:07:13 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:07:13 [INFO]  Round 5 starts--------|
2025-09-22 02:07:13 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:07:49 [INFO]  Epoch 5 loss: 337.26091480255127; train accuracy: 0.4248046875; test accuracy: 0.1877
2025-09-22 02:07:49 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_5.pth
2025-09-22 02:07:49 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:07:49 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:07:49 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:08:47 [INFO]  Epoch 5 loss: 514.332353591919; train accuracy: 0.4965662802419355; test accuracy: 0.3443
2025-09-22 02:08:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_5.pth
2025-09-22 02:08:47 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:08:47 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:08:47 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:09:52 [INFO]  Epoch 5 loss: 609.381459236145; train accuracy: 0.5176913496376812; test accuracy: 0.3891
2025-09-22 02:09:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_5.pth
2025-09-22 02:09:52 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:09:52 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:09:52 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:10:33 [INFO]  Epoch 5 loss: 368.4526515007019; train accuracy: 0.5577059659090909; test accuracy: 0.3022
2025-09-22 02:10:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_5.pth
2025-09-22 02:10:33 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:10:33 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:10:33 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:11:23 [INFO]  Epoch 5 loss: 408.04685735702515; train accuracy: 0.543984375; test accuracy: 0.2792
2025-09-22 02:11:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_5.pth
2025-09-22 02:11:23 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:11:23 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:11:23 [INFO]  Round 5 Finish--------|
2025-09-22 02:11:23 [INFO]  Model variance: mean: 0.0014749281108379364, sum: 16480.775390625
2025-09-22 02:11:23 [INFO]  g_protos_std: 1.0060272216796875
2025-09-22 02:11:30 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5702
2025-09-22 02:11:30 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:11:30 [INFO]  Round 6 starts--------|
2025-09-22 02:11:30 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:12:11 [INFO]  Epoch 6 loss: 329.0546073913574; train accuracy: 0.4106188322368421; test accuracy: 0.207
2025-09-22 02:12:11 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:12:11 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:12:11 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:13:13 [INFO]  Epoch 6 loss: 514.5478529930115; train accuracy: 0.4758694556451613; test accuracy: 0.3326
2025-09-22 02:13:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:13:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:13:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:14:17 [INFO]  Epoch 6 loss: 601.4824819564819; train accuracy: 0.4891021286231884; test accuracy: 0.3537
2025-09-22 02:14:17 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:14:17 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:14:17 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:14:59 [INFO]  Epoch 6 loss: 366.73125076293945; train accuracy: 0.5779030539772727; test accuracy: 0.3192
2025-09-22 02:14:59 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:14:59 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:14:59 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:15:47 [INFO]  Epoch 6 loss: 392.4600443840027; train accuracy: 0.5415234375; test accuracy: 0.2742
2025-09-22 02:15:47 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:15:47 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:15:47 [INFO]  Round 6 Finish--------|
2025-09-22 02:15:47 [INFO]  Model variance: mean: 0.001602091477252543, sum: 17901.693359375
2025-09-22 02:15:47 [INFO]  g_protos_std: 1.006036639213562
2025-09-22 02:15:54 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5746
2025-09-22 02:15:54 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:15:54 [INFO]  Round 7 starts--------|
2025-09-22 02:15:54 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:16:32 [INFO]  Epoch 7 loss: 320.7642922401428; train accuracy: 0.5341282894736842; test accuracy: 0.2718
2025-09-22 02:16:32 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:16:32 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:16:32 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:17:31 [INFO]  Epoch 7 loss: 487.88888788223267; train accuracy: 0.5193737399193549; test accuracy: 0.3496
2025-09-22 02:17:31 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:17:31 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:17:31 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:18:38 [INFO]  Epoch 7 loss: 595.7048153877258; train accuracy: 0.5851732336956522; test accuracy: 0.4586
2025-09-22 02:18:38 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:18:38 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:18:38 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:19:20 [INFO]  Epoch 7 loss: 353.55761909484863; train accuracy: 0.5171786221590909; test accuracy: 0.2737
2025-09-22 02:19:20 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:19:20 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:19:20 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:20:07 [INFO]  Epoch 7 loss: 385.8820991516113; train accuracy: 0.6286328125; test accuracy: 0.3199
2025-09-22 02:20:07 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:20:07 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:20:07 [INFO]  Round 7 Finish--------|
2025-09-22 02:20:07 [INFO]  Model variance: mean: 0.0017260119784623384, sum: 19286.375
2025-09-22 02:20:07 [INFO]  g_protos_std: 1.0060638189315796
2025-09-22 02:20:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6151
2025-09-22 02:20:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:20:14 [INFO]  Round 8 starts--------|
2025-09-22 02:20:14 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:20:50 [INFO]  Epoch 8 loss: 315.7400097846985; train accuracy: 0.51953125; test accuracy: 0.2639
2025-09-22 02:20:50 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:20:50 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:20:50 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:21:45 [INFO]  Epoch 8 loss: 481.06095123291016; train accuracy: 0.6131867439516129; test accuracy: 0.438
2025-09-22 02:21:45 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:21:45 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:21:45 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:22:49 [INFO]  Epoch 8 loss: 582.4634504318237; train accuracy: 0.630661231884058; test accuracy: 0.4606
2025-09-22 02:22:49 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:22:49 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:22:49 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:23:32 [INFO]  Epoch 8 loss: 351.5832152366638; train accuracy: 0.6993519176136364; test accuracy: 0.3837
2025-09-22 02:23:32 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:23:32 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:23:32 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:24:19 [INFO]  Epoch 8 loss: 389.1653575897217; train accuracy: 0.526875; test accuracy: 0.2695
2025-09-22 02:24:19 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:24:19 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:24:19 [INFO]  Round 8 Finish--------|
2025-09-22 02:24:19 [INFO]  Model variance: mean: 0.0018424999434500933, sum: 20588.005859375
2025-09-22 02:24:19 [INFO]  g_protos_std: 1.0060791969299316
2025-09-22 02:24:26 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6198
2025-09-22 02:24:26 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:24:26 [INFO]  Round 9 starts--------|
2025-09-22 02:24:26 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:25:05 [INFO]  Epoch 9 loss: 312.7684416770935; train accuracy: 0.46371299342105265; test accuracy: 0.255
2025-09-22 02:25:05 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:25:05 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:25:05 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:26:05 [INFO]  Epoch 9 loss: 479.4159879684448; train accuracy: 0.6043031754032258; test accuracy: 0.4508
2025-09-22 02:26:05 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:26:05 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:26:05 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:27:12 [INFO]  Epoch 9 loss: 571.6137428283691; train accuracy: 0.6228204257246377; test accuracy: 0.4667
2025-09-22 02:27:12 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:27:12 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:27:12 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:27:55 [INFO]  Epoch 9 loss: 347.8556351661682; train accuracy: 0.6609552556818182; test accuracy: 0.3526
2025-09-22 02:27:55 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:27:55 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:27:55 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:28:44 [INFO]  Epoch 9 loss: 379.51958656311035; train accuracy: 0.71421875; test accuracy: 0.3632
2025-09-22 02:28:44 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:28:44 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:28:44 [INFO]  Round 9 Finish--------|
2025-09-22 02:28:44 [INFO]  Model variance: mean: 0.0019557580817490816, sum: 21853.546875
2025-09-22 02:28:44 [INFO]  g_protos_std: 1.0060981512069702
2025-09-22 02:28:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6446
2025-09-22 02:28:51 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:28:51 [INFO]  Round 10 starts--------|
2025-09-22 02:28:51 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:29:29 [INFO]  Epoch 10 loss: 313.4249391555786; train accuracy: 0.60546875; test accuracy: 0.3287
2025-09-22 02:29:29 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_10.pth
2025-09-22 02:29:29 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:29:29 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:29:29 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:30:27 [INFO]  Epoch 10 loss: 474.96520805358887; train accuracy: 0.640593497983871; test accuracy: 0.5033
2025-09-22 02:30:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_10.pth
2025-09-22 02:30:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:30:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:30:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:31:33 [INFO]  Epoch 10 loss: 561.6683549880981; train accuracy: 0.6666666666666666; test accuracy: 0.4897
2025-09-22 02:31:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_10.pth
2025-09-22 02:31:33 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:31:33 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:31:33 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:32:14 [INFO]  Epoch 10 loss: 349.6955862045288; train accuracy: 0.6646839488636364; test accuracy: 0.3627
2025-09-22 02:32:15 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_10.pth
2025-09-22 02:32:15 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:32:15 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:32:15 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:33:04 [INFO]  Epoch 10 loss: 371.3285503387451; train accuracy: 0.6314453125; test accuracy: 0.3189
2025-09-22 02:33:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_10.pth
2025-09-22 02:33:04 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:33:04 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:33:04 [INFO]  Round 10 Finish--------|
2025-09-22 02:33:04 [INFO]  Model variance: mean: 0.0020607805345207453, sum: 23027.0625
2025-09-22 02:33:04 [INFO]  g_protos_std: 1.0061094760894775
2025-09-22 02:33:12 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6587
2025-09-22 02:33:12 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:33:12 [INFO]  Round 11 starts--------|
2025-09-22 02:33:12 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:33:46 [INFO]  Epoch 11 loss: 304.31577253341675; train accuracy: 0.6271073190789473; test accuracy: 0.2885
2025-09-22 02:33:46 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:33:46 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:33:46 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:34:41 [INFO]  Epoch 11 loss: 472.1248321533203; train accuracy: 0.6906817036290323; test accuracy: 0.4922
2025-09-22 02:34:41 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:34:42 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:34:42 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:35:47 [INFO]  Epoch 11 loss: 557.1397399902344; train accuracy: 0.6261322463768116; test accuracy: 0.4725
2025-09-22 02:35:47 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:35:47 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:35:47 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:36:29 [INFO]  Epoch 11 loss: 341.10350704193115; train accuracy: 0.6716530539772727; test accuracy: 0.4074
2025-09-22 02:36:29 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:36:29 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:36:29 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:37:18 [INFO]  Epoch 11 loss: 362.9301896095276; train accuracy: 0.6117578125; test accuracy: 0.3188
2025-09-22 02:37:18 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:37:18 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:37:18 [INFO]  Round 11 Finish--------|
2025-09-22 02:37:18 [INFO]  Model variance: mean: 0.0021630404517054558, sum: 24169.708984375
2025-09-22 02:37:18 [INFO]  g_protos_std: 1.006126046180725
2025-09-22 02:37:25 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6728
2025-09-22 02:37:25 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:37:25 [INFO]  Round 12 starts--------|
2025-09-22 02:37:25 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:38:01 [INFO]  Epoch 12 loss: 302.1256728172302; train accuracy: 0.64453125; test accuracy: 0.3974
2025-09-22 02:38:01 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:38:01 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:38:01 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:38:59 [INFO]  Epoch 12 loss: 465.5344891548157; train accuracy: 0.7772807459677419; test accuracy: 0.5747
2025-09-22 02:38:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:38:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:38:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:40:00 [INFO]  Epoch 12 loss: 554.3624858856201; train accuracy: 0.6058933423913043; test accuracy: 0.4608
2025-09-22 02:40:00 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:40:00 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:40:00 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:40:43 [INFO]  Epoch 12 loss: 336.9589595794678; train accuracy: 0.5691583806818182; test accuracy: 0.365
2025-09-22 02:40:43 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:40:43 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:40:43 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:41:31 [INFO]  Epoch 12 loss: 356.7052159309387; train accuracy: 0.746328125; test accuracy: 0.3889
2025-09-22 02:41:31 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:41:31 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:41:31 [INFO]  Round 12 Finish--------|
2025-09-22 02:41:31 [INFO]  Model variance: mean: 0.0022638370282948017, sum: 25296.005859375
2025-09-22 02:41:31 [INFO]  g_protos_std: 1.00614333152771
2025-09-22 02:41:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6885
2025-09-22 02:41:38 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:41:38 [INFO]  Round 13 starts--------|
2025-09-22 02:41:38 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:42:13 [INFO]  Epoch 13 loss: 302.5890197753906; train accuracy: 0.6453536184210527; test accuracy: 0.3783
2025-09-22 02:42:13 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:42:13 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:42:13 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:43:09 [INFO]  Epoch 13 loss: 457.418007850647; train accuracy: 0.6751512096774194; test accuracy: 0.5084
2025-09-22 02:43:09 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:43:09 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:43:09 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:44:16 [INFO]  Epoch 13 loss: 550.8494391441345; train accuracy: 0.6480978260869565; test accuracy: 0.4943
2025-09-22 02:44:16 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:44:16 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:44:16 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:44:57 [INFO]  Epoch 13 loss: 333.8521294593811; train accuracy: 0.7004172585227273; test accuracy: 0.423
2025-09-22 02:44:57 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:44:57 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:44:57 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:45:43 [INFO]  Epoch 13 loss: 359.38081645965576; train accuracy: 0.74734375; test accuracy: 0.404
2025-09-22 02:45:43 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:45:43 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:45:43 [INFO]  Round 13 Finish--------|
2025-09-22 02:45:43 [INFO]  Model variance: mean: 0.00235729874111712, sum: 26340.34375
2025-09-22 02:45:43 [INFO]  g_protos_std: 1.0061577558517456
2025-09-22 02:45:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6977
2025-09-22 02:45:51 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:45:51 [INFO]  Round 14 starts--------|
2025-09-22 02:45:51 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:46:26 [INFO]  Epoch 14 loss: 294.31902742385864; train accuracy: 0.6427837171052632; test accuracy: 0.3494
2025-09-22 02:46:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:46:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:46:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:47:26 [INFO]  Epoch 14 loss: 454.7907905578613; train accuracy: 0.7173009072580645; test accuracy: 0.5326
2025-09-22 02:47:26 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:47:26 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:47:26 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:48:27 [INFO]  Epoch 14 loss: 536.3504447937012; train accuracy: 0.7066066576086957; test accuracy: 0.5307
2025-09-22 02:48:27 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:48:27 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:48:27 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:49:09 [INFO]  Epoch 14 loss: 330.84571647644043; train accuracy: 0.748046875; test accuracy: 0.4652
2025-09-22 02:49:09 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:49:09 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:49:09 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:49:56 [INFO]  Epoch 14 loss: 356.80759954452515; train accuracy: 0.6879296875; test accuracy: 0.363
2025-09-22 02:49:56 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:49:56 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:49:56 [INFO]  Round 14 Finish--------|
2025-09-22 02:49:56 [INFO]  Model variance: mean: 0.0024503886234015226, sum: 27380.5234375
2025-09-22 02:49:56 [INFO]  g_protos_std: 1.0061726570129395
2025-09-22 02:50:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.705
2025-09-22 02:50:03 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:50:03 [INFO]  Round 15 starts--------|
2025-09-22 02:50:03 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:50:41 [INFO]  Epoch 15 loss: 295.97857093811035; train accuracy: 0.5618318256578947; test accuracy: 0.3315
2025-09-22 02:50:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_15.pth
2025-09-22 02:50:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:50:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:50:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:51:37 [INFO]  Epoch 15 loss: 453.4702978134155; train accuracy: 0.6928238407258065; test accuracy: 0.5227
2025-09-22 02:51:37 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_15.pth
2025-09-22 02:51:37 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:51:37 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:51:37 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:52:40 [INFO]  Epoch 15 loss: 538.2007083892822; train accuracy: 0.687698143115942; test accuracy: 0.5289
2025-09-22 02:52:40 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_15.pth
2025-09-22 02:52:40 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:52:40 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:52:40 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:53:20 [INFO]  Epoch 15 loss: 330.65858268737793; train accuracy: 0.7256747159090909; test accuracy: 0.4347
2025-09-22 02:53:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_15.pth
2025-09-22 02:53:20 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:53:20 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:53:20 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:54:09 [INFO]  Epoch 15 loss: 349.3971028327942; train accuracy: 0.7171484375; test accuracy: 0.386
2025-09-22 02:54:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_15.pth
2025-09-22 02:54:09 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:54:09 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:54:09 [INFO]  Round 15 Finish--------|
2025-09-22 02:54:09 [INFO]  Model variance: mean: 0.0025379823055118322, sum: 28359.29296875
2025-09-22 02:54:09 [INFO]  g_protos_std: 1.006184697151184
2025-09-22 02:54:17 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7028
2025-09-22 02:54:17 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:54:17 [INFO]  Round 16 starts--------|
2025-09-22 02:54:17 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:54:53 [INFO]  Epoch 16 loss: 286.4469246864319; train accuracy: 0.6200657894736842; test accuracy: 0.413
2025-09-22 02:54:53 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:54:53 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:54:53 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:55:53 [INFO]  Epoch 16 loss: 436.81676864624023; train accuracy: 0.7303742439516129; test accuracy: 0.5633
2025-09-22 02:55:53 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:55:53 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:55:53 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:56:59 [INFO]  Epoch 16 loss: 526.1778111457825; train accuracy: 0.7019927536231884; test accuracy: 0.5379
2025-09-22 02:56:59 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:56:59 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:56:59 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:57:40 [INFO]  Epoch 16 loss: 331.51504373550415; train accuracy: 0.6779119318181818; test accuracy: 0.442
2025-09-22 02:57:40 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:57:40 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:57:40 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:58:30 [INFO]  Epoch 16 loss: 347.8299765586853; train accuracy: 0.684921875; test accuracy: 0.3579
2025-09-22 02:58:30 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:58:30 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:58:30 [INFO]  Round 16 Finish--------|
2025-09-22 02:58:30 [INFO]  Model variance: mean: 0.0026267808862030506, sum: 29351.5234375
2025-09-22 02:58:30 [INFO]  g_protos_std: 1.006205439567566
2025-09-22 02:58:37 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7195
2025-09-22 02:58:37 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:58:37 [INFO]  Round 17 starts--------|
2025-09-22 02:58:37 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:59:17 [INFO]  Epoch 17 loss: 286.4992651939392; train accuracy: 0.7483552631578947; test accuracy: 0.4405
2025-09-22 02:59:17 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:59:17 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:59:17 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:00:15 [INFO]  Epoch 17 loss: 446.2200598716736; train accuracy: 0.6896736391129032; test accuracy: 0.5353
2025-09-22 03:00:15 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:00:15 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:00:15 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:01:17 [INFO]  Epoch 17 loss: 531.3701682090759; train accuracy: 0.6787533967391305; test accuracy: 0.5081
2025-09-22 03:01:17 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:01:17 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:01:17 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:02:00 [INFO]  Epoch 17 loss: 320.60103368759155; train accuracy: 0.7954545454545454; test accuracy: 0.4919
2025-09-22 03:02:00 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:02:00 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:02:00 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:02:47 [INFO]  Epoch 17 loss: 353.858021736145; train accuracy: 0.7871484375; test accuracy: 0.4181
2025-09-22 03:02:47 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:02:47 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:02:47 [INFO]  Round 17 Finish--------|
2025-09-22 03:02:47 [INFO]  Model variance: mean: 0.002711185486987233, sum: 30294.65625
2025-09-22 03:02:48 [INFO]  g_protos_std: 1.0062154531478882
2025-09-22 03:02:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7211
2025-09-22 03:02:55 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:02:55 [INFO]  Round 18 starts--------|
2025-09-22 03:02:55 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:03:34 [INFO]  Epoch 18 loss: 286.0241017341614; train accuracy: 0.6703844572368421; test accuracy: 0.4045
2025-09-22 03:03:34 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:03:34 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:03:34 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:04:33 [INFO]  Epoch 18 loss: 443.20826387405396; train accuracy: 0.7007938508064516; test accuracy: 0.5393
2025-09-22 03:04:33 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:04:33 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:04:33 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:05:37 [INFO]  Epoch 18 loss: 525.0012807846069; train accuracy: 0.6476732336956522; test accuracy: 0.478
2025-09-22 03:05:37 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:05:37 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:05:37 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:06:20 [INFO]  Epoch 18 loss: 325.64099502563477; train accuracy: 0.6822620738636364; test accuracy: 0.4247
2025-09-22 03:06:20 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:06:20 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:06:20 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:07:07 [INFO]  Epoch 18 loss: 344.09118604660034; train accuracy: 0.6583203125; test accuracy: 0.3522
2025-09-22 03:07:07 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:07:07 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:07:07 [INFO]  Round 18 Finish--------|
2025-09-22 03:07:07 [INFO]  Model variance: mean: 0.0027942040469497442, sum: 31222.302734375
2025-09-22 03:07:07 [INFO]  g_protos_std: 1.006230354309082
2025-09-22 03:07:15 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7194
2025-09-22 03:07:15 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:07:15 [INFO]  Round 19 starts--------|
2025-09-22 03:07:15 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:07:52 [INFO]  Epoch 19 loss: 284.22191190719604; train accuracy: 0.724609375; test accuracy: 0.4526
2025-09-22 03:07:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:07:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:07:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:08:52 [INFO]  Epoch 19 loss: 442.76066493988037; train accuracy: 0.736328125; test accuracy: 0.5662
2025-09-22 03:08:52 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:08:52 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:08:52 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:09:56 [INFO]  Epoch 19 loss: 512.3847198486328; train accuracy: 0.6920572916666666; test accuracy: 0.5215
2025-09-22 03:09:56 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:09:56 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:09:56 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:10:36 [INFO]  Epoch 19 loss: 322.1314072608948; train accuracy: 0.6671697443181818; test accuracy: 0.4361
2025-09-22 03:10:36 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:10:36 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:10:36 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:11:24 [INFO]  Epoch 19 loss: 344.9763813018799; train accuracy: 0.7855859375; test accuracy: 0.4379
2025-09-22 03:11:24 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:11:24 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:11:24 [INFO]  Round 19 Finish--------|
2025-09-22 03:11:24 [INFO]  Model variance: mean: 0.0028754074592143297, sum: 32129.6640625
2025-09-22 03:11:24 [INFO]  g_protos_std: 1.0062464475631714
2025-09-22 03:11:31 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7389
2025-09-22 03:11:31 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:11:31 [INFO]  Round 20 starts--------|
2025-09-22 03:11:31 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:12:07 [INFO]  Epoch 20 loss: 287.9446620941162; train accuracy: 0.7636204769736842; test accuracy: 0.4791
2025-09-22 03:12:07 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_20.pth
2025-09-22 03:12:07 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:12:07 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:12:07 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:13:04 [INFO]  Epoch 20 loss: 432.3150682449341; train accuracy: 0.7645539314516129; test accuracy: 0.5482
2025-09-22 03:13:04 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_20.pth
2025-09-22 03:13:04 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:13:04 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:13:04 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:14:09 [INFO]  Epoch 20 loss: 511.37461614608765; train accuracy: 0.7486696105072463; test accuracy: 0.5671
2025-09-22 03:14:09 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_20.pth
2025-09-22 03:14:09 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:14:09 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:14:09 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:14:50 [INFO]  Epoch 20 loss: 320.3373212814331; train accuracy: 0.7976740056818182; test accuracy: 0.4925
2025-09-22 03:14:50 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_20.pth
2025-09-22 03:14:50 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:14:50 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:14:50 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:15:36 [INFO]  Epoch 20 loss: 346.42678928375244; train accuracy: 0.8146875; test accuracy: 0.4595
2025-09-22 03:15:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_20.pth
2025-09-22 03:15:36 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:15:36 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:15:36 [INFO]  Round 20 Finish--------|
2025-09-22 03:15:36 [INFO]  Model variance: mean: 0.002953731920570135, sum: 33004.859375
2025-09-22 03:15:36 [INFO]  g_protos_std: 1.0062581300735474
2025-09-22 03:15:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.743
2025-09-22 03:15:44 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml




2025-09-22 01:49:03 [INFO]  Load config from ./configs/CIFAR10_alpha0.3_with_memorybank.yaml
2025-09-22 01:49:03 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.3', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.3}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'use_memory_bank': True, 'memory_bank_size': 4096}
2025-09-22 01:49:06 [INFO]  Dataset CIFAR10 loaded
2025-09-22 01:49:06 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10.pt
2025-09-22 01:49:06 [INFO]  OneshotOurs
2025-09-22 01:49:07 [INFO]  Round 0 starts--------|
2025-09-22 01:49:07 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:49:10 [INFO]  generating sample per sample
2025-09-22 01:49:10 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:49:10 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:49:35 [INFO]  Epoch 0 loss: 452.8600950241089; train accuracy: 0.4273231907894737; test accuracy: 0.1672
2025-09-22 01:49:35 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_0.pth
2025-09-22 01:49:35 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:49:35 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:49:35 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:49:42 [INFO]  generating sample per sample
2025-09-22 01:49:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:49:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:50:18 [INFO]  Epoch 0 loss: 727.6173973083496; train accuracy: 0.21978956653225806; test accuracy: 0.1442
2025-09-22 01:50:18 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_0.pth
2025-09-22 01:50:18 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:50:18 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:50:18 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:50:26 [INFO]  generating sample per sample
2025-09-22 01:50:26 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:50:26 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:51:06 [INFO]  Epoch 0 loss: 824.6779518127441; train accuracy: 0.27304121376811596; test accuracy: 0.1961
2025-09-22 01:51:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_0.pth
2025-09-22 01:51:06 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:51:06 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:51:06 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:51:11 [INFO]  generating sample per sample
2025-09-22 01:51:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:51:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:51:38 [INFO]  Epoch 0 loss: 515.4136648178101; train accuracy: 0.43989701704545453; test accuracy: 0.2249
2025-09-22 01:51:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_0.pth
2025-09-22 01:51:38 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:51:38 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:51:38 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:51:44 [INFO]  generating sample per sample
2025-09-22 01:51:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:51:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:52:17 [INFO]  Epoch 0 loss: 567.5255041122437; train accuracy: 0.2483984375; test accuracy: 0.127
2025-09-22 01:52:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_0.pth
2025-09-22 01:52:17 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:52:17 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:52:17 [INFO]  Round 0 Finish--------|
2025-09-22 01:52:17 [INFO]  Model variance: mean: 0.0006958345184102654, sum: 7775.2216796875
2025-09-22 01:52:17 [INFO]  g_protos_std: 1.0060471296310425
2025-09-22 01:52:25 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.2613
2025-09-22 01:52:25 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:52:25 [INFO]  Round 1 starts--------|
2025-09-22 01:52:25 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:52:25 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:52:25 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:52:54 [INFO]  Epoch 1 loss: 416.3091983795166; train accuracy: 0.4114925986842105; test accuracy: 0.1609
2025-09-22 01:52:54 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:52:54 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:52:54 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:52:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:52:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:53:40 [INFO]  Epoch 1 loss: 683.6266288757324; train accuracy: 0.35149949596774194; test accuracy: 0.2363
2025-09-22 01:53:40 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:53:40 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:53:40 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:53:40 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:53:40 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:54:31 [INFO]  Epoch 1 loss: 782.304048538208; train accuracy: 0.3939085144927536; test accuracy: 0.282
2025-09-22 01:54:32 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:54:32 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:54:32 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:54:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:54:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:55:09 [INFO]  Epoch 1 loss: 475.9540681838989; train accuracy: 0.23393110795454544; test accuracy: 0.1654
2025-09-22 01:55:09 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:55:09 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:55:09 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:55:09 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:55:09 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:55:51 [INFO]  Epoch 1 loss: 531.6506576538086; train accuracy: 0.3836328125; test accuracy: 0.1988
2025-09-22 01:55:51 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:55:51 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:55:51 [INFO]  Round 1 Finish--------|
2025-09-22 01:55:51 [INFO]  Model variance: mean: 0.0009273585164919496, sum: 10362.259765625
2025-09-22 01:55:51 [INFO]  g_protos_std: 1.0061702728271484
2025-09-22 01:55:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3591
2025-09-22 01:55:58 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:55:58 [INFO]  Round 2 starts--------|
2025-09-22 01:55:58 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:55:58 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:55:58 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:56:29 [INFO]  Epoch 2 loss: 408.9756317138672; train accuracy: 0.4370374177631579; test accuracy: 0.169
2025-09-22 01:56:29 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:56:29 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:56:29 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:56:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:56:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:57:19 [INFO]  Epoch 2 loss: 671.2014875411987; train accuracy: 0.29782006048387094; test accuracy: 0.201
2025-09-22 01:57:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:57:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:57:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:57:19 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:57:19 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:58:13 [INFO]  Epoch 2 loss: 766.6141843795776; train accuracy: 0.4729110054347826; test accuracy: 0.3439
2025-09-22 01:58:13 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:58:13 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:58:13 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:58:13 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:58:13 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:58:54 [INFO]  Epoch 2 loss: 463.12023162841797; train accuracy: 0.36323686079545453; test accuracy: 0.204
2025-09-22 01:58:54 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:58:54 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:58:54 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:58:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:58:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:59:41 [INFO]  Epoch 2 loss: 518.3125905990601; train accuracy: 0.3187890625; test accuracy: 0.164
2025-09-22 01:59:41 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:59:41 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:59:41 [INFO]  Round 2 Finish--------|
2025-09-22 01:59:41 [INFO]  Model variance: mean: 0.0011000890517607331, sum: 12292.341796875
2025-09-22 01:59:41 [INFO]  g_protos_std: 1.0062980651855469
2025-09-22 01:59:48 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3979
2025-09-22 01:59:48 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:59:48 [INFO]  Round 3 starts--------|
2025-09-22 01:59:48 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:59:48 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:59:48 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:00:25 [INFO]  Epoch 3 loss: 404.6774015426636; train accuracy: 0.4638671875; test accuracy: 0.1895
2025-09-22 02:00:25 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:00:25 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:00:25 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:00:25 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:00:25 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:01:23 [INFO]  Epoch 3 loss: 647.6109638214111; train accuracy: 0.3725743447580645; test accuracy: 0.2432
2025-09-22 02:01:23 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:01:23 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:01:23 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:01:23 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:01:23 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:02:21 [INFO]  Epoch 3 loss: 752.3587875366211; train accuracy: 0.4430763134057971; test accuracy: 0.3146
2025-09-22 02:02:21 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:02:21 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:02:21 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:02:21 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:02:21 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:03:01 [INFO]  Epoch 3 loss: 453.6126375198364; train accuracy: 0.4782492897727273; test accuracy: 0.2621
2025-09-22 02:03:01 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:03:01 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:03:01 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:03:01 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:03:01 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:03:44 [INFO]  Epoch 3 loss: 505.39124965667725; train accuracy: 0.4590625; test accuracy: 0.2337
2025-09-22 02:03:44 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:03:44 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:03:44 [INFO]  Round 3 Finish--------|
2025-09-22 02:03:44 [INFO]  Model variance: mean: 0.0012481051962822676, sum: 13946.267578125
2025-09-22 02:03:44 [INFO]  g_protos_std: 1.0064183473587036
2025-09-22 02:03:51 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4586
2025-09-22 02:03:51 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:03:51 [INFO]  Round 4 starts--------|
2025-09-22 02:03:51 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:03:51 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:03:51 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:04:26 [INFO]  Epoch 4 loss: 398.51751708984375; train accuracy: 0.37078536184210525; test accuracy: 0.1451
2025-09-22 02:04:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:04:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:04:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:04:26 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:04:26 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:05:21 [INFO]  Epoch 4 loss: 630.8925857543945; train accuracy: 0.41015625; test accuracy: 0.2732
2025-09-22 02:05:21 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:05:21 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:05:21 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:05:21 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:05:21 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:06:25 [INFO]  Epoch 4 loss: 736.6673545837402; train accuracy: 0.42170516304347827; test accuracy: 0.3058
2025-09-22 02:06:25 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:06:25 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:06:25 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:06:25 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:06:25 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:07:04 [INFO]  Epoch 4 loss: 446.49607372283936; train accuracy: 0.5680042613636364; test accuracy: 0.2888
2025-09-22 02:07:04 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:07:04 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:07:04 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:07:04 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:07:04 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:07:49 [INFO]  Epoch 4 loss: 493.90191555023193; train accuracy: 0.5966015625; test accuracy: 0.3103
2025-09-22 02:07:49 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:07:49 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:07:49 [INFO]  Round 4 Finish--------|
2025-09-22 02:07:49 [INFO]  Model variance: mean: 0.0013803478796035051, sum: 15423.9404296875
2025-09-22 02:07:49 [INFO]  g_protos_std: 1.00652277469635
2025-09-22 02:07:56 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4969
2025-09-22 02:07:56 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:07:56 [INFO]  Round 5 starts--------|
2025-09-22 02:07:56 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:07:56 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:07:56 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:08:30 [INFO]  Epoch 5 loss: 395.8996925354004; train accuracy: 0.4887438322368421; test accuracy: 0.1998
2025-09-22 02:08:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_5.pth
2025-09-22 02:08:30 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:08:30 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:08:30 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:08:30 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:08:30 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:09:24 [INFO]  Epoch 5 loss: 616.6686782836914; train accuracy: 0.5197832661290323; test accuracy: 0.3649
2025-09-22 02:09:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_5.pth
2025-09-22 02:09:25 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:09:25 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:09:25 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:09:25 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:09:25 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:10:26 [INFO]  Epoch 5 loss: 728.9200716018677; train accuracy: 0.39699388586956524; test accuracy: 0.2951
2025-09-22 02:10:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_5.pth
2025-09-22 02:10:27 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:10:27 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:10:27 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:10:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:10:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:11:11 [INFO]  Epoch 5 loss: 437.3135576248169; train accuracy: 0.6182972301136364; test accuracy: 0.3309
2025-09-22 02:11:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_5.pth
2025-09-22 02:11:11 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:11:11 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:11:11 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:11:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:11:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:12:00 [INFO]  Epoch 5 loss: 492.0768880844116; train accuracy: 0.4887109375; test accuracy: 0.2512
2025-09-22 02:12:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_5.pth
2025-09-22 02:12:01 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:12:01 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:12:01 [INFO]  Round 5 Finish--------|
2025-09-22 02:12:01 [INFO]  Model variance: mean: 0.0015028631314635277, sum: 16792.919921875
2025-09-22 02:12:01 [INFO]  g_protos_std: 1.0066142082214355
2025-09-22 02:12:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5277
2025-09-22 02:12:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:12:09 [INFO]  Round 6 starts--------|
2025-09-22 02:12:09 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:12:09 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:12:09 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:12:47 [INFO]  Epoch 6 loss: 390.6468086242676; train accuracy: 0.5553556743421053; test accuracy: 0.2509
2025-09-22 02:12:47 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:12:47 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:12:47 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:12:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:12:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:13:47 [INFO]  Epoch 6 loss: 607.6341495513916; train accuracy: 0.5442603326612904; test accuracy: 0.3638
2025-09-22 02:13:47 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:13:47 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:13:47 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:13:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:13:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:14:52 [INFO]  Epoch 6 loss: 714.4840230941772; train accuracy: 0.4722033514492754; test accuracy: 0.3461
2025-09-22 02:14:52 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:14:52 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:14:52 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:14:52 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:14:52 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:15:34 [INFO]  Epoch 6 loss: 434.4346561431885; train accuracy: 0.47416548295454547; test accuracy: 0.2691
2025-09-22 02:15:34 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:15:34 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:15:34 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:15:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:15:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:16:17 [INFO]  Epoch 6 loss: 483.5802307128906; train accuracy: 0.51515625; test accuracy: 0.2656
2025-09-22 02:16:17 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:16:17 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:16:17 [INFO]  Round 6 Finish--------|
2025-09-22 02:16:17 [INFO]  Model variance: mean: 0.0016179837984964252, sum: 18079.2734375
2025-09-22 02:16:17 [INFO]  g_protos_std: 1.0067002773284912
2025-09-22 02:16:24 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5458
2025-09-22 02:16:24 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:16:24 [INFO]  Round 7 starts--------|
2025-09-22 02:16:24 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:16:24 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:16:24 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:16:59 [INFO]  Epoch 7 loss: 385.38333320617676; train accuracy: 0.573961759868421; test accuracy: 0.2689
2025-09-22 02:16:59 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:16:59 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:16:59 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:16:59 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:16:59 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:17:54 [INFO]  Epoch 7 loss: 598.2441396713257; train accuracy: 0.5606098790322581; test accuracy: 0.3864
2025-09-22 02:17:54 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:17:54 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:17:54 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:17:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:17:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:18:57 [INFO]  Epoch 7 loss: 701.9340686798096; train accuracy: 0.5463937952898551; test accuracy: 0.4063
2025-09-22 02:18:57 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:18:57 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:18:57 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:18:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:18:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:19:37 [INFO]  Epoch 7 loss: 430.37999629974365; train accuracy: 0.5976118607954546; test accuracy: 0.3
2025-09-22 02:19:37 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:19:37 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:19:37 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:19:38 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:19:38 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:20:23 [INFO]  Epoch 7 loss: 472.90637969970703; train accuracy: 0.5055859375; test accuracy: 0.2619
2025-09-22 02:20:23 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:20:23 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:20:23 [INFO]  Round 7 Finish--------|
2025-09-22 02:20:23 [INFO]  Model variance: mean: 0.001729894895106554, sum: 19329.76171875
2025-09-22 02:20:23 [INFO]  g_protos_std: 1.0067811012268066
2025-09-22 02:20:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5785
2025-09-22 02:20:29 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:20:29 [INFO]  Round 8 starts--------|
2025-09-22 02:20:29 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:20:30 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:20:30 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:21:04 [INFO]  Epoch 8 loss: 378.2306671142578; train accuracy: 0.45805921052631576; test accuracy: 0.22
2025-09-22 02:21:04 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:21:04 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:21:04 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:21:04 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:21:04 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:22:03 [INFO]  Epoch 8 loss: 582.960654258728; train accuracy: 0.7047316028225806; test accuracy: 0.5008
2025-09-22 02:22:03 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:22:03 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:22:03 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:22:03 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:22:03 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:23:06 [INFO]  Epoch 8 loss: 700.9066390991211; train accuracy: 0.5963541666666666; test accuracy: 0.4338
2025-09-22 02:23:06 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:23:06 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:23:06 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:23:06 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:23:06 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:23:47 [INFO]  Epoch 8 loss: 423.0080213546753; train accuracy: 0.5390625; test accuracy: 0.3012
2025-09-22 02:23:47 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:23:47 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:23:47 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:23:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:23:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:24:34 [INFO]  Epoch 8 loss: 464.03285932540894; train accuracy: 0.5871875; test accuracy: 0.3046
2025-09-22 02:24:34 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:24:34 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:24:34 [INFO]  Round 8 Finish--------|
2025-09-22 02:24:34 [INFO]  Model variance: mean: 0.0018379074754193425, sum: 20536.689453125
2025-09-22 02:24:34 [INFO]  g_protos_std: 1.0068639516830444
2025-09-22 02:24:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6075
2025-09-22 02:24:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:24:41 [INFO]  Round 9 starts--------|
2025-09-22 02:24:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:24:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:24:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:25:16 [INFO]  Epoch 9 loss: 379.2552318572998; train accuracy: 0.462890625; test accuracy: 0.2137
2025-09-22 02:25:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:25:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:25:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:25:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:25:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:26:13 [INFO]  Epoch 9 loss: 578.9930157661438; train accuracy: 0.6330645161290323; test accuracy: 0.4309
2025-09-22 02:26:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:26:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:26:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:26:13 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:26:13 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:27:14 [INFO]  Epoch 9 loss: 688.1337842941284; train accuracy: 0.6322463768115942; test accuracy: 0.4687
2025-09-22 02:27:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:27:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:27:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:27:14 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:27:14 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:27:52 [INFO]  Epoch 9 loss: 424.4892506599426; train accuracy: 0.7346857244318182; test accuracy: 0.4022
2025-09-22 02:27:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:27:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:27:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:27:52 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:27:52 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:28:40 [INFO]  Epoch 9 loss: 456.3847179412842; train accuracy: 0.6882421875; test accuracy: 0.3539
2025-09-22 02:28:40 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:28:40 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:28:40 [INFO]  Round 9 Finish--------|
2025-09-22 02:28:40 [INFO]  Model variance: mean: 0.0019387819338589907, sum: 21663.85546875
2025-09-22 02:28:40 [INFO]  g_protos_std: 1.0069234371185303
2025-09-22 02:28:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6155
2025-09-22 02:28:47 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:28:47 [INFO]  Round 10 starts--------|
2025-09-22 02:28:47 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:28:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:28:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:29:23 [INFO]  Epoch 10 loss: 369.79186820983887; train accuracy: 0.562756990131579; test accuracy: 0.2559
2025-09-22 02:29:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_10.pth
2025-09-22 02:29:24 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:29:24 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:29:24 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:29:24 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:29:24 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:30:21 [INFO]  Epoch 10 loss: 574.0657501220703; train accuracy: 0.6875630040322581; test accuracy: 0.4833
2025-09-22 02:30:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_10.pth
2025-09-22 02:30:22 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:30:22 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:30:22 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:30:22 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:30:22 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:31:28 [INFO]  Epoch 10 loss: 690.3871984481812; train accuracy: 0.6145550271739131; test accuracy: 0.462
2025-09-22 02:31:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_10.pth
2025-09-22 02:31:28 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:31:28 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:31:28 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:31:28 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:31:28 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:32:10 [INFO]  Epoch 10 loss: 418.7451763153076; train accuracy: 0.6697443181818182; test accuracy: 0.3693
2025-09-22 02:32:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_10.pth
2025-09-22 02:32:11 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:32:11 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:32:11 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:32:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:32:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:32:54 [INFO]  Epoch 10 loss: 453.84004974365234; train accuracy: 0.7690625; test accuracy: 0.3938
2025-09-22 02:32:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_10.pth
2025-09-22 02:32:54 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:32:54 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:32:54 [INFO]  Round 10 Finish--------|
2025-09-22 02:32:54 [INFO]  Model variance: mean: 0.0020336138550192118, sum: 22723.50390625
2025-09-22 02:32:54 [INFO]  g_protos_std: 1.0069807767868042
2025-09-22 02:33:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6319
2025-09-22 02:33:01 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:33:01 [INFO]  Round 11 starts--------|
2025-09-22 02:33:01 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:33:01 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:33:01 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:33:37 [INFO]  Epoch 11 loss: 363.4648561477661; train accuracy: 0.5807462993421053; test accuracy: 0.3003
2025-09-22 02:33:37 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:33:37 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:33:37 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:33:37 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:33:37 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:34:30 [INFO]  Epoch 11 loss: 576.4699869155884; train accuracy: 0.668913810483871; test accuracy: 0.4966
2025-09-22 02:34:30 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:34:30 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:34:30 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:34:30 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:34:30 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:35:32 [INFO]  Epoch 11 loss: 685.8340177536011; train accuracy: 0.6681951992753623; test accuracy: 0.4862
2025-09-22 02:35:32 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:35:32 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:35:32 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:35:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:35:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:36:11 [INFO]  Epoch 11 loss: 412.1784477233887; train accuracy: 0.6344105113636364; test accuracy: 0.3327
2025-09-22 02:36:11 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:36:11 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:36:11 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:36:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:36:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:36:54 [INFO]  Epoch 11 loss: 455.2051057815552; train accuracy: 0.6081640625; test accuracy: 0.3098
2025-09-22 02:36:54 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:36:54 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:36:54 [INFO]  Round 11 Finish--------|
2025-09-22 02:36:54 [INFO]  Model variance: mean: 0.0021232585422694683, sum: 23725.1875
2025-09-22 02:36:54 [INFO]  g_protos_std: 1.0070456266403198
2025-09-22 02:37:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6471
2025-09-22 02:37:01 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:37:01 [INFO]  Round 12 starts--------|
2025-09-22 02:37:01 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:37:01 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:37:01 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:37:35 [INFO]  Epoch 12 loss: 359.8479804992676; train accuracy: 0.6756270559210527; test accuracy: 0.3604
2025-09-22 02:37:35 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:37:35 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:37:35 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:37:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:37:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:38:29 [INFO]  Epoch 12 loss: 569.9236431121826; train accuracy: 0.7051726310483871; test accuracy: 0.4979
2025-09-22 02:38:29 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:38:29 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:38:29 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:38:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:38:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:39:30 [INFO]  Epoch 12 loss: 672.3731622695923; train accuracy: 0.6428894927536232; test accuracy: 0.4771
2025-09-22 02:39:30 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:39:30 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:39:30 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:39:30 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:39:30 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:40:09 [INFO]  Epoch 12 loss: 410.10105419158936; train accuracy: 0.7210582386363636; test accuracy: 0.424
2025-09-22 02:40:09 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:40:09 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:40:09 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:40:09 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:40:09 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:40:52 [INFO]  Epoch 12 loss: 440.9009847640991; train accuracy: 0.75296875; test accuracy: 0.3961
2025-09-22 02:40:52 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:40:52 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:40:52 [INFO]  Round 12 Finish--------|
2025-09-22 02:40:52 [INFO]  Model variance: mean: 0.0022101907525211573, sum: 24696.56640625
2025-09-22 02:40:52 [INFO]  g_protos_std: 1.0070916414260864
2025-09-22 02:40:59 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6531
2025-09-22 02:40:59 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:40:59 [INFO]  Round 13 starts--------|
2025-09-22 02:40:59 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:40:59 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:40:59 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:41:34 [INFO]  Epoch 13 loss: 359.7909240722656; train accuracy: 0.5958573190789473; test accuracy: 0.312
2025-09-22 02:41:34 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:41:34 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:41:34 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:41:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:41:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:42:27 [INFO]  Epoch 13 loss: 559.8697910308838; train accuracy: 0.6849168346774194; test accuracy: 0.4975
2025-09-22 02:42:27 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:42:27 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:42:27 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:42:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:42:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:43:26 [INFO]  Epoch 13 loss: 670.3882985115051; train accuracy: 0.6772248641304348; test accuracy: 0.505
2025-09-22 02:43:26 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:43:26 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:43:26 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:43:26 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:43:26 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:44:04 [INFO]  Epoch 13 loss: 405.3398470878601; train accuracy: 0.6908291903409091; test accuracy: 0.4173
2025-09-22 02:44:04 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:44:04 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:44:04 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:44:04 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:44:04 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:44:45 [INFO]  Epoch 13 loss: 446.77578353881836; train accuracy: 0.7537890625; test accuracy: 0.4142
2025-09-22 02:44:45 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:44:45 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:44:45 [INFO]  Round 13 Finish--------|
2025-09-22 02:44:45 [INFO]  Model variance: mean: 0.0022964829113334417, sum: 25660.7890625
2025-09-22 02:44:45 [INFO]  g_protos_std: 1.007146954536438
2025-09-22 02:44:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6527
2025-09-22 02:44:52 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:44:52 [INFO]  Round 14 starts--------|
2025-09-22 02:44:52 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:44:52 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:44:52 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:45:24 [INFO]  Epoch 14 loss: 356.481782913208; train accuracy: 0.6069078947368421; test accuracy: 0.2946
2025-09-22 02:45:24 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:45:24 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:45:24 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:45:24 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:45:24 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:46:19 [INFO]  Epoch 14 loss: 566.7626514434814; train accuracy: 0.6769153225806451; test accuracy: 0.4772
2025-09-22 02:46:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:46:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:46:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:46:19 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:46:19 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:47:18 [INFO]  Epoch 14 loss: 659.022289276123; train accuracy: 0.6739979619565217; test accuracy: 0.5036
2025-09-22 02:47:18 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:47:18 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:47:18 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:47:18 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:47:18 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:47:55 [INFO]  Epoch 14 loss: 406.48946475982666; train accuracy: 0.7369495738636364; test accuracy: 0.4331
2025-09-22 02:47:55 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:47:55 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:47:55 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:47:55 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:47:55 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:48:39 [INFO]  Epoch 14 loss: 442.5723452568054; train accuracy: 0.7687109375; test accuracy: 0.4212
2025-09-22 02:48:39 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:48:39 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:48:39 [INFO]  Round 14 Finish--------|
2025-09-22 02:48:39 [INFO]  Model variance: mean: 0.0023793806321918964, sum: 26587.083984375
2025-09-22 02:48:39 [INFO]  g_protos_std: 1.0071924924850464
2025-09-22 02:48:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6705
2025-09-22 02:48:46 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:48:46 [INFO]  Round 15 starts--------|
2025-09-22 02:48:46 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:48:46 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:48:46 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:49:19 [INFO]  Epoch 15 loss: 357.10064601898193; train accuracy: 0.7362767269736842; test accuracy: 0.4274
2025-09-22 02:49:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_15.pth
2025-09-22 02:49:20 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:49:20 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:49:20 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:49:20 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:49:20 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:50:11 [INFO]  Epoch 15 loss: 563.7510242462158; train accuracy: 0.6018775201612904; test accuracy: 0.4449
2025-09-22 02:50:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_15.pth
2025-09-22 02:50:12 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:50:12 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:50:12 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:50:12 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:50:12 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:51:13 [INFO]  Epoch 15 loss: 665.522011756897; train accuracy: 0.6641757246376812; test accuracy: 0.4995
2025-09-22 02:51:13 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_15.pth
2025-09-22 02:51:13 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:51:13 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:51:13 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:51:13 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:51:13 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:51:54 [INFO]  Epoch 15 loss: 400.75504970550537; train accuracy: 0.7418323863636364; test accuracy: 0.4509
2025-09-22 02:51:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_15.pth
2025-09-22 02:51:54 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:51:54 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:51:54 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:51:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:51:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:52:38 [INFO]  Epoch 15 loss: 442.39113664627075; train accuracy: 0.6879296875; test accuracy: 0.3658
2025-09-22 02:52:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_15.pth
2025-09-22 02:52:38 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:52:38 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:52:38 [INFO]  Round 15 Finish--------|
2025-09-22 02:52:38 [INFO]  Model variance: mean: 0.002457886701449752, sum: 27464.30859375
2025-09-22 02:52:38 [INFO]  g_protos_std: 1.0072342157363892
2025-09-22 02:52:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6725
2025-09-22 02:52:44 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:52:44 [INFO]  Round 16 starts--------|
2025-09-22 02:52:44 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:52:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:52:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:53:18 [INFO]  Epoch 16 loss: 353.3790121078491; train accuracy: 0.6300884046052632; test accuracy: 0.3052
2025-09-22 02:53:18 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:53:18 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:53:18 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:53:18 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:53:18 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:54:15 [INFO]  Epoch 16 loss: 547.9018349647522; train accuracy: 0.57421875; test accuracy: 0.4283
2025-09-22 02:54:15 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:54:15 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:54:15 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:54:15 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:54:15 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:55:16 [INFO]  Epoch 16 loss: 652.3767375946045; train accuracy: 0.6849241394927537; test accuracy: 0.5194
2025-09-22 02:55:16 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:55:16 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:55:16 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:55:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:55:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:55:54 [INFO]  Epoch 16 loss: 396.6136894226074; train accuracy: 0.7005060369318182; test accuracy: 0.4118
2025-09-22 02:55:54 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:55:54 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:55:54 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:55:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:55:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:56:37 [INFO]  Epoch 16 loss: 439.1213550567627; train accuracy: 0.734375; test accuracy: 0.3989
2025-09-22 02:56:37 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:56:37 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:56:37 [INFO]  Round 16 Finish--------|
2025-09-22 02:56:37 [INFO]  Model variance: mean: 0.00253739464096725, sum: 28352.7265625
2025-09-22 02:56:37 [INFO]  g_protos_std: 1.0072771310806274
2025-09-22 02:56:44 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6959
2025-09-22 02:56:44 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:56:44 [INFO]  Round 17 starts--------|
2025-09-22 02:56:44 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:56:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:56:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:57:17 [INFO]  Epoch 17 loss: 353.82388639450073; train accuracy: 0.6751644736842105; test accuracy: 0.4116
2025-09-22 02:57:17 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:57:17 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:57:17 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:57:17 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:57:17 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:58:07 [INFO]  Epoch 17 loss: 550.852219581604; train accuracy: 0.7130166330645161; test accuracy: 0.5173
2025-09-22 02:58:07 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:58:07 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:58:07 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:58:07 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:58:07 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:59:07 [INFO]  Epoch 17 loss: 651.2730531692505; train accuracy: 0.546280570652174; test accuracy: 0.4054
2025-09-22 02:59:07 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:59:07 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:59:07 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:59:08 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:59:08 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:59:45 [INFO]  Epoch 17 loss: 398.2471876144409; train accuracy: 0.6684126420454546; test accuracy: 0.382
2025-09-22 02:59:45 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:59:45 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:59:45 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:59:45 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:59:45 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:00:27 [INFO]  Epoch 17 loss: 429.99966859817505; train accuracy: 0.6900390625; test accuracy: 0.3582
2025-09-22 03:00:27 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:00:27 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:00:27 [INFO]  Round 17 Finish--------|
2025-09-22 03:00:27 [INFO]  Model variance: mean: 0.0026115991640836, sum: 29181.8828125
2025-09-22 03:00:27 [INFO]  g_protos_std: 1.0073100328445435
2025-09-22 03:00:34 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.6849
2025-09-22 03:00:34 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:00:34 [INFO]  Round 18 starts--------|
2025-09-22 03:00:34 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:00:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:00:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:01:06 [INFO]  Epoch 18 loss: 350.12230014801025; train accuracy: 0.759765625; test accuracy: 0.426
2025-09-22 03:01:06 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:01:06 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:01:06 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:01:06 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:01:06 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:01:59 [INFO]  Epoch 18 loss: 547.243736743927; train accuracy: 0.6814201108870968; test accuracy: 0.512
2025-09-22 03:01:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:01:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:01:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:01:59 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:01:59 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:02:57 [INFO]  Epoch 18 loss: 642.5647468566895; train accuracy: 0.6028362771739131; test accuracy: 0.4554
2025-09-22 03:02:57 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:02:57 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:02:57 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:02:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:02:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:03:34 [INFO]  Epoch 18 loss: 394.79005002975464; train accuracy: 0.7673561789772727; test accuracy: 0.4214
2025-09-22 03:03:34 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:03:34 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:03:34 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:03:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:03:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:04:17 [INFO]  Epoch 18 loss: 430.61820793151855; train accuracy: 0.701640625; test accuracy: 0.3704
2025-09-22 03:04:17 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:04:17 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:04:17 [INFO]  Round 18 Finish--------|
2025-09-22 03:04:17 [INFO]  Model variance: mean: 0.0026864749379456043, sum: 30018.54296875
2025-09-22 03:04:17 [INFO]  g_protos_std: 1.0073423385620117
2025-09-22 03:04:23 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7005
2025-09-22 03:04:23 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:04:23 [INFO]  Round 19 starts--------|
2025-09-22 03:04:23 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:04:23 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:04:23 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:04:56 [INFO]  Epoch 19 loss: 342.42457342147827; train accuracy: 0.7748766447368421; test accuracy: 0.4608
2025-09-22 03:04:56 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:04:56 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:04:56 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:04:56 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:04:56 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:05:47 [INFO]  Epoch 19 loss: 538.9339838027954; train accuracy: 0.7758631552419355; test accuracy: 0.5699
2025-09-22 03:05:47 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:05:47 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:05:47 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:05:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:05:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:06:44 [INFO]  Epoch 19 loss: 639.9426693916321; train accuracy: 0.720901268115942; test accuracy: 0.542
2025-09-22 03:06:44 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:06:44 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:06:44 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:06:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:06:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:07:22 [INFO]  Epoch 19 loss: 393.09478092193604; train accuracy: 0.7717950994318182; test accuracy: 0.473
2025-09-22 03:07:22 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:07:22 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:07:22 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:07:22 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:07:22 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:08:04 [INFO]  Epoch 19 loss: 427.4447660446167; train accuracy: 0.7860546875; test accuracy: 0.4187
2025-09-22 03:08:04 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:08:04 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:08:04 [INFO]  Round 19 Finish--------|
2025-09-22 03:08:04 [INFO]  Model variance: mean: 0.0027597001753747463, sum: 30836.755859375
2025-09-22 03:08:04 [INFO]  g_protos_std: 1.0073798894882202
2025-09-22 03:08:10 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.72
2025-09-22 03:08:10 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 03:08:10 [INFO]  Round 20 starts--------|
2025-09-22 03:08:10 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 03:08:10 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:08:10 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:08:43 [INFO]  Epoch 20 loss: 344.5692443847656; train accuracy: 0.7134560032894737; test accuracy: 0.5032
2025-09-22 03:08:43 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_0/epoch_20.pth
2025-09-22 03:08:43 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 03:08:43 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 03:08:43 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 03:08:43 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:08:43 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:09:35 [INFO]  Epoch 20 loss: 541.1771187782288; train accuracy: 0.7762096774193549; test accuracy: 0.5646
2025-09-22 03:09:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_1/epoch_20.pth
2025-09-22 03:09:36 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 03:09:36 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 03:09:36 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 03:09:36 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:09:36 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:10:32 [INFO]  Epoch 20 loss: 638.6592950820923; train accuracy: 0.7152966485507246; test accuracy: 0.5215
2025-09-22 03:10:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_2/epoch_20.pth
2025-09-22 03:10:32 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 03:10:32 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 03:10:32 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 03:10:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:10:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:11:10 [INFO]  Epoch 20 loss: 390.94171380996704; train accuracy: 0.7627840909090909; test accuracy: 0.4726
2025-09-22 03:11:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_3/epoch_20.pth
2025-09-22 03:11:10 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 03:11:10 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 03:11:10 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 03:11:10 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 03:11:10 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 03:11:54 [INFO]  Epoch 20 loss: 427.8350625038147; train accuracy: 0.7959765625; test accuracy: 0.4472
2025-09-22 03:11:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.3/local_models/client_4/epoch_20.pth
2025-09-22 03:11:54 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 03:11:54 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 03:11:54 [INFO]  Round 20 Finish--------|
2025-09-22 03:11:54 [INFO]  Model variance: mean: 0.002827858319506049, sum: 31598.3515625
2025-09-22 03:11:54 [INFO]  g_protos_std: 1.0073952674865723
2025-09-22 03:12:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.7067
2025-09-22 03:12:01 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.3/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml




2025-09-22 01:50:22 [INFO]  Load config from ./configs/CIFAR10_alpha0.05.yaml
2025-09-22 01:50:22 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.05', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1}
2025-09-22 01:50:24 [INFO]  Dataset CIFAR10 loaded
2025-09-22 01:50:24 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10.pt
2025-09-22 01:50:24 [INFO]  OneshotOurs
2025-09-22 01:50:25 [INFO]  Round 0 starts--------|
2025-09-22 01:50:25 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:50:30 [INFO]  generating sample per sample
2025-09-22 01:51:05 [INFO]  Epoch 0 loss: 587.2354698181152; train accuracy: 0.2849542025862069; test accuracy: 0.1704
2025-09-22 01:51:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_0.pth
2025-09-22 01:51:06 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:51:06 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:51:06 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:51:07 [INFO]  generating sample per sample
2025-09-22 01:51:16 [INFO]  Epoch 0 loss: 111.66062211990356; train accuracy: 0.7521033653846154; test accuracy: 0.1144
2025-09-22 01:51:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_0.pth
2025-09-22 01:51:17 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:51:17 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:51:17 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:51:18 [INFO]  generating sample per sample
2025-09-22 01:51:26 [INFO]  Epoch 0 loss: 119.02467727661133; train accuracy: 0.8494318181818182; test accuracy: 0.1
2025-09-22 01:51:27 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_0.pth
2025-09-22 01:51:27 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:51:27 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:51:27 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:51:32 [INFO]  generating sample per sample
2025-09-22 01:52:01 [INFO]  Epoch 0 loss: 476.7403335571289; train accuracy: 0.25748005319148937; test accuracy: 0.1275
2025-09-22 01:52:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_0.pth
2025-09-22 01:52:01 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:52:01 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:52:01 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:52:05 [INFO]  generating sample per sample
2025-09-22 01:52:23 [INFO]  Epoch 0 loss: 301.0083131790161; train accuracy: 0.4014973958333333; test accuracy: 0.1272
2025-09-22 01:52:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_0.pth
2025-09-22 01:52:24 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:52:24 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:52:24 [INFO]  Round 0 Finish--------|
2025-09-22 01:52:24 [INFO]  Model variance: mean: 0.0005094854277558625, sum: 5692.96533203125
2025-09-22 01:52:24 [INFO]  g_protos_std: 1.0060614347457886
2025-09-22 01:52:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.2829
2025-09-22 01:52:29 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:52:29 [INFO]  Round 1 starts--------|
2025-09-22 01:52:29 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:53:05 [INFO]  Epoch 1 loss: 538.6883916854858; train accuracy: 0.38200431034482757; test accuracy: 0.2292
2025-09-22 01:53:05 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:53:05 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:53:05 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:53:14 [INFO]  Epoch 1 loss: 99.52527666091919; train accuracy: 0.4011418269230769; test accuracy: 0.1174
2025-09-22 01:53:14 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:53:14 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:53:14 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:53:23 [INFO]  Epoch 1 loss: 88.68253517150879; train accuracy: 0.8490767045454546; test accuracy: 0.1
2025-09-22 01:53:23 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:53:23 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:53:23 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:53:53 [INFO]  Epoch 1 loss: 436.609920501709; train accuracy: 0.4083277925531915; test accuracy: 0.1973
2025-09-22 01:53:53 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:53:53 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:53:53 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:54:14 [INFO]  Epoch 1 loss: 256.80935859680176; train accuracy: 0.3204427083333333; test accuracy: 0.1002
2025-09-22 01:54:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:54:14 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:54:14 [INFO]  Round 1 Finish--------|
2025-09-22 01:54:14 [INFO]  Model variance: mean: 0.0006434027454815805, sum: 7189.35107421875
2025-09-22 01:54:14 [INFO]  g_protos_std: 1.006077766418457
2025-09-22 01:54:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.345
2025-09-22 01:54:19 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:54:19 [INFO]  Round 2 starts--------|
2025-09-22 01:54:19 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:54:58 [INFO]  Epoch 2 loss: 519.4625701904297; train accuracy: 0.267578125; test accuracy: 0.1555
2025-09-22 01:54:58 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:54:58 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:54:58 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:55:08 [INFO]  Epoch 2 loss: 97.84989500045776; train accuracy: 0.7880108173076923; test accuracy: 0.1555
2025-09-22 01:55:08 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:55:08 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:55:08 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:55:17 [INFO]  Epoch 2 loss: 86.24399900436401; train accuracy: 0.29456676136363635; test accuracy: 0.0996
2025-09-22 01:55:17 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:55:17 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:55:17 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:55:49 [INFO]  Epoch 2 loss: 416.98790168762207; train accuracy: 0.30265126329787234; test accuracy: 0.1676
2025-09-22 01:55:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:55:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:55:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:56:09 [INFO]  Epoch 2 loss: 248.02006721496582; train accuracy: 0.6583333333333333; test accuracy: 0.2085
2025-09-22 01:56:09 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:56:09 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:56:09 [INFO]  Round 2 Finish--------|
2025-09-22 01:56:09 [INFO]  Model variance: mean: 0.0007657800451852381, sum: 8556.7890625
2025-09-22 01:56:09 [INFO]  g_protos_std: 1.0060986280441284
2025-09-22 01:56:14 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.354
2025-09-22 01:56:14 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:56:14 [INFO]  Round 3 starts--------|
2025-09-22 01:56:14 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:56:52 [INFO]  Epoch 3 loss: 502.907527923584; train accuracy: 0.3655711206896552; test accuracy: 0.2167
2025-09-22 01:56:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:56:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:56:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:57:02 [INFO]  Epoch 3 loss: 96.72761011123657; train accuracy: 0.5380108173076923; test accuracy: 0.1361
2025-09-22 01:57:02 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:57:02 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:57:02 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:57:12 [INFO]  Epoch 3 loss: 86.8564944267273; train accuracy: 0.84765625; test accuracy: 0.1005
2025-09-22 01:57:12 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:57:12 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:57:12 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:57:43 [INFO]  Epoch 3 loss: 418.0068988800049; train accuracy: 0.4943484042553192; test accuracy: 0.2633
2025-09-22 01:57:43 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:57:43 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:57:43 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:58:04 [INFO]  Epoch 3 loss: 243.0807809829712; train accuracy: 0.6505208333333333; test accuracy: 0.2047
2025-09-22 01:58:04 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:58:04 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:58:04 [INFO]  Round 3 Finish--------|
2025-09-22 01:58:04 [INFO]  Model variance: mean: 0.000869909068569541, sum: 9720.322265625
2025-09-22 01:58:04 [INFO]  g_protos_std: 1.006115198135376
2025-09-22 01:58:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3819
2025-09-22 01:58:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:58:09 [INFO]  Round 4 starts--------|
2025-09-22 01:58:09 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:58:52 [INFO]  Epoch 4 loss: 491.87415981292725; train accuracy: 0.44874730603448276; test accuracy: 0.2712
2025-09-22 01:58:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:58:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:58:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:59:04 [INFO]  Epoch 4 loss: 96.22553205490112; train accuracy: 0.8330829326923077; test accuracy: 0.1454
2025-09-22 01:59:04 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:59:04 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:59:04 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:59:14 [INFO]  Epoch 4 loss: 86.19061994552612; train accuracy: 0.8488991477272727; test accuracy: 0.1012
2025-09-22 01:59:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:59:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:59:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:59:51 [INFO]  Epoch 4 loss: 401.161741733551; train accuracy: 0.4356715425531915; test accuracy: 0.2252
2025-09-22 01:59:51 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:59:51 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:59:51 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:00:17 [INFO]  Epoch 4 loss: 239.08476448059082; train accuracy: 0.5588541666666667; test accuracy: 0.1734
2025-09-22 02:00:17 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:00:17 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:00:17 [INFO]  Round 4 Finish--------|
2025-09-22 02:00:17 [INFO]  Model variance: mean: 0.0009634714224375784, sum: 10765.783203125
2025-09-22 02:00:17 [INFO]  g_protos_std: 1.0061322450637817
2025-09-22 02:00:22 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4062
2025-09-22 02:00:22 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:00:22 [INFO]  Round 5 starts--------|
2025-09-22 02:00:22 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:01:06 [INFO]  Epoch 5 loss: 480.0229616165161; train accuracy: 0.5295662715517241; test accuracy: 0.3134
2025-09-22 02:01:06 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_5.pth
2025-09-22 02:01:06 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:01:06 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:01:06 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:01:19 [INFO]  Epoch 5 loss: 96.26849317550659; train accuracy: 0.8058894230769231; test accuracy: 0.1344
2025-09-22 02:01:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_5.pth
2025-09-22 02:01:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:01:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:01:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:01:29 [INFO]  Epoch 5 loss: 86.77839088439941; train accuracy: 0.8499644886363636; test accuracy: 0.1024
2025-09-22 02:01:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_5.pth
2025-09-22 02:01:30 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:01:30 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:01:30 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:02:05 [INFO]  Epoch 5 loss: 390.173171043396; train accuracy: 0.5592586436170213; test accuracy: 0.2834
2025-09-22 02:02:05 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_5.pth
2025-09-22 02:02:05 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:02:05 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:02:05 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:02:29 [INFO]  Epoch 5 loss: 235.77931213378906; train accuracy: 0.6899088541666667; test accuracy: 0.2181
2025-09-22 02:02:30 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_5.pth
2025-09-22 02:02:30 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:02:30 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:02:30 [INFO]  Round 5 Finish--------|
2025-09-22 02:02:30 [INFO]  Model variance: mean: 0.0010520099895074964, sum: 11755.109375
2025-09-22 02:02:30 [INFO]  g_protos_std: 1.006147861480713
2025-09-22 02:02:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4116
2025-09-22 02:02:35 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:02:35 [INFO]  Round 6 starts--------|
2025-09-22 02:02:35 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:03:18 [INFO]  Epoch 6 loss: 467.55148792266846; train accuracy: 0.48834859913793105; test accuracy: 0.2956
2025-09-22 02:03:18 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:03:18 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:03:18 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:03:29 [INFO]  Epoch 6 loss: 95.50773334503174; train accuracy: 0.8422475961538461; test accuracy: 0.1547
2025-09-22 02:03:29 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:03:29 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:03:29 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:03:38 [INFO]  Epoch 6 loss: 86.01531076431274; train accuracy: 0.8485440340909091; test accuracy: 0.1
2025-09-22 02:03:38 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:03:38 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:03:38 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:04:13 [INFO]  Epoch 6 loss: 390.9604320526123; train accuracy: 0.568110039893617; test accuracy: 0.2967
2025-09-22 02:04:13 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:04:13 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:04:13 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:04:36 [INFO]  Epoch 6 loss: 230.76768112182617; train accuracy: 0.7064453125; test accuracy: 0.2228
2025-09-22 02:04:36 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:04:36 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:04:36 [INFO]  Round 6 Finish--------|
2025-09-22 02:04:36 [INFO]  Model variance: mean: 0.0011349194683134556, sum: 12681.53515625
2025-09-22 02:04:36 [INFO]  g_protos_std: 1.0061638355255127
2025-09-22 02:04:41 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4383
2025-09-22 02:04:41 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:04:41 [INFO]  Round 7 starts--------|
2025-09-22 02:04:41 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:05:24 [INFO]  Epoch 7 loss: 458.2994112968445; train accuracy: 0.5842874461206896; test accuracy: 0.3509
2025-09-22 02:05:24 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:05:24 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:05:24 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:05:35 [INFO]  Epoch 7 loss: 95.57061529159546; train accuracy: 0.8861177884615384; test accuracy: 0.1641
2025-09-22 02:05:35 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:05:35 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:05:35 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:05:47 [INFO]  Epoch 7 loss: 85.99749660491943; train accuracy: 0.8480113636363636; test accuracy: 0.1014
2025-09-22 02:05:47 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:05:47 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:05:47 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:06:25 [INFO]  Epoch 7 loss: 384.78626251220703; train accuracy: 0.6105385638297872; test accuracy: 0.3103
2025-09-22 02:06:25 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:06:25 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:06:25 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:06:50 [INFO]  Epoch 7 loss: 233.25836277008057; train accuracy: 0.7876953125; test accuracy: 0.2503
2025-09-22 02:06:50 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:06:50 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:06:50 [INFO]  Round 7 Finish--------|
2025-09-22 02:06:50 [INFO]  Model variance: mean: 0.0012102874461561441, sum: 13523.693359375
2025-09-22 02:06:50 [INFO]  g_protos_std: 1.0061806440353394
2025-09-22 02:06:55 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4599
2025-09-22 02:06:55 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:06:55 [INFO]  Round 8 starts--------|
2025-09-22 02:06:55 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:07:40 [INFO]  Epoch 8 loss: 455.2025842666626; train accuracy: 0.6374259159482759; test accuracy: 0.3804
2025-09-22 02:07:40 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:07:40 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:07:40 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:07:51 [INFO]  Epoch 8 loss: 94.56321144104004; train accuracy: 0.6248497596153846; test accuracy: 0.1458
2025-09-22 02:07:51 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:07:51 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:07:51 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:08:01 [INFO]  Epoch 8 loss: 85.53218603134155; train accuracy: 0.8467684659090909; test accuracy: 0.1059
2025-09-22 02:08:01 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:08:01 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:08:01 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:08:36 [INFO]  Epoch 8 loss: 381.7124857902527; train accuracy: 0.6268700132978723; test accuracy: 0.3167
2025-09-22 02:08:36 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:08:36 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:08:36 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:09:00 [INFO]  Epoch 8 loss: 232.73977613449097; train accuracy: 0.7072916666666667; test accuracy: 0.2345
2025-09-22 02:09:00 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:09:00 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:09:00 [INFO]  Round 8 Finish--------|
2025-09-22 02:09:00 [INFO]  Model variance: mean: 0.001285718404687941, sum: 14366.5556640625
2025-09-22 02:09:00 [INFO]  g_protos_std: 1.0061911344528198
2025-09-22 02:09:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4787
2025-09-22 02:09:05 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:09:05 [INFO]  Round 9 starts--------|
2025-09-22 02:09:05 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:09:51 [INFO]  Epoch 9 loss: 446.0847840309143; train accuracy: 0.731377963362069; test accuracy: 0.4322
2025-09-22 02:09:51 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:09:51 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:09:51 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:10:04 [INFO]  Epoch 9 loss: 93.64683532714844; train accuracy: 0.7941706730769231; test accuracy: 0.1303
2025-09-22 02:10:04 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:10:04 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:10:04 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:10:13 [INFO]  Epoch 9 loss: 84.77826023101807; train accuracy: 0.8485440340909091; test accuracy: 0.1
2025-09-22 02:10:13 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:10:13 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:10:13 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:10:52 [INFO]  Epoch 9 loss: 371.92750453948975; train accuracy: 0.6112865691489362; test accuracy: 0.3104
2025-09-22 02:10:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:10:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:10:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:11:16 [INFO]  Epoch 9 loss: 229.3117914199829; train accuracy: 0.7359375; test accuracy: 0.2346
2025-09-22 02:11:16 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:11:16 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:11:16 [INFO]  Round 9 Finish--------|
2025-09-22 02:11:16 [INFO]  Model variance: mean: 0.0013583410764113069, sum: 15178.0380859375
2025-09-22 02:11:16 [INFO]  g_protos_std: 1.0062048435211182
2025-09-22 02:11:21 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4995
2025-09-22 02:11:21 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:11:21 [INFO]  Round 10 starts--------|
2025-09-22 02:11:21 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:12:11 [INFO]  Epoch 10 loss: 438.18964195251465; train accuracy: 0.6090382543103449; test accuracy: 0.3643
2025-09-22 02:12:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_10.pth
2025-09-22 02:12:12 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:12:12 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:12:12 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:12:24 [INFO]  Epoch 10 loss: 95.01918649673462; train accuracy: 0.8826622596153846; test accuracy: 0.1652
2025-09-22 02:12:25 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_10.pth
2025-09-22 02:12:25 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:12:25 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:12:25 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:12:36 [INFO]  Epoch 10 loss: 85.54242277145386; train accuracy: 0.8497869318181818; test accuracy: 0.1
2025-09-22 02:12:36 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_10.pth
2025-09-22 02:12:36 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:12:36 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:12:36 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:13:17 [INFO]  Epoch 10 loss: 364.35732412338257; train accuracy: 0.617935505319149; test accuracy: 0.3138
2025-09-22 02:13:17 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_10.pth
2025-09-22 02:13:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:13:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:13:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:13:45 [INFO]  Epoch 10 loss: 228.2423849105835; train accuracy: 0.7995442708333333; test accuracy: 0.2549
2025-09-22 02:13:45 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_10.pth
2025-09-22 02:13:45 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:13:45 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:13:45 [INFO]  Round 10 Finish--------|
2025-09-22 02:13:45 [INFO]  Model variance: mean: 0.0014295080909505486, sum: 15973.2548828125
2025-09-22 02:13:45 [INFO]  g_protos_std: 1.0062235593795776
2025-09-22 02:13:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4973
2025-09-22 02:13:50 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:13:50 [INFO]  Round 11 starts--------|
2025-09-22 02:13:50 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:14:38 [INFO]  Epoch 11 loss: 436.5971779823303; train accuracy: 0.7855940193965517; test accuracy: 0.4656
2025-09-22 02:14:38 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:14:38 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:14:38 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:14:48 [INFO]  Epoch 11 loss: 95.09881687164307; train accuracy: 0.8323317307692307; test accuracy: 0.1452
2025-09-22 02:14:48 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:14:48 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:14:48 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:14:59 [INFO]  Epoch 11 loss: 85.54518747329712; train accuracy: 0.8469460227272727; test accuracy: 0.1
2025-09-22 02:14:59 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:14:59 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:14:59 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:15:37 [INFO]  Epoch 11 loss: 356.7060070037842; train accuracy: 0.7083610372340425; test accuracy: 0.3569
2025-09-22 02:15:37 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:15:37 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:15:37 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:16:00 [INFO]  Epoch 11 loss: 223.4929642677307; train accuracy: 0.7616536458333333; test accuracy: 0.2451
2025-09-22 02:16:00 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:16:00 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:16:00 [INFO]  Round 11 Finish--------|
2025-09-22 02:16:00 [INFO]  Model variance: mean: 0.0014978684484958649, sum: 16737.109375
2025-09-22 02:16:00 [INFO]  g_protos_std: 1.0062408447265625
2025-09-22 02:16:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5003
2025-09-22 02:16:05 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:16:05 [INFO]  Round 12 starts--------|
2025-09-22 02:16:05 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:16:49 [INFO]  Epoch 12 loss: 427.6887969970703; train accuracy: 0.6886786099137931; test accuracy: 0.4045
2025-09-22 02:16:49 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:16:49 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:16:49 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:17:01 [INFO]  Epoch 12 loss: 94.8439302444458; train accuracy: 0.8366887019230769; test accuracy: 0.1446
2025-09-22 02:17:01 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:17:01 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:17:01 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:17:11 [INFO]  Epoch 12 loss: 84.99889373779297; train accuracy: 0.8595525568181818; test accuracy: 0.1181
2025-09-22 02:17:11 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:17:11 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:17:11 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:17:49 [INFO]  Epoch 12 loss: 350.98872470855713; train accuracy: 0.5910904255319149; test accuracy: 0.3034
2025-09-22 02:17:49 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:17:49 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:17:49 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:18:14 [INFO]  Epoch 12 loss: 222.7364821434021; train accuracy: 0.7667317708333333; test accuracy: 0.2559
2025-09-22 02:18:14 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:18:14 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:18:14 [INFO]  Round 12 Finish--------|
2025-09-22 02:18:14 [INFO]  Model variance: mean: 0.001562669756822288, sum: 17461.197265625
2025-09-22 02:18:14 [INFO]  g_protos_std: 1.0062569379806519
2025-09-22 02:18:19 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5258
2025-09-22 02:18:19 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:18:19 [INFO]  Round 13 starts--------|
2025-09-22 02:18:19 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:19:06 [INFO]  Epoch 13 loss: 418.2490520477295; train accuracy: 0.7361934267241379; test accuracy: 0.4336
2025-09-22 02:19:06 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:19:06 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:19:06 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:19:19 [INFO]  Epoch 13 loss: 94.24886703491211; train accuracy: 0.8915264423076923; test accuracy: 0.1788
2025-09-22 02:19:19 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:19:19 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:19:19 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:19:30 [INFO]  Epoch 13 loss: 84.69468021392822; train accuracy: 0.6860795454545454; test accuracy: 0.1222
2025-09-22 02:19:30 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:19:30 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:19:30 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:20:08 [INFO]  Epoch 13 loss: 345.24324464797974; train accuracy: 0.6647689494680851; test accuracy: 0.3359
2025-09-22 02:20:08 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:20:08 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:20:08 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:20:34 [INFO]  Epoch 13 loss: 223.42288494110107; train accuracy: 0.794921875; test accuracy: 0.2549
2025-09-22 02:20:34 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:20:34 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:20:34 [INFO]  Round 13 Finish--------|
2025-09-22 02:20:34 [INFO]  Model variance: mean: 0.0016244584694504738, sum: 18151.62109375
2025-09-22 02:20:34 [INFO]  g_protos_std: 1.0062720775604248
2025-09-22 02:20:39 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5262
2025-09-22 02:20:39 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:20:39 [INFO]  Round 14 starts--------|
2025-09-22 02:20:39 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:21:26 [INFO]  Epoch 14 loss: 416.20804738998413; train accuracy: 0.6847723599137931; test accuracy: 0.4043
2025-09-22 02:21:26 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:21:26 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:21:26 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:21:39 [INFO]  Epoch 14 loss: 94.19515228271484; train accuracy: 0.8820612980769231; test accuracy: 0.1815
2025-09-22 02:21:39 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:21:39 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:21:39 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:21:49 [INFO]  Epoch 14 loss: 85.19730758666992; train accuracy: 0.8513849431818182; test accuracy: 0.1014
2025-09-22 02:21:49 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:21:49 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:21:49 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:22:29 [INFO]  Epoch 14 loss: 341.9978642463684; train accuracy: 0.759017619680851; test accuracy: 0.3788
2025-09-22 02:22:29 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:22:29 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:22:29 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:22:55 [INFO]  Epoch 14 loss: 221.28468894958496; train accuracy: 0.7795572916666667; test accuracy: 0.2591
2025-09-22 02:22:55 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:22:55 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:22:55 [INFO]  Round 14 Finish--------|
2025-09-22 02:22:55 [INFO]  Model variance: mean: 0.001683650305494666, sum: 18813.02734375
2025-09-22 02:22:55 [INFO]  g_protos_std: 1.0062834024429321
2025-09-22 02:23:00 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5424
2025-09-22 02:23:00 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:23:00 [INFO]  Round 15 starts--------|
2025-09-22 02:23:00 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:23:48 [INFO]  Epoch 15 loss: 419.28046321868896; train accuracy: 0.7935075431034483; test accuracy: 0.4676
2025-09-22 02:23:48 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_15.pth
2025-09-22 02:23:48 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:23:48 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:23:48 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:24:00 [INFO]  Epoch 15 loss: 94.6563138961792; train accuracy: 0.740234375; test accuracy: 0.1637
2025-09-22 02:24:01 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_15.pth
2025-09-22 02:24:01 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:24:01 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:24:01 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:24:12 [INFO]  Epoch 15 loss: 84.9124116897583; train accuracy: 0.8513849431818182; test accuracy: 0.103
2025-09-22 02:24:12 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_15.pth
2025-09-22 02:24:12 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:24:12 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:24:12 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:24:52 [INFO]  Epoch 15 loss: 334.15918827056885; train accuracy: 0.7521193484042553; test accuracy: 0.378
2025-09-22 02:24:52 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_15.pth
2025-09-22 02:24:52 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:24:52 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:24:52 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:25:19 [INFO]  Epoch 15 loss: 220.42837858200073; train accuracy: 0.7509765625; test accuracy: 0.2439
2025-09-22 02:25:19 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_15.pth
2025-09-22 02:25:19 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:25:19 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:25:19 [INFO]  Round 15 Finish--------|
2025-09-22 02:25:19 [INFO]  Model variance: mean: 0.0017427655402570963, sum: 19473.578125
2025-09-22 02:25:19 [INFO]  g_protos_std: 1.006298303604126
2025-09-22 02:25:24 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5447
2025-09-22 02:25:24 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:25:24 [INFO]  Round 16 starts--------|
2025-09-22 02:25:24 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:26:13 [INFO]  Epoch 16 loss: 414.01959323883057; train accuracy: 0.7674771012931034; test accuracy: 0.454
2025-09-22 02:26:13 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:26:13 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:26:13 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:26:26 [INFO]  Epoch 16 loss: 93.46135473251343; train accuracy: 0.89453125; test accuracy: 0.1748
2025-09-22 02:26:26 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:26:26 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:26:26 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:26:37 [INFO]  Epoch 16 loss: 84.95464515686035; train accuracy: 0.8469460227272727; test accuracy: 0.1002
2025-09-22 02:26:37 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:26:37 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:26:37 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:27:15 [INFO]  Epoch 16 loss: 336.19592475891113; train accuracy: 0.7588929521276596; test accuracy: 0.3796
2025-09-22 02:27:15 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:27:15 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:27:15 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:27:41 [INFO]  Epoch 16 loss: 219.29514694213867; train accuracy: 0.850390625; test accuracy: 0.3061
2025-09-22 02:27:41 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:27:41 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:27:41 [INFO]  Round 16 Finish--------|
2025-09-22 02:27:41 [INFO]  Model variance: mean: 0.0017980026314035058, sum: 20090.794921875
2025-09-22 02:27:41 [INFO]  g_protos_std: 1.0063077211380005
2025-09-22 02:27:46 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5655
2025-09-22 02:27:46 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:27:46 [INFO]  Round 17 starts--------|
2025-09-22 02:27:46 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:28:33 [INFO]  Epoch 17 loss: 408.7343053817749; train accuracy: 0.8039129849137931; test accuracy: 0.4724
2025-09-22 02:28:33 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:28:33 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:28:33 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:28:46 [INFO]  Epoch 17 loss: 96.7244815826416; train accuracy: 0.8530649038461539; test accuracy: 0.1767
2025-09-22 02:28:46 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:28:46 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:28:46 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:28:57 [INFO]  Epoch 17 loss: 84.72430849075317; train accuracy: 0.8529829545454546; test accuracy: 0.1048
2025-09-22 02:28:57 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:28:57 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:28:57 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:29:35 [INFO]  Epoch 17 loss: 331.84785318374634; train accuracy: 0.8203125; test accuracy: 0.408
2025-09-22 02:29:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:29:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:29:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:30:03 [INFO]  Epoch 17 loss: 218.68852424621582; train accuracy: 0.8402994791666667; test accuracy: 0.3049
2025-09-22 02:30:03 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:30:03 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:30:03 [INFO]  Round 17 Finish--------|
2025-09-22 02:30:03 [INFO]  Model variance: mean: 0.0018538176082074642, sum: 20714.46875
2025-09-22 02:30:03 [INFO]  g_protos_std: 1.0063196420669556
2025-09-22 02:30:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5679
2025-09-22 02:30:08 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:30:08 [INFO]  Round 18 starts--------|
2025-09-22 02:30:08 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:30:55 [INFO]  Epoch 18 loss: 399.67599153518677; train accuracy: 0.8232421875; test accuracy: 0.4846
2025-09-22 02:30:55 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:30:55 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:30:55 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:31:08 [INFO]  Epoch 18 loss: 94.19789743423462; train accuracy: 0.8046875; test accuracy: 0.1717
2025-09-22 02:31:08 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:31:08 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:31:08 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:31:18 [INFO]  Epoch 18 loss: 84.54634952545166; train accuracy: 0.8607954545454546; test accuracy: 0.118
2025-09-22 02:31:18 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:31:18 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:31:18 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:31:59 [INFO]  Epoch 18 loss: 333.62059783935547; train accuracy: 0.761968085106383; test accuracy: 0.3809
2025-09-22 02:31:59 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:31:59 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:31:59 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:32:24 [INFO]  Epoch 18 loss: 217.46959161758423; train accuracy: 0.7884114583333334; test accuracy: 0.2617
2025-09-22 02:32:24 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:32:24 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:32:24 [INFO]  Round 18 Finish--------|
2025-09-22 02:32:24 [INFO]  Model variance: mean: 0.0019080813508480787, sum: 21320.80859375
2025-09-22 02:32:24 [INFO]  g_protos_std: 1.0063354969024658
2025-09-22 02:32:30 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5612
2025-09-22 02:32:30 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:32:30 [INFO]  Round 19 starts--------|
2025-09-22 02:32:30 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:33:15 [INFO]  Epoch 19 loss: 404.4775757789612; train accuracy: 0.842706088362069; test accuracy: 0.4976
2025-09-22 02:33:15 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:33:15 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:33:15 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:33:26 [INFO]  Epoch 19 loss: 94.02808570861816; train accuracy: 0.8706430288461539; test accuracy: 0.1817
2025-09-22 02:33:26 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:33:26 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:33:26 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:33:37 [INFO]  Epoch 19 loss: 84.65518140792847; train accuracy: 0.8487215909090909; test accuracy: 0.1003
2025-09-22 02:33:37 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:33:37 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:33:37 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:34:16 [INFO]  Epoch 19 loss: 330.2565793991089; train accuracy: 0.8098819813829787; test accuracy: 0.4005
2025-09-22 02:34:16 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:34:16 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:34:16 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:34:40 [INFO]  Epoch 19 loss: 216.06577587127686; train accuracy: 0.6763020833333333; test accuracy: 0.2227
2025-09-22 02:34:40 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:34:40 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:34:40 [INFO]  Round 19 Finish--------|
2025-09-22 02:34:40 [INFO]  Model variance: mean: 0.001961154630407691, sum: 21913.84765625
2025-09-22 02:34:40 [INFO]  g_protos_std: 1.0063502788543701
2025-09-22 02:34:45 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.581
2025-09-22 02:34:45 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:34:45 [INFO]  Round 20 starts--------|
2025-09-22 02:34:45 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:35:31 [INFO]  Epoch 20 loss: 398.83373737335205; train accuracy: 0.7462957974137931; test accuracy: 0.4355
2025-09-22 02:35:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_20.pth
2025-09-22 02:35:32 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:35:32 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:35:32 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:35:44 [INFO]  Epoch 20 loss: 93.88375329971313; train accuracy: 0.8578725961538461; test accuracy: 0.1778
2025-09-22 02:35:44 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_20.pth
2025-09-22 02:35:44 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:35:44 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:35:44 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:35:55 [INFO]  Epoch 20 loss: 84.51414966583252; train accuracy: 0.8469460227272727; test accuracy: 0.1002
2025-09-22 02:35:56 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_20.pth
2025-09-22 02:35:56 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:35:56 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:35:56 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:36:32 [INFO]  Epoch 20 loss: 327.89679288864136; train accuracy: 0.6655585106382979; test accuracy: 0.3345
2025-09-22 02:36:33 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_20.pth
2025-09-22 02:36:33 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:36:33 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:36:33 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:36:57 [INFO]  Epoch 20 loss: 216.3355197906494; train accuracy: 0.821875; test accuracy: 0.2983
2025-09-22 02:36:57 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_20.pth
2025-09-22 02:36:57 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:36:57 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:36:57 [INFO]  Round 20 Finish--------|
2025-09-22 02:36:57 [INFO]  Model variance: mean: 0.0020122092682868242, sum: 22484.330078125
2025-09-22 02:36:57 [INFO]  g_protos_std: 1.0063596963882446
2025-09-22 02:37:03 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5784
2025-09-22 02:37:03 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml




2025-09-22 01:51:52 [INFO]  Load config from ./configs/CIFAR10_alpha0.05_with_memorybank.yaml
2025-09-22 01:51:52 [INFO]  config: {'exp_name': 'CIFAR10_alpha0.05', 'dataset': {'data_name': 'CIFAR10', 'root_path': 'H:/codes/dataset', 'train_batch_size': 512, 'test_batch_size': 256, 'channels': 3, 'num_classes': 10, 'image_size': 32}, 'distribution': {'type': 'dirichlet', 'label_num_per_client': 2, 'alpha': 0.05}, 'client': {'num_clients': 5}, 'server': {'num_rounds': 300, 'frac_clients': 1.0, 'lr': 0.05, 'local_epochs': 1, 'optimizer': 'sgd', 'momentum': 0.9, 'weight_decay': 0.0001, 'loss_name': 'ce', 'model_name': 'resnet18', 'aggregated_by_datasize': True, 'lr_decay_per_round': 0.998}, 'device': 'cuda:0', 'checkpoint': {'save_path': './checkpoints/', 'save_freq': 5, 'result_file': 'CIFAR10_results.yaml'}, 'pretrain': {'lr': 0.01, 'epoch': 70, 'model_path': './pretrain/', 'momentum': 0.9, 'weight_decay': 0.0001, 'model_name': 'resnet18', 'model_file_name': 'resnet18-f37072fd.pth'}, 'DBCD': {'alpha_l_pa': 1, 'alpha_l_pb': 1, 'alpha_l_pc': 0.0, 'Beta_alpha': 0.2, 'unsup_method': 'infonce', 'contrastive_temperature': 0.5, 'encoder_epoch': 40, 'projector_epoch': 10, 'use_pretrain': False, 'aug_batch_size': 512, 'encoder_lr': 0.03, 'cls_optimizer': 'sgd', 'cls_lr': 0.05, 'supcon_temp': 0.07, 'super_gr': 100, 'aux_with_public': True}, 'etf': {'loss_name': 'ce'}, 'visualization': {'interval': 5, 'save_path': 'visualization/resnet18', 'vis_size': 16}, 'resume': True, 'resume_best': False, 'seed': 1, 'use_memory_bank': True, 'memory_bank_size': 4096}
2025-09-22 01:51:54 [INFO]  Dataset CIFAR10 loaded
2025-09-22 01:51:54 [INFO]  Dataset index dict loaded from preprocessed_data/CIFAR10.pt
2025-09-22 01:51:54 [INFO]  OneshotOurs
2025-09-22 01:51:55 [INFO]  Round 0 starts--------|
2025-09-22 01:51:55 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:52:00 [INFO]  generating sample per sample
2025-09-22 01:52:00 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:52:00 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:52:46 [INFO]  Epoch 0 loss: 671.3604888916016; train accuracy: 0.29657192887931033; test accuracy: 0.1749
2025-09-22 01:52:46 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_0.pth
2025-09-22 01:52:46 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:52:46 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:52:46 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:52:47 [INFO]  generating sample per sample
2025-09-22 01:52:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:52:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:52:59 [INFO]  Epoch 0 loss: 126.54868412017822; train accuracy: 0.6945612980769231; test accuracy: 0.1539
2025-09-22 01:52:59 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_0.pth
2025-09-22 01:52:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:52:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:52:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:53:00 [INFO]  generating sample per sample
2025-09-22 01:53:00 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:53:00 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:53:11 [INFO]  Epoch 0 loss: 129.6617488861084; train accuracy: 0.8487215909090909; test accuracy: 0.1
2025-09-22 01:53:11 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_0.pth
2025-09-22 01:53:11 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:53:11 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:53:11 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:53:16 [INFO]  generating sample per sample
2025-09-22 01:53:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:53:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:53:53 [INFO]  Epoch 0 loss: 543.8491020202637; train accuracy: 0.2546126994680851; test accuracy: 0.1257
2025-09-22 01:53:53 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_0.pth
2025-09-22 01:53:53 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:53:53 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:53:53 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:53:57 [INFO]  generating sample per sample
2025-09-22 01:53:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:53:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:54:22 [INFO]  Epoch 0 loss: 333.2044153213501; train accuracy: 0.4845052083333333; test accuracy: 0.1536
2025-09-22 01:54:22 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_0.pth
2025-09-22 01:54:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:54:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:54:22 [INFO]  Round 0 Finish--------|
2025-09-22 01:54:22 [INFO]  Model variance: mean: 0.0005794426542706788, sum: 6474.6640625
2025-09-22 01:54:22 [INFO]  g_protos_std: 1.0060847997665405
2025-09-22 01:54:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3093
2025-09-22 01:54:29 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:54:29 [INFO]  Round 1 starts--------|
2025-09-22 01:54:29 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:54:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:54:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:55:16 [INFO]  Epoch 1 loss: 629.1522302627563; train accuracy: 0.32371363146551724; test accuracy: 0.1956
2025-09-22 01:55:16 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:55:16 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:55:16 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:55:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:55:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:55:28 [INFO]  Epoch 1 loss: 115.74275302886963; train accuracy: 0.7346754807692307; test accuracy: 0.1078
2025-09-22 01:55:28 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:55:28 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:55:28 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:55:28 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:55:28 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:55:39 [INFO]  Epoch 1 loss: 99.19955253601074; train accuracy: 0.8478338068181818; test accuracy: 0.1
2025-09-22 01:55:39 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:55:39 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:55:39 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:55:39 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:55:39 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:56:16 [INFO]  Epoch 1 loss: 503.872127532959; train accuracy: 0.20748836436170212; test accuracy: 0.1007
2025-09-22 01:56:16 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:56:16 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:56:16 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:56:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:56:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:56:42 [INFO]  Epoch 1 loss: 293.8038625717163; train accuracy: 0.6479166666666667; test accuracy: 0.2048
2025-09-22 01:56:42 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:56:42 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:56:42 [INFO]  Round 1 Finish--------|
2025-09-22 01:56:42 [INFO]  Model variance: mean: 0.000741919269785285, sum: 8290.169921875
2025-09-22 01:56:42 [INFO]  g_protos_std: 1.0061591863632202
2025-09-22 01:56:49 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3
2025-09-22 01:56:49 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:56:49 [INFO]  Round 2 starts--------|
2025-09-22 01:56:49 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:56:49 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:56:49 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:57:34 [INFO]  Epoch 2 loss: 619.6619443893433; train accuracy: 0.22548491379310345; test accuracy: 0.136
2025-09-22 01:57:34 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 01:57:34 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 01:57:34 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 01:57:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:57:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:57:47 [INFO]  Epoch 2 loss: 114.1366286277771; train accuracy: 0.7995793269230769; test accuracy: 0.1418
2025-09-22 01:57:47 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 01:57:47 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 01:57:47 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 01:57:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:57:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:57:57 [INFO]  Epoch 2 loss: 97.94211626052856; train accuracy: 0.8483664772727273; test accuracy: 0.1
2025-09-22 01:57:57 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 01:57:57 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 01:57:57 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 01:57:57 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:57:57 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:58:35 [INFO]  Epoch 2 loss: 493.94057750701904; train accuracy: 0.4366688829787234; test accuracy: 0.2232
2025-09-22 01:58:35 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 01:58:35 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 01:58:35 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 01:58:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:58:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 01:59:01 [INFO]  Epoch 2 loss: 290.32593631744385; train accuracy: 0.5270833333333333; test accuracy: 0.1665
2025-09-22 01:59:01 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 01:59:01 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 01:59:01 [INFO]  Round 2 Finish--------|
2025-09-22 01:59:01 [INFO]  Model variance: mean: 0.0008559235138818622, sum: 9564.0478515625
2025-09-22 01:59:01 [INFO]  g_protos_std: 1.0062243938446045
2025-09-22 01:59:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3113
2025-09-22 01:59:08 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 01:59:08 [INFO]  Round 3 starts--------|
2025-09-22 01:59:08 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 01:59:08 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 01:59:08 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:00:05 [INFO]  Epoch 3 loss: 606.4483919143677; train accuracy: 0.32610452586206895; test accuracy: 0.1972
2025-09-22 02:00:05 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:00:05 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:00:05 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:00:05 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:00:05 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:00:20 [INFO]  Epoch 3 loss: 112.98135328292847; train accuracy: 0.8432992788461539; test accuracy: 0.1713
2025-09-22 02:00:20 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:00:20 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:00:20 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:00:20 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:00:20 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:00:33 [INFO]  Epoch 3 loss: 96.52328300476074; train accuracy: 0.8490767045454546; test accuracy: 0.1
2025-09-22 02:00:33 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:00:33 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:00:33 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:00:33 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:00:33 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:01:17 [INFO]  Epoch 3 loss: 482.1885862350464; train accuracy: 0.32588098404255317; test accuracy: 0.1601
2025-09-22 02:01:17 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:01:17 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:01:17 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:01:17 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:01:17 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:01:45 [INFO]  Epoch 3 loss: 290.1113920211792; train accuracy: 0.5503255208333333; test accuracy: 0.1744
2025-09-22 02:01:45 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:01:45 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:01:45 [INFO]  Round 3 Finish--------|
2025-09-22 02:01:45 [INFO]  Model variance: mean: 0.0009604949736967683, sum: 10732.5244140625
2025-09-22 02:01:45 [INFO]  g_protos_std: 1.006287932395935
2025-09-22 02:01:52 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3544
2025-09-22 02:01:52 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:01:52 [INFO]  Round 4 starts--------|
2025-09-22 02:01:52 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:01:52 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:01:52 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:02:39 [INFO]  Epoch 4 loss: 592.0500621795654; train accuracy: 0.4524851831896552; test accuracy: 0.2688
2025-09-22 02:02:39 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:02:39 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:02:39 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:02:39 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:02:39 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:02:52 [INFO]  Epoch 4 loss: 113.0798020362854; train accuracy: 0.8697415865384616; test accuracy: 0.1619
2025-09-22 02:02:52 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:02:52 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:02:52 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:02:52 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:02:52 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:03:04 [INFO]  Epoch 4 loss: 97.20550870895386; train accuracy: 0.8497869318181818; test accuracy: 0.1003
2025-09-22 02:03:04 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:03:04 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:03:04 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:03:04 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:03:04 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:03:45 [INFO]  Epoch 4 loss: 481.27709579467773; train accuracy: 0.3419215425531915; test accuracy: 0.1901
2025-09-22 02:03:45 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:03:45 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:03:45 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:03:45 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:03:45 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:04:11 [INFO]  Epoch 4 loss: 287.0243573188782; train accuracy: 0.5506510416666667; test accuracy: 0.1719
2025-09-22 02:04:11 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:04:11 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:04:11 [INFO]  Round 4 Finish--------|
2025-09-22 02:04:11 [INFO]  Model variance: mean: 0.001046183635480702, sum: 11690.005859375
2025-09-22 02:04:11 [INFO]  g_protos_std: 1.0063345432281494
2025-09-22 02:04:18 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3777
2025-09-22 02:04:18 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:04:18 [INFO]  Round 5 starts--------|
2025-09-22 02:04:18 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:04:18 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:04:18 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:05:09 [INFO]  Epoch 5 loss: 580.3504972457886; train accuracy: 0.5821322737068966; test accuracy: 0.3447
2025-09-22 02:05:10 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_5.pth
2025-09-22 02:05:10 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:05:10 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:05:10 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:05:10 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:05:10 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:05:24 [INFO]  Epoch 5 loss: 111.79258584976196; train accuracy: 0.88671875; test accuracy: 0.1679
2025-09-22 02:05:24 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_5.pth
2025-09-22 02:05:24 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:05:24 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:05:24 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:05:24 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:05:24 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:05:37 [INFO]  Epoch 5 loss: 97.76513671875; train accuracy: 0.8528053977272727; test accuracy: 0.1054
2025-09-22 02:05:38 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_5.pth
2025-09-22 02:05:38 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:05:38 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:05:38 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:05:38 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:05:38 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:06:22 [INFO]  Epoch 5 loss: 466.6181049346924; train accuracy: 0.4847490026595745; test accuracy: 0.257
2025-09-22 02:06:23 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_5.pth
2025-09-22 02:06:23 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:06:23 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:06:23 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:06:23 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:06:23 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:06:51 [INFO]  Epoch 5 loss: 281.41219997406006; train accuracy: 0.7491536458333333; test accuracy: 0.2368
2025-09-22 02:06:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_5.pth
2025-09-22 02:06:51 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:06:51 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:06:51 [INFO]  Round 5 Finish--------|
2025-09-22 02:06:51 [INFO]  Model variance: mean: 0.0011317647295072675, sum: 12646.2841796875
2025-09-22 02:06:51 [INFO]  g_protos_std: 1.006377935409546
2025-09-22 02:06:58 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3744
2025-09-22 02:06:58 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:06:58 [INFO]  Round 6 starts--------|
2025-09-22 02:06:58 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:06:58 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:06:58 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:07:48 [INFO]  Epoch 6 loss: 565.8343620300293; train accuracy: 0.503838900862069; test accuracy: 0.3013
2025-09-22 02:07:48 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:07:48 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:07:48 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:07:48 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:07:48 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:08:02 [INFO]  Epoch 6 loss: 111.02386426925659; train accuracy: 0.8341346153846154; test accuracy: 0.1732
2025-09-22 02:08:02 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:08:02 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:08:02 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:08:02 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:08:02 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:08:14 [INFO]  Epoch 6 loss: 97.25254154205322; train accuracy: 0.8465909090909091; test accuracy: 0.1
2025-09-22 02:08:14 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:08:14 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:08:14 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:08:14 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:08:14 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:08:56 [INFO]  Epoch 6 loss: 461.57183170318604; train accuracy: 0.3310339095744681; test accuracy: 0.1777
2025-09-22 02:08:56 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:08:56 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:08:56 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:08:56 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:08:56 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:09:22 [INFO]  Epoch 6 loss: 280.92004680633545; train accuracy: 0.6951171875; test accuracy: 0.219
2025-09-22 02:09:22 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:09:22 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:09:22 [INFO]  Round 6 Finish--------|
2025-09-22 02:09:22 [INFO]  Model variance: mean: 0.0012090064119547606, sum: 13509.37890625
2025-09-22 02:09:22 [INFO]  g_protos_std: 1.006410002708435
2025-09-22 02:09:29 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.3975
2025-09-22 02:09:29 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:09:29 [INFO]  Round 7 starts--------|
2025-09-22 02:09:29 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:09:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:09:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:10:19 [INFO]  Epoch 7 loss: 559.2380714416504; train accuracy: 0.5989022090517241; test accuracy: 0.3572
2025-09-22 02:10:19 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:10:19 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:10:19 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:10:20 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:10:20 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:10:33 [INFO]  Epoch 7 loss: 111.32541608810425; train accuracy: 0.7783954326923077; test accuracy: 0.1238
2025-09-22 02:10:33 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:10:33 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:10:33 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:10:33 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:10:33 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:10:47 [INFO]  Epoch 7 loss: 97.11242866516113; train accuracy: 0.8558238636363636; test accuracy: 0.1095
2025-09-22 02:10:47 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:10:47 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:10:47 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:10:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:10:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:11:32 [INFO]  Epoch 7 loss: 454.965763092041; train accuracy: 0.4878656914893617; test accuracy: 0.2469
2025-09-22 02:11:32 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:11:32 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:11:32 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:11:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:11:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:12:00 [INFO]  Epoch 7 loss: 278.7045307159424; train accuracy: 0.6722005208333334; test accuracy: 0.2096
2025-09-22 02:12:00 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:12:00 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:12:00 [INFO]  Round 7 Finish--------|
2025-09-22 02:12:00 [INFO]  Model variance: mean: 0.001283543067984283, sum: 14342.248046875
2025-09-22 02:12:00 [INFO]  g_protos_std: 1.006447196006775
2025-09-22 02:12:08 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.42
2025-09-22 02:12:08 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:12:08 [INFO]  Round 8 starts--------|
2025-09-22 02:12:08 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:12:08 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:12:08 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:13:02 [INFO]  Epoch 8 loss: 556.1343851089478; train accuracy: 0.5552262931034483; test accuracy: 0.3271
2025-09-22 02:13:02 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:13:02 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:13:02 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:13:03 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:13:03 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:13:16 [INFO]  Epoch 8 loss: 110.32907724380493; train accuracy: 0.7472956730769231; test accuracy: 0.1649
2025-09-22 02:13:16 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:13:16 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:13:16 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:13:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:13:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:13:29 [INFO]  Epoch 8 loss: 96.94805192947388; train accuracy: 0.8481889204545454; test accuracy: 0.1009
2025-09-22 02:13:29 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:13:29 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:13:29 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:13:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:13:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:14:14 [INFO]  Epoch 8 loss: 451.95895624160767; train accuracy: 0.5302942154255319; test accuracy: 0.2745
2025-09-22 02:14:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:14:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:14:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:14:14 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:14:14 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:14:43 [INFO]  Epoch 8 loss: 276.737473487854; train accuracy: 0.6823567708333333; test accuracy: 0.2156
2025-09-22 02:14:43 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:14:43 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:14:43 [INFO]  Round 8 Finish--------|
2025-09-22 02:14:43 [INFO]  Model variance: mean: 0.0013529076240956783, sum: 15117.32421875
2025-09-22 02:14:43 [INFO]  g_protos_std: 1.0064716339111328
2025-09-22 02:14:50 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4323
2025-09-22 02:14:50 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:14:50 [INFO]  Round 9 starts--------|
2025-09-22 02:14:50 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:14:50 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:14:50 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:15:44 [INFO]  Epoch 9 loss: 547.2421426773071; train accuracy: 0.6548356681034483; test accuracy: 0.3901
2025-09-22 02:15:44 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:15:44 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:15:44 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:15:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:15:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:15:58 [INFO]  Epoch 9 loss: 111.34745216369629; train accuracy: 0.8990384615384616; test accuracy: 0.1805
2025-09-22 02:15:58 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:15:58 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:15:58 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:15:58 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:15:58 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:16:09 [INFO]  Epoch 9 loss: 97.13647794723511; train accuracy: 0.84765625; test accuracy: 0.1
2025-09-22 02:16:09 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:16:09 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:16:09 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:16:09 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:16:09 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:16:51 [INFO]  Epoch 9 loss: 443.0029935836792; train accuracy: 0.554936835106383; test accuracy: 0.2791
2025-09-22 02:16:51 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:16:51 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:16:51 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:16:51 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:16:51 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:17:21 [INFO]  Epoch 9 loss: 273.6034860610962; train accuracy: 0.7598958333333333; test accuracy: 0.2393
2025-09-22 02:17:21 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:17:21 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:17:21 [INFO]  Round 9 Finish--------|
2025-09-22 02:17:21 [INFO]  Model variance: mean: 0.0014217166462913156, sum: 15886.193359375
2025-09-22 02:17:21 [INFO]  g_protos_std: 1.0065051317214966
2025-09-22 02:17:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4467
2025-09-22 02:17:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:17:27 [INFO]  Round 10 starts--------|
2025-09-22 02:17:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:17:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:17:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:18:20 [INFO]  Epoch 10 loss: 543.5774211883545; train accuracy: 0.5834792564655172; test accuracy: 0.3478
2025-09-22 02:18:20 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_10.pth
2025-09-22 02:18:20 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:18:20 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:18:20 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:18:20 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:18:20 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:18:34 [INFO]  Epoch 10 loss: 110.85064935684204; train accuracy: 0.8703425480769231; test accuracy: 0.1794
2025-09-22 02:18:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_10.pth
2025-09-22 02:18:34 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:18:34 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:18:34 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:18:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:18:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:18:46 [INFO]  Epoch 10 loss: 97.17414379119873; train accuracy: 0.8572443181818182; test accuracy: 0.1123
2025-09-22 02:18:47 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_10.pth
2025-09-22 02:18:47 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:18:47 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:18:47 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:18:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:18:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:19:31 [INFO]  Epoch 10 loss: 437.5061230659485; train accuracy: 0.6030585106382979; test accuracy: 0.3117
2025-09-22 02:19:32 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_10.pth
2025-09-22 02:19:32 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:19:32 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:19:32 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:19:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:19:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:20:02 [INFO]  Epoch 10 loss: 273.48779678344727; train accuracy: 0.6962239583333333; test accuracy: 0.2182
2025-09-22 02:20:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_10.pth
2025-09-22 02:20:02 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:20:02 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:20:02 [INFO]  Round 10 Finish--------|
2025-09-22 02:20:02 [INFO]  Model variance: mean: 0.0014867986319586635, sum: 16613.416015625
2025-09-22 02:20:02 [INFO]  g_protos_std: 1.0065239667892456
2025-09-22 02:20:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4534
2025-09-22 02:20:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:20:09 [INFO]  Round 11 starts--------|
2025-09-22 02:20:09 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:20:09 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:20:09 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:21:02 [INFO]  Epoch 11 loss: 531.3620095252991; train accuracy: 0.6270878232758621; test accuracy: 0.3753
2025-09-22 02:21:02 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:21:02 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:21:02 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:21:02 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:21:02 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:21:16 [INFO]  Epoch 11 loss: 110.18201732635498; train accuracy: 0.78125; test accuracy: 0.1248
2025-09-22 02:21:16 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:21:16 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:21:16 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:21:16 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:21:16 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:21:29 [INFO]  Epoch 11 loss: 96.90161943435669; train accuracy: 0.8600852272727273; test accuracy: 0.1135
2025-09-22 02:21:29 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:21:29 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:21:29 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:21:29 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:21:29 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:22:14 [INFO]  Epoch 11 loss: 438.1162552833557; train accuracy: 0.6926529255319149; test accuracy: 0.3513
2025-09-22 02:22:14 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:22:14 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:22:14 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:22:14 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:22:14 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:22:43 [INFO]  Epoch 11 loss: 274.3338141441345; train accuracy: 0.7299479166666667; test accuracy: 0.2316
2025-09-22 02:22:43 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:22:43 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:22:43 [INFO]  Round 11 Finish--------|
2025-09-22 02:22:43 [INFO]  Model variance: mean: 0.0015481723239645362, sum: 17299.203125
2025-09-22 02:22:43 [INFO]  g_protos_std: 1.0065405368804932
2025-09-22 02:22:49 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4669
2025-09-22 02:22:49 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:22:49 [INFO]  Round 12 starts--------|
2025-09-22 02:22:49 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:22:49 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:22:49 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:23:44 [INFO]  Epoch 12 loss: 527.6377339363098; train accuracy: 0.7073679956896551; test accuracy: 0.4218
2025-09-22 02:23:44 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:23:44 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:23:44 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:23:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:23:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:23:59 [INFO]  Epoch 12 loss: 108.840811252594; train accuracy: 0.8082932692307693; test accuracy: 0.1728
2025-09-22 02:23:59 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:23:59 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:23:59 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:23:59 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:23:59 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:24:11 [INFO]  Epoch 12 loss: 96.79971218109131; train accuracy: 0.8485440340909091; test accuracy: 0.1003
2025-09-22 02:24:11 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:24:11 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:24:11 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:24:11 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:24:11 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:24:53 [INFO]  Epoch 12 loss: 432.1245422363281; train accuracy: 0.6800615026595744; test accuracy: 0.3436
2025-09-22 02:24:53 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:24:53 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:24:53 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:24:53 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:24:53 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:25:23 [INFO]  Epoch 12 loss: 273.0235767364502; train accuracy: 0.79140625; test accuracy: 0.2477
2025-09-22 02:25:23 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:25:23 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:25:23 [INFO]  Round 12 Finish--------|
2025-09-22 02:25:23 [INFO]  Model variance: mean: 0.001607312704436481, sum: 17960.03515625
2025-09-22 02:25:23 [INFO]  g_protos_std: 1.00655996799469
2025-09-22 02:25:30 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4614
2025-09-22 02:25:30 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:25:30 [INFO]  Round 13 starts--------|
2025-09-22 02:25:30 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:25:30 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:25:30 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:26:23 [INFO]  Epoch 13 loss: 527.4601616859436; train accuracy: 0.6434199892241379; test accuracy: 0.3814
2025-09-22 02:26:23 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:26:23 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:26:23 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:26:24 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:26:24 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:26:38 [INFO]  Epoch 13 loss: 109.78760957717896; train accuracy: 0.8195612980769231; test accuracy: 0.1401
2025-09-22 02:26:38 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:26:38 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:26:38 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:26:38 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:26:38 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:26:51 [INFO]  Epoch 13 loss: 97.01120567321777; train accuracy: 0.865234375; test accuracy: 0.124
2025-09-22 02:26:51 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:26:51 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:26:51 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:26:51 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:26:51 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:27:34 [INFO]  Epoch 13 loss: 428.17702865600586; train accuracy: 0.5898021941489362; test accuracy: 0.3025
2025-09-22 02:27:34 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:27:34 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:27:34 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:27:34 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:27:34 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:28:02 [INFO]  Epoch 13 loss: 268.24731063842773; train accuracy: 0.7820963541666667; test accuracy: 0.2469
2025-09-22 02:28:02 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:28:02 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:28:02 [INFO]  Round 13 Finish--------|
2025-09-22 02:28:02 [INFO]  Model variance: mean: 0.0016654494684189558, sum: 18609.65234375
2025-09-22 02:28:02 [INFO]  g_protos_std: 1.006582260131836
2025-09-22 02:28:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.4979
2025-09-22 02:28:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:28:09 [INFO]  Round 14 starts--------|
2025-09-22 02:28:09 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:28:09 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:28:09 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:29:02 [INFO]  Epoch 14 loss: 524.6794891357422; train accuracy: 0.6779700969827587; test accuracy: 0.4008
2025-09-22 02:29:02 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:29:02 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:29:02 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:29:02 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:29:02 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:29:15 [INFO]  Epoch 14 loss: 109.4414381980896; train accuracy: 0.8245192307692307; test accuracy: 0.14
2025-09-22 02:29:15 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:29:15 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:29:15 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:29:15 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:29:15 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:29:28 [INFO]  Epoch 14 loss: 97.04938650131226; train accuracy: 0.8231534090909091; test accuracy: 0.1187
2025-09-22 02:29:28 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:29:28 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:29:28 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:29:28 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:29:28 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:30:13 [INFO]  Epoch 14 loss: 426.9739279747009; train accuracy: 0.5479138962765957; test accuracy: 0.2851
2025-09-22 02:30:13 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:30:13 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:30:13 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:30:13 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:30:13 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:30:40 [INFO]  Epoch 14 loss: 265.5200185775757; train accuracy: 0.7380208333333333; test accuracy: 0.2357
2025-09-22 02:30:40 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:30:40 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:30:40 [INFO]  Round 14 Finish--------|
2025-09-22 02:30:40 [INFO]  Model variance: mean: 0.0017197314882650971, sum: 19216.197265625
2025-09-22 02:30:40 [INFO]  g_protos_std: 1.0065863132476807
2025-09-22 02:30:47 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5052
2025-09-22 02:30:47 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:30:47 [INFO]  Round 15 starts--------|
2025-09-22 02:30:47 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:30:47 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:30:47 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:31:40 [INFO]  Epoch 15 loss: 522.554575920105; train accuracy: 0.7676791487068966; test accuracy: 0.4497
2025-09-22 02:31:41 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_15.pth
2025-09-22 02:31:41 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:31:41 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:31:41 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:31:41 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:31:41 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:31:55 [INFO]  Epoch 15 loss: 109.4599061012268; train accuracy: 0.9005408653846154; test accuracy: 0.1817
2025-09-22 02:31:55 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_15.pth
2025-09-22 02:31:55 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:31:55 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:31:55 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:31:55 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:31:55 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:32:07 [INFO]  Epoch 15 loss: 96.35540771484375; train accuracy: 0.8464133522727273; test accuracy: 0.1008
2025-09-22 02:32:08 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_15.pth
2025-09-22 02:32:08 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:32:08 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:32:08 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:32:08 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:32:08 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:32:51 [INFO]  Epoch 15 loss: 419.67119312286377; train accuracy: 0.7583942819148937; test accuracy: 0.3824
2025-09-22 02:32:51 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_15.pth
2025-09-22 02:32:51 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:32:51 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:32:51 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:32:51 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:32:51 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:33:20 [INFO]  Epoch 15 loss: 266.26697540283203; train accuracy: 0.7670572916666667; test accuracy: 0.2516
2025-09-22 02:33:21 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_15.pth
2025-09-22 02:33:21 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:33:21 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:33:21 [INFO]  Round 15 Finish--------|
2025-09-22 02:33:21 [INFO]  Model variance: mean: 0.0017739509930834174, sum: 19822.04296875
2025-09-22 02:33:21 [INFO]  g_protos_std: 1.0066108703613281
2025-09-22 02:33:27 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5201
2025-09-22 02:33:27 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:33:27 [INFO]  Round 16 starts--------|
2025-09-22 02:33:27 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:33:27 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:33:27 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:34:18 [INFO]  Epoch 16 loss: 512.2389302253723; train accuracy: 0.6990840517241379; test accuracy: 0.4141
2025-09-22 02:34:18 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:34:18 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:34:18 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:34:18 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:34:18 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:34:32 [INFO]  Epoch 16 loss: 109.28609561920166; train accuracy: 0.8772536057692307; test accuracy: 0.1816
2025-09-22 02:34:32 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:34:32 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:34:32 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:34:32 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:34:32 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:34:44 [INFO]  Epoch 16 loss: 96.66721725463867; train accuracy: 0.8474786931818182; test accuracy: 0.1
2025-09-22 02:34:44 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:34:44 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:34:44 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:34:44 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:34:44 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:35:24 [INFO]  Epoch 16 loss: 415.75045013427734; train accuracy: 0.7118101728723404; test accuracy: 0.3584
2025-09-22 02:35:24 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:35:24 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:35:24 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:35:24 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:35:24 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:35:54 [INFO]  Epoch 16 loss: 268.33890676498413; train accuracy: 0.7533854166666667; test accuracy: 0.2395
2025-09-22 02:35:54 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:35:54 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:35:54 [INFO]  Round 16 Finish--------|
2025-09-22 02:35:54 [INFO]  Model variance: mean: 0.0018269909778609872, sum: 20414.708984375
2025-09-22 02:35:54 [INFO]  g_protos_std: 1.0066173076629639
2025-09-22 02:36:01 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5116
2025-09-22 02:36:01 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:36:01 [INFO]  Round 17 starts--------|
2025-09-22 02:36:01 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:36:01 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:36:01 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:36:52 [INFO]  Epoch 17 loss: 505.6287808418274; train accuracy: 0.8356681034482759; test accuracy: 0.4921
2025-09-22 02:36:52 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:36:52 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:36:52 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:36:52 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:36:52 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:37:06 [INFO]  Epoch 17 loss: 109.3661732673645; train accuracy: 0.8819110576923077; test accuracy: 0.1606
2025-09-22 02:37:06 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:37:06 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:37:06 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:37:06 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:37:06 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:37:18 [INFO]  Epoch 17 loss: 96.48018550872803; train accuracy: 0.857421875; test accuracy: 0.1109
2025-09-22 02:37:18 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:37:18 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:37:18 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:37:18 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:37:18 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:38:01 [INFO]  Epoch 17 loss: 418.15903425216675; train accuracy: 0.7576047207446809; test accuracy: 0.3813
2025-09-22 02:38:01 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:38:01 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:38:01 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:38:01 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:38:01 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:38:28 [INFO]  Epoch 17 loss: 263.74276638031006; train accuracy: 0.7915364583333333; test accuracy: 0.2582
2025-09-22 02:38:28 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:38:28 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:38:28 [INFO]  Round 17 Finish--------|
2025-09-22 02:38:28 [INFO]  Model variance: mean: 0.0018777030054479837, sum: 20981.36328125
2025-09-22 02:38:28 [INFO]  g_protos_std: 1.006635069847107
2025-09-22 02:38:35 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5259
2025-09-22 02:38:35 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:38:35 [INFO]  Round 18 starts--------|
2025-09-22 02:38:35 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:38:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:38:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:39:25 [INFO]  Epoch 18 loss: 506.9389457702637; train accuracy: 0.80859375; test accuracy: 0.4775
2025-09-22 02:39:25 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:39:25 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:39:25 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:39:25 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:39:25 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:39:38 [INFO]  Epoch 18 loss: 109.41607189178467; train accuracy: 0.8704927884615384; test accuracy: 0.1553
2025-09-22 02:39:38 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:39:38 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:39:38 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:39:38 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:39:38 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:39:51 [INFO]  Epoch 18 loss: 96.74403047561646; train accuracy: 0.8469460227272727; test accuracy: 0.1
2025-09-22 02:39:51 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:39:51 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:39:51 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:39:51 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:39:51 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:40:31 [INFO]  Epoch 18 loss: 406.885272026062; train accuracy: 0.7062001329787234; test accuracy: 0.3566
2025-09-22 02:40:31 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:40:31 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:40:31 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:40:31 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:40:31 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:40:59 [INFO]  Epoch 18 loss: 265.4153594970703; train accuracy: 0.7708333333333334; test accuracy: 0.2502
2025-09-22 02:40:59 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:40:59 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:40:59 [INFO]  Round 18 Finish--------|
2025-09-22 02:40:59 [INFO]  Model variance: mean: 0.0019264448201283813, sum: 21526.001953125
2025-09-22 02:40:59 [INFO]  g_protos_std: 1.0066477060317993
2025-09-22 02:41:05 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5087
2025-09-22 02:41:05 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:41:05 [INFO]  Round 19 starts--------|
2025-09-22 02:41:05 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:41:05 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:41:05 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:41:58 [INFO]  Epoch 19 loss: 503.44975423812866; train accuracy: 0.7561287715517241; test accuracy: 0.4453
2025-09-22 02:41:58 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:41:58 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:41:58 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:41:58 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:41:58 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:42:13 [INFO]  Epoch 19 loss: 109.64374780654907; train accuracy: 0.8156550480769231; test accuracy: 0.1344
2025-09-22 02:42:13 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:42:13 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:42:13 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:42:13 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:42:13 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:42:24 [INFO]  Epoch 19 loss: 96.38730907440186; train accuracy: 0.8693181818181818; test accuracy: 0.1191
2025-09-22 02:42:24 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:42:24 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:42:24 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:42:24 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:42:24 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:43:03 [INFO]  Epoch 19 loss: 413.63271856307983; train accuracy: 0.7469664228723404; test accuracy: 0.3729
2025-09-22 02:43:03 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:43:03 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:43:03 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:43:03 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:43:03 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:43:31 [INFO]  Epoch 19 loss: 261.07421112060547; train accuracy: 0.7620442708333334; test accuracy: 0.2611
2025-09-22 02:43:31 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:43:31 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:43:31 [INFO]  Round 19 Finish--------|
2025-09-22 02:43:31 [INFO]  Model variance: mean: 0.0019745889585465193, sum: 22063.9609375
2025-09-22 02:43:31 [INFO]  g_protos_std: 1.0066587924957275
2025-09-22 02:43:38 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5178
2025-09-22 02:43:38 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml
2025-09-22 02:43:38 [INFO]  Round 20 starts--------|
2025-09-22 02:43:38 [INFO]  Client 0 Starts Local Trainning--------|
2025-09-22 02:43:38 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:43:38 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:44:28 [INFO]  Epoch 20 loss: 504.2744994163513; train accuracy: 0.7254849137931034; test accuracy: 0.4204
2025-09-22 02:44:28 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_0/epoch_20.pth
2025-09-22 02:44:28 [INFO]  Client 0 Finish Local Training--------|
2025-09-22 02:44:28 [INFO]  Client 0 Collecting Local Prototypes--------|
2025-09-22 02:44:28 [INFO]  Client 1 Starts Local Trainning--------|
2025-09-22 02:44:28 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:44:28 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:44:41 [INFO]  Epoch 20 loss: 109.18890237808228; train accuracy: 0.8820612980769231; test accuracy: 0.1634
2025-09-22 02:44:42 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_1/epoch_20.pth
2025-09-22 02:44:42 [INFO]  Client 1 Finish Local Training--------|
2025-09-22 02:44:42 [INFO]  Client 1 Collecting Local Prototypes--------|
2025-09-22 02:44:42 [INFO]  Client 2 Starts Local Trainning--------|
2025-09-22 02:44:42 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:44:42 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:44:54 [INFO]  Epoch 20 loss: 96.23696804046631; train accuracy: 0.8528053977272727; test accuracy: 0.1039
2025-09-22 02:44:54 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_2/epoch_20.pth
2025-09-22 02:44:54 [INFO]  Client 2 Finish Local Training--------|
2025-09-22 02:44:54 [INFO]  Client 2 Collecting Local Prototypes--------|
2025-09-22 02:44:54 [INFO]  Client 3 Starts Local Trainning--------|
2025-09-22 02:44:54 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:44:54 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:45:34 [INFO]  Epoch 20 loss: 409.8239550590515; train accuracy: 0.7703623670212766; test accuracy: 0.3862
2025-09-22 02:45:34 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_3/epoch_20.pth
2025-09-22 02:45:34 [INFO]  Client 3 Finish Local Training--------|
2025-09-22 02:45:34 [INFO]  Client 3 Collecting Local Prototypes--------|
2025-09-22 02:45:34 [INFO]  Client 4 Starts Local Trainning--------|
2025-09-22 02:45:35 [INFO]  Dynamically determined feature dimension: 512
2025-09-22 02:45:35 [INFO]  Client using Memory Bank with size 4096 and feature dim 512
2025-09-22 02:46:02 [INFO]  Epoch 20 loss: 260.77979373931885; train accuracy: 0.8143229166666667; test accuracy: 0.2741
2025-09-22 02:46:02 [INFO]  Save the model in ./checkpoints/CIFAR10_alpha0.05/local_models/client_4/epoch_20.pth
2025-09-22 02:46:02 [INFO]  Client 4 Finish Local Training--------|
2025-09-22 02:46:02 [INFO]  Client 4 Collecting Local Prototypes--------|
2025-09-22 02:46:02 [INFO]  Round 20 Finish--------|
2025-09-22 02:46:02 [INFO]  Model variance: mean: 0.0020208144560456276, sum: 22580.482421875
2025-09-22 02:46:02 [INFO]  g_protos_std: 1.0066732168197632
2025-09-22 02:46:09 [INFO]  The test accuracy (with prototype) of OneShotOurs+Ensemble: 0.5214
2025-09-22 02:46:09 [INFO]  Save config to ./checkpoints/CIFAR10_alpha0.05/baselines_OneShotOurs+Ensemble_CIFAR10_results.yaml




